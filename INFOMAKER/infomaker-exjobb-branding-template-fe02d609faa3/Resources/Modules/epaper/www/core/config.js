(function(){var e=this,t=e._,n={},r=Array.prototype,i=Object.prototype,s=Function.prototype,o=r.push,u=r.slice,a=r.concat,f=i.toString,l=i.hasOwnProperty,c=r.forEach,h=r.map,p=r.reduce,d=r.reduceRight,v=r.filter,m=r.every,g=r.some,y=r.indexOf,b=r.lastIndexOf,w=Array.isArray,E=Object.keys,S=s.bind,x=function(e){return e instanceof x?e:this instanceof x?(this._wrapped=e,void 0):new x(e)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=x),exports._=x):e._=x,x.VERSION="1.4.4";var T=x.each=x.forEach=function(e,t,r){if(null!=e)if(c&&e.forEach===c)e.forEach(t,r);else if(e.length===+e.length){for(var i=0,s=e.length;s>i;i++)if(t.call(r,e[i],i,e)===n)return}else for(var o in e)if(x.has(e,o)&&t.call(r,e[o],o,e)===n)return};x.map=x.collect=function(e,t,n){var r=[];return null==e?r:h&&e.map===h?e.map(t,n):(T(e,function(e,i,s){r[r.length]=t.call(n,e,i,s)}),r)};var N="Reduce of empty array with no initial value";x.reduce=x.foldl=x.inject=function(e,t,n,r){var i=arguments.length>2;if(null==e&&(e=[]),p&&e.reduce===p)return r&&(t=x.bind(t,r)),i?e.reduce(t,n):e.reduce(t);if(T(e,function(e,s,o){i?n=t.call(r,n,e,s,o):(n=e,i=!0)}),!i)throw new TypeError(N);return n},x.reduceRight=x.foldr=function(e,t,n,r){var i=arguments.length>2;if(null==e&&(e=[]),d&&e.reduceRight===d)return r&&(t=x.bind(t,r)),i?e.reduceRight(t,n):e.reduceRight(t);var s=e.length;if(s!==+s){var o=x.keys(e);s=o.length}if(T(e,function(u,a,f){a=o?o[--s]:--s,i?n=t.call(r,n,e[a],a,f):(n=e[a],i=!0)}),!i)throw new TypeError(N);return n},x.find=x.detect=function(e,t,n){var r;return C(e,function(e,i,s){return t.call(n,e,i,s)?(r=e,!0):void 0}),r},x.filter=x.select=function(e,t,n){var r=[];return null==e?r:v&&e.filter===v?e.filter(t,n):(T(e,function(e,i,s){t.call(n,e,i,s)&&(r[r.length]=e)}),r)},x.reject=function(e,t,n){return x.filter(e,function(e,r,i){return!t.call(n,e,r,i)},n)},x.every=x.all=function(e,t,r){t||(t=x.identity);var i=!0;return null==e?i:m&&e.every===m?e.every(t,r):(T(e,function(e,s,o){return(i=i&&t.call(r,e,s,o))?void 0:n}),!!i)};var C=x.some=x.any=function(e,t,r){t||(t=x.identity);var i=!1;return null==e?i:g&&e.some===g?e.some(t,r):(T(e,function(e,s,o){return i||(i=t.call(r,e,s,o))?n:void 0}),!!i)};x.contains=x.include=function(e,t){return null==e?!1:y&&e.indexOf===y?e.indexOf(t)!=-1:C(e,function(e){return e===t})},x.invoke=function(e,t){var n=u.call(arguments,2),r=x.isFunction(t);return x.map(e,function(e){return(r?t:e[t]).apply(e,n)})},x.pluck=function(e,t){return x.map(e,function(e){return e[t]})},x.where=function(e,t,n){return x.isEmpty(t)?n?null:[]:x[n?"find":"filter"](e,function(e){for(var n in t)if(t[n]!==e[n])return!1;return!0})},x.findWhere=function(e,t){return x.where(e,t,!0)},x.max=function(e,t,n){if(!t&&x.isArray(e)&&e[0]===+e[0]&&65535>e.length)return Math.max.apply(Math,e);if(!t&&x.isEmpty(e))return-1/0;var r={computed:-1/0,value:-1/0};return T(e,function(e,i,s){var o=t?t.call(n,e,i,s):e;o>=r.computed&&(r={value:e,computed:o})}),r.value},x.min=function(e,t,n){if(!t&&x.isArray(e)&&e[0]===+e[0]&&65535>e.length)return Math.min.apply(Math,e);if(!t&&x.isEmpty(e))return 1/0;var r={computed:1/0,value:1/0};return T(e,function(e,i,s){var o=t?t.call(n,e,i,s):e;r.computed>o&&(r={value:e,computed:o})}),r.value},x.shuffle=function(e){var t,n=0,r=[];return T(e,function(e){t=x.random(n++),r[n-1]=r[t],r[t]=e}),r};var k=function(e){return x.isFunction(e)?e:function(t){return t[e]}};x.sortBy=function(e,t,n){var r=k(t);return x.pluck(x.map(e,function(e,t,i){return{value:e,index:t,criteria:r.call(n,e,t,i)}}).sort(function(e,t){var n=e.criteria,r=t.criteria;if(n!==r){if(n>r||n===void 0)return 1;if(r>n||r===void 0)return-1}return e.index<t.index?-1:1}),"value")};var L=function(e,t,n,r){var i={},s=k(t||x.identity);return T(e,function(t,o){var u=s.call(n,t,o,e);r(i,u,t)}),i};x.groupBy=function(e,t,n){return L(e,t,n,function(e,t,n){(x.has(e,t)?e[t]:e[t]=[]).push(n)})},x.countBy=function(e,t,n){return L(e,t,n,function(e,t){x.has(e,t)||(e[t]=0),e[t]++})},x.sortedIndex=function(e,t,n,r){n=null==n?x.identity:k(n);for(var i=n.call(r,t),s=0,o=e.length;o>s;){var u=s+o>>>1;i>n.call(r,e[u])?s=u+1:o=u}return s},x.toArray=function(e){return e?x.isArray(e)?u.call(e):e.length===+e.length?x.map(e,x.identity):x.values(e):[]},x.size=function(e){return null==e?0:e.length===+e.length?e.length:x.keys(e).length},x.first=x.head=x.take=function(e,t,n){return null==e?void 0:null==t||n?e[0]:u.call(e,0,t)},x.initial=function(e,t,n){return u.call(e,0,e.length-(null==t||n?1:t))},x.last=function(e,t,n){return null==e?void 0:null==t||n?e[e.length-1]:u.call(e,Math.max(e.length-t,0))},x.rest=x.tail=x.drop=function(e,t,n){return u.call(e,null==t||n?1:t)},x.compact=function(e){return x.filter(e,x.identity)};var A=function(e,t,n){return T(e,function(e){x.isArray(e)?t?o.apply(n,e):A(e,t,n):n.push(e)}),n};x.flatten=function(e,t){return A(e,t,[])},x.without=function(e){return x.difference(e,u.call(arguments,1))},x.uniq=x.unique=function(e,t,n,r){x.isFunction(t)&&(r=n,n=t,t=!1);var i=n?x.map(e,n,r):e,s=[],o=[];return T(i,function(n,r){(t?r&&o[o.length-1]===n:x.contains(o,n))||(o.push(n),s.push(e[r]))}),s},x.union=function(){return x.uniq(a.apply(r,arguments))},x.intersection=function(e){var t=u.call(arguments,1);return x.filter(x.uniq(e),function(e){return x.every(t,function(t){return x.indexOf(t,e)>=0})})},x.difference=function(e){var t=a.apply(r,u.call(arguments,1));return x.filter(e,function(e){return!x.contains(t,e)})},x.zip=function(){for(var e=u.call(arguments),t=x.max(x.pluck(e,"length")),n=Array(t),r=0;t>r;r++)n[r]=x.pluck(e,""+r);return n},x.object=function(e,t){if(null==e)return{};for(var n={},r=0,i=e.length;i>r;r++)t?n[e[r]]=t[r]:n[e[r][0]]=e[r][1];return n},x.indexOf=function(e,t,n){if(null==e)return-1;var r=0,i=e.length;if(n){if("number"!=typeof n)return r=x.sortedIndex(e,t),e[r]===t?r:-1;r=0>n?Math.max(0,i+n):n}if(y&&e.indexOf===y)return e.indexOf(t,n);for(;i>r;r++)if(e[r]===t)return r;return-1},x.lastIndexOf=function(e,t,n){if(null==e)return-1;var r=null!=n;if(b&&e.lastIndexOf===b)return r?e.lastIndexOf(t,n):e.lastIndexOf(t);for(var i=r?n:e.length;i--;)if(e[i]===t)return i;return-1},x.range=function(e,t,n){1>=arguments.length&&(t=e||0,e=0),n=arguments[2]||1;for(var r=Math.max(Math.ceil((t-e)/n),0),i=0,s=Array(r);r>i;)s[i++]=e,e+=n;return s},x.bind=function(e,t){if(e.bind===S&&S)return S.apply(e,u.call(arguments,1));var n=u.call(arguments,2);return function(){return e.apply(t,n.concat(u.call(arguments)))}},x.partial=function(e){var t=u.call(arguments,1);return function(){return e.apply(this,t.concat(u.call(arguments)))}},x.bindAll=function(e){var t=u.call(arguments,1);return 0===t.length&&(t=x.functions(e)),T(t,function(t){e[t]=x.bind(e[t],e)}),e},x.memoize=function(e,t){var n={};return t||(t=x.identity),function(){var r=t.apply(this,arguments);return x.has(n,r)?n[r]:n[r]=e.apply(this,arguments)}},x.delay=function(e,t){var n=u.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},x.defer=function(e){return x.delay.apply(x,[e,1].concat(u.call(arguments,1)))},x.throttle=function(e,t){var n,r,i,s,o=0,u=function(){o=new Date,i=null,s=e.apply(n,r)};return function(){var a=new Date,f=t-(a-o);return n=this,r=arguments,0>=f?(clearTimeout(i),i=null,o=a,s=e.apply(n,r)):i||(i=setTimeout(u,f)),s}},x.debounce=function(e,t,n){var r,i;return function(){var s=this,o=arguments,u=function(){r=null,n||(i=e.apply(s,o))},a=n&&!r;return clearTimeout(r),r=setTimeout(u,t),a&&(i=e.apply(s,o)),i}},x.once=function(e){var t,n=!1;return function(){return n?t:(n=!0,t=e.apply(this,arguments),e=null,t)}},x.wrap=function(e,t){return function(){var n=[e];return o.apply(n,arguments),t.apply(this,n)}},x.compose=function(){var e=arguments;return function(){for(var t=arguments,n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}},x.after=function(e,t){return 0>=e?t():function(){return 1>--e?t.apply(this,arguments):void 0}},x.keys=E||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var n in e)x.has(e,n)&&(t[t.length]=n);return t},x.values=function(e){var t=[];for(var n in e)x.has(e,n)&&t.push(e[n]);return t},x.pairs=function(e){var t=[];for(var n in e)x.has(e,n)&&t.push([n,e[n]]);return t},x.invert=function(e){var t={};for(var n in e)x.has(e,n)&&(t[e[n]]=n);return t},x.functions=x.methods=function(e){var t=[];for(var n in e)x.isFunction(e[n])&&t.push(n);return t.sort()},x.extend=function(e){return T(u.call(arguments,1),function(t){if(t)for(var n in t)e[n]=t[n]}),e},x.pick=function(e){var t={},n=a.apply(r,u.call(arguments,1));return T(n,function(n){n in e&&(t[n]=e[n])}),t},x.omit=function(e){var t={},n=a.apply(r,u.call(arguments,1));for(var i in e)x.contains(n,i)||(t[i]=e[i]);return t},x.defaults=function(e){return T(u.call(arguments,1),function(t){if(t)for(var n in t)null==e[n]&&(e[n]=t[n])}),e},x.clone=function(e){return x.isObject(e)?x.isArray(e)?e.slice():x.extend({},e):e},x.tap=function(e,t){return t(e),e};var O=function(e,t,n,r){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return e===t;e instanceof x&&(e=e._wrapped),t instanceof x&&(t=t._wrapped);var i=f.call(e);if(i!=f.call(t))return!1;switch(i){case"[object String]":return e==t+"";case"[object Number]":return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if("object"!=typeof e||"object"!=typeof t)return!1;for(var s=n.length;s--;)if(n[s]==e)return r[s]==t;n.push(e),r.push(t);var o=0,u=!0;if("[object Array]"==i){if(o=e.length,u=o==t.length)for(;o--&&(u=O(e[o],t[o],n,r)););}else{var a=e.constructor,l=t.constructor;if(a!==l&&!(x.isFunction(a)&&a instanceof a&&x.isFunction(l)&&l instanceof l))return!1;for(var c in e)if(x.has(e,c)&&(o++,!(u=x.has(t,c)&&O(e[c],t[c],n,r))))break;if(u){for(c in t)if(x.has(t,c)&&!(o--))break;u=!o}}return n.pop(),r.pop(),u};x.isEqual=function(e,t){return O(e,t,[],[])},x.isEmpty=function(e){if(null==e)return!0;if(x.isArray(e)||x.isString(e))return 0===e.length;for(var t in e)if(x.has(e,t))return!1;return!0},x.isElement=function(e){return!!e&&1===e.nodeType},x.isArray=w||function(e){return"[object Array]"==f.call(e)},x.isObject=function(e){return e===Object(e)},T(["Arguments","Function","String","Number","Date","RegExp"],function(e){x["is"+e]=function(t){return f.call(t)=="[object "+e+"]"}}),x.isArguments(arguments)||(x.isArguments=function(e){return!!e&&!!x.has(e,"callee")}),"function"!=typeof / . /&&(x.isFunction=function(e){return"function"==typeof e}),x.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},x.isNaN=function(e){return x.isNumber(e)&&e!=+e},x.isBoolean=function(e){return e===!0||e===!1||"[object Boolean]"==f.call(e)},x.isNull=function(e){return null===e},x.isUndefined=function(e){return e===void 0},x.has=function(e,t){return l.call(e,t)},x.noConflict=function(){return e._=t,this},x.identity=function(e){return e},x.times=function(e,t,n){for(var r=Array(e),i=0;e>i;i++)r[i]=t.call(n,i);return r},x.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))};var M={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};M.unescape=x.invert(M.escape);var _={escape:RegExp("["+x.keys(M.escape).join("")+"]","g"),unescape:RegExp("("+x.keys(M.unescape).join("|")+")","g")};x.each(["escape","unescape"],function(e){x[e]=function(t){return null==t?"":(""+t).replace(_[e],function(t){return M[e][t]})}}),x.result=function(e,t){if(null==e)return null;var n=e[t];return x.isFunction(n)?n.call(e):n},x.mixin=function(e){T(x.functions(e),function(t){var n=x[t]=e[t];x.prototype[t]=function(){var e=[this._wrapped];return o.apply(e,arguments),j.call(this,n.apply(x,e))}})};var D=0;x.uniqueId=function(e){var t=++D+"";return e?e+t:t},x.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var P=/(.)^/,H={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},B=/\\|'|\r|\n|\t|\u2028|\u2029/g;x.template=function(e,t,n){var r;n=x.defaults({},n,x.templateSettings);var i=RegExp([(n.escape||P).source,(n.interpolate||P).source,(n.evaluate||P).source].join("|")+"|$","g"),s=0,o="__p+='";e.replace(i,function(t,n,r,i,u){return o+=e.slice(s,u).replace(B,function(e){return"\\"+H[e]}),n&&(o+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'"),r&&(o+="'+\n((__t=("+r+"))==null?'':__t)+\n'"),i&&(o+="';\n"+i+"\n__p+='"),s=u+t.length,t}),o+="';\n",n.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{r=Function(n.variable||"obj","_",o)}catch(u){throw u.source=o,u}if(t)return r(t,x);var a=function(e){return r.call(this,e,x)};return a.source="function("+(n.variable||"obj")+"){\n"+o+"}",a},x.chain=function(e){return x(e).chain()};var j=function(e){return this._chain?x(e).chain():e};x.mixin(x),T(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=r[e];x.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),"shift"!=e&&"splice"!=e||0!==n.length||delete n[0],j.call(this,n)}}),T(["concat","join","slice"],function(e){var t=r[e];x.prototype[e]=function(){return j.call(this,t.apply(this._wrapped,arguments))}}),x.extend(x.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}).call(this),define("underscore",function(e){return function(){var t,n;return t||e._}}(this)),typeof JSON!="object"&&(JSON={}),function(){"use strict";function f(e){return e<10?"0"+e:e}function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return typeof t=="string"?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var n,r,i,s,o=gap,u,a=t[e];a&&typeof a=="object"&&typeof a.toJSON=="function"&&(a=a.toJSON(e)),typeof rep=="function"&&(a=rep.call(t,e,a));switch(typeof a){case"string":return quote(a);case"number":return isFinite(a)?String(a):"null";case"boolean":case"null":return String(a);case"object":if(!a)return"null";gap+=indent,u=[];if(Object.prototype.toString.apply(a)==="[object Array]"){s=a.length;for(n=0;n<s;n+=1)u[n]=str(n,a)||"null";return i=u.length===0?"[]":gap?"[\n"+gap+u.join(",\n"+gap)+"\n"+o+"]":"["+u.join(",")+"]",gap=o,i}if(rep&&typeof rep=="object"){s=rep.length;for(n=0;n<s;n+=1)typeof rep[n]=="string"&&(r=rep[n],i=str(r,a),i&&u.push(quote(r)+(gap?": ":":")+i))}else for(r in a)Object.prototype.hasOwnProperty.call(a,r)&&(i=str(r,a),i&&u.push(quote(r)+(gap?": ":":")+i));return i=u.length===0?"{}":gap?"{\n"+gap+u.join(",\n"+gap)+"\n"+o+"}":"{"+u.join(",")+"}",gap=o,i}}typeof Date.prototype.toJSON!="function"&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var cx,escapable,gap,indent,meta,rep;typeof JSON.stringify!="function"&&(escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(e,t,n){var r;gap="",indent="";if(typeof n=="number")for(r=0;r<n;r+=1)indent+=" ";else typeof n=="string"&&(indent=n);rep=t;if(!t||typeof t=="function"||typeof t=="object"&&typeof t.length=="number")return str("",{"":e});throw new Error("JSON.stringify")}),typeof JSON.parse!="function"&&(cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,JSON.parse=function(text,reviver){function walk(e,t){var n,r,i=e[t];if(i&&typeof i=="object")for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r=walk(i,n),r!==undefined?i[n]=r:delete i[n]);return reviver.call(e,t,i)}var j;text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),typeof reviver=="function"?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),function(e,t){typeof module=="object"&&typeof module.exports=="object"?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}(typeof window!="undefined"?window:this,function(window,noGlobal){function isArraylike(e){var t=e.length,n=jQuery.type(e);return n==="function"||jQuery.isWindow(e)?!1:e.nodeType===1&&t?!0:n==="array"||t===0||typeof t=="number"&&t>0&&t-1 in e}function winnow(e,t,n){if(jQuery.isFunction(t))return jQuery.grep(e,function(e,r){return!!t.call(e,r,e)!==n});if(t.nodeType)return jQuery.grep(e,function(e){return e===t!==n});if(typeof t=="string"){if(risSimple.test(t))return jQuery.filter(t,e,n);t=jQuery.filter(t,e)}return jQuery.grep(e,function(e){return indexOf.call(t,e)>=0!==n})}function sibling(e,t){while((e=e[t])&&e.nodeType!==1);return e}function createOptions(e){var t=optionsCache[e]={};return jQuery.each(e.match(rnotwhite)||[],function(e,n){t[n]=!0}),t}function completed(){document.removeEventListener("DOMContentLoaded",completed,!1),window.removeEventListener("load",completed,!1),jQuery.ready()}function Data(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=jQuery.expando+Math.random()}function dataAttr(e,t,n){var r;if(n===undefined&&e.nodeType===1){r="data-"+t.replace(rmultiDash,"-$1").toLowerCase(),n=e.getAttribute(r);if(typeof n=="string"){try{n=n==="true"?!0:n==="false"?!1:n==="null"?null:+n+""===n?+n:rbrace.test(n)?jQuery.parseJSON(n):n}catch(i){}data_user.set(e,t,n)}else n=undefined}return n}function returnTrue(){return!0}function returnFalse(){return!1}function safeActiveElement(){try{return document.activeElement}catch(e){}}function manipulationTarget(e,t){return jQuery.nodeName(e,"table")&&jQuery.nodeName(t.nodeType!==11?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function disableScript(e){return e.type=(e.getAttribute("type")!==null)+"/"+e.type,e}function restoreScript(e){var t=rscriptTypeMasked.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function setGlobalEval(e,t){var n=0,r=e.length;for(;n<r;n++)data_priv.set(e[n],"globalEval",!t||data_priv.get(t[n],"globalEval"))}function cloneCopyEvent(e,t){var n,r,i,s,o,u,a,f;if(t.nodeType!==1)return;if(data_priv.hasData(e)){s=data_priv.access(e),o=data_priv.set(t,s),f=s.events;if(f){delete o.handle,o.events={};for(i in f)for(n=0,r=f[i].length;n<r;n++)jQuery.event.add(t,i,f[i][n])}}data_user.hasData(e)&&(u=data_user.access(e),a=jQuery.extend({},u),data_user.set(t,a))}function getAll(e,t){var n=e.getElementsByTagName?e.getElementsByTagName(t||"*"):e.querySelectorAll?e.querySelectorAll(t||"*"):[];return t===undefined||t&&jQuery.nodeName(e,t)?jQuery.merge([e],n):n}function fixInput(e,t){var n=t.nodeName.toLowerCase();if(n==="input"&&rcheckableType.test(e.type))t.checked=e.checked;else if(n==="input"||n==="textarea")t.defaultValue=e.defaultValue}function actualDisplay(e,t){var n,r=jQuery(t.createElement(e)).appendTo(t.body),i=window.getDefaultComputedStyle&&(n=window.getDefaultComputedStyle(r[0]))?n.display:jQuery.css(r[0],"display");return r.detach(),i}function defaultDisplay(e){var t=document,n=elemdisplay[e];if(!n){n=actualDisplay(e,t);if(n==="none"||!n)iframe=(iframe||jQuery("<iframe frameborder='0' width='0' height='0'/>")).appendTo(t.documentElement),t=iframe[0].contentDocument,t.write(),t.close(),n=actualDisplay(e,t),iframe.detach();elemdisplay[e]=n}return n}function curCSS(e,t,n){var r,i,s,o,u=e.style;return n=n||getStyles(e),n&&(o=n.getPropertyValue(t)||n[t]),n&&(o===""&&!jQuery.contains(e.ownerDocument,e)&&(o=jQuery.style(e,t)),rnumnonpx.test(o)&&rmargin.test(t)&&(r=u.width,i=u.minWidth,s=u.maxWidth,u.minWidth=u.maxWidth=u.width=o,o=n.width,u.width=r,u.minWidth=i,u.maxWidth=s)),o!==undefined?o+"":o}function addGetHookIf(e,t){return{get:function(){if(e()){delete this.get;return}return(this.get=t).apply(this,arguments)}}}function vendorPropName(e,t){if(t in e)return t;var n=t[0].toUpperCase()+t.slice(1),r=t,i=cssPrefixes.length;while(i--){t=cssPrefixes[i]+n;if(t in e)return t}return r}function setPositiveNumber(e,t,n){var r=rnumsplit.exec(t);return r?Math.max(0,r[1]-(n||0))+(r[2]||"px"):t}function augmentWidthOrHeight(e,t,n,r,i){var s=n===(r?"border":"content")?4:t==="width"?1:0,o=0;for(;s<4;s+=2)n==="margin"&&(o+=jQuery.css(e,n+cssExpand[s],!0,i)),r?(n==="content"&&(o-=jQuery.css(e,"padding"+cssExpand[s],!0,i)),n!=="margin"&&(o-=jQuery.css(e,"border"+cssExpand[s]+"Width",!0,i))):(o+=jQuery.css(e,"padding"+cssExpand[s],!0,i),n!=="padding"&&(o+=jQuery.css(e,"border"+cssExpand[s]+"Width",!0,i)));return o}function getWidthOrHeight(e,t,n){var r=!0,i=t==="width"?e.offsetWidth:e.offsetHeight,s=getStyles(e),o=jQuery.css(e,"boxSizing",!1,s)==="border-box";if(i<=0||i==null){i=curCSS(e,t,s);if(i<0||i==null)i=e.style[t];if(rnumnonpx.test(i))return i;r=o&&(support.boxSizingReliable()||i===e.style[t]),i=parseFloat(i)||0}return i+augmentWidthOrHeight(e,t,n||(o?"border":"content"),r,s)+"px"}function showHide(e,t){var n,r,i,s=[],o=0,u=e.length;for(;o<u;o++){r=e[o];if(!r.style)continue;s[o]=data_priv.get(r,"olddisplay"),n=r.style.display,t?(!s[o]&&n==="none"&&(r.style.display=""),r.style.display===""&&isHidden(r)&&(s[o]=data_priv.access(r,"olddisplay",defaultDisplay(r.nodeName)))):(i=isHidden(r),(n!=="none"||!i)&&data_priv.set(r,"olddisplay",i?n:jQuery.css(r,"display")))}for(o=0;o<u;o++){r=e[o];if(!r.style)continue;if(!t||r.style.display==="none"||r.style.display==="")r.style.display=t?s[o]||"":"none"}return e}function Tween(e,t,n,r,i){return new Tween.prototype.init(e,t,n,r,i)}function createFxNow(){return setTimeout(function(){fxNow=undefined}),fxNow=jQuery.now()}function genFx(e,t){var n,r=0,i={height:e};t=t?1:0;for(;r<4;r+=2-t)n=cssExpand[r],i["margin"+n]=i["padding"+n]=e;return t&&(i.opacity=i.width=e),i}function createTween(e,t,n){var r,i=(tweeners[t]||[]).concat(tweeners["*"]),s=0,o=i.length;for(;s<o;s++)if(r=i[s].call(n,t,e))return r}function defaultPrefilter(e,t,n){var r,i,s,o,u,a,f,l,c=this,h={},p=e.style,d=e.nodeType&&isHidden(e),v=data_priv.get(e,"fxshow");n.queue||(u=jQuery._queueHooks(e,"fx"),u.unqueued==null&&(u.unqueued=0,a=u.empty.fire,u.empty.fire=function(){u.unqueued||a()}),u.unqueued++,c.always(function(){c.always(function(){u.unqueued--,jQuery.queue(e,"fx").length||u.empty.fire()})})),e.nodeType===1&&("height"in t||"width"in t)&&(n.overflow=[p.overflow,p.overflowX,p.overflowY],f=jQuery.css(e,"display"),l=f==="none"?data_priv.get(e,"olddisplay")||defaultDisplay(e.nodeName):f,l==="inline"&&jQuery.css(e,"float")==="none"&&(p.display="inline-block")),n.overflow&&(p.overflow="hidden",c.always(function(){p.overflow=n.overflow[0],p.overflowX=n.overflow[1],p.overflowY=n.overflow[2]}));for(r in t){i=t[r];if(rfxtypes.exec(i)){delete t[r],s=s||i==="toggle";if(i===(d?"hide":"show")){if(i!=="show"||!v||v[r]===undefined)continue;d=!0}h[r]=v&&v[r]||jQuery.style(e,r)}else f=undefined}if(!jQuery.isEmptyObject(h)){v?"hidden"in v&&(d=v.hidden):v=data_priv.access(e,"fxshow",{}),s&&(v.hidden=!d),d?jQuery(e).show():c.done(function(){jQuery(e).hide()}),c.done(function(){var t;data_priv.remove(e,"fxshow");for(t in h)jQuery.style(e,t,h[t])});for(r in h)o=createTween(d?v[r]:0,r,c),r in v||(v[r]=o.start,d&&(o.end=o.start,o.start=r==="width"||r==="height"?1:0))}else(f==="none"?defaultDisplay(e.nodeName):f)==="inline"&&(p.display=f)}function propFilter(e,t){var n,r,i,s,o;for(n in e){r=jQuery.camelCase(n),i=t[r],s=e[n],jQuery.isArray(s)&&(i=s[1],s=e[n]=s[0]),n!==r&&(e[r]=s,delete e[n]),o=jQuery.cssHooks[r];if(o&&"expand"in o){s=o.expand(s),delete e[r];for(n in s)n in e||(e[n]=s[n],t[n]=i)}else t[r]=i}}function Animation(e,t,n){var r,i,s=0,o=animationPrefilters.length,u=jQuery.Deferred().always(function(){delete a.elem}),a=function(){if(i)return!1;var t=fxNow||createFxNow(),n=Math.max(0,f.startTime+f.duration-t),r=n/f.duration||0,s=1-r,o=0,a=f.tweens.length;for(;o<a;o++)f.tweens[o].run(s);return u.notifyWith(e,[f,s,n]),s<1&&a?n:(u.resolveWith(e,[f]),!1)},f=u.promise({elem:e,props:jQuery.extend({},t),opts:jQuery.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:fxNow||createFxNow(),duration:n.duration,tweens:[],createTween:function(t,n){var r=jQuery.Tween(e,f.opts,t,n,f.opts.specialEasing[t]||f.opts.easing);return f.tweens.push(r),r},stop:function(t){var n=0,r=t?f.tweens.length:0;if(i)return this;i=!0;for(;n<r;n++)f.tweens[n].run(1);return t?u.resolveWith(e,[f,t]):u.rejectWith(e,[f,t]),this}}),l=f.props;propFilter(l,f.opts.specialEasing);for(;s<o;s++){r=animationPrefilters[s].call(f,e,l,f.opts);if(r)return r}return jQuery.map(l,createTween,f),jQuery.isFunction(f.opts.start)&&f.opts.start.call(e,f),jQuery.fx.timer(jQuery.extend(a,{elem:e,anim:f,queue:f.opts.queue})),f.progress(f.opts.progress).done(f.opts.done,f.opts.complete).fail(f.opts.fail).always(f.opts.always)}function addToPrefiltersOrTransports(e){return function(t,n){typeof t!="string"&&(n=t,t="*");var r,i=0,s=t.toLowerCase().match(rnotwhite)||[];if(jQuery.isFunction(n))while(r=s[i++])r[0]==="+"?(r=r.slice(1)||"*",(e[r]=e[r]||[]).unshift(n)):(e[r]=e[r]||[]).push(n)}}function inspectPrefiltersOrTransports(e,t,n,r){function o(u){var a;return i[u]=!0,jQuery.each(e[u]||[],function(e,u){var f=u(t,n,r);if(typeof f=="string"&&!s&&!i[f])return t.dataTypes.unshift(f),o(f),!1;if(s)return!(a=f)}),a}var i={},s=e===transports;return o(t.dataTypes[0])||!i["*"]&&o("*")}function ajaxExtend(e,t){var n,r,i=jQuery.ajaxSettings.flatOptions||{};for(n in t)t[n]!==undefined&&((i[n]?e:r||(r={}))[n]=t[n]);return r&&jQuery.extend(!0,e,r),e}function ajaxHandleResponses(e,t,n){var r,i,s,o,u=e.contents,a=e.dataTypes;while(a[0]==="*")a.shift(),r===undefined&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(i in u)if(u[i]&&u[i].test(r)){a.unshift(i);break}if(a[0]in n)s=a[0];else{for(i in n){if(!a[0]||e.converters[i+" "+a[0]]){s=i;break}o||(o=i)}s=s||o}if(s)return s!==a[0]&&a.unshift(s),n[s]}function ajaxConvert(e,t,n,r){var i,s,o,u,a,f={},l=e.dataTypes.slice();if(l[1])for(o in e.converters)f[o.toLowerCase()]=e.converters[o];s=l.shift();while(s){e.responseFields[s]&&(n[e.responseFields[s]]=t),!a&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),a=s,s=l.shift();if(s)if(s==="*")s=a;else if(a!=="*"&&a!==s){o=f[a+" "+s]||f["* "+s];if(!o)for(i in f){u=i.split(" ");if(u[1]===s){o=f[a+" "+u[0]]||f["* "+u[0]];if(o){o===!0?o=f[i]:f[i]!==!0&&(s=u[0],l.unshift(u[1]));break}}}if(o!==!0)if(o&&e["throws"])t=o(t);else try{t=o(t)}catch(c){return{state:"parsererror",error:o?c:"No conversion from "+a+" to "+s}}}}return{state:"success",data:t}}function buildParams(e,t,n,r){var i;if(jQuery.isArray(t))jQuery.each(t,function(t,i){n||rbracket.test(e)?r(e,i):buildParams(e+"["+(typeof i=="object"?t:"")+"]",i,n,r)});else if(!n&&jQuery.type(t)==="object")for(i in t)buildParams(e+"["+i+"]",t[i],n,r);else r(e,t)}function getWindow(e){return jQuery.isWindow(e)?e:e.nodeType===9&&e.defaultView}var arr=[],slice=arr.slice,concat=arr.concat,push=arr.push,indexOf=arr.indexOf,class2type={},toString=class2type.toString,hasOwn=class2type.hasOwnProperty,support={},document=window.document,version="2.1.1",jQuery=function(e,t){return new jQuery.fn.init(e,t)},rtrim=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,rmsPrefix=/^-ms-/,rdashAlpha=/-([\da-z])/gi,fcamelCase=function(e,t){return t.toUpperCase()};jQuery.fn=jQuery.prototype={jquery:version,constructor:jQuery,selector:"",length:0,toArray:function(){return slice.call(this)},get:function(e){return e!=null?e<0?this[e+this.length]:this[e]:slice.call(this)},pushStack:function(e){var t=jQuery.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return jQuery.each(this,e,t)},map:function(e){return this.pushStack(jQuery.map(this,function(t,n){return e.call(t,n,t)}))},slice:function(){return this.pushStack(slice.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(e<0?t:0);return this.pushStack(n>=0&&n<t?[this[n]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:push,sort:arr.sort,splice:arr.splice},jQuery.extend=jQuery.fn.extend=function(){var e,t,n,r,i,s,o=arguments[0]||{},u=1,a=arguments.length,f=!1;typeof o=="boolean"&&(f=o,o=arguments[u]||{},u++),typeof o!="object"&&!jQuery.isFunction(o)&&(o={}),u===a&&(o=this,u--);for(;u<a;u++)if((e=arguments[u])!=null)for(t in e){n=o[t],r=e[t];if(o===r)continue;f&&r&&(jQuery.isPlainObject(r)||(i=jQuery.isArray(r)))?(i?(i=!1,s=n&&jQuery.isArray(n)?n:[]):s=n&&jQuery.isPlainObject(n)?n:{},o[t]=jQuery.extend(f,s,r)):r!==undefined&&(o[t]=r)}return o},jQuery.extend({expando:"jQuery"+(version+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isFunction:function(e){return jQuery.type(e)==="function"},isArray:Array.isArray,isWindow:function(e){return e!=null&&e===e.window},isNumeric:function(e){return!jQuery.isArray(e)&&e-parseFloat(e)>=0},isPlainObject:function(e){return jQuery.type(e)!=="object"||e.nodeType||jQuery.isWindow(e)?!1:e.constructor&&!hasOwn.call(e.constructor.prototype,"isPrototypeOf")?!1:!0},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},type:function(e){return e==null?e+"":typeof e=="object"||typeof e=="function"?class2type[toString.call(e)]||"object":typeof e},globalEval:function(code){var script,indirect=eval;code=jQuery.trim(code),code&&(code.indexOf("use strict")===1?(script=document.createElement("script"),script.text=code,document.head.appendChild(script).parentNode.removeChild(script)):indirect(code))},camelCase:function(e){return e.replace(rmsPrefix,"ms-").replace(rdashAlpha,fcamelCase)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,n){var r,i=0,s=e.length,o=isArraylike(e);if(n)if(o)for(;i<s;i++){r=t.apply(e[i],n);if(r===!1)break}else for(i in e){r=t.apply(e[i],n);if(r===!1)break}else if(o)for(;i<s;i++){r=t.call(e[i],i,e[i]);if(r===!1)break}else for(i in e){r=t.call(e[i],i,e[i]);if(r===!1)break}return e},trim:function(e){return e==null?"":(e+"").replace(rtrim,"")},makeArray:function(e,t){var n=t||[];return e!=null&&(isArraylike(Object(e))?jQuery.merge(n,typeof e=="string"?[e]:e):push.call(n,e)),n},inArray:function(e,t,n){return t==null?-1:indexOf.call(t,e,n)},merge:function(e,t){var n=+t.length,r=0,i=e.length;for(;r<n;r++)e[i++]=t[r];return e.length=i,e},grep:function(e,t,n){var r,i=[],s=0,o=e.length,u=!n;for(;s<o;s++)r=!t(e[s],s),r!==u&&i.push(e[s]);return i},map:function(e,t,n){var r,i=0,s=e.length,o=isArraylike(e),u=[];if(o)for(;i<s;i++)r=t(e[i],i,n),r!=null&&u.push(r);else for(i in e)r=t(e[i],i,n),r!=null&&u.push(r);return concat.apply([],u)},guid:1,proxy:function(e,t){var n,r,i;return typeof t=="string"&&(n=e[t],t=e,e=n),jQuery.isFunction(e)?(r=slice.call(arguments,2),i=function(){return e.apply(t||this,r.concat(slice.call(arguments)))},i.guid=e.guid=e.guid||jQuery.guid++,i):undefined},now:Date.now,support:support}),jQuery.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){class2type["[object "+t+"]"]=t.toLowerCase()});var Sizzle=function(e){function st(e,t,r,i){var s,u,f,l,c,d,g,y,S,x;(t?t.ownerDocument||t:E)!==p&&h(t),t=t||p,r=r||[];if(!e||typeof e!="string")return r;if((l=t.nodeType)!==1&&l!==9)return[];if(v&&!i){if(s=Z.exec(e))if(f=s[1]){if(l===9){u=t.getElementById(f);if(!u||!u.parentNode)return r;if(u.id===f)return r.push(u),r}else if(t.ownerDocument&&(u=t.ownerDocument.getElementById(f))&&b(t,u)&&u.id===f)return r.push(u),r}else{if(s[2])return P.apply(r,t.getElementsByTagName(e)),r;if((f=s[3])&&n.getElementsByClassName&&t.getElementsByClassName)return P.apply(r,t.getElementsByClassName(f)),r}if(n.qsa&&(!m||!m.test(e))){y=g=w,S=t,x=l===9&&e;if(l===1&&t.nodeName.toLowerCase()!=="object"){d=o(e),(g=t.getAttribute("id"))?y=g.replace(tt,"\\$&"):t.setAttribute("id",y),y="[id='"+y+"'] ",c=d.length;while(c--)d[c]=y+mt(d[c]);S=et.test(e)&&dt(t.parentNode)||t,x=d.join(",")}if(x)try{return P.apply(r,S.querySelectorAll(x)),r}catch(T){}finally{g||t.removeAttribute("id")}}}return a(e.replace(z,"$1"),t,r,i)}function ot(){function t(n,i){return e.push(n+" ")>r.cacheLength&&delete t[e.shift()],t[n+" "]=i}var e=[];return t}function ut(e){return e[w]=!0,e}function at(e){var t=p.createElement("div");try{return!!e(t)}catch(n){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function ft(e,t){var n=e.split("|"),i=e.length;while(i--)r.attrHandle[n[i]]=t}function lt(e,t){var n=t&&e,r=n&&e.nodeType===1&&t.nodeType===1&&(~t.sourceIndex||A)-(~e.sourceIndex||A);if(r)return r;if(n)while(n=n.nextSibling)if(n===t)return-1;return e?1:-1}function ct(e){return function(t){var n=t.nodeName.toLowerCase();return n==="input"&&t.type===e}}function ht(e){return function(t){var n=t.nodeName.toLowerCase();return(n==="input"||n==="button")&&t.type===e}}function pt(e){return ut(function(t){return t=+t,ut(function(n,r){var i,s=e([],n.length,t),o=s.length;while(o--)n[i=s[o]]&&(n[i]=!(r[i]=n[i]))})})}function dt(e){return e&&typeof e.getElementsByTagName!==L&&e}function vt(){}function mt(e){var t=0,n=e.length,r="";for(;t<n;t++)r+=e[t].value;return r}function gt(e,t,n){var r=t.dir,i=n&&r==="parentNode",s=x++;return t.first?function(t,n,s){while(t=t[r])if(t.nodeType===1||i)return e(t,n,s)}:function(t,n,o){var u,a,f=[S,s];if(o){while(t=t[r])if(t.nodeType===1||i)if(e(t,n,o))return!0}else while(t=t[r])if(t.nodeType===1||i){a=t[w]||(t[w]={});if((u=a[r])&&u[0]===S&&u[1]===s)return f[2]=u[2];a[r]=f;if(f[2]=e(t,n,o))return!0}}}function yt(e){return e.length>1?function(t,n,r){var i=e.length;while(i--)if(!e[i](t,n,r))return!1;return!0}:e[0]}function bt(e,t,n){var r=0,i=t.length;for(;r<i;r++)st(e,t[r],n);return n}function wt(e,t,n,r,i){var s,o=[],u=0,a=e.length,f=t!=null;for(;u<a;u++)if(s=e[u])if(!n||n(s,r,i))o.push(s),f&&t.push(u);return o}function Et(e,t,n,r,i,s){return r&&!r[w]&&(r=Et(r)),i&&!i[w]&&(i=Et(i,s)),ut(function(s,o,u,a){var f,l,c,h=[],p=[],d=o.length,v=s||bt(t||"*",u.nodeType?[u]:u,[]),m=e&&(s||!t)?wt(v,h,e,u,a):v,g=n?i||(s?e:d||r)?[]:o:m;n&&n(m,g,u,a);if(r){f=wt(g,p),r(f,[],u,a),l=f.length;while(l--)if(c=f[l])g[p[l]]=!(m[p[l]]=c)}if(s){if(i||e){if(i){f=[],l=g.length;while(l--)(c=g[l])&&f.push(m[l]=c);i(null,g=[],f,a)}l=g.length;while(l--)(c=g[l])&&(f=i?B.call(s,c):h[l])>-1&&(s[f]=!(o[f]=c))}}else g=wt(g===o?g.splice(d,g.length):g),i?i(null,o,g,a):P.apply(o,g)})}function St(e){var t,n,i,s=e.length,o=r.relative[e[0].type],u=o||r.relative[" "],a=o?1:0,l=gt(function(e){return e===t},u,!0),c=gt(function(e){return B.call(t,e)>-1},u,!0),h=[function(e,n,r){return!o&&(r||n!==f)||((t=n).nodeType?l(e,n,r):c(e,n,r))}];for(;a<s;a++)if(n=r.relative[e[a].type])h=[gt(yt(h),n)];else{n=r.filter[e[a].type].apply(null,e[a].matches);if(n[w]){i=++a;for(;i<s;i++)if(r.relative[e[i].type])break;return Et(a>1&&yt(h),a>1&&mt(e.slice(0,a-1).concat({value:e[a-2].type===" "?"*":""})).replace(z,"$1"),n,a<i&&St(e.slice(a,i)),i<s&&St(e=e.slice(i)),i<s&&mt(e))}h.push(n)}return yt(h)}function xt(e,t){var n=t.length>0,i=e.length>0,s=function(s,o,u,a,l){var c,h,d,v=0,m="0",g=s&&[],y=[],b=f,w=s||i&&r.find.TAG("*",l),E=S+=b==null?1:Math.random()||.1,x=w.length;l&&(f=o!==p&&o);for(;m!==x&&(c=w[m])!=null;m++){if(i&&c){h=0;while(d=e[h++])if(d(c,o,u)){a.push(c);break}l&&(S=E)}n&&((c=!d&&c)&&v--,s&&g.push(c))}v+=m;if(n&&m!==v){h=0;while(d=t[h++])d(g,y,o,u);if(s){if(v>0)while(m--)!g[m]&&!y[m]&&(y[m]=_.call(a));y=wt(y)}P.apply(a,y),l&&!s&&y.length>0&&v+t.length>1&&st.uniqueSort(a)}return l&&(S=E,f=b),g};return n?ut(s):s}var t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w="sizzle"+ -(new Date),E=e.document,S=0,x=0,T=ot(),N=ot(),C=ot(),k=function(e,t){return e===t&&(c=!0),0},L=typeof undefined,A=1<<31,O={}.hasOwnProperty,M=[],_=M.pop,D=M.push,P=M.push,H=M.slice,B=M.indexOf||function(e){var t=0,n=this.length;for(;t<n;t++)if(this[t]===e)return t;return-1},j="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",F="[\\x20\\t\\r\\n\\f]",I="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",q=I.replace("w","w#"),R="\\["+F+"*("+I+")(?:"+F+"*([*^$|!~]?=)"+F+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+q+"))|)"+F+"*\\]",U=":("+I+")(?:\\(("+"('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|"+"((?:\\\\.|[^\\\\()[\\]]|"+R+")*)|"+".*"+")\\)|)",z=new RegExp("^"+F+"+|((?:^|[^\\\\])(?:\\\\.)*)"+F+"+$","g"),W=new RegExp("^"+F+"*,"+F+"*"),X=new RegExp("^"+F+"*([>+~]|"+F+")"+F+"*"),V=new RegExp("="+F+"*([^\\]'\"]*?)"+F+"*\\]","g"),$=new RegExp(U),J=new RegExp("^"+q+"$"),K={ID:new RegExp("^#("+I+")"),CLASS:new RegExp("^\\.("+I+")"),TAG:new RegExp("^("+I.replace("w","w*")+")"),ATTR:new RegExp("^"+R),PSEUDO:new RegExp("^"+U),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+F+"*(even|odd|(([+-]|)(\\d*)n|)"+F+"*(?:([+-]|)"+F+"*(\\d+)|))"+F+"*\\)|)","i"),bool:new RegExp("^(?:"+j+")$","i"),needsContext:new RegExp("^"+F+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+F+"*((?:-\\d)?\\d*)"+F+"*\\)|)(?=[^-]|$)","i")},Q=/^(?:input|select|textarea|button)$/i,G=/^h\d$/i,Y=/^[^{]+\{\s*\[native \w/,Z=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,et=/[+~]/,tt=/'|\\/g,nt=new RegExp("\\\\([\\da-f]{1,6}"+F+"?|("+F+")|.)","ig"),rt=function(e,t,n){var r="0x"+t-65536;return r!==r||n?t:r<0?String.fromCharCode(r+65536):String.fromCharCode(r>>10|55296,r&1023|56320)};try{P.apply(M=H.call(E.childNodes),E.childNodes),M[E.childNodes.length].nodeType}catch(it){P={apply:M.length?function(e,t){D.apply(e,H.call(t))}:function(e,t){var n=e.length,r=0;while(e[n++]=t[r++]);e.length=n-1}}}n=st.support={},s=st.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?t.nodeName!=="HTML":!1},h=st.setDocument=function(e){var t,i=e?e.ownerDocument||e:E,o=i.defaultView;if(i===p||i.nodeType!==9||!i.documentElement)return p;p=i,d=i.documentElement,v=!s(i),o&&o!==o.top&&(o.addEventListener?o.addEventListener("unload",function(){h()},!1):o.attachEvent&&o.attachEvent("onunload",function(){h()})),n.attributes=at(function(e){return e.className="i",!e.getAttribute("className")}),n.getElementsByTagName=at(function(e){return e.appendChild(i.createComment("")),!e.getElementsByTagName("*").length}),n.getElementsByClassName=Y.test(i.getElementsByClassName)&&at(function(e){return e.innerHTML="<div class='a'></div><div class='a i'></div>",e.firstChild.className="i",e.getElementsByClassName("i").length===2}),n.getById=at(function(e){return d.appendChild(e).id=w,!i.getElementsByName||!i.getElementsByName(w).length}),n.getById?(r.find.ID=function(e,t){if(typeof t.getElementById!==L&&v){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}},r.filter.ID=function(e){var t=e.replace(nt,rt);return function(e){return e.getAttribute("id")===t}}):(delete r.find.ID,r.filter.ID=function(e){var t=e.replace(nt,rt);return function(e){var n=typeof e.getAttributeNode!==L&&e.getAttributeNode("id");return n&&n.value===t}}),r.find.TAG=n.getElementsByTagName?function(e,t){if(typeof t.getElementsByTagName!==L)return t.getElementsByTagName(e)}:function(e,t){var n,r=[],i=0,s=t.getElementsByTagName(e);if(e==="*"){while(n=s[i++])n.nodeType===1&&r.push(n);return r}return s},r.find.CLASS=n.getElementsByClassName&&function(e,t){if(typeof t.getElementsByClassName!==L&&v)return t.getElementsByClassName(e)},g=[],m=[];if(n.qsa=Y.test(i.querySelectorAll))at(function(e){e.innerHTML="<select msallowclip=''><option selected=''></option></select>",e.querySelectorAll("[msallowclip^='']").length&&m.push("[*^$]="+F+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||m.push("\\["+F+"*(?:value|"+j+")"),e.querySelectorAll(":checked").length||m.push(":checked")}),at(function(e){var t=i.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&m.push("name"+F+"*[*^$|!~]?="),e.querySelectorAll(":enabled").length||m.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),m.push(",.*:")});return(n.matchesSelector=Y.test(y=d.matches||d.webkitMatchesSelector||d.mozMatchesSelector||d.oMatchesSelector||d.msMatchesSelector))&&at(function(e){n.disconnectedMatch=y.call(e,"div"),y.call(e,"[s!='']:x"),g.push("!=",U)}),m=m.length&&new RegExp(m.join("|")),g=g.length&&new RegExp(g.join("|")),t=Y.test(d.compareDocumentPosition),b=t||Y.test(d.contains)?function(e,t){var n=e.nodeType===9?e.documentElement:e,r=t&&t.parentNode;return e===r||!!r&&r.nodeType===1&&!!(n.contains?n.contains(r):e.compareDocumentPosition&&e.compareDocumentPosition(r)&16)}:function(e,t){if(t)while(t=t.parentNode)if(t===e)return!0;return!1},k=t?function(e,t){if(e===t)return c=!0,0;var r=!e.compareDocumentPosition-!t.compareDocumentPosition;return r?r:(r=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1,r&1||!n.sortDetached&&t.compareDocumentPosition(e)===r?e===i||e.ownerDocument===E&&b(E,e)?-1:t===i||t.ownerDocument===E&&b(E,t)?1:l?B.call(l,e)-B.call(l,t):0:r&4?-1:1)}:function(e,t){if(e===t)return c=!0,0;var n,r=0,s=e.parentNode,o=t.parentNode,u=[e],a=[t];if(!s||!o)return e===i?-1:t===i?1:s?-1:o?1:l?B.call(l,e)-B.call(l,t):0;if(s===o)return lt(e,t);n=e;while(n=n.parentNode)u.unshift(n);n=t;while(n=n.parentNode)a.unshift(n);while(u[r]===a[r])r++;return r?lt(u[r],a[r]):u[r]===E?-1:a[r]===E?1:0},i},st.matches=function(e,t){return st(e,null,null,t)},st.matchesSelector=function(e,t){(e.ownerDocument||e)!==p&&h(e),t=t.replace(V,"='$1']");if(n.matchesSelector&&v&&(!g||!g.test(t))&&(!m||!m.test(t)))try{var r=y.call(e,t);if(r||n.disconnectedMatch||e.document&&e.document.nodeType!==11)return r}catch(i){}return st(t,p,null,[e]).length>0},st.contains=function(e,t){return(e.ownerDocument||e)!==p&&h(e),b(e,t)},st.attr=function(e,t){(e.ownerDocument||e)!==p&&h(e);var i=r.attrHandle[t.toLowerCase()],s=i&&O.call(r.attrHandle,t.toLowerCase())?i(e,t,!v):undefined;return s!==undefined?s:n.attributes||!v?e.getAttribute(t):(s=e.getAttributeNode(t))&&s.specified?s.value:null},st.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},st.uniqueSort=function(e){var t,r=[],i=0,s=0;c=!n.detectDuplicates,l=!n.sortStable&&e.slice(0),e.sort(k);if(c){while(t=e[s++])t===e[s]&&(i=r.push(s));while(i--)e.splice(r[i],1)}return l=null,e},i=st.getText=function(e){var t,n="",r=0,s=e.nodeType;if(!s)while(t=e[r++])n+=i(t);else if(s===1||s===9||s===11){if(typeof e.textContent=="string")return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=i(e)}else if(s===3||s===4)return e.nodeValue;return n},r=st.selectors={cacheLength:50,createPseudo:ut,match:K,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(nt,rt),e[3]=(e[3]||e[4]||e[5]||"").replace(nt,rt),e[2]==="~="&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),e[1].slice(0,3)==="nth"?(e[3]||st.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*(e[3]==="even"||e[3]==="odd")),e[5]=+(e[7]+e[8]||e[3]==="odd")):e[3]&&st.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return K.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&$.test(n)&&(t=o(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(nt,rt).toLowerCase();return e==="*"?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=T[e+" "];return t||(t=new RegExp("(^|"+F+")"+e+"("+F+"|$)"))&&T(e,function(e){return t.test(typeof e.className=="string"&&e.className||typeof e.getAttribute!==L&&e.getAttribute("class")||"")})},ATTR:function(e,t,n){return function(r){var i=st.attr(r,e);return i==null?t==="!=":t?(i+="",t==="="?i===n:t==="!="?i!==n:t==="^="?n&&i.indexOf(n)===0:t==="*="?n&&i.indexOf(n)>-1:t==="$="?n&&i.slice(-n.length)===n:t==="~="?(" "+i+" ").indexOf(n)>-1:t==="|="?i===n||i.slice(0,n.length+1)===n+"-":!1):!0}},CHILD:function(e,t,n,r,i){var s=e.slice(0,3)!=="nth",o=e.slice(-4)!=="last",u=t==="of-type";return r===1&&i===0?function(e){return!!e.parentNode}:function(t,n,a){var f,l,c,h,p,d,v=s!==o?"nextSibling":"previousSibling",m=t.parentNode,g=u&&t.nodeName.toLowerCase(),y=!a&&!u;if(m){if(s){while(v){c=t;while(c=c[v])if(u?c.nodeName.toLowerCase()===g:c.nodeType===1)return!1;d=v=e==="only"&&!d&&"nextSibling"}return!0}d=[o?m.firstChild:m.lastChild];if(o&&y){l=m[w]||(m[w]={}),f=l[e]||[],p=f[0]===S&&f[1],h=f[0]===S&&f[2],c=p&&m.childNodes[p];while(c=++p&&c&&c[v]||(h=p=0)||d.pop())if(c.nodeType===1&&++h&&c===t){l[e]=[S,p,h];break}}else if(y&&(f=(t[w]||(t[w]={}))[e])&&f[0]===S)h=f[1];else while(c=++p&&c&&c[v]||(h=p=0)||d.pop())if((u?c.nodeName.toLowerCase()===g:c.nodeType===1)&&++h){y&&((c[w]||(c[w]={}))[e]=[S,h]);if(c===t)break}return h-=i,h===r||h%r===0&&h/r>=0}}},PSEUDO:function(e,t){var n,i=r.pseudos[e]||r.setFilters[e.toLowerCase()]||st.error("unsupported pseudo: "+e);return i[w]?i(t):i.length>1?(n=[e,e,"",t],r.setFilters.hasOwnProperty(e.toLowerCase())?ut(function(e,n){var r,s=i(e,t),o=s.length;while(o--)r=B.call(e,s[o]),e[r]=!(n[r]=s[o])}):function(e){return i(e,0,n)}):i}},pseudos:{not:ut(function(e){var t=[],n=[],r=u(e.replace(z,"$1"));return r[w]?ut(function(e,t,n,i){var s,o=r(e,null,i,[]),u=e.length;while(u--)if(s=o[u])e[u]=!(t[u]=s)}):function(e,i,s){return t[0]=e,r(t,null,s,n),!n.pop()}}),has:ut(function(e){return function(t){return st(e,t).length>0}}),contains:ut(function(e){return function(t){return(t.textContent||t.innerText||i(t)).indexOf(e)>-1}}),lang:ut(function(e){return J.test(e||"")||st.error("unsupported lang: "+e),e=e.replace(nt,rt).toLowerCase(),function(t){var n;do if(n=v?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return n=n.toLowerCase(),n===e||n.indexOf(e+"-")===0;while((t=t.parentNode)&&t.nodeType===1);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===d},focus:function(e){return e===p.activeElement&&(!p.hasFocus||p.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return t==="input"&&!!e.checked||t==="option"&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!r.pseudos.empty(e)},header:function(e){return G.test(e.nodeName)},input:function(e){return Q.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return t==="input"&&e.type==="button"||t==="button"},text:function(e){var t;return e.nodeName.toLowerCase()==="input"&&e.type==="text"&&((t=e.getAttribute("type"))==null||t.toLowerCase()==="text")},first:pt(function(){return[0]}),last:pt(function(e,t){return[t-1]}),eq:pt(function(e,t,n){return[n<0?n+t:n]}),even:pt(function(e,t){var n=0;for(;n<t;n+=2)e.push(n);return e}),odd:pt(function(e,t){var n=1;for(;n<t;n+=2)e.push(n);return e}),lt:pt(function(e,t,n){var r=n<0?n+t:n;for(;--r>=0;)e.push(r);return e}),gt:pt(function(e,t,n){var r=n<0?n+t:n;for(;++r<t;)e.push(r);return e})}},r.pseudos.nth=r.pseudos.eq;for(t in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})r.pseudos[t]=ct(t);for(t in{submit:!0,reset:!0})r.pseudos[t]=ht(t);return vt.prototype=r.filters=r.pseudos,r.setFilters=new vt,o=st.tokenize=function(e,t){var n,i,s,o,u,a,f,l=N[e+" "];if(l)return t?0:l.slice(0);u=e,a=[],f=r.preFilter;while(u){if(!n||(i=W.exec(u)))i&&(u=u.slice(i[0].length)||u),a.push(s=[]);n=!1;if(i=X.exec(u))n=i.shift(),s.push({value:n,type:i[0].replace(z," ")}),u=u.slice(n.length);for(o in r.filter)(i=K[o].exec(u))&&(!f[o]||(i=f[o](i)))&&(n=i.shift(),s.push({value:n,type:o,matches:i}),u=u.slice(n.length));if(!n)break}return t?u.length:u?st.error(e):N(e,a).slice(0)},u=st.compile=function(e,t){var n,r=[],i=[],s=C[e+" "];if(!s){t||(t=o(e)),n=t.length;while(n--)s=St(t[n]),s[w]?r.push(s):i.push(s);s=C(e,xt(i,r)),s.selector=e}return s},a=st.select=function(e,t,i,s){var a,f,l,c,h,p=typeof e=="function"&&e,d=!s&&o(e=p.selector||e);i=i||[];if(d.length===1){f=d[0]=d[0].slice(0);if(f.length>2&&(l=f[0]).type==="ID"&&n.getById&&t.nodeType===9&&v&&r.relative[f[1].type]){t=(r.find.ID(l.matches[0].replace(nt,rt),t)||[])[0];if(!t)return i;p&&(t=t.parentNode),e=e.slice(f.shift().value.length)}a=K.needsContext.test(e)?0:f.length;while(a--){l=f[a];if(r.relative[c=l.type])break;if(h=r.find[c])if(s=h(l.matches[0].replace(nt,rt),et.test(f[0].type)&&dt(t.parentNode)||t)){f.splice(a,1),e=s.length&&mt(f);if(!e)return P.apply(i,s),i;break}}}return(p||u(e,d))(s,t,!v,i,et.test(e)&&dt(t.parentNode)||t),i},n.sortStable=w.split("").sort(k).join("")===w,n.detectDuplicates=!!c,h(),n.sortDetached=at(function(e){return e.compareDocumentPosition(p.createElement("div"))&1}),at(function(e){return e.innerHTML="<a href='#'></a>",e.firstChild.getAttribute("href")==="#"})||ft("type|href|height|width",function(e,t,n){if(!n)return e.getAttribute(t,t.toLowerCase()==="type"?1:2)}),(!n.attributes||!at(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),e.firstChild.getAttribute("value")===""}))&&ft("value",function(e,t,n){if(!n&&e.nodeName.toLowerCase()==="input")return e.defaultValue}),at(function(e){return e.getAttribute("disabled")==null})||ft(j,function(e,t,n){var r;if(!n)return e[t]===!0?t.toLowerCase():(r=e.getAttributeNode(t))&&r.specified?r.value:null}),st}(window);jQuery.find=Sizzle,jQuery.expr=Sizzle.selectors,jQuery.expr[":"]=jQuery.expr.pseudos,jQuery.unique=Sizzle.uniqueSort,jQuery.text=Sizzle.getText,jQuery.isXMLDoc=Sizzle.isXML,jQuery.contains=Sizzle.contains;var rneedsContext=jQuery.expr.match.needsContext,rsingleTag=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,risSimple=/^.[^:#\[\.,]*$/;jQuery.filter=function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),t.length===1&&r.nodeType===1?jQuery.find.matchesSelector(r,e)?[r]:[]:jQuery.find.matches(e,jQuery.grep(t,function(e){return e.nodeType===1}))},jQuery.fn.extend({find:function(e){var t,n=this.length,r=[],i=this;if(typeof e!="string")return this.pushStack(jQuery(e).filter(function(){for(t=0;t<n;t++)if(jQuery.contains(i[t],this))return!0}));for(t=0;t<n;t++)jQuery.find(e,i[t],r);return r=this.pushStack(n>1?jQuery.unique(r):r),r.selector=this.selector?this.selector+" "+e:e,r},filter:function(e){return this.pushStack(winnow(this,e||[],!1))},not:function(e){return this.pushStack(winnow(this,e||[],!0))},is:function(e){return!!winnow(this,typeof e=="string"&&rneedsContext.test(e)?jQuery(e):e||[],!1).length}});var rootjQuery,rquickExpr=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,init=jQuery.fn.init=function(e,t){var n,r;if(!e)return this;if(typeof e=="string"){e[0]==="<"&&e[e.length-1]===">"&&e.length>=3?n=[null,e,null]:n=rquickExpr.exec(e);if(n&&(n[1]||!t)){if(n[1]){t=t instanceof jQuery?t[0]:t,jQuery.merge(this,jQuery.parseHTML(n[1],t&&t.nodeType?t.ownerDocument||t:document,!0));if(rsingleTag.test(n[1])&&jQuery.isPlainObject(t))for(n in t)jQuery.isFunction(this[n])?this[n](t[n]):this.attr(n,t[n]);return this}return r=document.getElementById(n[2]),r&&r.parentNode&&(this.length=1,this[0]=r),this.context=document,this.selector=e,this}return!t||t.jquery?(t||rootjQuery).find(e):this.constructor(t).find(e)}return e.nodeType?(this.context=this[0]=e,this.length=1,this):jQuery.isFunction(e)?typeof rootjQuery.ready!="undefined"?rootjQuery.ready(e):e(jQuery):(e.selector!==undefined&&(this.selector=e.selector,this.context=e.context),jQuery.makeArray(e,this))};init.prototype=jQuery.fn,rootjQuery=jQuery(document);var rparentsprev=/^(?:parents|prev(?:Until|All))/,guaranteedUnique={children:!0,contents:!0,next:!0,prev:!0};jQuery.extend({dir:function(e,t,n){var r=[],i=n!==undefined;while((e=e[t])&&e.nodeType!==9)if(e.nodeType===1){if(i&&jQuery(e).is(n))break;r.push(e)}return r},sibling:function(e,t){var n=[];for(;e;e=e.nextSibling)e.nodeType===1&&e!==t&&n.push(e);return n}}),jQuery.fn.extend({has:function(e){var t=jQuery(e,this),n=t.length;return this.filter(function(){var e=0;for(;e<n;e++)if(jQuery.contains(this,t[e]))return!0})},closest:function(e,t){var n,r=0,i=this.length,s=[],o=rneedsContext.test(e)||typeof e!="string"?jQuery(e,t||this.context):0;for(;r<i;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(o?o.index(n)>-1:n.nodeType===1&&jQuery.find.matchesSelector(n,e))){s.push(n);break}return this.pushStack(s.length>1?jQuery.unique(s):s)},index:function(e){return e?typeof e=="string"?indexOf.call(jQuery(e),this[0]):indexOf.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(jQuery.unique(jQuery.merge(this.get(),jQuery(e,t))))},addBack:function(e){return this.add(e==null?this.prevObject:this.prevObject.filter(e))}}),jQuery.each({parent:function(e){var t=e.parentNode;return t&&t.nodeType!==11?t:null},parents:function(e){return jQuery.dir(e,"parentNode")},parentsUntil:function(e,t,n){return jQuery.dir(e,"parentNode",n)},next:function(e){return sibling(e,"nextSibling")},prev:function(e){return sibling(e,"previousSibling")},nextAll:function(e){return jQuery.dir(e,"nextSibling")},prevAll:function(e){return jQuery.dir(e,"previousSibling")},nextUntil:function(e,t,n){return jQuery.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return jQuery.dir(e,"previousSibling",n)},siblings:function(e){return jQuery.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return jQuery.sibling(e.firstChild)},contents:function(e){return e.contentDocument||jQuery.merge([],e.childNodes)}},function(e,t){jQuery.fn[e]=function(n,r){var i=jQuery.map(this,t,n);return e.slice(-5)!=="Until"&&(r=n),r&&typeof r=="string"&&(i=jQuery.filter(r,i)),this.length>1&&(guaranteedUnique[e]||jQuery.unique(i),rparentsprev.test(e)&&i.reverse()),this.pushStack(i)}});var rnotwhite=/\S+/g,optionsCache={};jQuery.Callbacks=function(e){e=typeof e=="string"?optionsCache[e]||createOptions(e):jQuery.extend({},e);var t,n,r,i,s,o,u=[],a=!e.once&&[],f=function(c){t=e.memory&&c,n=!0,o=i||0,i=0,s=u.length,r=!0;for(;u&&o<s;o++)if(u[o].apply(c[0],c[1])===!1&&e.stopOnFalse){t=!1;break}r=!1,u&&(a?a.length&&f(a.shift()):t?u=[]:l.disable())},l={add:function(){if(u){var n=u.length;(function o(t){jQuery.each(t,function(t,n){var r=jQuery.type(n);r==="function"?(!e.unique||!l.has(n))&&u.push(n):n&&n.length&&r!=="string"&&o(n)})})(arguments),r?s=u.length:t&&(i=n,f(t))}return this},remove:function(){return u&&jQuery.each(arguments,function(e,t){var n;while((n=jQuery.inArray(t,u,n))>-1)u.splice(n,1),r&&(n<=s&&s--,n<=o&&o--)}),this},has:function(e){return e?jQuery.inArray(e,u)>-1:!!u&&!!u.length},empty:function(){return u=[],s=0,this},disable:function(){return u=a=t=undefined,this},disabled:function(){return!u},lock:function(){return a=undefined,t||l.disable(),this},locked:function(){return!a},fireWith:function(e,t){return u&&(!n||a)&&(t=t||[],t=[e,t.slice?t.slice():t],r?a.push(t):f(t)),this},fire:function(){return l.fireWith(this,arguments),this},fired:function(){return!!n}};return l},jQuery.extend({Deferred:function(e){var t=[["resolve","done",jQuery.Callbacks("once memory"),"resolved"],["reject","fail",jQuery.Callbacks("once memory"),"rejected"],["notify","progress",jQuery.Callbacks("memory")]],n="pending",r={state:function(){return n},always:function(){return i.done(arguments).fail(arguments),this},then:function(){var e=arguments;return jQuery.Deferred(function(n){jQuery.each(t,function(t,s){var o=jQuery.isFunction(e[t])&&e[t];i[s[1]](function(){var e=o&&o.apply(this,arguments);e&&jQuery.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[s[0]+"With"](this===r?n.promise():this,o?[e]:arguments)})}),e=null}).promise()},promise:function(e){return e!=null?jQuery.extend(e,r):r}},i={};return r.pipe=r.then,jQuery.each(t,function(e,s){var o=s[2],u=s[3];r[s[1]]=o.add,u&&o.add(function(){n=u},t[e^1][2].disable,t[2][2].lock),i[s[0]]=function(){return i[s[0]+"With"](this===i?r:this,arguments),this},i[s[0]+"With"]=o.fireWith}),r.promise(i),e&&e.call(i,i),i},when:function(e){var t=0,n=slice.call(arguments),r=n.length,i=r!==1||e&&jQuery.isFunction(e.promise)?r:0,s=i===1?e:jQuery.Deferred(),o=function(e,t,n){return function(r){t[e]=this,n[e]=arguments.length>1?slice.call(arguments):r,n===u?s.notifyWith(t,n):--i||s.resolveWith(t,n)}},u,a,f;if(r>1){u=new Array(r),a=new Array(r),f=new Array(r);for(;t<r;t++)n[t]&&jQuery.isFunction(n[t].promise)?n[t].promise().done(o(t,f,n)).fail(s.reject).progress(o(t,a,u)):--i}return i||s.resolveWith(f,n),s.promise()}});var readyList;jQuery.fn.ready=function(e){return jQuery.ready.promise().done(e),this},jQuery.extend({isReady:!1,readyWait:1,holdReady:function(e){e?jQuery.readyWait++:jQuery.ready(!0)},ready:function(e){if(e===!0?--jQuery.readyWait:jQuery.isReady)return;jQuery.isReady=!0;if(e!==!0&&--jQuery.readyWait>0)return;readyList.resolveWith(document,[jQuery]),jQuery.fn.triggerHandler&&(jQuery(document).triggerHandler("ready"),jQuery(document).off("ready"))}}),jQuery.ready.promise=function(e){return readyList||(readyList=jQuery.Deferred(),document.readyState==="complete"?setTimeout(jQuery.ready):(document.addEventListener("DOMContentLoaded",completed,!1),window.addEventListener("load",completed,!1))),readyList.promise(e)},jQuery.ready.promise();var access=jQuery.access=function(e,t,n,r,i,s,o){var u=0,a=e.length,f=n==null;if(jQuery.type(n)==="object"){i=!0;for(u in n)jQuery.access(e,t,u,n[u],!0,s,o)}else if(r!==undefined){i=!0,jQuery.isFunction(r)||(o=!0),f&&(o?(t.call(e,r),t=null):(f=t,t=function(e,t,n){return f.call(jQuery(e),n)}));if(t)for(;u<a;u++)t(e[u],n,o?r:r.call(e[u],u,t(e[u],n)))}return i?e:f?t.call(e):a?t(e[0],n):s};jQuery.acceptData=function(e){return e.nodeType===1||e.nodeType===9||!+e.nodeType},Data.uid=1,Data.accepts=jQuery.acceptData,Data.prototype={key:function(e){if(!Data.accepts(e))return 0;var t={},n=e[this.expando];if(!n){n=Data.uid++;try{t[this.expando]={value:n},Object.defineProperties(e,t)}catch(r){t[this.expando]=n,jQuery.extend(e,t)}}return this.cache[n]||(this.cache[n]={}),n},set:function(e,t,n){var r,i=this.key(e),s=this.cache[i];if(typeof t=="string")s[t]=n;else if(jQuery.isEmptyObject(s))jQuery.extend(this.cache[i],t);else for(r in t)s[r]=t[r];return s},get:function(e,t){var n=this.cache[this.key(e)];return t===undefined?n:n[t]},access:function(e,t,n){var r;return t===undefined||t&&typeof t=="string"&&n===undefined?(r=this.get(e,t),r!==undefined?r:this.get(e,jQuery.camelCase(t))):(this.set(e,t,n),n!==undefined?n:t)},remove:function(e,t){var n,r,i,s=this.key(e),o=this.cache[s];if(t===undefined)this.cache[s]={};else{jQuery.isArray(t)?r=t.concat(t.map(jQuery.camelCase)):(i=jQuery.camelCase(t),t in o?r=[t,i]:(r=i,r=r in o?[r]:r.match(rnotwhite)||[])),n=r.length;while(n--)delete o[r[n]]}},hasData:function(e){return!jQuery.isEmptyObject(this.cache[e[this.expando]]||{})},discard:function(e){e[this.expando]&&delete this.cache[e[this.expando]]}};var data_priv=new Data,data_user=new Data,rbrace=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,rmultiDash=/([A-Z])/g;jQuery.extend({hasData:function(e){return data_user.hasData(e)||data_priv.hasData(e)},data:function(e,t,n){return data_user.access(e,t,n)},removeData:function(e,t){data_user.remove(e,t)},_data:function(e,t,n){return data_priv.access(e,t,n)},_removeData:function(e,t){data_priv.remove(e,t)}}),jQuery.fn.extend({data:function(e,t){var n,r,i,s=this[0],o=s&&s.attributes;if(e===undefined){if(this.length){i=data_user.get(s);if(s.nodeType===1&&!data_priv.get(s,"hasDataAttrs")){n=o.length;while(n--)o[n]&&(r=o[n].name,r.indexOf("data-")===0&&(r=jQuery.camelCase(r.slice(5)),dataAttr(s,r,i[r])));data_priv.set(s,"hasDataAttrs",!0)}}return i}return typeof e=="object"?this.each(function(){data_user.set(this,e)}):access(this,function(t){var n,r=jQuery.camelCase(e);if(s&&t===undefined){n=data_user.get(s,e);if(n!==undefined)return n;n=data_user.get(s,r);if(n!==undefined)return n;n=dataAttr(s,r,undefined);if(n!==undefined)return n;return}this.each(function(){var n=data_user.get(this,r);data_user.set(this,r,t),e.indexOf("-")!==-1&&n!==undefined&&data_user.set(this,e,t)})},null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){data_user.remove(this,e)})}}),jQuery.extend({queue:function(e,t,n){var r;if(e)return t=(t||"fx")+"queue",r=data_priv.get(e,t),n&&(!r||jQuery.isArray(n)?r=data_priv.access(e,t,jQuery.makeArray(n)):r.push(n)),r||[]},dequeue:function(e,t){t=t||"fx";var n=jQuery.queue(e,t),r=n.length,i=n.shift(),s=jQuery._queueHooks(e,t),o=function(){jQuery.dequeue(e,t)};i==="inprogress"&&(i=n.shift(),r--),i&&(t==="fx"&&n.unshift("inprogress"),delete s.stop,i.call(e,o,s)),!r&&s&&s.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return data_priv.get(e,n)||data_priv.access(e,n,{empty:jQuery.Callbacks("once memory").add(function(){data_priv.remove(e,[t+"queue",n])})})}}),jQuery.fn.extend({queue:function(e,t){var n=2;return typeof e!="string"&&(t=e,e="fx",n--),arguments.length<n?jQuery.queue(this[0],e):t===undefined?this:this.each(function(){var n=jQuery.queue(this,e,t);jQuery._queueHooks(this,e),e==="fx"&&n[0]!=="inprogress"&&jQuery.dequeue(this,e)})},dequeue:function(e){return this.each(function(){jQuery.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,r=1,i=jQuery.Deferred(),s=this,o=this.length,u=function(){--r||i.resolveWith(s,[s])};typeof e!="string"&&(t=e,e=undefined),e=e||"fx";while(o--)n=data_priv.get(s[o],e+"queueHooks"),n&&n.empty&&(r++,n.empty.add(u));return u(),i.promise(t)}});var pnum=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,cssExpand=["Top","Right","Bottom","Left"],isHidden=function(e,t){return e=t||e,jQuery.css(e,"display")==="none"||!jQuery.contains(e.ownerDocument,e)},rcheckableType=/^(?:checkbox|radio)$/i;(function(){var e=document.createDocumentFragment(),t=e.appendChild(document.createElement("div")),n=document.createElement("input");n.setAttribute("type","radio"),n.setAttribute("checked","checked"),n.setAttribute("name","t"),t.appendChild(n),support.checkClone=t.cloneNode(!0).cloneNode(!0).lastChild.checked,t.innerHTML="<textarea>x</textarea>",support.noCloneChecked=!!t.cloneNode(!0).lastChild.defaultValue})();var strundefined=typeof undefined;support.focusinBubbles="onfocusin"in window;var rkeyEvent=/^key/,rmouseEvent=/^(?:mouse|pointer|contextmenu)|click/,rfocusMorph=/^(?:focusinfocus|focusoutblur)$/,rtypenamespace=/^([^.]*)(?:\.(.+)|)$/;jQuery.event={global:{},add:function(e,t,n,r,i){var s,o,u,a,f,l,c,h,p,d,v,m=data_priv.get(e);if(!m)return;n.handler&&(s=n,n=s.handler,i=s.selector),n.guid||(n.guid=jQuery.guid++),(a=m.events)||(a=m.events={}),(o=m.handle)||(o=m.handle=function(t){return typeof jQuery!==strundefined&&jQuery.event.triggered!==t.type?jQuery.event.dispatch.apply(e,arguments):undefined}),t=(t||"").match(rnotwhite)||[""],f=t.length;while(f--){u=rtypenamespace.exec(t[f])||[],p=v=u[1],d=(u[2]||"").split(".").sort();if(!p)continue;c=jQuery.event.special[p]||{},p=(i?c.delegateType:c.bindType)||p,c=jQuery.event.special[p]||{},l=jQuery.extend({type:p,origType:v,data:r,handler:n,guid:n.guid,selector:i,needsContext:i&&jQuery.expr.match.needsContext.test(i),namespace:d.join(".")},s),(h=a[p])||(h=a[p]=[],h.delegateCount=0,(!c.setup||c.setup.call(e,r,d,o)===!1)&&e.addEventListener&&e.addEventListener(p,o,!1)),c.add&&(c.add.call(e,l),l.handler.guid||(l.handler.guid=n.guid)),i?h.splice(h.delegateCount++,0,l):h.push(l),jQuery.event.global[p]=!0}},remove:function(e,t,n,r,i){var s,o,u,a,f,l,c,h,p,d,v,m=data_priv.hasData(e)&&data_priv.get(e);if(!m||!(a=m.events))return;t=(t||"").match(rnotwhite)||[""],f=t.length;while(f--){u=rtypenamespace.exec(t[f])||[],p=v=u[1],d=(u[2]||"").split(".").sort();if(!p){for(p in a)jQuery.event.remove(e,p+t[f],n,r,!0);continue}c=jQuery.event.special[p]||{},p=(r?c.delegateType:c.bindType)||p,h=a[p]||[],u=u[2]&&new RegExp("(^|\\.)"+d.join("\\.(?:.*\\.|)")+"(\\.|$)"),o=s=h.length;while(s--)l=h[s],(i||v===l.origType)&&(!n||n.guid===l.guid)&&(!u||u.test(l.namespace))&&(!r||r===l.selector||r==="**"&&l.selector)&&(h.splice(s,1),l.selector&&h.delegateCount--,c.remove&&c.remove.call(e,l));o&&!h.length&&((!c.teardown||c.teardown.call(e,d,m.handle)===!1)&&jQuery.removeEvent(e,p,m.handle),delete a[p])}jQuery.isEmptyObject(a)&&(delete m.handle,data_priv.remove(e,"events"))},trigger:function(e,t,n,r){var i,s,o,u,a,f,l,c=[n||document],h=hasOwn.call(e,"type")?e.type:e,p=hasOwn.call(e,"namespace")?e.namespace.split("."):[];s=o=n=n||document;if(n.nodeType===3||n.nodeType===8)return;if(rfocusMorph.test(h+jQuery.event.triggered))return;h.indexOf(".")>=0&&(p=h.split("."),h=p.shift(),p.sort()),a=h.indexOf(":")<0&&"on"+h,e=e[jQuery.expando]?e:new jQuery.Event(h,typeof e=="object"&&e),e.isTrigger=r?2:3,e.namespace=p.join("."),e.namespace_re=e.namespace?new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=undefined,e.target||(e.target=n),t=t==null?[e]:jQuery.makeArray(t,[e]),l=jQuery.event.special[h]||{};if(!r&&l.trigger&&l.trigger.apply(n,t)===!1)return;if(!r&&!l.noBubble&&!jQuery.isWindow(n)){u=l.delegateType||h,rfocusMorph.test(u+h)||(s=s.parentNode);for(;s;s=s.parentNode)c.push(s),o=s;o===(n.ownerDocument||document)&&c.push(o.defaultView||o.parentWindow||window)}i=0;while((s=c[i++])&&!e.isPropagationStopped())e.type=i>1?u:l.bindType||h,f=(data_priv.get(s,"events")||{})[e.type]&&data_priv.get(s,"handle"),f&&f.apply(s,t),f=a&&s[a],f&&f.apply&&jQuery.acceptData(s)&&(e.result=f.apply(s,t),e.result===!1&&e.preventDefault());return e.type=h,!r&&!e.isDefaultPrevented()&&(!l._default||l._default.apply(c.pop(),t)===!1)&&jQuery.acceptData(n)&&a&&jQuery.isFunction(n[h])&&!jQuery.isWindow(n)&&(o=n[a],o&&(n[a]=null),jQuery.event.triggered=h,n[h](),jQuery.event.triggered=undefined,o&&(n[a]=o)),e.result},dispatch:function(e){e=jQuery.event.fix(e);var t,n,r,i,s,o=[],u=slice.call(arguments),a=(data_priv.get(this,"events")||{})[e.type]||[],f=jQuery.event.special[e.type]||{};u[0]=e,e.delegateTarget=this;if(f.preDispatch&&f.preDispatch.call(this,e)===!1)return;o=jQuery.event.handlers.call(this,e,a),t=0;while((i=o[t++])&&!e.isPropagationStopped()){e.currentTarget=i.elem,n=0;while((s=i.handlers[n++])&&!e.isImmediatePropagationStopped())if(!e.namespace_re||e.namespace_re.test(s.namespace))e.handleObj=s,e.data=s.data,r=((jQuery.event.special[s.origType]||{}).handle||s.handler).apply(i.elem,u),r!==undefined&&(e.result=r)===!1&&(e.preventDefault(),e.stopPropagation())}return f.postDispatch&&f.postDispatch.call(this,e),e.result},handlers:function(e,t){var n,r,i,s,o=[],u=t.delegateCount,a=e.target;if(u&&a.nodeType&&(!e.button||e.type!=="click"))for(;a!==this;a=a.parentNode||this)if(a.disabled!==!0||e.type!=="click"){r=[];for(n=0;n<u;n++)s=t[n],i=s.selector+" ",r[i]===undefined&&(r[i]=s.needsContext?jQuery(i,this).index(a)>=0:jQuery.find(i,this,null,[a]).length),r[i]&&r.push(s);r.length&&o.push({elem:a,handlers:r})}return u<t.length&&o.push({elem:this,handlers:t.slice(u)}),o},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return e.which==null&&(e.which=t.charCode!=null?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var n,r,i,s=t.button;return e.pageX==null&&t.clientX!=null&&(n=e.target.ownerDocument||document,r=n.documentElement,i=n.body,e.pageX=t.clientX+(r&&r.scrollLeft||i&&i.scrollLeft||0)-(r&&r.clientLeft||i&&i.clientLeft||0),e.pageY=t.clientY+(r&&r.scrollTop||i&&i.scrollTop||0)-(r&&r.clientTop||i&&i.clientTop||0)),!e.which&&s!==undefined&&(e.which=s&1?1:s&2?3:s&4?2:0),e}},fix:function(e){if(e[jQuery.expando])return e;var t,n,r,i=e.type,s=e,o=this.fixHooks[i];o||(this.fixHooks[i]=o=rmouseEvent.test(i)?this.mouseHooks:rkeyEvent.test(i)?this.keyHooks:{}),r=o.props?this.props.concat(o.props):this.props,e=new jQuery.Event(s),t=r.length;while(t--)n=r[t],e[n]=s[n];return e.target||(e.target=document),e.target.nodeType===3&&(e.target=e.target.parentNode),o.filter?o.filter(e,s):e},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==safeActiveElement()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===safeActiveElement()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if(this.type==="checkbox"&&this.click&&jQuery.nodeName(this,"input"))return this.click(),!1},_default:function(e){return jQuery.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){e.result!==undefined&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,n,r){var i=jQuery.extend(new jQuery.Event,n,{type:e,isSimulated:!0,originalEvent:{}});r?jQuery.event.trigger(i,null,t):jQuery.event.dispatch.call(t,i),i.isDefaultPrevented()&&n.preventDefault()}},jQuery.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)},jQuery.Event=function(e,t){if(!(this instanceof jQuery.Event))return new jQuery.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.defaultPrevented===undefined&&e.returnValue===!1?returnTrue:returnFalse):this.type=e,t&&jQuery.extend(this,t),this.timeStamp=e&&e.timeStamp||jQuery.now(),this[jQuery.expando]=!0},jQuery.Event.prototype={isDefaultPrevented:returnFalse,isPropagationStopped:returnFalse,isImmediatePropagationStopped:returnFalse,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=returnTrue,e&&e.preventDefault&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=returnTrue,e&&e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=returnTrue,e&&e.stopImmediatePropagation&&e.stopImmediatePropagation(),this.stopPropagation()}},jQuery.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,t){jQuery.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=this,i=e.relatedTarget,s=e.handleObj;if(!i||i!==r&&!jQuery.contains(r,i))e.type=s.origType,n=s.handler.apply(this,arguments),e.type=t;return n}}}),support.focusinBubbles||jQuery.each({focus:"focusin",blur:"focusout"},function(e,t){var n=function(e){jQuery.event.simulate(t,e.target,jQuery.event.fix(e),!0)};jQuery.event.special[t]={setup:function(){var r=this.ownerDocument||this,i=data_priv.access(r,t);i||r.addEventListener(e,n,!0),data_priv.access(r,t,(i||0)+1)},teardown:function(){var r=this.ownerDocument||this,i=data_priv.access(r,t)-1;i?data_priv.access(r,t,i):(r.removeEventListener(e,n,!0),data_priv.remove(r,t))}}}),jQuery.fn.extend({on:function(e,t,n,r,i){var s,o;if(typeof e=="object"){typeof t!="string"&&(n=n||t,t=undefined);for(o in e)this.on(o,t,n,e[o],i);return this}n==null&&r==null?(r=t,n=t=undefined):r==null&&(typeof t=="string"?(r=n,n=undefined):(r=n,n=t,t=undefined));if(r===!1)r=returnFalse;else if(!r)return this;return i===1&&(s=r,r=function(e){return jQuery().off(e),s.apply(this,arguments)},r.guid=s.guid||(s.guid=jQuery.guid++)),this.each(function(){jQuery.event.add(this,e,r,n,t)})},one:function(e,t,n,r){return this.on(e,t,n,r,1)},off:function(e,t,n){var r,i;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,jQuery(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if(typeof e=="object"){for(i in e)this.off(i,t,e[i]);return this}if(t===!1||typeof t=="function")n=t,t=undefined;return n===!1&&(n=returnFalse),this.each(function(){jQuery.event.remove(this,e,n,t)})},trigger:function(e,t){return this.each(function(){jQuery.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];if(n)return jQuery.event.trigger(e,t,n,!0)}});var rxhtmlTag=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,rtagName=/<([\w:]+)/,rhtml=/<|&#?\w+;/,rnoInnerhtml=/<(?:script|style|link)/i,rchecked=/checked\s*(?:[^=]|=\s*.checked.)/i,rscriptType=/^$|\/(?:java|ecma)script/i,rscriptTypeMasked=/^true\/(.*)/,rcleanScript=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,wrapMap={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};wrapMap.optgroup=wrapMap.option,wrapMap.tbody=wrapMap.tfoot=wrapMap.colgroup=wrapMap.caption=wrapMap.thead,wrapMap.th=wrapMap.td,jQuery.extend({clone:function(e,t,n){var r,i,s,o,u=e.cloneNode(!0),a=jQuery.contains(e.ownerDocument,e);if(!support.noCloneChecked&&(e.nodeType===1||e.nodeType===11)&&!jQuery.isXMLDoc(e)){o=getAll(u),s=getAll(e);for(r=0,i=s.length;r<i;r++)fixInput(s[r],o[r])}if(t)if(n){s=s||getAll(e),o=o||getAll(u);for(r=0,i=s.length;r<i;r++)cloneCopyEvent(s[r],o[r])}else cloneCopyEvent(e,u);return o=getAll(u,"script"),o.length>0&&setGlobalEval(o,!a&&getAll(e,"script")),u},buildFragment:function(e,t,n,r){var i,s,o,u,a,f,l=t.createDocumentFragment(),c=[],h=0,p=e.length;for(;h<p;h++){i=e[h];if(i||i===0)if(jQuery.type(i)==="object")jQuery.merge(c,i.nodeType?[i]:i);else if(!rhtml.test(i))c.push(t.createTextNode(i));else{s=s||l.appendChild(t.createElement("div")),o=(rtagName.exec(i)||["",""])[1].toLowerCase(),u=wrapMap[o]||wrapMap._default,s.innerHTML=u[1]+i.replace(rxhtmlTag,"<$1></$2>")+u[2],f=u[0];while(f--)s=s.lastChild;jQuery.merge(c,s.childNodes),s=l.firstChild,s.textContent=""}}l.textContent="",h=0;while(i=c[h++]){if(r&&jQuery.inArray(i,r)!==-1)continue;a=jQuery.contains(i.ownerDocument,i),s=getAll(l.appendChild(i),"script"),a&&setGlobalEval(s);if(n){f=0;while(i=s[f++])rscriptType.test(i.type||"")&&n.push(i)}}return l},cleanData:function(e){var t,n,r,i,s=jQuery.event.special,o=0;for(;(n=e[o])!==undefined;o++){if(jQuery.acceptData(n)){i=n[data_priv.expando];if(i&&(t=data_priv.cache[i])){if(t.events)for(r in t.events)s[r]?jQuery.event.remove(n,r):jQuery.removeEvent(n,r,t.handle);data_priv.cache[i]&&delete data_priv.cache[i]}}delete data_user.cache[n[data_user.expando]]}}}),jQuery.fn.extend({text:function(e){return access(this,function(e){return e===undefined?jQuery.text(this):this.empty().each(function(){if(this.nodeType===1||this.nodeType===11||this.nodeType===9)this.textContent=e})},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var t=manipulationTarget(this,e);t.appendChild(e)}})},prepend:function(){return this.domManip(arguments,function(e){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var t=manipulationTarget(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){var n,r=e?jQuery.filter(e,this):this,i=0;for(;(n=r[i])!=null;i++)!t&&n.nodeType===1&&jQuery.cleanData(getAll(n)),n.parentNode&&(t&&jQuery.contains(n.ownerDocument,n)&&setGlobalEval(getAll(n,"script")),n.parentNode.removeChild(n));return this},empty:function(){var e,t=0;for(;(e=this[t])!=null;t++)e.nodeType===1&&(jQuery.cleanData(getAll(e,!1)),e.textContent="");return this},clone:function(e,t){return e=e==null?!1:e,t=t==null?e:t,this.map(function(){return jQuery.clone(this,e,t)})},html:function(e){return access(this,function(e){var t=this[0]||{},n=0,r=this.length;if(e===undefined&&t.nodeType===1)return t.innerHTML;if(typeof e=="string"&&!rnoInnerhtml.test(e)&&!wrapMap[(rtagName.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(rxhtmlTag,"<$1></$2>");try{for(;n<r;n++)t=this[n]||{},t.nodeType===1&&(jQuery.cleanData(getAll(t,!1)),t.innerHTML=e);t=0}catch(i){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=arguments[0];return this.domManip(arguments,function(t){e=this.parentNode,jQuery.cleanData(getAll(this)),e&&e.replaceChild(t,this)}),e&&(e.length||e.nodeType)?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(e,t){e=concat.apply([],e);var n,r,i,s,o,u,a=0,f=this.length,l=this,c=f-1,h=e[0],p=jQuery.isFunction(h);if(p||f>1&&typeof h=="string"&&!support.checkClone&&rchecked.test(h))return this.each(function(n){var r=l.eq(n);p&&(e[0]=h.call(this,n,r.html())),r.domManip(e,t)});if(f){n=jQuery.buildFragment(e,this[0].ownerDocument,!1,this),r=n.firstChild,n.childNodes.length===1&&(n=r);if(r){i=jQuery.map(getAll(n,"script"),disableScript),s=i.length;for(;a<f;a++)o=n,a!==c&&(o=jQuery.clone(o,!0,!0),s&&jQuery.merge(i,getAll(o,"script"))),t.call(this[a],o,a);if(s){u=i[i.length-1].ownerDocument,jQuery.map(i,restoreScript);for(a=0;a<s;a++)o=i[a],rscriptType.test(o.type||"")&&!data_priv.access(o,"globalEval")&&jQuery.contains(u,o)&&(o.src?jQuery._evalUrl&&jQuery._evalUrl(o.src):jQuery.globalEval(o.textContent.replace(rcleanScript,"")))}}}return this}}),jQuery.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){jQuery.fn[e]=function(e){var n,r=[],i=jQuery(e),s=i.length-1,o=0;for(;o<=s;o++)n=o===s?this:this.clone(!0),jQuery(i[o])[t](n),push.apply(r,n.get());return this.pushStack(r)}});var iframe,elemdisplay={},rmargin=/^margin/,rnumnonpx=new RegExp("^("+pnum+")(?!px)[a-z%]+$","i"),getStyles=function(e){return e.ownerDocument.defaultView.getComputedStyle(e,null)};(function(){function s(){i.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",i.innerHTML="",n.appendChild(r);var s=window.getComputedStyle(i,null);e=s.top!=="1%",t=s.width==="4px",n.removeChild(r)}var e,t,n=document.documentElement,r=document.createElement("div"),i=document.createElement("div");if(!i.style)return;i.style.backgroundClip="content-box",i.cloneNode(!0).style.backgroundClip="",support.clearCloneStyle=i.style.backgroundClip==="content-box",r.style.cssText="border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;position:absolute",r.appendChild(i),window.getComputedStyle&&jQuery.extend(support,{pixelPosition:function(){return s(),e},boxSizingReliable:function(){return t==null&&s(),t},reliableMarginRight:function(){var e,t=i.appendChild(document.createElement("div"));return t.style.cssText=i.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",t.style.marginRight=t.style.width="0",i.style.width="1px",n.appendChild(r),e=!parseFloat(window.getComputedStyle(t,null).marginRight),n.removeChild(r),e}})})(),jQuery.swap=function(e,t,n,r){var i,s,o={};for(s in t)o[s]=e.style[s],e.style[s]=t[s];i=n.apply(e,r||[]);for(s in t)e.style[s]=o[s];return i};var rdisplayswap=/^(none|table(?!-c[ea]).+)/,rnumsplit=new RegExp("^("+pnum+")(.*)$","i"),rrelNum=new RegExp("^([+-])=("+pnum+")","i"),cssShow={position:"absolute",visibility:"hidden",display:"block"},cssNormalTransform={letterSpacing:"0",fontWeight:"400"},cssPrefixes=["Webkit","O","Moz","ms"];jQuery.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=curCSS(e,"opacity");return n===""?"1":n}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(e,t,n,r){if(!e||e.nodeType===3||e.nodeType===8||!e.style)return;var i,s,o,u=jQuery.camelCase(t),a=e.style;t=jQuery.cssProps[u]||(jQuery.cssProps[u]=vendorPropName(a,u)),o=jQuery.cssHooks[t]||jQuery.cssHooks[u];if(n===undefined)return o&&"get"in o&&(i=o.get(e,!1,r))!==undefined?i:a[t];s=typeof n,s==="string"&&(i=rrelNum.exec(n))&&(n=(i[1]+1)*i[2]+parseFloat(jQuery.css(e,t)),s="number");if(n==null||n!==n)return;s==="number"&&!jQuery.cssNumber[u]&&(n+="px"),!support.clearCloneStyle&&n===""&&t.indexOf("background")===0&&(a[t]="inherit");if(!o||!("set"in o)||(n=o.set(e,n,r))!==undefined)a[t]=n},css:function(e,t,n,r){var i,s,o,u=jQuery.camelCase(t);return t=jQuery.cssProps[u]||(jQuery.cssProps[u]=vendorPropName(e.style,u)),o=jQuery.cssHooks[t]||jQuery.cssHooks[u],o&&"get"in o&&(i=o.get(e,!0,n)),i===undefined&&(i=curCSS(e,t,r)),i==="normal"&&t in cssNormalTransform&&(i=cssNormalTransform[t]),n===""||n?(s=parseFloat(i),n===!0||jQuery.isNumeric(s)?s||0:i):i}}),jQuery.each(["height","width"],function(e,t){jQuery.cssHooks[t]={get:function(e,n,r){if(n)return rdisplayswap.test(jQuery.css(e,"display"))&&e.offsetWidth===0?jQuery.swap(e,cssShow,function(){return getWidthOrHeight(e,t,r)}):getWidthOrHeight(e,t,r)},set:function(e,n,r){var i=r&&getStyles(e);return setPositiveNumber(e,n,r?augmentWidthOrHeight(e,t,r,jQuery.css(e,"boxSizing",!1,i)==="border-box",i):0)}}}),jQuery.cssHooks.marginRight=addGetHookIf(support.reliableMarginRight,function(e,t){if(t)return jQuery.swap(e,{display:"inline-block"},curCSS,[e,"marginRight"])}),jQuery.each({margin:"",padding:"",border:"Width"},function(e,t){jQuery.cssHooks[e+t]={expand:function(n){var r=0,i={},s=typeof n=="string"?n.split(" "):[n];for(;r<4;r++)i[e+cssExpand[r]+t]=s[r]||s[r-2]||s[0];return i}},rmargin.test(e)||(jQuery.cssHooks[e+t].set=setPositiveNumber)}),jQuery.fn.extend({css:function(e,t){return access(this,function(e,t,n){var r,i,s={},o=0;if(jQuery.isArray(t)){r=getStyles(e),i=t.length;for(;o<i;o++)s[t[o]]=jQuery.css(e,t[o],!1,r);return s}return n!==undefined?jQuery.style(e,t,n):jQuery.css(e,t)},e,t,arguments.length>1)},show:function(){return showHide(this,!0)},hide:function(){return showHide(this)},toggle:function(e){return typeof e=="boolean"?e?this.show():this.hide():this.each(function(){isHidden(this)?jQuery(this).show():jQuery(this).hide()})}}),jQuery.Tween=Tween,Tween.prototype={constructor:Tween,init:function(e,t,n,r,i,s){this.elem=e,this.prop=n,this.easing=i||"swing",this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=s||(jQuery.cssNumber[n]?"":"px")},cur:function(){var e=Tween.propHooks[this.prop];return e&&e.get?e.get(this):Tween.propHooks._default.get(this)},run:function(e){var t,n=Tween.propHooks[this.prop];return this.options.duration?this.pos=t=jQuery.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):Tween.propHooks._default.set(this),this}},Tween.prototype.init.prototype=Tween.prototype,Tween.propHooks={_default:{get:function(e){var t;return e.elem[e.prop]==null||!!e.elem.style&&e.elem.style[e.prop]!=null?(t=jQuery.css(e.elem,e.prop,""),!t||t==="auto"?0:t):e.elem[e.prop]},set:function(e){jQuery.fx.step[e.prop]?jQuery.fx.step[e.prop](e):e.elem.style&&(e.elem.style[jQuery.cssProps[e.prop]]!=null||jQuery.cssHooks[e.prop])?jQuery.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},Tween.propHooks.scrollTop=Tween.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},jQuery.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},jQuery.fx=Tween.prototype.init,jQuery.fx.step={};var fxNow,timerId,rfxtypes=/^(?:toggle|show|hide)$/,rfxnum=new RegExp("^(?:([+-])=|)("+pnum+")([a-z%]*)$","i"),rrun=/queueHooks$/,animationPrefilters=[defaultPrefilter],tweeners={"*":[function(e,t){var n=this.createTween(e,t),r=n.cur(),i=rfxnum.exec(t),s=i&&i[3]||(jQuery.cssNumber[e]?"":"px"),o=(jQuery.cssNumber[e]||s!=="px"&&+r)&&rfxnum.exec(jQuery.css(n.elem,e)),u=1,a=20;if(o&&o[3]!==s){s=s||o[3],i=i||[],o=+r||1;do u=u||".5",o/=u,jQuery.style(n.elem,e,o+s);while(u!==(u=n.cur()/r)&&u!==1&&--a)}return i&&(o=n.start=+o||+r||0,n.unit=s,n.end=i[1]?o+(i[1]+1)*i[2]:+i[2]),n}]};jQuery.Animation=jQuery.extend(Animation,{tweener:function(e,t){jQuery.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");var n,r=0,i=e.length;for(;r<i;r++)n=e[r],tweeners[n]=tweeners[n]||[],tweeners[n].unshift(t)},prefilter:function(e,t){t?animationPrefilters.unshift(e):animationPrefilters.push(e)}}),jQuery.speed=function(e,t,n){var r=e&&typeof e=="object"?jQuery.extend({},e):{complete:n||!n&&t||jQuery.isFunction(e)&&e,duration:e,easing:n&&t||t&&!jQuery.isFunction(t)&&t};r.duration=jQuery.fx.off?0:typeof r.duration=="number"?r.duration:r.duration in jQuery.fx.speeds?jQuery.fx.speeds[r.duration]:jQuery.fx.speeds._default;if(r.queue==null||r.queue===!0)r.queue="fx";return r.old=r.complete,r.complete=function(){jQuery.isFunction(r.old)&&r.old.call(this),r.queue&&jQuery.dequeue(this,r.queue)},r},jQuery.fn.extend({fadeTo:function(e,t,n,r){return this.filter(isHidden).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=jQuery.isEmptyObject(e),s=jQuery.speed(t,n,r),o=function(){var t=Animation(this,jQuery.extend({},e),s);(i||data_priv.get(this,"finish"))&&t.stop(!0)};return o.finish=o,i||s.queue===!1?this.each(o):this.queue(s.queue,o)},stop:function(e,t,n){var r=function(e){var t=e.stop;delete e.stop,t(n)};return typeof e!="string"&&(n=t,t=e,e=undefined),t&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,i=e!=null&&e+"queueHooks",s=jQuery.timers,o=data_priv.get(this);if(i)o[i]&&o[i].stop&&r(o[i]);else for(i in o)o[i]&&o[i].stop&&rrun.test(i)&&r(o[i]);for(i=s.length;i--;)s[i].elem===this&&(e==null||s[i].queue===e)&&(s[i].anim.stop(n),t=!1,s.splice(i,1));(t||!n)&&jQuery.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,n=data_priv.get(this),r=n[e+"queue"],i=n[e+"queueHooks"],s=jQuery.timers,o=r?r.length:0;n.finish=!0,jQuery.queue(this,e,[]),i&&i.stop&&i.stop.call(this,!0);for(t=s.length;t--;)s[t].elem===this&&s[t].queue===e&&(s[t].anim.stop(!0),s.splice(t,1));for(t=0;t<o;t++)r[t]&&r[t].finish&&r[t].finish.call(this);delete n.finish})}}),jQuery.each(["toggle","show","hide"],function(e,t){var n=jQuery.fn[t];jQuery.fn[t]=function(e,r,i){return e==null||typeof e=="boolean"?n.apply(this,arguments):this.animate(genFx(t,!0),e,r,i)}}),jQuery.each({slideDown:genFx("show"),slideUp:genFx("hide"),slideToggle:genFx("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){jQuery.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),jQuery.timers=[],jQuery.fx.tick=function(){var e,t=0,n=jQuery.timers;fxNow=jQuery.now();for(;t<n.length;t++)e=n[t],!e()&&n[t]===e&&n.splice(t--,1);n.length||jQuery.fx.stop(),fxNow=undefined},jQuery.fx.timer=function(e){jQuery.timers.push(e),e()?jQuery.fx.start():jQuery.timers.pop()},jQuery.fx.interval=13,jQuery.fx.start=function(){timerId||(timerId=setInterval(jQuery.fx.tick,jQuery.fx.interval))},jQuery.fx.stop=function(){clearInterval(timerId),timerId=null},jQuery.fx.speeds={slow:600,fast:200,_default:400},jQuery.fn.delay=function(e,t){return e=jQuery.fx?jQuery.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var r=setTimeout(t,e);n.stop=function(){clearTimeout(r)}})},function(){var e=document.createElement("input"),t=document.createElement("select"),n=t.appendChild(document.createElement("option"));e.type="checkbox",support.checkOn=e.value!=="",support.optSelected=n.selected,t.disabled=!0,support.optDisabled=!n.disabled,e=document.createElement("input"),e.value="t",e.type="radio",support.radioValue=e.value==="t"}();var nodeHook,boolHook,attrHandle=jQuery.expr.attrHandle;jQuery.fn.extend({attr:function(e,t){return access(this,jQuery.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){jQuery.removeAttr(this,e)})}}),jQuery.extend({attr:function(e,t,n){var r,i,s=e.nodeType;if(!e||s===3||s===8||s===2)return;if(typeof e.getAttribute===strundefined)return jQuery.prop(e,t,n);if(s!==1||!jQuery.isXMLDoc(e))t=t.toLowerCase(),r=jQuery.attrHooks[t]||(jQuery.expr.match.bool.test(t)?boolHook:nodeHook);if(n===undefined)return r&&"get"in r&&(i=r.get(e,t))!==null?i:(i=jQuery.find.attr(e,t),i==null?undefined:i);if(n!==null)return r&&"set"in r&&(i=r.set(e,n,t))!==undefined?i:(e.setAttribute(t,n+""),n);jQuery.removeAttr(e,t)},removeAttr:function(e,t){var n,r,i=0,s=t&&t.match(rnotwhite);if(s&&e.nodeType===1)while(n=s[i++])r=jQuery.propFix[n]||n,jQuery.expr.match.bool.test(n)&&(e[r]=!1),e.removeAttribute(n)},attrHooks:{type:{set:function(e,t){if(!support.radioValue&&t==="radio"&&jQuery.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}}}),boolHook={set:function(e,t,n){return t===!1?jQuery.removeAttr(e,n):e.setAttribute(n,n),n}},jQuery.each(jQuery.expr.match.bool.source.match(/\w+/g),function(e,t){var n=attrHandle[t]||jQuery.find.attr;attrHandle[t]=function(e,t,r){var i,s;return r||(s=attrHandle[t],attrHandle[t]=i,i=n(e,t,r)!=null?t.toLowerCase():null,attrHandle[t]=s),i}});var rfocusable=/^(?:input|select|textarea|button)$/i;jQuery.fn.extend({prop:function(e,t){return access(this,jQuery.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[jQuery.propFix[e]||e]})}}),jQuery.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(e,t,n){var r,i,s,o=e.nodeType;if(!e||o===3||o===8||o===2)return;return s=o!==1||!jQuery.isXMLDoc(e),s&&(t=jQuery.propFix[t]||t,i=jQuery.propHooks[t]),n!==undefined?i&&"set"in i&&(r=i.set(e,n,t))!==undefined?r:e[t]=n:i&&"get"in i&&(r=i.get(e,t))!==null?r:e[t]},propHooks:{tabIndex:{get:function(e){return e.hasAttribute("tabindex")||rfocusable.test(e.nodeName)||e.href?e.tabIndex:-1}}}}),support.optSelected||(jQuery.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null}}),jQuery.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){jQuery.propFix[this.toLowerCase()]=this});var rclass=/[\t\r\n\f]/g;jQuery.fn.extend({addClass:function(e){var t,n,r,i,s,o,u=typeof e=="string"&&e,a=0,f=this.length;if(jQuery.isFunction(e))return this.each(function(t){jQuery(this).addClass(e.call(this,t,this.className))});if(u){t=(e||"").match(rnotwhite)||[];for(;a<f;a++){n=this[a],r=n.nodeType===1&&(n.className?(" "+n.className+" ").replace(rclass," "):" ");if(r){s=0;while(i=t[s++])r.indexOf(" "+i+" ")<0&&(r+=i+" ");o=jQuery.trim(r),n.className!==o&&(n.className=o)}}}return this},removeClass:function(e){var t,n,r,i,s,o,u=arguments.length===0||typeof e=="string"&&e,a=0,f=this.length;if(jQuery.isFunction(e))return this.each(function(t){jQuery(this).removeClass(e.call(this,t,this.className))});if(u){t=(e||"").match(rnotwhite)||[];for(;a<f;a++){n=this[a],r=n.nodeType===1&&(n.className?(" "+n.className+" ").replace(rclass," "):"");if(r){s=0;while(i=t[s++])while(r.indexOf(" "+i+" ")>=0)r=r.replace(" "+i+" "," ");o=e?jQuery.trim(r):"",n.className!==o&&(n.className=o)}}}return this},toggleClass:function(e,t){var n=typeof e;return typeof t=="boolean"&&n==="string"?t?this.addClass(e):this.removeClass(e):jQuery.isFunction(e)?this.each(function(n){jQuery(this).toggleClass(e.call(this,n,this.className,t),t)}):this.each(function(){if(n==="string"){var t,r=0,i=jQuery(this),s=e.match(rnotwhite)||[];while(t=s[r++])i.hasClass(t)?i.removeClass(t):i.addClass(t)}else if(n===strundefined||n==="boolean")this.className&&data_priv.set(this,"__className__",this.className),this.className=this.className||e===!1?"":data_priv.get(this,"__className__")||""})},hasClass:function(e){var t=" "+e+" ",n=0,r=this.length;for(;n<r;n++)if(this[n].nodeType===1&&(" "+this[n].className+" ").replace(rclass," ").indexOf(t)>=0)return!0;return!1}});var rreturn=/\r/g;jQuery.fn.extend({val:function(e){var t,n,r,i=this[0];if(!arguments.length){if(i)return t=jQuery.valHooks[i.type]||jQuery.valHooks[i.nodeName.toLowerCase()],t&&"get"in t&&(n=t.get(i,"value"))!==undefined?n:(n=i.value,typeof n=="string"?n.replace(rreturn,""):n==null?"":n);return}return r=jQuery.isFunction(e),this.each(function(n){var i;if(this.nodeType!==1)return;r?i=e.call(this,n,jQuery(this).val()):i=e,i==null?i="":typeof i=="number"?i+="":jQuery.isArray(i)&&(i=jQuery.map(i,function(e){return e==null?"":e+""})),t=jQuery.valHooks[this.type]||jQuery.valHooks[this.nodeName.toLowerCase()];if(!t||!("set"in t)||t.set(this,i,"value")===undefined)this.value=i})}}),jQuery.extend({valHooks:{option:{get:function(e){var t=jQuery.find.attr(e,"value");return t!=null?t:jQuery.trim(jQuery.text(e))}},select:{get:function(e){var t,n,r=e.options,i=e.selectedIndex,s=e.type==="select-one"||i<0,o=s?null:[],u=s?i+1:r.length,a=i<0?u:s?i:0;for(;a<u;a++){n=r[a];if((n.selected||a===i)&&(support.optDisabled?!n.disabled:n.getAttribute("disabled")===null)&&(!n.parentNode.disabled||!jQuery.nodeName(n.parentNode,"optgroup"))){t=jQuery(n).val();if(s)return t;o.push(t)}}return o},set:function(e,t){var n,r,i=e.options,s=jQuery.makeArray(t),o=i.length;while(o--){r=i[o];if(r.selected=jQuery.inArray(r.value,s)>=0)n=!0}return n||(e.selectedIndex=-1),s}}}}),jQuery.each(["radio","checkbox"],function(){jQuery.valHooks[this]={set:function(e,t){if(jQuery.isArray(t))return e.checked=jQuery.inArray(jQuery(e).val(),t)>=0}},support.checkOn||(jQuery.valHooks[this].get=function(e){return e.getAttribute("value")===null?"on":e.value})}),jQuery.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){jQuery.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),jQuery.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return arguments.length===1?this.off(e,"**"):this.off(t,e||"**",n)}});var nonce=jQuery.now(),rquery=/\?/;jQuery.parseJSON=function(e){return JSON.parse(e+"")},jQuery.parseXML=function(e){var t,n;if(!e||typeof e!="string")return null;try{n=new DOMParser,t=n.parseFromString(e,"text/xml")}catch(r){t=undefined}return(!t||t.getElementsByTagName("parsererror").length)&&jQuery.error("Invalid XML: "+e),t};var ajaxLocParts,ajaxLocation,rhash=/#.*$/,rts=/([?&])_=[^&]*/,rheaders=/^(.*?):[ \t]*([^\r\n]*)$/mg,rlocalProtocol=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,rnoContent=/^(?:GET|HEAD)$/,rprotocol=/^\/\//,rurl=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,prefilters={},transports={},allTypes="*/".concat("*");try{ajaxLocation=location.href}catch(e){ajaxLocation=document.createElement("a"),ajaxLocation.href="",ajaxLocation=ajaxLocation.href}ajaxLocParts=rurl.exec(ajaxLocation.toLowerCase())||[],jQuery.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:ajaxLocation,type:"GET",isLocal:rlocalProtocol.test(ajaxLocParts[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":allTypes,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":jQuery.parseJSON,"text xml":jQuery.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?ajaxExtend(ajaxExtend(e,jQuery.ajaxSettings),t):ajaxExtend(jQuery.ajaxSettings,e)},ajaxPrefilter:addToPrefiltersOrTransports(prefilters),ajaxTransport:addToPrefiltersOrTransports(transports),ajax:function(e,t){function S(e,t,s,u){var f,m,g,b,E,S=t;if(y===2)return;y=2,o&&clearTimeout(o),n=undefined,i=u||"",w.readyState=e>0?4:0,f=e>=200&&e<300||e===304,s&&(b=ajaxHandleResponses(l,w,s)),b=ajaxConvert(l,b,w,f);if(f)l.ifModified&&(E=w.getResponseHeader("Last-Modified"),E&&(jQuery.lastModified[r]=E),E=w.getResponseHeader("etag"),E&&(jQuery.etag[r]=E)),e===204||l.type==="HEAD"?S="nocontent":e===304?S="notmodified":(S=b.state,m=b.data,g=b.error,f=!g);else{g=S;if(e||!S)S="error",e<0&&(e=0)}w.status=e,w.statusText=(t||S)+"",f?p.resolveWith(c,[m,S,w]):p.rejectWith(c,[w,S,g]),w.statusCode(v),v=undefined,a&&h.trigger(f?"ajaxSuccess":"ajaxError",[w,l,f?m:g]),d.fireWith(c,[w,S]),a&&(h.trigger("ajaxComplete",[w,l]),--jQuery.active||jQuery.event.trigger("ajaxStop"))}typeof e=="object"&&(t=e,e=undefined),t=t||{};var n,r,i,s,o,u,a,f,l=jQuery.ajaxSetup({},t),c=l.context||l,h=l.context&&(c.nodeType||c.jquery)?jQuery(c):jQuery.event,p=jQuery.Deferred(),d=jQuery.Callbacks("once memory"),v=l.statusCode||{},m={},g={},y=0,b="canceled",w={readyState:0,getResponseHeader:function(e){var t;if(y===2){if(!s){s={};while(t=rheaders.exec(i))s[t[1].toLowerCase()]=t[2]}t=s[e.toLowerCase()]}return t==null?null:t},getAllResponseHeaders:function(){return y===2?i:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return y||(e=g[n]=g[n]||e,m[e]=t),this},overrideMimeType:function(e){return y||(l.mimeType=e),this},statusCode:function(e){var t;if(e)if(y<2)for(t in e)v[t]=[v[t],e[t]];else w.always(e[w.status]);return this},abort:function(e){var t=e||b;return n&&n.abort(t),S(0,t),this}};p.promise(w).complete=d.add,w.success=w.done,w.error=w.fail,l.url=((e||l.url||ajaxLocation)+"").replace(rhash,"").replace(rprotocol,ajaxLocParts[1]+"//"),l.type=t.method||t.type||l.method||l.type,l.dataTypes=jQuery.trim(l.dataType||"*").toLowerCase().match(rnotwhite)||[""],l.crossDomain==null&&(u=rurl.exec(l.url.toLowerCase()),l.crossDomain=!(!u||u[1]===ajaxLocParts[1]&&u[2]===ajaxLocParts[2]&&(u[3]||(u[1]==="http:"?"80":"443"))===(ajaxLocParts[3]||(ajaxLocParts[1]==="http:"?"80":"443")))),l.data&&l.processData&&typeof l.data!="string"&&(l.data=jQuery.param(l.data,l.traditional)),inspectPrefiltersOrTransports(prefilters,l,t,w);if(y===2)return w;a=l.global,a&&jQuery.active++===0&&jQuery.event.trigger("ajaxStart"),l.type=l.type.toUpperCase(),l.hasContent=!rnoContent.test(l.type),r=l.url,l.hasContent||(l.data&&(r=l.url+=(rquery.test(r)?"&":"?")+l.data,delete l.data),l.cache===!1&&(l.url=rts.test(r)?r.replace(rts,"$1_="+nonce++):r+(rquery.test(r)?"&":"?")+"_="+nonce++)),l.ifModified&&(jQuery.lastModified[r]&&w.setRequestHeader("If-Modified-Since",jQuery.lastModified[r]),jQuery.etag[r]&&w.setRequestHeader("If-None-Match",jQuery.etag[r])),(l.data&&l.hasContent&&l.contentType!==!1||t.contentType)&&w.setRequestHeader("Content-Type",l.contentType),w.setRequestHeader("Accept",l.dataTypes[0]&&l.accepts[l.dataTypes[0]]?l.accepts[l.dataTypes[0]]+(l.dataTypes[0]!=="*"?", "+allTypes+"; q=0.01":""):l.accepts["*"]);for(f in l.headers)w.setRequestHeader(f,l.headers[f]);if(!l.beforeSend||l.beforeSend.call(c,w,l)!==!1&&y!==2){b="abort";for(f in{success:1,error:1,complete:1})w[f](l[f]);n=inspectPrefiltersOrTransports(transports,l,t,w);if(!n)S(-1,"No Transport");else{w.readyState=1,a&&h.trigger("ajaxSend",[w,l]),l.async&&l.timeout>0&&(o=setTimeout(function(){w.abort("timeout")},l.timeout));try{y=1,n.send(m,S)}catch(E){if(!(y<2))throw E;S(-1,E)}}return w}return w.abort()},getJSON:function(e,t,n){return jQuery.get(e,t,n,"json")},getScript:function(e,t){return jQuery.get(e,undefined,t,"script")}}),jQuery.each(["get","post"],function(e,t){jQuery[t]=function(e,n,r,i){return jQuery.isFunction(n)&&(i=i||r,r=n,n=undefined),jQuery.ajax({url:e,type:t,dataType:i,data:n,success:r})}}),jQuery.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){jQuery.fn[t]=function(e){return this.on(t,e)}}),jQuery._evalUrl=function(e){return jQuery.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},jQuery.fn.extend({wrapAll:function(e){var t;return jQuery.isFunction(e)?this.each(function(t){jQuery(this).wrapAll(e.call(this,t))}):(this[0]&&(t=jQuery(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;while(e.firstElementChild)e=e.firstElementChild;return e}).append(this)),this)},wrapInner:function(e){return jQuery.isFunction(e)?this.each(function(t){jQuery(this).wrapInner(e.call(this,t))}):this.each(function(){var t=jQuery(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=jQuery.isFunction(e);return this.each(function(n){jQuery(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){jQuery.nodeName(this,"body")||jQuery(this).replaceWith(this.childNodes)}).end()}}),jQuery.expr.filters.hidden=function(e){return e.offsetWidth<=0&&e.offsetHeight<=0},jQuery.expr.filters.visible=function(e){return!jQuery.expr.filters.hidden(e)};var r20=/%20/g,rbracket=/\[\]$/,rCRLF=/\r?\n/g,rsubmitterTypes=/^(?:submit|button|image|reset|file)$/i,rsubmittable=/^(?:input|select|textarea|keygen)/i;jQuery.param=function(e,t){var n,r=[],i=function(e,t){t=jQuery.isFunction(t)?t():t==null?"":t,r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};t===undefined&&(t=jQuery.ajaxSettings&&jQuery.ajaxSettings.traditional);if(jQuery.isArray(e)||e.jquery&&!jQuery.isPlainObject(e))jQuery.each(e,function(){i(this.name,this.value)});else for(n in e)buildParams(n,e[n],t,i);return r.join("&").replace(r20,"+")},jQuery.fn.extend({serialize:function(){return jQuery.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=jQuery.prop(this,"elements");return e?jQuery.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!jQuery(this).is(":disabled")&&rsubmittable.test(this.nodeName)&&!rsubmitterTypes.test(e)&&(this.checked||!rcheckableType.test(e))}).map(function(e,t){var n=jQuery(this).val();return n==null?null:jQuery.isArray(n)?jQuery.map(n,function(e){return{name:t.name,value:e.replace(rCRLF,"\r\n")}}):{name:t.name,value:n.replace(rCRLF,"\r\n")}}).get()}}),jQuery.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(e){}};var xhrId=0,xhrCallbacks={},xhrSuccessStatus={0:200,1223:204},xhrSupported=jQuery.ajaxSettings.xhr();window.ActiveXObject&&jQuery(window).on("unload",function(){for(var e in xhrCallbacks)xhrCallbacks[e]()}),support.cors=!!xhrSupported&&"withCredentials"in xhrSupported,support.ajax=xhrSupported=!!xhrSupported,jQuery.ajaxTransport(function(e){var t;if(support.cors||xhrSupported&&!e.crossDomain)return{send:function(n,r){var i,s=e.xhr(),o=++xhrId;s.open(e.type,e.url,e.async,e.username,e.password);if(e.xhrFields)for(i in e.xhrFields)s[i]=e.xhrFields[i];e.mimeType&&s.overrideMimeType&&s.overrideMimeType(e.mimeType),!e.crossDomain&&!n["X-Requested-With"]&&(n["X-Requested-With"]="XMLHttpRequest");for(i in n)s.setRequestHeader(i,n[i]);t=function(e){return function(){t&&(delete xhrCallbacks[o],t=s.onload=s.onerror=null,e==="abort"?s.abort():e==="error"?r(s.status,s.statusText):r(xhrSuccessStatus[s.status]||s.status,s.statusText,typeof s.responseText=="string"?{text:s.responseText}:undefined,s.getAllResponseHeaders()))}},s.onload=t(),s.onerror=t("error"),t=xhrCallbacks[o]=t("abort");try{s.send(e.hasContent&&e.data||null)}catch(u){if(t)throw u}},abort:function(){t&&t()}}}),jQuery.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return jQuery.globalEval(e),e}}}),jQuery.ajaxPrefilter("script",function(e){e.cache===undefined&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),jQuery.ajaxTransport("script",function(e){if(e.crossDomain){var t,n;return{send:function(r,i){t=jQuery("<script>").prop({async:!0,charset:e.scriptCharset,src:e.url}).on("load error",n=function(e){t.remove(),n=null,e&&i(e.type==="error"?404:200,e.type)}),document.head.appendChild(t[0])},abort:function(){n&&n()}}}});var oldCallbacks=[],rjsonp=/(=)\?(?=&|$)|\?\?/;jQuery.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=oldCallbacks.pop()||jQuery.expando+"_"+nonce++;return this[e]=!0,e}}),jQuery.ajaxPrefilter("json jsonp",function(e,t,n){var r,i,s,o=e.jsonp!==!1&&(rjsonp.test(e.url)?"url":typeof e.data=="string"&&!(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&rjsonp.test(e.data)&&"data");if(o||e.dataTypes[0]==="jsonp")return r=e.jsonpCallback=jQuery.isFunction(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,o?e[o]=e[o].replace(rjsonp,"$1"+r):e.jsonp!==!1&&(e.url+=(rquery.test(e.url)?"&":"?")+e.jsonp+"="+r),e.converters["script json"]=function(){return s||jQuery.error(r+" was not called"),s[0]},e.dataTypes[0]="json",i=window[r],window[r]=function(){s=arguments},n.always(function(){window[r]=i,e[r]&&(e.jsonpCallback=t.jsonpCallback,oldCallbacks.push(r)),s&&jQuery.isFunction(i)&&i(s[0]),s=i=undefined}),"script"}),jQuery.parseHTML=function(e,t,n){if(!e||typeof e!="string")return null;typeof t=="boolean"&&(n=t,t=!1),t=t||document;var r=rsingleTag.exec(e),i=!n&&[];return r?[t.createElement(r[1])]:(r=jQuery.buildFragment([e],t,i),i&&i.length&&jQuery(i).remove(),jQuery.merge([],r.childNodes))};var _load=jQuery.fn.load;jQuery.fn.load=function(e,t,n){if(typeof e!="string"&&_load)return _load.apply(this,arguments);var r,i,s,o=this,u=e.indexOf(" ");return u>=0&&(r=jQuery.trim(e.slice(u)),e=e.slice(0,u)),jQuery.isFunction(t)?(n=t,t=undefined):t&&typeof t=="object"&&(i="POST"),o.length>0&&jQuery.ajax({url:e,type:i,dataType:"html",data:t}).done(function(e){s=arguments,o.html(r?jQuery("<div>").append(jQuery.parseHTML(e)).find(r):e)}).complete(n&&function(e,t){o.each(n,s||[e.responseText,t,e])}),this},jQuery.expr.filters.animated=function(e){return jQuery.grep(jQuery.timers,function(t){return e===t.elem}).length};var docElem=window.document.documentElement;jQuery.offset={setOffset:function(e,t,n){var r,i,s,o,u,a,f,l=jQuery.css(e,"position"),c=jQuery(e),h={};l==="static"&&(e.style.position="relative"),u=c.offset(),s=jQuery.css(e,"top"),a=jQuery.css(e,"left"),f=(l==="absolute"||l==="fixed")&&(s+a).indexOf("auto")>-1,f?(r=c.position(),o=r.top,i=r.left):(o=parseFloat(s)||0,i=parseFloat(a)||0),jQuery.isFunction(t)&&(t=t.call(e,n,u)),t.top!=null&&(h.top=t.top-u.top+o),t.left!=null&&(h.left=t.left-u.left+i),"using"in t?t.using.call(e,h):c.css(h)}},jQuery.fn.extend({offset:function(e){if(arguments.length)return e===undefined?this:this.each(function(t){jQuery.offset.setOffset(this,e,t)});var t,n,r=this[0],i={top:0,left:0},s=r&&r.ownerDocument;if(!s)return;return t=s.documentElement,jQuery.contains(t,r)?(typeof r.getBoundingClientRect!==strundefined&&(i=r.getBoundingClientRect()),n=getWindow(s),{top:i.top+n.pageYOffset-t.clientTop,left:i.left+n.pageXOffset-t.clientLeft}):i},position:function(){if(!this[0])return;var e,t,n=this[0],r={top:0,left:0};return jQuery.css(n,"position")==="fixed"?t=n.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),jQuery.nodeName(e[0],"html")||(r=e.offset()),r.top+=jQuery.css(e[0],"borderTopWidth",!0),r.left+=jQuery.css(e[0],"borderLeftWidth",!0)),{top:t.top-r.top-jQuery.css(n,"marginTop",!0),left:t.left-r.left-jQuery.css(n,"marginLeft",!0)}},offsetParent:function(){return this.map(function(){var e=this.offsetParent||docElem;while(e&&!jQuery.nodeName(e,"html")&&jQuery.css(e,"position")==="static")e=e.offsetParent;return e||docElem})}}),jQuery.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,t){var n="pageYOffset"===t;jQuery.fn[e]=function(r){return access(this,function(e,r,i){var s=getWindow(e);if(i===undefined)return s?s[t]:e[r];s?s.scrollTo(n?window.pageXOffset:i,n?i:window.pageYOffset):e[r]=i},e,r,arguments.length,null)}}),jQuery.each(["top","left"],function(e,t){jQuery.cssHooks[t]=addGetHookIf(support.pixelPosition,function(e,n){if(n)return n=curCSS(e,t),rnumnonpx.test(n)?jQuery(e).position()[t]+"px":n})}),jQuery.each({Height:"height",Width:"width"},function(e,t){jQuery.each({padding:"inner"+e,content:t,"":"outer"+e},function(n,r){jQuery.fn[r]=function(r,i){var s=arguments.length&&(n||typeof r!="boolean"),o=n||(r===!0||i===!0?"margin":"border");return access(this,function(t,n,r){var i;return jQuery.isWindow(t)?t.document.documentElement["client"+e]:t.nodeType===9?(i=t.documentElement,Math.max(t.body["scroll"+e],i["scroll"+e],t.body["offset"+e],i["offset"+e],i["client"+e])):r===undefined?jQuery.css(t,n,o):jQuery.style(t,n,r,o)},t,s?r:undefined,s,null)}})}),jQuery.fn.size=function(){return this.length},jQuery.fn.andSelf=jQuery.fn.addBack,typeof define=="function"&&define.amd&&define("jquery",[],function(){return jQuery});var _jQuery=window.jQuery,_$=window.$;return jQuery.noConflict=function(e){return window.$===jQuery&&(window.$=_$),e&&window.jQuery===jQuery&&(window.jQuery=_jQuery),jQuery},typeof noGlobal===strundefined&&(window.jQuery=window.$=jQuery),jQuery}),function(e){if(!e.support.cors&&e.ajaxTransport&&window.XDomainRequest){var t=/^https?:\/\//i,n=/^get|post$/i,r=new RegExp("^"+location.protocol,"i"),i=/text\/html/i,s=/\/json/i,o=/\/xml/i;e.ajaxTransport("* text html xml json",function(u,a,f){if(u.crossDomain&&u.async&&n.test(u.type)&&t.test(u.url)&&r.test(u.url)){var l=null,c=(a.dataType||"").toLowerCase();return{send:function(t,n){l=new XDomainRequest,/^\d+$/.test(a.timeout)&&(l.timeout=a.timeout),l.ontimeout=function(){n(500,"timeout")},l.onload=function(){var t="Content-Length: "+l.responseText.length+"\r\nContent-Type: "+l.contentType,r={code:200,message:"success"},u={text:l.responseText};try{if(c==="html"||i.test(l.contentType))u.html=l.responseText;else if(c==="json"||c!=="text"&&s.test(l.contentType))try{u.json=e.parseJSON(l.responseText)}catch(a){r.code=500,r.message="parseerror"}else if(c==="xml"||c!=="text"&&o.test(l.contentType)){var f=new ActiveXObject("Microsoft.XMLDOM");f.async=!1;try{f.loadXML(l.responseText)}catch(a){f=undefined}if(!f||!f.documentElement||f.getElementsByTagName("parsererror").length)throw r.code=500,r.message="parseerror","Invalid XML: "+l.responseText;u.xml=f}}catch(h){throw h}finally{n(r.code,r.message,u,t)}},l.onprogress=function(){},l.onerror=function(){n(500,"error",{text:l.responseText})};var r="";a.data&&(r=e.type(a.data)==="string"?a.data:e.param(a.data)),l.open(u.type,u.url),l.send(r)},abort:function(){l&&l.abort()}}}})}}(jQuery),function(e,t){if(typeof define=="function"&&define.amd)define("backbone",["underscore","jquery","exports"],function(n,r,i){e.Backbone=t(e,i,n,r)});else if(typeof exports!="undefined"){var n=require("underscore");t(e,exports,n)}else e.Backbone=t(e,{},e._,e.jQuery||e.Zepto||e.ender||e.$)}(this,function(e,t,n,r){var i=e.Backbone,s=[],o=s.push,u=s.slice,a=s.splice;t.VERSION="1.1.2",t.$=r,t.noConflict=function(){return e.Backbone=i,this},t.emulateHTTP=!1,t.emulateJSON=!1;var f=t.Events={on:function(e,t,n){if(!c(this,"on",e,[t,n])||!t)return this;this._events||(this._events={});var r=this._events[e]||(this._events[e]=[]);return r.push({callback:t,context:n,ctx:n||this}),this},once:function(e,t,r){if(!c(this,"once",e,[t,r])||!t)return this;var i=this,s=n.once(function(){i.off(e,s),t.apply(this,arguments)});return s._callback=t,this.on(e,s,r)},off:function(e,t,r){var i,s,o,u,a,f,l,h;if(!this._events||!c(this,"off",e,[t,r]))return this;if(!e&&!t&&!r)return this._events=void 0,this;u=e?[e]:n.keys(this._events);for(a=0,f=u.length;a<f;a++){e=u[a];if(o=this._events[e]){this._events[e]=i=[];if(t||r)for(l=0,h=o.length;l<h;l++)s=o[l],(t&&t!==s.callback&&t!==s.callback._callback||r&&r!==s.context)&&i.push(s);i.length||delete this._events[e]}}return this},trigger:function(e){if(!this._events)return this;var t=u.call(arguments,1);if(!c(this,"trigger",e,t))return this;var n=this._events[e],r=this._events.all;return n&&h(n,t),r&&h(r,arguments),this},stopListening:function(e,t,r){var i=this._listeningTo;if(!i)return this;var s=!t&&!r;!r&&typeof t=="object"&&(r=this),e&&((i={})[e._listenId]=e);for(var o in i)e=i[o],e.off(t,r,this),(s||n.isEmpty(e._events))&&delete this._listeningTo[o];return this}},l=/\s+/,c=function(e,t,n,r){if(!n)return!0;if(typeof n=="object"){for(var i in n)e[t].apply(e,[i,n[i]].concat(r));return!1}if(l.test(n)){var s=n.split(l);for(var o=0,u=s.length;o<u;o++)e[t].apply(e,[s[o]].concat(r));return!1}return!0},h=function(e,t){var n,r=-1,i=e.length,s=t[0],o=t[1],u=t[2];switch(t.length){case 0:while(++r<i)(n=e[r]).callback.call(n.ctx);return;case 1:while(++r<i)(n=e[r]).callback.call(n.ctx,s);return;case 2:while(++r<i)(n=e[r]).callback.call(n.ctx,s,o);return;case 3:while(++r<i)(n=e[r]).callback.call(n.ctx,s,o,u);return;default:while(++r<i)(n=e[r]).callback.apply(n.ctx,t);return}},p={listenTo:"on",listenToOnce:"once"};n.each(p,function(e,t){f[t]=function(t,r,i){var s=this._listeningTo||(this._listeningTo={}),o=t._listenId||(t._listenId=n.uniqueId("l"));return s[o]=t,!i&&typeof r=="object"&&(i=this),t[e](r,i,this),this}}),f.bind=f.on,f.unbind=f.off,n.extend(t,f);var d=t.Model=function(e,t){var r=e||{};t||(t={}),this.cid=n.uniqueId("c"),this.attributes={},t.collection&&(this.collection=t.collection),t.parse&&(r=this.parse(r,t)||{}),r=n.defaults({},r,n.result(this,"defaults")),this.set(r,t),this.changed={},this.initialize.apply(this,arguments)};n.extend(d.prototype,f,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(e){return n.clone(this.attributes)},sync:function(){return t.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return n.escape(this.get(e))},has:function(e){return this.get(e)!=null},set:function(e,t,r){var i,s,o,u,a,f,l,c;if(e==null)return this;typeof e=="object"?(s=e,r=t):(s={})[e]=t,r||(r={});if(!this._validate(s,r))return!1;o=r.unset,a=r.silent,u=[],f=this._changing,this._changing=!0,f||(this._previousAttributes=n.clone(this.attributes),this.changed={}),c=this.attributes,l=this._previousAttributes,this.idAttribute in s&&(this.id=s[this.idAttribute]);for(i in s)t=s[i],n.isEqual(c[i],t)||u.push(i),n.isEqual(l[i],t)?delete this.changed[i]:this.changed[i]=t,o?delete c[i]:c[i]=t;if(!a){u.length&&(this._pending=r);for(var h=0,p=u.length;h<p;h++)this.trigger("change:"+u[h],this,c[u[h]],r)}if(f)return this;if(!a)while(this._pending)r=this._pending,this._pending=!1,this.trigger("change",this,r);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,n.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var r in this.attributes)t[r]=void 0;return this.set(t,n.extend({},e,{unset:!0}))},hasChanged:function(e){return e==null?!n.isEmpty(this.changed):n.has(this.changed,e)},changedAttributes:function(e){if(!e)return this.hasChanged()?n.clone(this.changed):!1;var t,r=!1,i=this._changing?this._previousAttributes:this.attributes;for(var s in e){if(n.isEqual(i[s],t=e[s]))continue;(r||(r={}))[s]=t}return r},previous:function(e){return e==null||!this._previousAttributes?null:this._previousAttributes[e]},previousAttributes:function(){return n.clone(this._previousAttributes)},fetch:function(e){e=e?n.clone(e):{},e.parse===void 0&&(e.parse=!0);var t=this,r=e.success;return e.success=function(n){if(!t.set(t.parse(n,e),e))return!1;r&&r(t,n,e),t.trigger("sync",t,n,e)},I(this,e),this.sync("read",this,e)},save:function(e,t,r){var i,s,o,u=this.attributes;e==null||typeof e=="object"?(i=e,r=t):(i={})[e]=t,r=n.extend({validate:!0},r);if(i&&!r.wait){if(!this.set(i,r))return!1}else if(!this._validate(i,r))return!1;i&&r.wait&&(this.attributes=n.extend({},u,i)),r.parse===void 0&&(r.parse=!0);var a=this,f=r.success;return r.success=function(e){a.attributes=u;var t=a.parse(e,r);r.wait&&(t=n.extend(i||{},t));if(n.isObject(t)&&!a.set(t,r))return!1;f&&f(a,e,r),a.trigger("sync",a,e,r)},I(this,r),s=this.isNew()?"create":r.patch?"patch":"update",s==="patch"&&(r.attrs=i),o=this.sync(s,this,r),i&&r.wait&&(this.attributes=u),o},destroy:function(e){e=e?n.clone(e):{};var t=this,r=e.success,i=function(){t.trigger("destroy",t,t.collection,e)};e.success=function(n){(e.wait||t.isNew())&&i(),r&&r(t,n,e),t.isNew()||t.trigger("sync",t,n,e)};if(this.isNew())return e.success(),!1;I(this,e);var s=this.sync("delete",this,e);return e.wait||i(),s},url:function(){var e=n.result(this,"urlRoot")||n.result(this.collection,"url")||F();return this.isNew()?e:e.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(e){return this._validate({},n.extend(e||{},{validate:!0}))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=n.extend({},this.attributes,e);var r=this.validationError=this.validate(e,t)||null;return r?(this.trigger("invalid",this,r,n.extend(t,{validationError:r})),!1):!0}});var v=["keys","values","pairs","invert","pick","omit"];n.each(v,function(e){d.prototype[e]=function(){var t=u.call(arguments);return t.unshift(this.attributes),n[e].apply(n,t)}});var m=t.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),t.comparator!==void 0&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,n.extend({silent:!0},t))},g={add:!0,remove:!0,merge:!0},y={add:!0,remove:!1};n.extend(m.prototype,f,{model:d,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return t.sync.apply(this,arguments)},add:function(e,t){return this.set(e,n.extend({merge:!1},t,y))},remove:function(e,t){var r=!n.isArray(e);e=r?[e]:n.clone(e),t||(t={});var i,s,o,u;for(i=0,s=e.length;i<s;i++){u=e[i]=this.get(e[i]);if(!u)continue;delete this._byId[u.id],delete this._byId[u.cid],o=this.indexOf(u),this.models.splice(o,1),this.length--,t.silent||(t.index=o,u.trigger("remove",u,this,t)),this._removeReference(u,t)}return r?e[0]:e},set:function(e,t){t=n.defaults({},t,g),t.parse&&(e=this.parse(e,t));var r=!n.isArray(e);e=r?e?[e]:[]:n.clone(e);var i,s,o,u,a,f,l,c=t.at,h=this.model,p=this.comparator&&c==null&&t.sort!==!1,v=n.isString(this.comparator)?this.comparator:null,m=[],y=[],b={},w=t.add,E=t.merge,S=t.remove,x=!p&&w&&S?[]:!1;for(i=0,s=e.length;i<s;i++){a=e[i]||{},a instanceof d?o=u=a:o=a[h.prototype.idAttribute||"id"];if(f=this.get(o))S&&(b[f.cid]=!0),E&&(a=a===u?u.attributes:a,t.parse&&(a=f.parse(a,t)),f.set(a,t),p&&!l&&f.hasChanged(v)&&(l=!0)),e[i]=f;else if(w){u=e[i]=this._prepareModel(a,t);if(!u)continue;m.push(u),this._addReference(u,t)}u=f||u,x&&(u.isNew()||!b[u.id])&&x.push(u),b[u.id]=!0}if(S){for(i=0,s=this.length;i<s;++i)b[(u=this.models[i]).cid]||y.push(u);y.length&&this.remove(y,t)}if(m.length||x&&x.length){p&&(l=!0),this.length+=m.length;if(c!=null)for(i=0,s=m.length;i<s;i++)this.models.splice(c+i,0,m[i]);else{x&&(this.models.length=0);var T=x||m;for(i=0,s=T.length;i<s;i++)this.models.push(T[i])}}l&&this.sort({silent:!0});if(!t.silent){for(i=0,s=m.length;i<s;i++)(u=m[i]).trigger("add",u,this,t);(l||x&&x.length)&&this.trigger("sort",this,t)}return r?e[0]:e},reset:function(e,t){t||(t={});for(var r=0,i=this.models.length;r<i;r++)this._removeReference(this.models[r],t);return t.previousModels=this.models,this._reset(),e=this.add(e,n.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),e},push:function(e,t){return this.add(e,n.extend({at:this.length},t))},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return this.add(e,n.extend({at:0},t))},shift:function(e){var t=this.at(0);return this.remove(t,e),t},slice:function(){return u.apply(this.models,arguments)},get:function(e){return e==null?void 0:this._byId[e]||this._byId[e.id]||this._byId[e.cid]},at:function(e){return this.models[e]},where:function(e,t){return n.isEmpty(e)?t?void 0:[]:this[t?"find":"filter"](function(t){for(var n in e)if(e[n]!==t.get(n))return!1;return!0})},findWhere:function(e){return this.where(e,!0)},sort:function(e){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return e||(e={}),n.isString(this.comparator)||this.comparator.length===1?this.models=this.sortBy(this.comparator,this):this.models.sort(n.bind(this.comparator,this)),e.silent||this.trigger("sort",this,e),this},pluck:function(e){return n.invoke(this.models,"get",e)},fetch:function(e){e=e?n.clone(e):{},e.parse===void 0&&(e.parse=!0);var t=e.success,r=this;return e.success=function(n){var i=e.reset?"reset":"set";r[i](n,e),t&&t(r,n,e),r.trigger("sync",r,n,e)},I(this,e),this.sync("read",this,e)},create:function(e,t){t=t?n.clone(t):{};if(!(e=this._prepareModel(e,t)))return!1;t.wait||this.add(e,t);var r=this,i=t.success;return t.success=function(e,n){t.wait&&r.add(e,t),i&&i(e,n,t)},e.save(null,t),e},parse:function(e,t){return e},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(e instanceof d)return e;t=t?n.clone(t):{},t.collection=this;var r=new this.model(e,t);return r.validationError?(this.trigger("invalid",this,r.validationError,t),!1):r},_addReference:function(e,t){this._byId[e.cid]=e,e.id!=null&&(this._byId[e.id]=e),e.collection||(e.collection=this),e.on("all",this._onModelEvent,this)},_removeReference:function(e,t){this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,r){if((e==="add"||e==="remove")&&n!==this)return;e==="destroy"&&this.remove(t,r),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],t.id!=null&&(this._byId[t.id]=t)),this.trigger.apply(this,arguments)}});var b=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain","sample"];n.each(b,function(e){m.prototype[e]=function(){var t=u.call(arguments);return t.unshift(this.models),n[e].apply(n,t)}});var w=["groupBy","countBy","sortBy","indexBy"];n.each(w,function(e){m.prototype[e]=function(t,r){var i=n.isFunction(t)?t:function(e){return e.get(t)};return n[e](this.models,i,r)}});var E=t.View=function(e){this.cid=n.uniqueId("view"),e||(e={}),n.extend(this,n.pick(e,x)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},S=/^(\S+)\s*(.*)$/,x=["model","collection","el","id","attributes","className","tagName","events"];n.extend(E.prototype,f,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(e,n){return this.$el&&this.undelegateEvents(),this.$el=e instanceof t.$?e:t.$(e),this.el=this.$el[0],n!==!1&&this.delegateEvents(),this},delegateEvents:function(e){if(!e&&!(e=n.result(this,"events")))return this;this.undelegateEvents();for(var t in e){var r=e[t];n.isFunction(r)||(r=this[e[t]]);if(!r)continue;var i=t.match(S),s=i[1],o=i[2];r=n.bind(r,this),s+=".delegateEvents"+this.cid,o===""?this.$el.on(s,r):this.$el.on(s,o,r)}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(!this.el){var e=n.extend({},n.result(this,"attributes"));this.id&&(e.id=n.result(this,"id")),this.className&&(e["class"]=n.result(this,"className"));var r=t.$("<"+n.result(this,"tagName")+">").attr(e);this.setElement(r,!1)}else this.setElement(n.result(this,"el"),!1)}}),t.sync=function(e,r,i){var s=N[e];n.defaults(i||(i={}),{emulateHTTP:t.emulateHTTP,emulateJSON:t.emulateJSON});var o={type:s,dataType:"json"};i.url||(o.url=n.result(r,"url")||F()),i.data==null&&r&&(e==="create"||e==="update"||e==="patch")&&(o.contentType="application/json",o.data=JSON.stringify(i.attrs||r.toJSON(i))),i.emulateJSON&&(o.contentType="application/x-www-form-urlencoded",o.data=o.data?{model:o.data}:{});if(i.emulateHTTP&&(s==="PUT"||s==="DELETE"||s==="PATCH")){o.type="POST",i.emulateJSON&&(o.data._method=s);var u=i.beforeSend;i.beforeSend=function(e){e.setRequestHeader("X-HTTP-Method-Override",s);if(u)return u.apply(this,arguments)}}o.type!=="GET"&&!i.emulateJSON&&(o.processData=!1),o.type==="PATCH"&&T&&(o.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var a=i.xhr=t.ajax(n.extend(o,i));return r.trigger("request",r,a,i),a};var T=typeof window!="undefined"&&!!window.ActiveXObject&&(!window.XMLHttpRequest||!(new XMLHttpRequest).dispatchEvent),N={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};t.ajax=function(){return t.$.ajax.apply(t.$,arguments)};var C=t.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},k=/\((.*?)\)/g,L=/(\(\?)?:\w+/g,A=/\*\w+/g,O=/[\-{}\[\]+?.,\\\^$|#\s]/g;n.extend(C.prototype,f,{initialize:function(){},route:function(e,r,i){n.isRegExp(e)||(e=this._routeToRegExp(e)),n.isFunction(r)&&(i=r,r=""),i||(i=this[r]);var s=this;return t.history.route(e,function(n){var o=s._extractParameters(e,n);s.execute(i,o),s.trigger.apply(s,["route:"+r].concat(o)),s.trigger("route",r,o),t.history.trigger("route",s,r,o)}),this},execute:function(e,t){e&&e.apply(this,t)},navigate:function(e,n){return t.history.navigate(e,n),this},_bindRoutes:function(){if(!this.routes)return;this.routes=n.result(this,"routes");var e,t=n.keys(this.routes);while((e=t.pop())!=null)this.route(e,this.routes[e])},_routeToRegExp:function(e){return e=e.replace(O,"\\$&").replace(k,"(?:$1)?").replace(L,function(e,t){return t?e:"([^/?]+)"}).replace(A,"([^?]*?)"),new RegExp("^"+e+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(e,t){var r=e.exec(t).slice(1);return n.map(r,function(e,t){return t===r.length-1?e||null:e?decodeURIComponent(e):null})}});var M=t.History=function(){this.handlers=[],n.bindAll(this,"checkUrl"),typeof window!="undefined"&&(this.location=window.location,this.history=window.history)},_=/^[#\/]|\s+$/g,D=/^\/+|\/+$/g,P=/msie [\w.]+/,H=/\/$/,B=/#.*$/;M.started=!1,n.extend(M.prototype,f,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root},getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getFragment:function(e,t){if(e==null)if(this._hasPushState||!this._wantsHashChange||t){e=decodeURI(this.location.pathname+this.location.search);var n=this.root.replace(H,"");e.indexOf(n)||(e=e.slice(n.length))}else e=this.getHash();return e.replace(_,"")},start:function(e){if(M.started)throw new Error("Backbone.history has already been started");M.started=!0,this.options=n.extend({root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var r=this.getFragment(),i=document.documentMode,s=P.exec(navigator.userAgent.toLowerCase())&&(!i||i<=7);this.root=("/"+this.root+"/").replace(D,"/");if(s&&this._wantsHashChange){var o=t.$('<iframe src="javascript:0" tabindex="-1">');this.iframe=o.hide().appendTo("body")[0].contentWindow,this.navigate(r)}this._hasPushState?t.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!s?t.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=r;var u=this.location;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot())return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+"#"+this.fragment),!0;this._hasPushState&&this.atRoot()&&u.hash&&(this.fragment=this.getHash().replace(_,""),this.history.replaceState({},document.title,this.root+this.fragment))}if(!this.options.silent)return this.loadUrl()},stop:function(){t.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),M.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();t===this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe)));if(t===this.fragment)return!1;this.iframe&&this.navigate(t),this.loadUrl()},loadUrl:function(e){return e=this.fragment=this.getFragment(e),n.any(this.handlers,function(t){if(t.route.test(e))return t.callback(e),!0})},navigate:function(e,t){if(!M.started)return!1;if(!t||t===!0)t={trigger:!!t};var n=this.root+(e=this.getFragment(e||""));e=e.replace(B,"");if(this.fragment===e)return;this.fragment=e,e===""&&n!=="/"&&(n=n.slice(0,-1));if(this._hasPushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,e,t.replace))}if(t.trigger)return this.loadUrl(e)},_updateHash:function(e,t,n){if(n){var r=e.href.replace(/(javascript:|#).*$/,"");e.replace(r+"#"+t)}else e.hash="#"+t}}),t.history=new M;var j=function(e,t){var r=this,i;e&&n.has(e,"constructor")?i=e.constructor:i=function(){return r.apply(this,arguments)},n.extend(i,r,t);var s=function(){this.constructor=i};return s.prototype=r.prototype,i.prototype=new s,e&&n.extend(i.prototype,e),i.__super__=r.prototype,i};d.extend=m.extend=C.extend=E.extend=M.extend=j;var F=function(){throw new Error('A "url" property or function must be specified')},I=function(e,t){var n=t.error;t.error=function(r){n&&n(e,r,t),e.trigger("error",e,r,t)}};return t}),function(e){typeof define=="function"&&define.amd?define("jqueryBrowser",["jquery"],function(t){return e(t)}):typeof module=="object"&&typeof module.exports=="object"?module.exports=e(require("jquery")):e(window.jQuery)}(function(e){"use strict";function t(e){e===undefined&&(e=window.navigator.userAgent),e=e.toLowerCase();var t=/(edge)\/([\w.]+)/.exec(e)||/(opr)[\/]([\w.]+)/.exec(e)||/(chrome)[ \/]([\w.]+)/.exec(e)||/(iemobile)[\/]([\w.]+)/.exec(e)||/(version)(applewebkit)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+).*(version)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("trident")>=0&&/(rv)(?::| )([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[],n=/(ipad)/.exec(e)||/(ipod)/.exec(e)||/(windows phone)/.exec(e)||/(iphone)/.exec(e)||/(kindle)/.exec(e)||/(silk)/.exec(e)||/(android)/.exec(e)||/(win)/.exec(e)||/(mac)/.exec(e)||/(linux)/.exec(e)||/(cros)/.exec(e)||/(playbook)/.exec(e)||/(bb)/.exec(e)||/(blackberry)/.exec(e)||[],r={},i={browser:t[5]||t[3]||t[1]||"",version:t[2]||t[4]||"0",versionNumber:t[4]||t[2]||"0",platform:n[0]||""};i.browser&&(r[i.browser]=!0,r.version=i.version,r.versionNumber=parseInt(i.versionNumber,10)),i.platform&&(r[i.platform]=!0);if(r.android||r.bb||r.blackberry||r.ipad||r.iphone||r.ipod||r.kindle||r.playbook||r.silk||r["windows phone"])r.mobile=!0;if(r.cros||r.mac||r.linux||r.win)r.desktop=!0;if(r.chrome||r.opr||r.safari)r.webkit=!0;if(r.rv||r.iemobile){var s="msie";i.browser=s,r[s]=!0}if(r.edge){delete r.edge;var o="msedge";i.browser=o,r[o]=!0}if(r.safari&&r.blackberry){var u="blackberry";i.browser=u,r[u]=!0}if(r.safari&&r.playbook){var a="playbook";i.browser=a,r[a]=!0}if(r.bb){var f="blackberry";i.browser=f,r[f]=!0}if(r.opr){var l="opera";i.browser=l,r[l]=!0}if(r.safari&&r.android){var c="android";i.browser=c,r[c]=!0}if(r.safari&&r.kindle){var h="kindle";i.browser=h,r[h]=!0}if(r.safari&&r.silk){var p="silk";i.browser=p,r[p]=!0}return r.name=i.browser,r.platform=i.platform,r}return window.jQBrowser=t(window.navigator.userAgent),window.jQBrowser.uaMatch=t,e&&(e.browser=window.jQBrowser),window.jQBrowser}),"use strict",define("localService",[],function(){var e="EPAPER:",t="",n="";return{get:function(n){return localStorage.getItem(e+t+n)},put:function(n,r){localStorage.setItem(e+t+n,r)},destroy:function(n){localStorage.removeItem(e+t+n)},clear:function(){localStorage.clear()},setProductId:function(e){t=e+":"},setOverrideId:function(e){n=e},getOverrides:function(){return JSON.parse(localStorage.getItem(e+n))},setOverrides:function(t){localStorage.setItem(e+n,JSON.stringify(t))},clearOverrides:function(){localStorage.removeItem(e+n)}}}),"use strict",define("sessionService",[],function(){var e="EPAPER:",t="";return{get:function(n){return sessionStorage.getItem(e+t+n)},put:function(n,r){sessionStorage.setItem(e+t+n,r)},destroy:function(n){sessionStorage.removeItem(e+t+n)},clear:function(){sessionStorage.clear()},setProductId:function(e){t=e+":"}}}),"use strict",define("deviceUtility",["backbone","jquery","jqueryBrowser","localService","sessionService"],function(e,t,n,r,i){var s=768,o,u,a,f,l=navigator.userAgent.match(/(iPad|iPhone|iPod)/i)?!0:!1,c=navigator.userAgent.match(/Android/i)?!0:!1,h=n["windows phone"]?!0:!1,p=document.URL.indexOf("http://")===-1&&document.URL.indexOf("https://")===-1&&document.URL.indexOf("localhost")===-1,d=n.mobile?!0:!1,v=n.msie||n.msedge,m;return{tabletWidth:s-249,mobileWidth:s+200,setSmallDevice:function(e){a=e},isiOS:function(){return l},isAndroid:function(){return c},isWindowsPhone:function(){return h},isMSBrowser:function(){return v},getOs:function(){return this.isiOS()?"ios":this.isAndroid()?"android":""},isBadAndroid:function(){return c&&parseFloat(m)<4.4},isEvenMoreBadAndroid:function(){return c&&parseFloat(m)<4.3},getOsVersion:function(){return m},setOsVersion:function(e){m=e},hasTouchSupport:d,isRunningAsHybridApplication:p,isRunningAtMobile:function(){var e=Math.max(window.innerHeight,window.innerWidth),t=a?this.mobileWidth:this.tabletWidth;return u=e<t,u},isSmallDevice:function(){var e=Math.max(window.innerHeight,window.innerWidth);return e<s},forceOrientationToPortrait:function(){f=!0,e.trigger("checkOrientation")},resetOrientation:function(t){f=!1;if(t)return;e.trigger("checkOrientation")},isPortraitForced:function(){return f},isPortrait:function(){return f?f:this.isTruePortrait()},isTruePortrait:function(){return window.innerHeight>t("#application").width()},isExtraWideDevice:function(){var e,t,n=100;return o||(e=window.innerWidth,t=window.innerHeight,e>t?n=t/e*100:n=e/t*100,o=n<66),o},isPdfCompatible:function(){var e=!1,t=i.get("issueType");if(t&&t.indexOf("pdf")===-1)return!1;if(p||!d&&!v)e=!0;return e}}}),"use strict",define("requestService",["jquery"],function(e){return{getJSON:function(t){return e.getJSON(t)},get:function(t,n){return e.get(t,{token:n,xhrFields:{withCredentials:!0}})},ajax:function(t,n,r,i){var s={token:n};return e.ajax({url:t,data:s,processData:!0,cache:!1,crossDomain:!0,xhrFields:{withCredentials:!0},success:function(e){r(e)},error:function(e){i(e)}})},stat:function(t,n,r){return e.ajax({url:t,cache:!1,crossDomain:!0,success:function(e){n(e)},error:function(e){r(e)}})}}}),"use strict",define("apiService",[],function(){var e={defaults:{environment:"stage.",productId:0,productUuid:"",authId:0,tokenPrefix:"",productName:"",authenticationServiceIdentifier:"",rootPath:"{protocol}://{env}im-epaper.se/api/v2",loginURL:"/products/{authId}/auth_url",refreshURL:"/products/{authId}/refresh_token",logoutURL:"/logout",issuesURL:"/products/{productId}/issues",issueURL:"/issues/",sharedLinkURL:"/issues/{issueid}/generatesharelink/",statscriptURL:"/products/{productId}/statscript",latestCoverURL:"/products/{productId}/latest/cover",archiveSearchURL:"{protocol}://search.{env}im-epaper.se/{product_uuid}"},setEnvironment:function(t){if(t.toLowerCase()==="dev")e.defaults.environment="dev.";else if(!t||t.toLowerCase()==="loc")e.defaults.environment="loc.";else if(!t||t.toLowerCase()==="stage")e.defaults.environment="stage.";else if(t.toLowerCase()==="prod"||t.toLowerCase()==="production")e.defaults.environment=""},decideProtocol:function(){var e=window.location.protocol.toLowerCase();return e==="http:"?"http":"https"},setProductId:function(t){e.defaults.productId=t},setAuthId:function(t){e.defaults.authId=t},setProductUuid:function(t){e.defaults.productUuid=t},setTokenPrefix:function(t){e.defaults.tokenPrefix=t},setProductName:function(t){e.defaults.productName=t},setAuthenticationServiceIdentifier:function(t){e.defaults.authenticationServiceIdentifier=t},convertURL:function(t){return t.replace("{productId}",e.defaults.productId).replace("{authId}",e.defaults.authId)},getProductName:function(){return e.defaults.productName},getAuthenticationServiceIdentifier:function(){return e.defaults.authenticationServiceIdentifier},getProductId:function(){return e.defaults.productId},getProductUuid:function(){return e.defaults.productUuid},getRootPath:function(){return e.defaults.rootPath.replace("{protocol}",this.decideProtocol()).replace("{env}",e.defaults.environment)},getLoginURL:function(){return e.getRootPath()+e.convertURL(e.defaults.loginURL)},getRefreshURL:function(){return e.getRootPath()+e.convertURL(e.defaults.refreshURL)},getLogoutUrl:function(){return e.getRootPath()+e.convertURL(e.defaults.logoutURL)},getIssuesURL:function(){return e.getRootPath()+e.convertURL(e.defaults.issuesURL)},getIssueURL:function(){return e.getRootPath()+e.convertURL(e.defaults.issueURL)},getGenerateShareLinkUrl:function(t){return e.getRootPath()+e.convertURL(e.defaults.sharedLinkURL.replace("{issueid}",t))},getTokenPrefix:function(){return e.defaults.tokenPrefix},getStatscriptUrl:function(){return e.getRootPath()+e.convertURL(e.defaults.statscriptURL)},getLatestCoverUrl:function(t){return e.getRootPath()+e.convertURL(e.defaults.latestCoverURL.replace("{productId}",t))},getArchiveSearchURL:function(){return e.defaults.archiveSearchURL.replace("{product_uuid}",e.getProductUuid()).replace("{env}",e.defaults.environment).replace("{protocol}",this.decideProtocol())}};return e}),"use strict",define("cookieService",[],function(){return{getItem:function(e){return decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null},setItem:function(e,t,n,r,i,s){if(!e||/^(?:expires|max\-age|path|domain|secure)$/i.test(e))return!1;var o="";if(n)switch(n.constructor){case Number:o=n===Infinity?"; expires=Fri, 31 Dec 9999 23:59:59 GMT":"; max-age="+n;break;case String:o="; expires="+n;break;case Date:o="; expires="+n.toUTCString()}return document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(t)+o+(i?"; domain="+i:"")+(r?"; path="+r:"")+(s?"; secure":""),!0},removeItem:function(e,t,n){return!e||!this.hasItem(e)?!1:(document.cookie=encodeURIComponent(e)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"+(n?"; domain="+n:"")+(t?"; path="+t:""),!0)},hasItem:function(e){return(new RegExp("(?:^|;\\s*)"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=")).test(document.cookie)},keys:function(){var e=document.cookie.replace(/((?:^|\s*;)[^\=]+)(?=;|$)|^\s*|\s*(?:\=[^;]*)?(?:\1|$)/g,"").split(/\s*(?:\=[^;]*)?;\s*/);for(var t=0;t<e.length;t++)e[t]=decodeURIComponent(e[t]);return e}}}),"use strict",define("appUtility",["cookieService"],function(e){function n(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var n=(e+Math.random()*16)%16|0;return e=Math.floor(e/16),(t=="x"?n:n&7|8).toString(16)})}function r(){var r=e.getItem(t),i,s;return r||(r=n(),i=63072e6,s=new Date((new Date).getTime()+i),e.setItem(t,r,s)),r}var t="gaTrackingId";return{getTrackingUUID:r,generateUUID:n}}),"use strict",define("nativeService",["backbone","underscore","jquery","requestService","apiService","appUtility","deviceUtility"],function(e,t,n,r,i,s,o){var u=0,a,f,l=!1,c,h,p=function(){return typeof f=="boolean"?f:f===1},d=function(){return u++},v=function(e,t,n,r){var i="Epaper",s="callback"+d(),o="callback"+d();r.success=s,r.error=o,window[s]=e,window[o]=t;if(n==="downloadIssueFromURL"){var u="callback"+d();window[u]=r.callback,r.callback=u}window[i]?(console.log(n),window[i][n](JSON.stringify(r))):window.location="infomaker:"+i+":"+n+":"+encodeURIComponent(JSON.stringify(r))},m=function(e,t){v(e,t,"exitApp",{})},g=function(e,t){v(function(r){r?(r=i.getTokenPrefix()+r,n("#application").addClass("authenticated"),e(r)):t()},t,"getAuthenticationToken",{})},y=function(e,t){v(function(t){f=t,e(p())},t,"isDeviceOnline",{})},b=function(e,t){v(function(r){r?(r=i.getTokenPrefix()+r,n("#application").addClass("authenticated"),e(r)):t({message:"user canceled login",status:200})},t,"login",{})},w=function(e,t,n){var i=r.getJSON(e);i.done(t).fail(n)},E=function(e,t){v(function(t){t=JSON.parse(t),e(t)},t,"getDownloadedIssues",{})},S=function(){return a},x=function(e,t){v(function(t){a=t+"/",e(a)},t,"getRootPath",{})},T=function(e,t){E(function(n){if(n.length>0){var r=[],i,s,o=n.split(",");for(var u=0,f=o.length;u<f;u++)s=o[u],i=s.substring(s.indexOf("id-")+3),r.push({issueid:i,fullPath:a+s+"/"});e(r)}else t()},function(){})},N=function(e,t,n){v(t,n,"downloadIssueFromURL",{id:e.issueId,url:e.url+"?action=download&os="+o.getOs(),quality:"hdpi",revision:e.revision,callback:e.callback})},C=function(e,t,n){v(t,n,"deleteIssueWithId",{id:e})},k=function(e,t,n){v(t,n,"updateJSONFile",e)},L=function(e,t,n){v(t,n,"showConfirmationDialog",e)},A=function(e,t){v(function(t){n("#application").addClass("authenticated"),e(t)},function(){e()},"getUserId",{})},O=function(e){v(e,function(){},"getUserDisplayName",{})},M=function(e,t){v(function(){},function(){},"shareContent",{content:t+"\n"+e})},_=function(e,t){v(e,t,"getOSVersion",{})},D=function(){v(function(){n("#application").removeClass("authenticated"),e.trigger("setRoute",{route:"issues",trigger:!0})},function(){},"logout",{})},P=function(e,t){g(e,t)},H=function(e){e(s.getTrackingUUID())},B=function(e,t,n){v(t,n,"toggleMenu",e)},j=function(e,t){v(function(t){typeof t=="string"&&(t=JSON.parse(t)),e(t)},t,"getIssueProgresses",{})},F=function(e,t,n){v(t,n,"getDownloadProgressForIssueWithId",e)},I=function(e,t,n){v(t,n,"showEntitlementAlert",e)},q=function(e,t,n){v(t,n,"openNativePagesView",e)},R=function(e,t,n){v(t,n,"openWebView",e)},U=function(e,t,n){v(t,n,"closeWebView",e)},z=function(e,t){v(t,function(){},"cancelDownloadIssue",{issueId:e})},W=function(){v(function(){},function(){},"backButton",{})},X=function(e){v(function(){},function(){},"handleCustomAction",e)},V=function(e){v(function(){},function(){},"openExternalURL",e)},$=function(e){v(e,function(){},"getUserProducts",{})},J=function(e){h?v(function(t){t&&(c=!0,t=parseInt(t,10),t=h.find(function(e){return e.id===t})),e({config:t?t.config:{},strings:t?t.strings:{}})},function(){},"getProductId",{}):e({})},K=function(e,t){v(t,function(){},"setProductId",{productId:e.id})},Q=function(e){v(e,function(){},"setProductId",{productId:""})},G=function(){window.epaperClient=window.epaperClient||{},window.epaperClient.connectionStatus=function(n){if(f!==n||t.isUndefined(f))f=n,e.trigger("connectionchange",p())},window.epaperClient.userFinishedAuthentication=function(t){t===1?(n("#application").addClass("authenticated"),A(function(t){e.trigger("stat:userlogin",{userId:t})})):(n("#application").removeClass("authenticated"),e.trigger("stat:userlogout")),e.trigger("userFinishedAuthentication",t)},window.epaperClient.didEnterForeground=function(){e.trigger("didEnterForeground",p())},window.epaperClient.goToArticle=function(t){var n="reader";if(!t)return;typeof t=="string"&&(t=JSON.parse(t)),n+="/"+t.issueId,t.partId&&t.partId!=="null"&&(n+="/"+t.partId),t.articleId&&t.articleId!=="null"&&(n+="/"+t.articleId),e.trigger("updateCurrentIssueModel",t),e.trigger("setRoute",{route:n,trigger:!0})},window.epaperClient.goToIssueEntry=function(t){if(!t)return;typeof t=="string"&&(t=JSON.parse(t)),e.trigger("setRoute",{route:"entry/"+t.issueId,trigger:!0})},window.epaperClient.goToCovers=function(){e.trigger("closeOpenFullscreen"),e.trigger("setRoute",{route:"issues",trigger:!0})},window.epaperClient.openNativePagesView=function(t){var n="pages/"+t.issueId;t.partId&&t.partId!=="null"&&(n+="/"+t.partId),e.trigger("setRoute",{route:n,trigger:!0})},window.epaperClient.reportNativePagesPageViews=function(t){t.forEach(function(t){if(!t.eventType)return;switch(t.eventType){case"pageView":e.trigger("stat:pageView",t.eventData);break;case"eventLayer":e.trigger("stat:articleEventLayerTapped",{articleId:t.eventData.articleId});break;case"readDownload":case"pushDownload":case"userDownload":e.trigger("stat:downloadStarted",t.eventData);break;case"downloadCompleted":e.trigger("stat:downloadCompleted",t.eventData)}})},window.epaperClient.nativeBackButtonPressed=function(){if(l){e.trigger("backButton");return}W()},window.epaperClient.scrollToTop=function(){e.trigger("scrollTo","top")},e.on("willHandleBackButton",function(e){l=e},this),e.on("toggleNativeMenuEvent",function(e){B(e,function(){},function(){})},this),e.on("handleCustomAction",function(e){X(e)},this),e.on("openExternalURL",function(e){V(e)},this),e.on("updateStateForNative",function(e){v(e.success,e.error,"setState",e.state)},this)};return{exitApp:m,getAuthenticationToken:g,login:b,openWebView:R,closeWebView:U,getJSON:w,getDownloadedIssues:E,getApplicationRootPath:S,setApplicationRootPath:x,getSubDirectories:T,downloadIssue:N,deleteIssueById:C,updateJSONFile:k,setConnectionStatus:y,online:p,showConfirmationDialog:L,getUserId:A,getUserDisplayName:O,shareContent:M,isLoggedIn:P,getOsVersion:_,logout:D,getTrackingUUID:H,getIssueProgresses:j,getDownloadProgressForIssueWithId:F,showEntitlementAlert:I,openNativePagesView:q,cancelDownloadIssue:z,handleCustomAction:X,openExternalURL:V,getUserProducts:$,init:G,getOverrides:J,setOverrides:K,selection:function(){return c},clearOverrides:Q,setSelections:function(e){h=e},getSelections:function(){return h}}}),"use strict",define("nativeAuthService",["nativeService"],function(e){var t=function(){return console.log("NAS! Not implemented!"),"Not Implemented!"};return{authenticate:function(t,n){e.getAuthenticationToken(t,function(){e.login(t,n)})},cleanlogin:t,cleanLogout:t,loginError:t,isErrorRoute:t,getLoginErrorMessage:function(){},unsetLoginErrorMessage:t,removeAttempt:t,getRequestedRoute:function(){return!1},getReturnRoute:function(){return!1},login:e.login,logout:e.logout,isLoggedIn:e.isLoggedIn,getAuthenticationToken:e.getAuthenticationToken,getUsername:t,getUserDisplayName:function(t){e.getUserDisplayName(function(e){t(e)})},getUserId:e.getUserId,getUserProducts:function(t){e.getUserProducts(t)},setAuthStrings:t}}),"use strict",define("webService",["backbone","localService","sessionService","apiService","requestService","appUtility"],function(e,t,n,r,i,s){var o,u,a,f,l=function(){var e=window.location.hash.indexOf("#error")!==-1;return e&&n.clear(),e},c=function(e,t){var n=t?t.substr(t.indexOf("?")+1):window.location.search.substring(1),r=n.split("&"),i=null,s;for(var o=0,u=r.length;o<u;o++){s=r[o].split("=");if(s[0]===e){i=s[1];break}}return i},h=function(){return u},p=function(e,t){u=navigator.onLine,e(h())},d=function(){return o},v=function(e,t){o="/",e(o)},m=function(){return!l()&&window.location.hash?window.location.hash.split("#")[1]:""},g=function(e){e(s.getTrackingUUID())},y=function(e,t){e([])},b=function(e,t,n){t({id:e.id,progress:69})},w=function(e){switch(e.requestedAction){case"openExternalURL":E(e)}},E=function(e){console.log("openExternalURL",e);switch(e.requestedTarget){case"self":window.location.assign(e.requestedURL);break;case"new":window.open(e.requestedURL,"_blank");break;default:window.open(e.requestedURL,"_blank")}},S=function(t,n,r){e.trigger("popup:open",{openContent:function(n){e.trigger("message:open",{messageConfig:t,context:n})},closeContent:function(){e.trigger("message:close")}})},x=function(){e.on("handleCustomAction",function(e){w(e)},this),e.on("openExternalURL",function(e){E(e)},this)},T=function(){};return{exitApp:function(){},authURL:r.getLoginURL,refreshURL:r.getRefreshURL,logoutURL:r.getLogoutUrl,getGenerateShareLinkUrl:r.getGenerateShareLinkUrl,getUrlQuery:c,isErrorRoute:l,getApplicationRootPath:d,setApplicationRootPath:v,setConnectionStatus:p,online:h,showConfirmationDialog:S,getRequestedRoute:m,getDownloadedIssues:function(){return[]},getDownloadedIssue:function(){return[]},getOsVersion:function(e,t){e("0")},getTrackingUUID:g,getIssueProgresses:y,getDownloadProgressForIssueWithId:b,handleCustomAction:w,openExternalURL:E,init:x,shareContent:T,getOverrides:function(e){var n=t.getOverrides();n&&(a=!0,n=parseInt(n.id,10),n=f.find(function(e){return e.id===n})),e({config:n?n.config:{},strings:n?n.strings:{}})},setOverrides:function(e,n){t.setOverrides({id:e.id}),n()},selection:function(){return a},clearOverrides:function(e){t.clearOverrides(),e()},setSelections:function(e){f=e},getSelections:function(){return f}}}),define("webAuthService",["backbone","jquery","requestService","sessionService","webService","deviceUtility","apiService"],function(e,t,n,r,i,s,o){"use strict";var u="attempt",a="loginError",f="token",l="successbang",c="userId",h="name",p="username",d="products",v="token_expires",m=0,g={genericAuthenticationErrorMessage:"Failed authentication. Please try again"},y=function(){r.put(u,"true")},b=function(){return r.get(u)},w=function(){r.destroy(u)},E=function(){return r.get(c)},S=function(e){i.isErrorRoute()||r.put(l,e+"|"+(new Date).getTime())},x=function(){var e=r.get(l),t=e?e.split("|")[0]:null,n=e?parseInt(e.split("|")[1]):null,s=(new Date).getTime(),o=3e5;return r.destroy(l),!i.isErrorRoute()&&t&&s-n<o?t:!1},T=function(){if(!i.isErrorRoute()){var e=r.get(f),t=parseInt(r.get(v))||0,n=(new Date).getTime();return r.get("previewMode")?o.getTokenPrefix()+"token":e?n<t?e.split("|")[0]:null:!1}},N=function(e){i.isErrorRoute()||r.put(f,e+"|"+(new Date).getTime())},C=function(e){r.put(v,e*1e3)},k=function(e){var t=window.location.origin+window.location.pathname+window.location.hash,n=window.location.hash.split("#")[1];e?t=window.location.origin+window.location.pathname:S(n),window.location.assign(t)},L=function(e,n){var o="web",u=s.getOs(),a=i.refreshURL()+"?client="+encodeURIComponent(o)+"&token="+r.get(f).split("|")[0]+"&os="+u;t.ajax({url:a,xhrFields:{withCredentials:!0},success:function(i){i.status===200?(N(i.token),C(i.expires),t("#application").addClass("authenticated"),e(i.token)):(r.clear(),n())},error:n})},A=function(t){var n=i.getUrlQuery("token",t);return w(),n?(N(n),C(i.getUrlQuery("expires",t)),r.put(c,i.getUrlQuery("id",t)),r.put(h,i.getUrlQuery("name",t)),r.put(p,i.getUrlQuery("username",t)),r.put(d,i.getUrlQuery("products",t)),e.trigger("userlogin",{userId:E()}),e.trigger("stat:userlogin",{userId:E()}),k(),n):!1},O=function(){var e=decodeURIComponent(i.getUrlQuery("message")).replace(/\+/g," ");e&&r.put(a,e),w(),k(!0)},M=function(){return r.get(a)},_=function(){r.destroy(a)},D=function(){r.destroy(f)},P=function(e,t){var r="web",o=s.getOs(),u=window.location.origin+window.location.pathname+window.location.hash,a=window.location.origin+window.location.pathname+"#loginerror",f=i.authURL()+"?return_url="+encodeURIComponent(u)+"&error_url="+encodeURIComponent(a)+"&client="+encodeURIComponent(r)+"&os="+o;T()?e(T()):b()?A()||t(g.genericAuthenticationErrorMessage):n.getJSON(f).success(function(e){e.authorize_url&&(y(),window.location.assign(e.authorize_url))}).error(function(e,t){console.log("Login fail")})},H=function(){r.clear(),e.trigger("userlogout"),e.trigger("stat:userlogout"),t("#application").removeClass("authenticated"),window.location.assign(window.location.origin+window.location.pathname)},B=function(){var e=T()||o.getAuthenticationServiceIdentifier(),t="web",n=window.location.origin+window.location.pathname+"#cleanlogout",r=window.location.origin+window.location.pathname+"#loginerror",s=i.logoutURL()+"?return_url="+encodeURIComponent(n)+"&error_url="+encodeURIComponent(r)+"&token="+e+"&client="+encodeURIComponent(t);S("cleanlogout"),window.location.assign(s)},j=function(){return i.getRequestedRoute()},F=function(){return r.get(p)},I=function(e){e(r.get(h))},q=function(e){S(e)},R=function(e,n){var r=T();r?(t("#application").addClass("authenticated"),e(r)):r===null?L(e,n):(t("#application").removeClass("authenticated"),n())},U=function(e){var t=r.get(d)||[];typeof t=="string"&&(t.length>0?(t=decodeURIComponent(t),t=t.split(",")):t=[]),e(t)},z=function(e){e&&(g=e)};return{cleanlogin:A,cleanLogout:H,loginError:O,getLoginErrorMessage:M,unsetLoginErrorMessage:_,removeAttempt:w,getRequestedRoute:j,getReturnRoute:x,getAuthenticationToken:R,getUsername:F,getUserDisplayName:I,setActiveRoute:q,login:P,logout:B,isLoggedIn:function(e,n){var r=T();r===""&&(r=!1),r?(t("#application").addClass("authenticated"),e(r)):n()},clearState:function(){t("#application").removeClass("authenticated"),r.clear()},getUserId:function(e,n){var i=r.get(c);i&&t("#application").addClass("authenticated"),e(i)},getUserProducts:U,authenticate:function(e,t){R(e,function(){P(e,t)})},setAuthStrings:z}}),"use strict",define("authService",["deviceUtility","nativeAuthService","webAuthService"],function(e,t,n){return e.isRunningAsHybridApplication?t:n}),"use strict",define("stateService",["localService","underscore","jquery"],function(e,t,n){var r=function(t){var r=JSON.parse(e.get("state")||"{}");t=n.extend({},r,t),e.put("state",JSON.stringify(t))},i=function(){return JSON.parse(e.get("state")||"{}")},s=function(n){var r=JSON.parse(e.get("state")||"{}");t.isArray(n)||(n=n?[n]:[]);for(var i in r)t.contains(n,i)&&delete r[i];e.put("state",JSON.stringify(r))};return{setState:r,getState:i,removeState:s}}),"use strict",define("router",["backbone","deviceUtility","authService","stateService"],function(e,t,n,r){return e.Router.extend({routes:{start:function(){e.trigger("setRoute",{route:this.configuredStartRoute,trigger:!0})},error:function(){},loginerror:function(){n.loginError()},logout:n.logout,cleanlogin:n.cleanlogin,cleanlogout:n.cleanLogout},initialize:function(t){e.on("setRoute",this.setRoute,this)},setRoute:function(t){var i=n.getLoginErrorMessage();i==="null"&&(i=null);var s=e.history.fragment===t.route,o=t.trigger||!1;t.route&&(e.trigger("routeTriggered",t.route),this.navigate(t.route,{trigger:o,replace:s}),s&&o&&e.history.loadUrl(e.history.getFragment()),r.setState({route:t.route})),i&&e.trigger("AuthenticationError",{messageBody:i})}})}),"use strict",define("dataService",["deviceUtility","nativeService","webService"],function(e,t,n){return e.isRunningAsHybridApplication?t:n}),"use strict",define("baseModel",["backbone","dataService","deviceUtility"],function(e,t,n){var r=e.sync;return e.Model.extend({sync:function(e,t,i){return i=i||{},i.crossDomain||(i.crossDomain=!0),n.isRunningAsHybridApplication?i.excludeHeaders||(i.headers={Authorization:i.token}):i.xhrFields={withCredentials:!0},r(e,t,i)}})}),"use strict",define("issueModel",["baseModel","apiService","dataService"],function(e,t,n){return e.extend({initialize:function(){this.urlRoot=t.getIssueURL()},defaults:{downloaded:!1,downloading:!1,allowShare:!1},urlRoot:t.getIssueURL(),parse:function(e){var t=n.getApplicationRootPath();return e.status?e:(e.allowShare=e.allowShare?parseInt(e.allowShare):!1,e.api_paths={files_basepath:e.cloudfront+e.publicpath+e.pubdate+"/",thumbnails_basepath:e.cloudfront+e.publicpath+e.pubdate+"/"+"thumbnails/"},e.downloaded?(e.files_basepath=t+e.pubdate+"-id-"+e.issueid+"/",e.thumbnails_basepath=t+e.pubdate+"-id-"+e.issueid+"/",e.api_paths.files_basepath+=e.secretpath):(e.files_basepath=e.cloudfront+e.publicpath+e.pubdate+"/",e.thumbnails_basepath=e.files_basepath+"thumbnails/",e.secretpath&&(e.files_basepath+=e.secretpath,e.api_paths.files_basepath+=e.secretpath)),e)},getArticleIdByActivePageIndex:function(){var e=this.get("parts").get(this.get("activePartId")),t,n,r,i=0;return e&&(n=e.get("pages").at(this.get("activePageIndex")-1),n&&(r=n.get("articleAreas"),r&&r.forEach(function(e){e.hasOwnProperty("area")&&e.area>i&&(i=e.area,t=e.hasOwnProperty("articleId")?e.articleId:!1)}))),t},setRoute:function(e){return this}})}),"use strict",define("baseCollection",["backbone","deviceUtility"],function(e,t){var n=e.sync;return e.Collection.extend({sync:function(e,r,i){i=i||{},i.data=i.data||{},i.data.env||(i.data.env=window.location.host||"app");if(!t.isRunningAsHybridApplication){i.xhrFields={withCredentials:!0};if(!i.data.br){var s=window.navigator.userAgent.toLowerCase();i.data.br=s.indexOf("edge")!==-1?"edge":s.indexOf("chrome")!==-1?"chr":s.indexOf("firefox")!==-1?"fir":s.indexOf("safari")!==-1?"saf":"ukn"}}return t.isPdfCompatible()&&(i.data.pdf="true"),i.data.epaperversion||(i.data.epaperversion=window.epaperClient.version),i.data.os||(i.data.os=t.getOs()),i.data.osversion||(i.data.osversion=t.getOsVersion()),i.crossDomain||(i.crossDomain=!0),n(e,r,i)}})}),"use strict",define("issueCollection",["underscore","baseCollection","issueModel","apiService"],function(e,t,n,r){var i,s;return t.extend({model:n,url:r.getIssuesURL,getNextURL:function(){return i},getPreviousURL:function(){return s},comparator:function(e){return-(new Date(e.get("pubdate"))).getTime()},parse:function(t){var n=this,r=t.results,o=[];return e.each(r,function(e){var t=n.findWhere({issueid:e.issueid});if(!t||e.revision!==t.get("revision"))n.remove(t),o.push(e)}),t.results=o,i=t.next,s=t.previous,t.results}})}),"use strict",define("sectionModel",["baseModel"],function(e){return e.extend({activate:function(){return this},active:function(){return this},inactivate:function(){return this},inactive:function(){return this}})}),"use strict",define("sectionCollection",["baseCollection","sectionModel"],function(e,t){return e.extend({model:t})}),"use strict",define("articleModel",["baseModel"],function(e){return e.extend({defaults:{id:null,author:"",html:"",height:null,width:null,images:[],title:"",page_id:null,xpos:null,ypos:null,section:"",displayImages:!1},injectAd:function(e){this.set("ad",e)},removeAd:function(){this.unset("ad",{silent:!0})},activate:function(){return this},active:function(){return this},inactivate:function(){return this},inactive:function(){return this}})}),"use strict",define("advertModel",["baseModel"],function(e){return e.extend({defaults:{articleType:"advert",section:"advert"}})}),"use strict",define("articleCollection",["baseCollection","articleModel","advertModel"],function(e,t,n){return e.extend({model:function(e,r){return e.files?new n(e,r):new t(e,r)}})}),"use strict",define("pageModel",["baseModel"],function(e){return e.extend({})}),"use strict",define("pageCollection",["baseCollection","pageModel"],function(e,t){return e.extend({model:t})}),"use strict",define("partModel",["backbone"],function(e){return e.Model.extend({})}),"use strict",define("partCollection",["baseCollection","partModel"],function(e,t){return e.extend({model:t,addParts:function(e){for(var n=0,r=e.length;n<r;n++)this.add(new t(e[n]))}})}),"use strict",define("advertUtility",["deviceUtility"],function(e){var t="advertiesment:",n=function(t){if(e.isRunningAsHybridApplication)window.location="adverts:"+t;else{var n=window.open(t,"_blank");n.focus()}},r=function(e){var t=document.createElement("img");return t.classList.add("ad"),e.get("urlClickToShow")&&(t.title=e.get("urlClickToShow"),t.onclick=function(){n(e.get("urlClickToShow"))}),t},i=function(e){var t=document.createElement("iframe");return t.classList.add("ad"),t.setAttribute("seamless","seamless"),t.setAttribute("frameborder","0"),t.setAttribute("allowtransparency","true"),t.setAttribute("scrolling","no"),t},s=function(e){var t=document.createElement("div");return t.classList.add("adInputTarget"),e.get("urlClickToShow")&&(t.onclick=function(){n(e.get("urlClickToShow"))}),t},o=function(){var e=document.createElement("span");return e.classList.add("adHelper"),e},u=function(){var e=document.createElement("div");return e.classList.add("adContainer"),e},a=function(){var e=document.createElement("div");return e.innerText=t,e.classList.add("adLeadin"),e},f=function(e){var t=document.createElement("div");return t.classList.add("adWrapper"),t.classList.add(e.get("adType")),t},l=function(e){var t=f(e),n=u();return n.appendChild(s(e)),n.appendChild(i(e)),t.appendChild(n),t},c=function(e){var t=f(e),n=u();return n.appendChild(o()),n.appendChild(r(e)),t.appendChild(a()),t.appendChild(n),t},h=function(e,t){e.injectAd(t)},p=function(e,t){var n,r,i=3;for(n=i-1;n<e.length;n+=i){r=t.shift();if(!r)return e;r.get("adType").toLowerCase()==="full"?e.add(r,{at:n}):h(e.at(n),r)}return e.add(t.models),e},d=function(e){t=e};return{generateIframeAdvertElement:l,generateImageAdvertElement:c,injectAdsToSection:p,setAdPointer:d}}),"use strict",define("errorService",["backbone","dataService","deviceUtility"],function(e,t,n){var r=function(r){n.isRunningAsHybridApplication?r.err.message==="user canceled login"?r.callback():t.showEntitlementAlert(r.err,r.callback,function(){}):typeof r.err=="string"?(e.trigger("removeLoader"),e.trigger("AuthenticationError",{messageBody:r.err,exitCallback:r.callback})):typeof r.err.message=="string"?(e.trigger("removeLoader"),e.trigger("AuthenticationError",{messageBody:r.err.message,exitCallback:r.callback})):r.callback()};return{oops:r}}),define("issueService",["backbone","jquery","stateService","issueModel","issueCollection","sectionCollection","articleCollection","pageCollection","partCollection","advertUtility","dataService","authService","deviceUtility","requestService","apiService","sessionService","errorService"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";var g="fetchIssueAmount",y=25,b=y,w=new i,E,S,x=function(e){return b=e,b<1&&(b=y),v.put(g,b),b},T=function(){var e=S.get("activePartId"),t=S.get("parts"),n;return e?n=t.get(e):n=t.at(0),n},N=function(e){return e.get("parts").models||e.set("parts",new a(e.get("parts"))),e},C=function(e){var t,n,r,i;return e.get("parts").models||e.set("parts",new a(e.get("parts"))),e.get("parts").each(function(e){t=new s(e.get("sections")),r=new u(e.get("pages")),t.each(function(e){i=new o(e.get("ads")),n=new o(e.get("articles"),{parse:!0}),f.injectAdsToSection(n,i),n.each(function(e){e.get("articles")&&e.set("articles",new o(e.get("articles")))}),e.set("articles",n)}),e.set({sections:t,pages:r})}),e},k=function(e,t,n,i){var s={env:window.location.host||"app"};h.isRunningAsHybridApplication||(s.token=t),i=i||new r({id:e}),i.fetch({token:t,data:s,xhrFields:{withCredentials:!0},crossDomain:!0,processData:!0,emulateHTTP:!0,success:function(e){if(e.get("status")){n.reject(e);return}e=N(e),w.add(e),n.resolve(e)},error:function(e,t,r){n.reject(e,t,r)}})},L=function(t,n,r){var i={env:window.location.host||"app"};if(!h.isRunningAsHybridApplication&&!i.br){var s=window.navigator.userAgent.toLowerCase();i.br=s.indexOf("edge")!==-1?"edge":s.indexOf("chrome")!==-1?"chr":s.indexOf("firefox")!==-1?"fir":s.indexOf("safari")!==-1?"saf":"ukn"}t.url=t.get("files_basepath")+"_issue.json",t.fetch({data:i,silent:!0,success:function(t){S=C(t),w.add(S),e.trigger("stat:issueFetched",t),r.resolve(S)},error:function(){r.reject()}})},A=function(e){if(!l.online()){e.resolve(w);return}w.fetch({merge:!1,remove:!1,data:{results:b},success:function(t){t.each(function(e){e.get("downloaded")||N(e)}),e.resolve(t)},error:function(t,n,r){e.reject("failed to fetch issues")}})};return w.fetchNextIssues=function(){var e=t.Deferred(),n=w.getNextURL();return n?(x(b+y),A(e)):setTimeout(function(){e.reject(w)},10),e},w.fetchPreviousIssues=function(){var e=t.Deferred(),n=w.getPreviousURL();return n?(x(b-y),A(e)):setTimeout(function(){e.reject(w)},10),e},{getIssueModelFromCollectionById:function(e){return w?w.get(e):!1},getCurrentIssueModel:function(){return S},getCurrentIssueId:function(){return S.get("id")},getRealCurrentIssueId:function(){return S.get("issueid")},getIssueExtension:function(){return S.get("extension")},getCurrentPartId:function(){return T().get("id")},getCurrentIssueFilesBasePath:function(){return S.get("files_basepath")},getCurrentIssueThumbnailBasePath:function(){return S?S.get("thumbnails_basepath"):!1},getSectionsFromCurrentIssue:function(){var e,t,n;return S?(e=new s,t=S.get("parts"),t.each(function(t){n=t.get("sections"),n&&e.add(n.models)}),e):!1},getPagesFromCurrentIssuePart:function(){var e,t,n;return S?(t=T(),t.get("pages")):!1},getArticlesFromCurrentIssue:function(){var e=new o,t,n;return S&&(t=S.get("parts"),t.each(function(t){n=t.get("sections"),n&&n.each(function(t){e.add(t.get("articles").models)})})),e},getNumberOfCurrentIssueArticles:function(){return this.getArticlesFromCurrentIssue().length},setResultsRange:function(e){y=v.get(g)||e,x(parseInt(y,10))},setCurrentIssueModel:function(e){e?(S=e,E=S):E&&(S=E),n.setState({issueId:S.get("issueid")})},fetchIssues:function(){var e=t.Deferred();return A(e),e},fetchDownloadedIssues:function(){var e=t.Deferred(),n=0,i;return w.reset([]),h.isRunningAsHybridApplication?(l.getDownloadedIssues(function(t){i=t.length;if(i===0)return e.resolve(w),e;t.forEach(function(t){p.getJSON(t.path).success(function(t){n++,t.downloaded=!0;var s=new r(t,{parse:!0});s.url=s.get("api_paths").files_basepath+"_issue.json",w.add(C(s)),n===i&&e.resolve(w)}).error(function(){console.log("Error loading issue from device",t,arguments),n++,n===i&&e.resolve(w)})})}),e):(e.resolve(w),e)},fetchIssueById:function(n){var r,i=t.Deferred(),s=t.Deferred(),o=function(t){m.oops({err:t,callback:function(){e.trigger("setRoute",{route:"start",trigger:!0})}})};return n?(r=w.get(n),r?r.has("secretpath")?(S=r,S.get("downloaded")===!0?i.resolve(S):c.authenticate(function(e){i.resolve(S)},function(e){o(e)})):c.authenticate(function(e){k(n,e,s,r),s.done(function(t){L(t,e,i)})},function(e){o(e)}):c.authenticate(function(e){k(n,e,s),s.done(function(t){L(t,e,i)})},function(e){o(e)}),s.fail(function(e){o({status:e.get("status"),message:e.get("message")||e.get("msg")})}),i):(window.setTimeout(function(){i.reject("Failed due to that no ID was passed in")},10),i)},fetchIssuePreview:function(e,n){var i=t.Deferred(),s=t.Deferred(),o=new r({id:e.issueId});o.url=d.getIssueURL()+e.issueId+"/revision/"+e.revision,k(null,"token",i,o),i.done(function(e){L(e,"token",s),s.done(function(e){n(e)})}),i.fail(function(e,t,n){})},letsDance:function(e,t){var n=this,r,i,s;i=n.fetchDownloadedIssues(),i.done(function(i){s=i,r=n.fetchIssues(),r.done(function(r){s.add(r.models);if(!h.isRunningAsHybridApplication){e(s);return}n.checkCollectionForDownloadProgresses(s,function(t){e(t)},t)}),r.fail(function(){e(i)})})},checkCollectionForDownloadProgresses:function(e,t,n){var r=this,i=0;l.getIssueProgresses(function(n){n.forEach(function(t){var n,s=e.findWhere({issueid:t.id}),o=parseInt(t.progress,10);s&&o<100&&(n=i+=1,window.setTimeout(function(){r.doTheSpin(s,o)},n*1e3))}),t(e)},n)},doTheSpin:function(t,n){var r,i=l.getApplicationRootPath(),s=t.get("pubdate");t.set({downloading:!0,progress:n}),l.getDownloadProgressForIssueWithId({id:t.get("issueid")},function(n,o){r=Math.floor(o);if(!_.isNaN(r)){t.set("progress",r);if(r<100)return;t.set({files_basepath:i+s+"-id-"+n+"/",thumbnails_basepath:i+s+"-id-"+n+"/"}),t.set({downloaded:!0,downloading:!1}),e.trigger("stat:downloadIssue",{issueId:n,issueDate:s,issueRevision:t.get("revision")})}},function(e){})}}}),"use strict",define("viewUtility",["jquery"],function(e){var t=function(e,t){return t?t:e.context},n=function(e){e.triggerHook&&e.triggerHook.call(e,"beforeRender")},r=function(e){e.triggerHook&&e.triggerHook.call(e,"afterRender")},i=function(){this.triggerHook&&this.triggerHook("beforeClose"),this.unbindEvents(),this.remove(),this.unbind(),this.$el&&delete this.$el,this.el&&delete this.el,this.model&&this.model.off(),this.activeViews&&this.activeViews.forEach(function(e){e&&e.close.call(e)},this),this.activeViews=[],this.triggerHook&&this.triggerHook("afterClose");if(!this.hasOwnProperty("router")&&this.hooks)for(var e in this.hooks)this.hooks.hasOwnProperty(e)&&delete this.hooks[e]},s=function(i,s){n(i),e(t(i,s)).html(i.render().el),r(i)},o=function(i,s){n(i),e(t(i,s)).append(i.render().el),r(i)},u=function(i,s){n(i),e(t(i,s)).prepend(i.render().el),r(i)},a=function(e,t,n){var r;this.activeViews||(this.activeViews=[]),this.activeViews.push(e),t&&(n==="html"?r=s:r=o,r(e,t))};return{addView:a,appendView:o,prependView:u,setView:s,close:i}}),"use strict",define("app",["backbone","viewUtility","deviceUtility","stateService"],function(e,t,n,r){var i,s={},o=function(e,t){return this.initView.call(this,e,t)},u=function(t){t.primary&&(i=!1),e.trigger(t.name+":beforeClose"),t.close.call(t)},a=function(){for(var e in s)s.hasOwnProperty(e)&&u(s[e]);s={}},f=function(e){i&&(a(),u(i)),r.setState({componentName:e.name}),i=e},l=function(e){s.hasOwnProperty(e.name)||(s[e.name]=e)},c=function(){i&&(a(),i.triggerHistoryRoute.call(i))},h=function(i,s,u){var a=function(){var e=o.call(i,i.view,s);t.prependView(e,e.context),u(e)};if(i.primary){f(i);if(n.isRunningAsHybridApplication){e.trigger("updateStateForNative",{state:r.getState(),success:a,error:a});return}}else l(i);a()};return window.epaperClient=window.epaperClient||{},window.epaperClient.backButton=c,{renderComponentView:h,closeComponent:u}}),"use strict",define("historyUtility",["backbone","issueService"],function(e,t){var n=null;return e.on("setHistoryModel",function(e){n=e}),{triggerHistoryRoute:function(r){if(n){n.callback();return}if(r.hasOwnProperty("route")){var i=r.route;if(r.route.indexOf("{issueId}")>-1){var s=t.getCurrentIssueModel();s&&(i=r.route.replace("{issueId}",s.get("id")))}e.trigger("setRoute",{route:i,trigger:!0})}}}}),"use strict",define("baseComponent",["viewUtility","historyUtility","jquery"],function(e,t,n){return{setId:function(e){return this.id=e,this},setComponentName:function(e){return this.componentName=e,this},setPrimary:function(e){return this.primary=e,this},setContext:function(e){return this.context=e,this},setStrings:function(e){return this.strings=e,this},setRouter:function(e){return this.router=e,this},setHistory:function(e){return this.history=e||{},this},setSelection:function(e){return this.selection=e,this},addRoutes:function(){if(this.hasOwnProperty("routes"))for(var e in this.routes)this.router.route(e,this.routes[e]);return this},addViewOptions:function(e){return this.viewOptions=e,this},addFeature:function(e){return this.features[e.name]||this.features.push(e),this},triggerHistoryRoute:function(){t.triggerHistoryRoute(this.history)},renderFeatures:function(){return this.features.forEach(function(e){e.render.call(e).triggerDone.call(e)},this),this},removeFeatures:function(){this.features.forEach(function(e){e.close.call(e)},this)},initView:function(t,r){return this.viewOptions=this.viewOptions||{},this.viewOptions.componentName=this.componentName,r=n.extend({context:this.context,strings:this.strings,viewOptions:this.viewOptions},r),t=new t(r),e.addView.call(this,t),t},hasActiveView:function(){return this.activeViews&&this.activeViews[0]?this.activeViews[0]:!1},ready:function(e){e&&e()},close:function(){e.close.call(this),this.removeFeatures()},open:function(){},reInit:function(){},remove:function(){},unbind:function(){},unbindEvents:function(){}}}),"use strict",define("stringUtility",["underscore"],function(e){var t=function(e,t){var n=t.convertFrom||e,r=t.convertTo||e;return e.toLowerCase()===n.toLowerCase()?r:e},n=function(e,n){n=n||[];for(var r in n)e=t(e,n[r]);return e};return{convertStringList:n,convertString:t,replace:function(e,t){var n;for(var r in t)t.hasOwnProperty(r)&&(n=new RegExp("%%"+r+"%%","gi"),e=e.replace(n,t[r]));return e},truncate:function(e,t,n){return e=typeof e=="string"?e.trim():"",n=n||"...",e.length>t?e.slice(0,t)+n:e}}}),"use strict",define("dateUtility",[],function(){var e={weekdays:{untruncated:["sndag","mndag","tisdag","onsdag","torsdag","fredag","lrdag"],truncated:["mn"]},months:{untruncated:["januari","februari","mars","april","maj","juni","juli","augusti","september","oktober","november","december"],truncated:["jan"]}},t=function(e){return e<10&&(e="0"+e),e};return{setDateStrings:function(t){e=t},parseDate:function(e,t){t=t||"yyyy-mm-dd";var n=e.match(/(\d+)/g),r=0,i={};return t.replace(/(yyyy|dd|mm)/g,function(e){i[e]=r++}),new Date(n[i.yyyy],n[i.mm]-1,n[i.dd])},dateToStringFormat:function(t,n){var r,i;n=typeof n=="string"?n:"",t?i=this.parseDate(t):i=new Date;var s=i.getDate(),o=i.getDay(),u=i.getMonth(),a=i.getFullYear(),f=e.months.untruncated,l=e.weekdays.untruncated,c=f[u],h=l[o];return r=n.replace(/%%weekday%%/gi,h).replace(/%%date%%/gi,s).replace(/%%month%%/gi,c).replace(/%%year%%/gi,a),r},getDateString:function(e){return e||(e=new Date),e.getFullYear()+"-"+t(e.getMonth()+1)+"-"+t(e.getDate())}}}),"use strict",define("baseView",["backbone","jquery","underscore","deviceUtility","viewUtility","stringUtility","dateUtility","localService"],function(e,t,n,r,i,s,o,u){var a,f="body",l=window.orientation,c="#application",h="#application-content",p=".application-page",d="#app-loader-container",v="#loader-msg",m="portrait",g="landscape",y="hidden",b=r.isAndroid(),w=function(){t(d).addClass("hidden"),t(v).empty()},E=function(){var e=r.isTruePortrait()?m:g,t=e===m?g:m;S(e,t)},S=function(e,n){t(f).addClass(e).removeClass(n)},x=function(e){w(),e||(e=""),t(d).removeClass("hidden"),t(v).text(e)},T=function(){t(f).addClass("resizing"),E(),!r.hasTouchSupport&&!r.isRunningAsHybridApplication?e.trigger("orientationchange"):e.trigger("resizeInstant"),window.orientation!==l&&(l=window.orientation,window.setTimeout(function(){e.trigger("orientationchange")},b?500:0)),clearTimeout(a),a=window.setTimeout(function(){t(f).removeClass("resizing")},500)};return function(){var e=0,t=["ms","moz","webkit","o"];for(var n=0;n<t.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t,n){var r=(new Date).getTime(),i=Math.max(0,16-(r-e)),s=window.setTimeout(function(){t(r+i)},i);return e=r+i,s}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})}(),e.on("displayLoader",x),e.on("removeLoader",w),e.on("toggleOrientation",E,this),e.on("checkOrientation",T,this),E(),window.addEventListener?(window.addEventListener("orientationchange",T,!1),window.addEventListener("resize",T,!1)):window.attachEvent&&(window.attachEvent("orientationchange",T),window.attachEvent("resize",T)),e.View.extend({init:function(e){this.context=e.context,this.viewOptions=e.viewOptions,this.strings=e.strings,this.generateTemplateModel()},viewHelpers:{StringUtility:s,DateUtility:o},generateTemplateModel:function(){this.model=this.model||new e.Model,this.templateModel=t.extend(!0,{},this.viewHelpers,{strings:this.strings,viewOptions:this.viewOptions},this.model.toJSON())},getViewId:function(){return this.cid},unbindEvents:function(){},addHook:function(e,t){this.hooks||(this.hooks={}),this.hooks[e]=t},triggerHook:function(e){this.hooks&&this.hooks.hasOwnProperty(e)&&this.hooks[e].call(this)},addView:function(e,t,n){i.addView.call(this,e,t,n)},appendView:function(e,t){i.appendView.call(this,e,t)},setView:function(e,t){i.appendView.call(this,e,t)},close:function(){i.close.call(this)},componentDone:function(){},getHiddenClass:function(){return y},replaceForeignCharacters:function(e){return e.replace(/ /g,"-").replace(/[]/g,"a").replace(//g,"o").toLowerCase()},numberIsEven:function(e){return parseInt(e,10)%2===0},setApplicationClass:function(e){t(c).addClass(e)},applicationHasClass:function(e){return t(c).hasClass(e)},removeApplicationClass:function(e){t(c).removeClass(e)},setRouteClass:function(e){return t(c).removeAttr("class").addClass(e),this},getRouteClass:function(){return t(c).attr("class")},hasRouteClass:function(e){return t(c).hasClass(e)},appendToApplication:function(){for(var e=0,n=arguments.length;e<n;e++)t(c).append(arguments[e]);return this},prependToApplication:function(){for(var e=0,n=arguments.length;e<n;e++)t(c).prepend(arguments[e]);return this},appendViewToElement:function(e,n){t(e).append(n)},setApplicationContentHTML:function(e){return t(h).html(e),this},scrollTouchFix:function(e){return e||(e=t(p)),e.css("-webkit-overflow-scrolling","touch"),this},removeScrollTouchFix:function(e){return e||(e=t(p)),e.css("-webkit-overflow-scrolling",""),this},resetScrollTouchFix:function(e){this.removeScrollTouchFix(e).scrollTouchFix(e)},getApplicationHeight:function(){return t(h).height()},getApplicationWidth:function(){return t(h).width()},showApplication:function(e){return this.toggleElementVisibility(t(c),e),this},toggleElementVisibility:function(e,n){return n?t(e).removeClass(y):t(e).addClass(y),this}})}),define("vendor/text",["module"],function(e){"use strict";var t,n,r,i,s=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],o=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,u=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,a=typeof location!="undefined"&&location.href,f=a&&location.protocol&&location.protocol.replace(/\:/,""),l=a&&location.hostname,c=a&&(location.port||undefined),h={},p=e.config&&e.config()||{};t={version:"2.0.7",strip:function(e){if(e){e=e.replace(o,"");var t=e.match(u);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:p.createXhr||function(){var e,t,n;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;if(typeof ActiveXObject!="undefined")for(t=0;t<3;t+=1){n=s[t];try{e=new ActiveXObject(n)}catch(r){}if(e){s=[n];break}}return e},parseName:function(e){var t,n,r,i=!1,s=e.indexOf("."),o=e.indexOf("./")===0||e.indexOf("../")===0;return s!==-1&&(!o||s>1)?(t=e.substring(0,s),n=e.substring(s+1,e.length)):t=e,r=n||t,s=r.indexOf("!"),s!==-1&&(i=r.substring(s+1)==="strip",r=r.substring(0,s),n?n=r:t=r),{moduleName:t,ext:n,strip:i}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,n,r,i){var s,o,u,a=t.xdRegExp.exec(e);return a?(s=a[2],o=a[3],o=o.split(":"),u=o[1],o=o[0],(!s||s===n)&&(!o||o.toLowerCase()===r.toLowerCase())&&(!u&&!o||u===i)):!0},finishLoad:function(e,n,r,i){r=n?t.strip(r):r,p.isBuild&&(h[e]=r),i(r)},load:function(e,n,r,i){if(i.isBuild&&!i.inlineText){r();return}p.isBuild=i.isBuild;var s=t.parseName(e),o=s.moduleName+(s.ext?"."+s.ext:""),u=n.toUrl(o),h=p.useXhr||t.useXhr;!a||h(u,f,l,c)?t.get(u,function(n){t.finishLoad(e,s.strip,n,r)},function(e){r.error&&r.error(e)}):n([o],function(e){t.finishLoad(s.moduleName+"."+s.ext,s.strip,e,r)})},write:function(e,n,r,i){if(h.hasOwnProperty(n)){var s=t.jsEscape(h[n]);r.asModule(e+"!"+n,"define(function () { return '"+s+"';});\n")}},writeFile:function(e,n,r,i,s){var o=t.parseName(n),u=o.ext?"."+o.ext:"",a=o.moduleName+u,f=r.toUrl(o.moduleName+u)+".js";t.load(a,r,function(n){var r=function(e){return i(f,e)};r.asModule=function(e,t){return i.asModule(e,f,t)},t.write(e,a,r,s)},s)}};if(p.env==="node"||!p.env&&typeof process!="undefined"&&process.versions&&!!process.versions.node)n=require.nodeRequire("fs"),t.get=function(e,t,r){try{var i=n.readFileSync(e,"utf8");i.indexOf("")===0&&(i=i.substring(1)),t(i)}catch(s){r(s)}};else if(p.env==="xhr"||!p.env&&t.createXhr())t.get=function(e,n,r,i){var s=t.createXhr(),o;s.open("GET",e,!0);if(i)for(o in i)i.hasOwnProperty(o)&&s.setRequestHeader(o.toLowerCase(),i[o]);p.onXhr&&p.onXhr(s,e),s.onreadystatechange=function(t){var i,o;s.readyState===4&&(i=s.status,i>399&&i<600?(o=new Error(e+" HTTP status: "+i),o.xhr=s,r(o)):n(s.responseText),p.onXhrComplete&&p.onXhrComplete(s,e))},s.send(null)};else if(p.env==="rhino"||!p.env&&typeof Packages!="undefined"&&typeof java!="undefined")t.get=function(e,t){var n,r,i="utf-8",s=new java.io.File(e),o=java.lang.System.getProperty("line.separator"),u=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(s),i)),a="";try{n=new java.lang.StringBuffer,r=u.readLine(),r&&r.length()&&r.charAt(0)===65279&&(r=r.substring(1)),r!==null&&n.append(r);while((r=u.readLine())!==null)n.append(o),n.append(r);a=String(n.toString())}finally{u.close()}t(a)};else if(p.env==="xpconnect"||!p.env&&typeof Components!="undefined"&&Components.classes&&Components.interfaces)r=Components.classes,i=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),t.get=function(e,t){var n,s,o={},u=new FileUtils.File(e);try{n=r["@mozilla.org/network/file-input-stream;1"].createInstance(i.nsIFileInputStream),n.init(u,1,0,!1),s=r["@mozilla.org/intl/converter-input-stream;1"].createInstance(i.nsIConverterInputStream),s.init(n,"utf-8",n.available(),i.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),s.readString(n.available(),o),s.close(),n.close(),t(o.value)}catch(a){throw new Error((u&&u.path||"")+": "+a)}};return t}),define("vendor/text!components/authMessage/templates/authMessageTemplate.html",[],function(){return'<div class="">\n    <div class="">\n        <!--<h1 class="message-heading"><%= headline %></h1>-->\n        <p class="message-body"><%= messageBody %></p>\n        <!--<hr class="message-border"></hr>-->\n        <button class="message-button">ok</button>\n    </div>\n</div>\n'}),"use strict",define("authMessageView",["backbone","jquery","baseView","authService","webAuthService","deviceUtility","vendor/text!components/authMessage/templates/authMessageTemplate.html"],function(e,t,n,r,i,s,o){return n.extend({className:"authmessage-component",events:{tap:"tap"},initialize:function(e){this.init.call(this,e),this.skipRemoteLogout=this.viewOptions&&this.viewOptions.keepRemoteSessionOnFailedAuthorization?this.viewOptions.keepRemoteSessionOnFailedAuthorization:!1,this.authMessageHtml=_.template(o),this.strings=e.strings,this.headline=e.strings.headline,this.messageBody=e.messageBody,this.addHook.call(this,"beforeClose",function(){this.cleanUp()}),this.bindEvents()},tap:function(){this.cleanLogout()},cleanLogout:function(){this.cleanUp(),s.isiOS()&&e.trigger("popup:close"),this.skipRemoteLogout?r.cleanLogout():r.logout()},bindEvents:function(){this.unbindEvents(),e.on("closingPopup",this.cleanLogout,this)},unbindEvents:function(){e.off("closingPopup",this.cleanLogout,this)},cleanUp:function(){r.unsetLoginErrorMessage()},render:function(){return this.$el.html(this.authMessageHtml({headline:this.headline,messageBody:this.messageBody})),this.catchAnchorTag(this.$(".message-body")),this},closeContent:function(){this.cleanUp()},catchAnchorTag:function(e){var t=this;e.find("a").bind("click",function(e){return s.isiOS()?(e.preventDefault(),t.cleanLogout(),!1):!0})}})}),"use strict",define("authMessageComponent",["backbone","app","underscore","baseComponent","authMessageView"],function(e,t,n,r,i){var s=n.extend({},r);return s.name="authMessage",s.features=[],s.routes={},s.view=i,s.open=function(e){e=e||{},t.renderComponentView(s,e,function(t){s.ready(e.componentReady)})},s.popup=function(t){e.trigger("popup:open",{openContent:function(n){e.trigger("authMessage:open",{context:n,messageBody:t.messageBody})},closeContent:function(){e.trigger("authMessage:close"),"exitCallback"in t&&t.exitCallback()}})},s.beforeClose=function(){},s.closeComponent=function(){t.closeComponent(s)},e.on(s.name+":open",s.open,s),e.on(s.name+":beforeClose",s.beforeClose,s),e.on(s.name+":close",s.closeComponent,s),e.on("AuthenticationError",s.popup,s),s}),define("vendor/text!components/popup/templates/popup.html",[],function(){return'<div id="popup">\n    <div class="popup-dialog">\n        <div class="popup-content">\n            <div class="popup-header">\n                <% if (viewOptions.closeButton.iconName) { %>\n                <span class="close-popup"><i class="<%= viewOptions.closeButton.iconName %>"></i></span>\n                <% } %>\n            </div>\n            <div class="popup-body">\n            </div>\n            <div class="popup-footer"></div>\n        </div>\n    </div>\n</div>'}),"use strict",define("popupView",["jquery","baseView","deviceUtility","vendor/text!components/popup/templates/popup.html"],function(e,t,n,r){return t.extend({className:"popup-wrapper popup-backdrop",events:{"tap .close-popup":"closePopup",tap:"tryClosePopup"},initialize:function(e){this.init.call(this,e),this.popupTemplate=_.template(r),this.openContent=e.openContent,this.closeContent=e.closeContent,this.addHook.call(this,"afterRender",function(){this.openContent(".popup-body"),this.setApplicationClass("has-popup")}),this.addHook.call(this,"beforeClose",function(){this.closeContent(),this.removeApplicationClass("has-popup")}),this.keydownListener=this.keydownListener.bind(this),this.bindEvents()},bindEvents:function(){this.unbindEvents(),window.addEventListener("keydown",this.keydownListener,!0)},unbindEvents:function(){window.removeEventListener("keydown",this.keydownListener,!0)},keydownListener:function(e){e.keyCode===27&&this.closePopup()},render:function(){return this.$el.html(this.popupTemplate(this.templateModel)),this.popup=this.$(".popup-dialog"),this},closePopup:function(){this.trigger("closePopup")},tryClosePopup:function(t){var n=e(t.target);return(n.is("#popup")||n.is(".popup-dialog"))&&this.closePopup(),!1}})}),"use strict",define("popupComponent",["backbone","app","underscore","baseComponent","popupView"],function(e,t,n,r,i){var s=n.extend({},r);return s.name="popup",s.view=i,s.features=[],s.open=function(n){n=n||{},t.renderComponentView(s,n,function(t){s.renderFeatures(),s.ready(n.componentReady),t.on("closePopup",function(){e.trigger("closingPopup"),s.closeComponent()})})},s.beforeClose=function(){},s.closeComponent=function(){t.closeComponent(s)},e.on(s.name+":open",s.open,s),e.on(s.name+":beforeClose",s.beforeClose,s),e.on(s.name+":close",s.closeComponent,s),s}),define("vendor/text!components/header/templates/placeholders.html",[],function(){return'<div class="header-top">\n    <div class="header-top-center"></div>\n    <div class="header-top-left"></div>\n    <div class="header-top-right"></div>\n</div>\n\n<div class="header-bottom">\n    <div class="header-bottom-center"></div>\n    <div class="header-bottom-left"></div>\n    <div class="header-bottom-right"></div>\n</div>\n'}),"use strict",define("headerView",["backbone","underscore","baseView","vendor/text!components/header/templates/placeholders.html"],function(e,t,n,r){return n.extend({id:"header",toggleClass:"move-down",className:"update-on-android header-bar",togglePartVisible:!0,initialize:function(e){this.init(e),this.placeholders=t.template(r),e.hasOwnProperty("viewOptions")&&(this.animate=e.viewOptions.animate,this.togglePartVisible=e.viewOptions.visiblePart),this.addHooks().toggleBottom().bindEvents()},addHooks:function(){return this.addHook.call(this,"beforeRender",function(){this.setApplicationClass("has-header "+this.viewOptions.applicationClassName)}),this.addHook.call(this,"beforeClose",function(){this.removeApplicationClass("has-header "+this.viewOptions.applicationClassName),delete this.placeholders,this.toggle()}),this},bindEvents:function(){return this.unbindEvents(),e.on("header:toggle",this.toggle,this),e.on("header:openPart",this.openBottomPart,this),e.on("header:closePart",this.closeBottomPart,this),this},unbindEvents:function(){return e.off("header:toggle",this.toggle,this),e.off("header:openPart",this.openBottomPart,this),e.off("header:closePart",this.closeBottomPart,this),this},toggle:function(){return this.animate&&this.$el.addClass("animate"),this.toggleBottom(),this},render:function(){return this.$el.addClass(this.viewOptions.viewClassName),this.$el.append(this.placeholders),this},openBottomPart:function(){e.trigger("overlayElementOpen","header"),this.$el.addClass(this.toggleClass),this.togglePartVisible=!1},closeBottomPart:function(){e.trigger("overlayElementClose","header"),this.$el.removeClass(this.toggleClass),this.togglePartVisible=!0},toggleBottom:function(){return this.togglePartVisible?this.openBottomPart():this.closeBottomPart(),this}})}),"use strict",define("headerComponent",["backbone","app","underscore","baseComponent","headerView"],function(e,t,n,r,i){var s=n.extend({},r);return s.features=[],s.name="header",s.view=i,s.open=function(e){e=e||{},t.renderComponentView(s,e,function(t){s.renderFeatures(),s.ready(e.componentReady)})},s.beforeClose=function(){},s.closeComponent=function(){t.closeComponent(s)},e.on(s.name+":open",s.open,s),e.on(s.name+":beforeClose",s.beforeClose,s),e.on(s.name+":close",s.closeComponent,s),s}),function(e,t){"use strict";function n(){if(!r.READY){r.event.determineEventTypes();for(var e in r.gestures)r.gestures.hasOwnProperty(e)&&r.detection.register(r.gestures[e]);r.event.onTouch(r.DOCUMENT,r.EVENT_MOVE,r.detection.detect),r.event.onTouch(r.DOCUMENT,r.EVENT_END,r.detection.detect),r.READY=!0}}var r=function(e,t){return new r.Instance(e,t||{})};r.defaults={stop_browser_behavior:{userSelect:"none",touchAction:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},r.HAS_POINTEREVENTS=navigator.pointerEnabled||navigator.msPointerEnabled,r.HAS_TOUCHEVENTS="ontouchstart"in e,r.MOBILE_REGEX=/mobile|tablet|ip(ad|hone|od)|android/i,r.NO_MOUSEEVENTS=r.HAS_TOUCHEVENTS&&navigator.userAgent.match(r.MOBILE_REGEX),r.EVENT_TYPES={},r.DIRECTION_DOWN="down",r.DIRECTION_LEFT="left",r.DIRECTION_UP="up",r.DIRECTION_RIGHT="right",r.POINTER_MOUSE="mouse",r.POINTER_TOUCH="touch",r.POINTER_PEN="pen",r.EVENT_START="start",r.EVENT_MOVE="move",r.EVENT_END="end",r.DOCUMENT=document,r.plugins={},r.READY=!1,r.Instance=function(e,t){var i=this;return n(),this.element=e,this.enabled=!0,this.options=r.utils.extend(r.utils.extend({},r.defaults),t||{}),this.options.stop_browser_behavior&&r.utils.stopDefaultBrowserBehavior(this.element,this.options.stop_browser_behavior),r.event.onTouch(e,r.EVENT_START,function(e){i.enabled&&r.detection.startDetect(i,e)}),this},r.Instance.prototype={on:function(e,t){for(var n=e.split(" "),r=0;n.length>r;r++)this.element.addEventListener(n[r],t,!1);return this},off:function(e,t){for(var n=e.split(" "),r=0;n.length>r;r++)this.element.removeEventListener(n[r],t,!1);return this},trigger:function(e,t){var n=r.DOCUMENT.createEvent("Event");n.initEvent(e,!0,!0),n.gesture=t;var i=this.element;return r.utils.hasParent(t.target,i)&&(i=t.target),i.dispatchEvent(n),this},enable:function(e){return this.enabled=e,this}};var i=null,s=!1,o=!1;r.event={bindDom:function(e,t,n){for(var r=t.split(" "),i=0;r.length>i;i++)e.addEventListener(r[i],n,!1)},onTouch:function(e,t,n){var u=this;this.bindDom(e,r.EVENT_TYPES[t],function(f){var l=f.type.toLowerCase();if(!l.match(/mouse/)||!o){l.match(/touch/)||l.match(/pointerdown/)||l.match(/mouse/)&&1===f.which?s=!0:l.match(/mouse/)&&1!==f.which&&(s=!1),l.match(/touch|pointer/)&&(o=!0);var c=0;s&&(r.HAS_POINTEREVENTS&&t!=r.EVENT_END?c=r.PointerEvent.updatePointer(t,f):l.match(/touch/)?c=f.touches.length:o||(c=l.match(/up/)?0:1),c>0&&t==r.EVENT_END?t=r.EVENT_MOVE:c||(t=r.EVENT_END),c||null===i?i=f:f=i,n.call(r.detection,u.collectEventData(e,t,f)),r.HAS_POINTEREVENTS&&t==r.EVENT_END&&(c=r.PointerEvent.updatePointer(t,f))),c||(i=null,s=!1,o=!1,r.PointerEvent.reset())}})},determineEventTypes:function(){var e;e=r.HAS_POINTEREVENTS?r.PointerEvent.getEvents():r.NO_MOUSEEVENTS?["touchstart","touchmove","touchend touchcancel"]:["touchstart mousedown","touchmove mousemove","touchend touchcancel mouseup"],r.EVENT_TYPES[r.EVENT_START]=e[0],r.EVENT_TYPES[r.EVENT_MOVE]=e[1],r.EVENT_TYPES[r.EVENT_END]=e[2]},getTouchList:function(e){return r.HAS_POINTEREVENTS?r.PointerEvent.getTouchList():e.touches?e.touches:[{identifier:1,pageX:e.pageX,pageY:e.pageY,target:e.target}]},collectEventData:function(e,t,n){var i=this.getTouchList(n,t),s=r.POINTER_TOUCH;return(n.type.match(/mouse/)||r.PointerEvent.matchType(r.POINTER_MOUSE,n))&&(s=r.POINTER_MOUSE),{center:r.utils.getCenter(i),timeStamp:(new Date).getTime(),target:n.target,touches:i,eventType:t,pointerType:s,srcEvent:n,preventDefault:function(){this.srcEvent.preventManipulation&&this.srcEvent.preventManipulation(),this.srcEvent.preventDefault&&this.srcEvent.preventDefault()},stopPropagation:function(){this.srcEvent.stopPropagation()},stopDetect:function(){return r.detection.stopDetect()}}}},r.PointerEvent={pointers:{},getTouchList:function(){var e=this,t=[];return Object.keys(e.pointers).sort().forEach(function(n){t.push(e.pointers[n])}),t},updatePointer:function(e,t){return e==r.EVENT_END?this.pointers={}:(t.identifier=t.pointerId,this.pointers[t.pointerId]=t),Object.keys(this.pointers).length},matchType:function(e,t){if(!t.pointerType)return!1;var n={};return n[r.POINTER_MOUSE]=t.pointerType==t.MSPOINTER_TYPE_MOUSE||t.pointerType==r.POINTER_MOUSE,n[r.POINTER_TOUCH]=t.pointerType==t.MSPOINTER_TYPE_TOUCH||t.pointerType==r.POINTER_TOUCH,n[r.POINTER_PEN]=t.pointerType==t.MSPOINTER_TYPE_PEN||t.pointerType==r.POINTER_PEN,n[e]},getEvents:function(){return["pointerdown MSPointerDown","pointermove MSPointerMove","pointerup pointercancel MSPointerUp MSPointerCancel"]},reset:function(){this.pointers={}}},r.utils={extend:function(e,n,r){for(var i in n)e[i]!==t&&r||(e[i]=n[i]);return e},hasParent:function(e,t){for(;e;){if(e==t)return!0;e=e.parentNode}return!1},getCenter:function(e){for(var t=[],n=[],r=0,i=e.length;i>r;r++)t.push(e[r].pageX),n.push(e[r].pageY);return{pageX:(Math.min.apply(Math,t)+Math.max.apply(Math,t))/2,pageY:(Math.min.apply(Math,n)+Math.max.apply(Math,n))/2}},getVelocity:function(e,t,n){return{x:Math.abs(t/e)||0,y:Math.abs(n/e)||0}},getAngle:function(e,t){var n=t.pageY-e.pageY,r=t.pageX-e.pageX;return 180*Math.atan2(n,r)/Math.PI},getDirection:function(e,t){var n=Math.abs(e.pageX-t.pageX),i=Math.abs(e.pageY-t.pageY);return n>=i?e.pageX-t.pageX>0?r.DIRECTION_LEFT:r.DIRECTION_RIGHT:e.pageY-t.pageY>0?r.DIRECTION_UP:r.DIRECTION_DOWN},getDistance:function(e,t){var n=t.pageX-e.pageX,r=t.pageY-e.pageY;return Math.sqrt(n*n+r*r)},getScale:function(e,t){return e.length>=2&&t.length>=2?this.getDistance(t[0],t[1])/this.getDistance(e[0],e[1]):1},getRotation:function(e,t){return e.length>=2&&t.length>=2?this.getAngle(t[1],t[0])-this.getAngle(e[1],e[0]):0},isVertical:function(e){return e==r.DIRECTION_UP||e==r.DIRECTION_DOWN},stopDefaultBrowserBehavior:function(e,t){var n,r=["webkit","khtml","moz","ms","o",""];if(t&&e.style){for(var i=0;r.length>i;i++)for(var s in t)t.hasOwnProperty(s)&&(n=s,r[i]&&(n=r[i]+n.substring(0,1).toUpperCase()+n.substring(1)),e.style[n]=t[s]);"none"==t.userSelect&&(e.onselectstart=function(){return!1})}}},r.detection={gestures:[],current:null,previous:null,stopped:!1,startDetect:function(e,t){this.current||(this.stopped=!1,this.current={inst:e,startEvent:r.utils.extend({},t),lastEvent:!1,name:""},this.detect(t))},detect:function(e){if(this.current&&!this.stopped){e=this.extendEventData(e);for(var t=this.current.inst.options,n=0,i=this.gestures.length;i>n;n++){var s=this.gestures[n];if(!this.stopped&&t[s.name]!==!1&&s.handler.call(s,e,this.current.inst)===!1){this.stopDetect();break}}return this.current&&(this.current.lastEvent=e),e.eventType==r.EVENT_END&&!e.touches.length-1&&this.stopDetect(),e}},stopDetect:function(){this.previous=r.utils.extend({},this.current),this.current=null,this.stopped=!0},extendEventData:function(e){var t=this.current.startEvent;if(t&&(e.touches.length!=t.touches.length||e.touches===t.touches)){t.touches=[];for(var n=0,i=e.touches.length;i>n;n++)t.touches.push(r.utils.extend({},e.touches[n]))}var s=e.timeStamp-t.timeStamp,o=e.center.pageX-t.center.pageX,u=e.center.pageY-t.center.pageY,a=r.utils.getVelocity(s,o,u);return r.utils.extend(e,{deltaTime:s,deltaX:o,deltaY:u,velocityX:a.x,velocityY:a.y,distance:r.utils.getDistance(t.center,e.center),angle:r.utils.getAngle(t.center,e.center),direction:r.utils.getDirection(t.center,e.center),scale:r.utils.getScale(t.touches,e.touches),rotation:r.utils.getRotation(t.touches,e.touches),startEvent:t}),e},register:function(e){var n=e.defaults||{};return n[e.name]===t&&(n[e.name]=!0),r.utils.extend(r.defaults,n,!0),e.index=e.index||1e3,this.gestures.push(e),this.gestures.sort(function(e,t){return e.index<t.index?-1:e.index>t.index?1:0}),this.gestures}},r.gestures=r.gestures||{},r.gestures.Hold={name:"hold",index:10,defaults:{hold_timeout:500,hold_threshold:1},timer:null,handler:function(e,t){switch(e.eventType){case r.EVENT_START:clearTimeout(this.timer),r.detection.current.name=this.name,this.timer=setTimeout(function(){"hold"==r.detection.current.name&&t.trigger("hold",e)},t.options.hold_timeout);break;case r.EVENT_MOVE:e.distance>t.options.hold_threshold&&clearTimeout(this.timer);break;case r.EVENT_END:clearTimeout(this.timer)}}},r.gestures.Tap={name:"tap",index:100,defaults:{tap_max_touchtime:250,tap_max_distance:10,tap_always:!0,doubletap_distance:20,doubletap_interval:300},handler:function(e,t){if(e.eventType==r.EVENT_END){var n=r.detection.previous,i=!1;if(e.deltaTime>t.options.tap_max_touchtime||e.distance>t.options.tap_max_distance)return;n&&"tap"==n.name&&e.timeStamp-n.lastEvent.timeStamp<t.options.doubletap_interval&&e.distance<t.options.doubletap_distance&&(t.trigger("doubletap",e),i=!0),(!i||t.options.tap_always)&&(r.detection.current.name="tap",t.trigger(r.detection.current.name,e))}}},r.gestures.Swipe={name:"swipe",index:40,defaults:{swipe_max_touches:1,swipe_velocity:.7},handler:function(e,t){if(e.eventType==r.EVENT_END){if(t.options.swipe_max_touches>0&&e.touches.length>t.options.swipe_max_touches)return;(e.velocityX>t.options.swipe_velocity||e.velocityY>t.options.swipe_velocity)&&(t.trigger(this.name,e),t.trigger(this.name+e.direction,e))}}},r.gestures.Drag={name:"drag",index:50,defaults:{drag_min_distance:10,drag_max_touches:1,drag_block_horizontal:!1,drag_block_vertical:!1,drag_lock_to_axis:!1,drag_lock_min_distance:25},triggered:!1,handler:function(e,n){if(r.detection.current.name!=this.name&&this.triggered)return n.trigger(this.name+"end",e),this.triggered=!1,t;if(!(n.options.drag_max_touches>0&&e.touches.length>n.options.drag_max_touches))switch(e.eventType){case r.EVENT_START:this.triggered=!1;break;case r.EVENT_MOVE:if(e.distance<n.options.drag_min_distance&&r.detection.current.name!=this.name)return;r.detection.current.name=this.name,(r.detection.current.lastEvent.drag_locked_to_axis||n.options.drag_lock_to_axis&&n.options.drag_lock_min_distance<=e.distance)&&(e.drag_locked_to_axis=!0);var i=r.detection.current.lastEvent.direction;e.drag_locked_to_axis&&i!==e.direction&&(e.direction=r.utils.isVertical(i)?0>e.deltaY?r.DIRECTION_UP:r.DIRECTION_DOWN:0>e.deltaX?r.DIRECTION_LEFT:r.DIRECTION_RIGHT),this.triggered||(n.trigger(this.name+"start",e),this.triggered=!0),n.trigger(this.name,e),n.trigger(this.name+e.direction,e),(n.options.drag_block_vertical&&r.utils.isVertical(e.direction)||n.options.drag_block_horizontal&&!r.utils.isVertical(e.direction))&&e.preventDefault();break;case r.EVENT_END:this.triggered&&n.trigger(this.name+"end",e),this.triggered=!1}}},r.gestures.Transform={name:"transform",index:45,defaults:{transform_min_scale:.01,transform_min_rotation:1,transform_always_block:!1},triggered:!1,handler:function(e,n){if(r.detection.current.name!=this.name&&this.triggered)return n.trigger(this.name+"end",e),this.triggered=!1,t;if(!(2>e.touches.length))switch(n.options.transform_always_block&&e.preventDefault(),e.eventType){case r.EVENT_START:this.triggered=!1;break;case r.EVENT_MOVE:var i=Math.abs(1-e.scale),s=Math.abs(e.rotation);if(n.options.transform_min_scale>i&&n.options.transform_min_rotation>s)return;r.detection.current.name=this.name,this.triggered||(n.trigger(this.name+"start",e),this.triggered=!0),n.trigger(this.name,e),s>n.options.transform_min_rotation&&n.trigger("rotate",e),i>n.options.transform_min_scale&&(n.trigger("pinch",e),n.trigger("pinch"+(1>e.scale?"in":"out"),e));break;case r.EVENT_END:this.triggered&&n.trigger(this.name+"end",e),this.triggered=!1}}},r.gestures.Touch={name:"touch",index:-1/0,defaults:{prevent_default:!1,prevent_mouseevents:!1},handler:function(e,n){return n.options.prevent_mouseevents&&e.pointerType==r.POINTER_MOUSE?(e.stopDetect(),t):(n.options.prevent_default&&e.preventDefault(),e.eventType==r.EVENT_START&&n.trigger(this.name,e),t)}},r.gestures.Release={name:"release",index:1/0,handler:function(e,t){e.eventType==r.EVENT_END&&t.trigger(this.name,e)}},"object"==typeof module&&"object"==typeof module.exports?module.exports=r:(e.Hammer=r,"function"==typeof e.define&&e.define.amd&&e.define("hammer",[],function(){return r}))}(this),function(e,t){"use strict";e!==t&&(Hammer.event.bindDom=function(n,r,i){e(n).on(r,function(e){var n=e.originalEvent||e;n.pageX===t&&(n.pageX=e.pageX,n.pageY=e.pageY),n.target||(n.target=e.target),n.which===t&&(n.which=n.button),n.preventDefault||(n.preventDefault=e.preventDefault),n.stopPropagation||(n.stopPropagation=e.stopPropagation),i.call(this,n)})},Hammer.Instance.prototype.on=function(t,n){return e(this.element).on(t,n)},Hammer.Instance.prototype.off=function(t,n){return e(this.element).off(t,n)},Hammer.Instance.prototype.trigger=function(t,n){var r=e(this.element);return r.has(n.target).length&&(r=e(n.target)),r.trigger({type:t,gesture:n})},e.fn.hammer=function(t){return this.each(function(){var n=e(this),r=n.data("hammer");r?r&&t&&Hammer.utils.extend(r.options,t):n.data("hammer",new Hammer(this,t||{}))})})}(window.jQuery||window.Zepto),function(e){function n(){var t=arguments[0],n=arguments[1];this._delegateGuids=[],this._fn=function(r){n.trigger(e.Event(t,r))},this._delegateFn=function(n){var r=e.Event(t,n);e(r.originalEvent.target).trigger(r)}}var t=["hold","tap","doubletap","transformstart","transform","transformend","dragstart","drag","dragend","swipe","release"];n.prototype={addDelegate:function(e){return this._delegateGuids.push(e),this},removeDelegate:function(e){var t=this._delegateGuids.indexOf(e);return t>=0&&this._delegateGuids.splice(t),this},getFn:function(){return this._delegateGuids.length>0?this._delegateFn:this._fn},destroy:function(){this._fn=null,this._delegateFn=null,this._delegateGuids=null,delete this._fn,delete this._delegateFn,delete this._delegateGuids}},e.each(t,function(t,r){e.event.special[r]={setup:function(t,i,s){var o=e(this),u=o.data("hammerjs");u||(u=new Hammer(this,t),u.__Fns={},o.data("hammerjs",u)),u.__Fns[r]=new n(r,o)},add:function(t){var n=e(this).data("hammerjs");!t.selector||n.__Fns[r].addDelegate(t.guid),n["on"+r]=n.__Fns[r].getFn()},remove:function(t){var n=e(this).data("hammerjs");!t.selector||n.__Fns[r].removeDelegate(t.guid),n["on"+r]=n.__Fns[r].getFn()},teardown:function(t){var n=e(this).data("hammerjs");n.__Fns[r].destroy(),delete n.__Fns[r]}}})}(jQuery),define("hammer",["jquery"],function(e){return function(){var t,n;return t||e.Hammer}}(this)),define("vendor/text!components/footer/templates/placeholders.html",[],function(){return'<div class="footer-top">\n    <div class="footer-top-center"></div>\n    <div class="footer-top-left"></div>\n    <div class="footer-top-right"></div>\n</div>\n\n<div class="footer-bottom">\n    <div class="footer-bottom-center"></div>\n    <div class="footer-bottom-left"></div>\n    <div class="footer-bottom-right"></div>\n</div>\n'}),"use strict",define("footerView",["backbone","baseView","hammer","vendor/text!components/footer/templates/placeholders.html"],function(e,t,n,r){return t.extend({id:"footer",toggleClass:"move-up",className:"footerbar",togglePartVisible:!0,sticky:!0,placeholdersHTML:_.template(r),isDragging:!1,initialize:function(e){this.init(e),e.hasOwnProperty("viewOptions")&&(this.togglePartVisible=e.viewOptions.visiblePart),this.addHooks().toggleTop().bindEvents()},addHooks:function(){return this.addHook.call(this,"beforeRender",function(){this.setApplicationClass("has-footer"),this.viewOptions.sticky&&this.setApplicationClass("sticky-footer")}),this.addHook.call(this,"beforeClose",function(){this.removeApplicationClass("has-footer"),this.viewOptions.sticky&&this.removeApplicationClass("sticky-footer"),this.toggle()}),this},bindEvents:function(){return this.unbindEvents(),e.on("footer:toggle",this.toggleTop,this),e.on("footer:closePart",this.closePart,this),e.on("footer:openPart",this.openPart,this),n(this.$el).on("dragdown",this.dragStart,this),n(this.$el).on("dragend",this.closeAllParts,this),this},unbindEvents:function(){return e.off("footer:toggle",this.toggleTop,this),e.off("footer:closePart",this.closePart,this),e.off("footer:openPart",this.openPart,this),n(this.$el).off("dragdown",this.dragStart,this),n(this.$el).off("dragend",this.closeAllParts,this),this},dragStart:function(){this.isDragging||(this.isDragging=!0)},closeAllParts:function(t){this.isDragging&&(this.isDragging=!1,e.trigger("overlayElementCloseAll",t))},openPart:function(){this.$el.addClass(this.toggleClass),this.togglePartVisible=!1,e.trigger("overlayElementOpen","footer")},closePart:function(){this.$el.removeClass(this.toggleClass),this.togglePartVisible=!0,e.trigger("overlayElementClose","footer")},toggle:function(){this.viewOptions.animate&&this.$el.addClass("animate"),this.toggleTop()},render:function(){return this.$el.append(this.placeholdersHTML),this},toggleTop:function(){return this.togglePartVisible?this.openPart():this.closePart(),this}})}),"use strict",define("footerComponent",["backbone","app","underscore","baseComponent","footerView"],function(e,t,n,r,i){var s=n.extend({},r);return s.features=[],s.name="footer",s.view=i,s.open=function(e){e=e||{},t.renderComponentView(s,e,function(t){s.renderFeatures(),s.ready(e.componentReady)})},s.beforeClose=function(){},s.closeComponent=function(){t.closeComponent(s)},e.on(s.name+":open",s.open,s),e.on(s.name+":beforeClose",s.beforeClose,s),e.on(s.name+":close",s.closeComponent,s),s}),function(){"use strict";function n(t){t.fn.swiper=function(n){var r;return t(this).each(function(){var t=new e(this,n);r||(r=t)}),r}}var e=function(t,n){function f(){return u.params.direction==="horizontal"}function l(){u.autoplayTimeoutId=setTimeout(function(){u.params.loop?(u.fixLoop(),u._slideNext()):u.isEnd?n.autoplayStopOnLast?u.stopAutoplay():u._slideTo(0):u._slideNext()},u.params.autoplay)}function h(e,t){var n=a(e.target);if(!n.is(t))if(typeof t=="string")n=n.parents(t);else if(t.nodeType){var r;return n.parents().each(function(e,n){n===t&&(r=t)}),r?t:undefined}return n.length===0?undefined:n[0]}function k(e,t){t=t||{};var n=window.MutationObserver||window.WebkitMutationObserver,r=new n(function(e){e.forEach(function(e){u.onResize(!0),u.emit("onObserverUpdate",u,e)})});r.observe(e,{attributes:typeof t.attributes=="undefined"?!0:t.attributes,childList:typeof t.childList=="undefined"?!0:t.childList,characterData:typeof t.characterData=="undefined"?!0:t.characterData}),u.observers.push(r)}function L(e){e.originalEvent&&(e=e.originalEvent);var t=e.keyCode||e.charCode;if(!u.params.allowSwipeToNext&&(f()&&t===39||!f()&&t===40))return!1;if(!u.params.allowSwipeToPrev&&(f()&&t===37||!f()&&t===38))return!1;if(e.shiftKey||e.altKey||e.ctrlKey||e.metaKey)return;if(document.activeElement&&document.activeElement.nodeName&&(document.activeElement.nodeName.toLowerCase()==="input"||document.activeElement.nodeName.toLowerCase()==="textarea"))return;if(t===37||t===39||t===38||t===40){var n=!1;if(u.container.parents(".swiper-slide").length>0&&u.container.parents(".swiper-slide-active").length===0)return;var r={left:window.pageXOffset,top:window.pageYOffset},i=window.innerWidth,s=window.innerHeight,o=u.container.offset(),a=[[o.left,o.top],[o.left+u.width,o.top],[o.left,o.top+u.height],[o.left+u.width,o.top+u.height]];for(var l=0;l<a.length;l++){var c=a[l];c[0]>=r.left&&c[0]<=r.left+i&&c[1]>=r.top&&c[1]<=r.top+s&&(n=!0)}if(!n)return}if(f()){if(t===37||t===39)e.preventDefault?e.preventDefault():e.returnValue=!1;t===39&&u.slideNext(),t===37&&u.slidePrev()}else{if(t===38||t===40)e.preventDefault?e.preventDefault():e.returnValue=!1;t===40&&u.slideNext(),t===38&&u.slidePrev()}}function O(e){e.originalEvent&&(e=e.originalEvent);var t=u._wheelEvent,n=0;if(e.detail)n=-e.detail;else if(t==="mousewheel")if(u.params.mousewheelForceToAxis)if(f()){if(!(Math.abs(e.wheelDeltaX)>Math.abs(e.wheelDeltaY)))return;n=e.wheelDeltaX}else{if(!(Math.abs(e.wheelDeltaY)>Math.abs(e.wheelDeltaX)))return;n=e.wheelDeltaY}else n=e.wheelDelta;else if(t==="DOMMouseScroll")n=-e.detail;else if(t==="wheel")if(u.params.mousewheelForceToAxis)if(f()){if(!(Math.abs(e.deltaX)>Math.abs(e.deltaY)))return;n=-e.deltaX}else{if(!(Math.abs(e.deltaY)>Math.abs(e.deltaX)))return;n=-e.deltaY}else n=Math.abs(e.deltaX)>Math.abs(e.deltaY)?-e.deltaX:-e.deltaY;if(!u.params.freeMode)(new window.Date).getTime()-u._lastWheelScrollTime>60&&(n<0?u.slideNext():u.slidePrev()),u._lastWheelScrollTime=(new window.Date).getTime();else{var r=u.getWrapperTranslate()+n;r>0&&(r=0),r<u.maxTranslate()&&(r=u.maxTranslate()),u.setWrapperTransition(0),u.setWrapperTranslate(r),u.updateProgress(),u.updateActiveIndex();if(r===0||r===u.maxTranslate())return}return u.params.autoplay&&u.stopAutoplay(),e.preventDefault?e.preventDefault():e.returnValue=!1,!1}function M(e,t){e=a(e);var n,r,i;n=e.attr("data-swiper-parallax")||"0",r=e.attr("data-swiper-parallax-x"),i=e.attr("data-swiper-parallax-y"),r||i?(r=r||"0",i=i||"0"):f()?(r=n,i="0"):(i=n,r="0"),r.indexOf("%")>=0?r=parseInt(r,10)*t+"%":r=r*t+"px",i.indexOf("%")>=0?i=parseInt(i,10)*t+"%":i=i*t+"px",e.transform("translate3d("+r+", "+i+",0px)")}function P(e){return e.indexOf("on")!==0&&(e[0]!==e[0].toUpperCase()?e="on"+e[0].toUpperCase()+e.substring(1):e="on"+e),e}if(this instanceof e){var r={direction:"horizontal",touchEventsTarget:"container",initialSlide:0,speed:300,autoplay:!1,autoplayDisableOnInteraction:!0,freeMode:!1,freeModeMomentum:!0,freeModeMomentumRatio:1,freeModeMomentumBounce:!0,freeModeMomentumBounceRatio:1,freeModeSticky:!1,setWrapperSize:!1,virtualTranslate:!1,effect:"slide",coverflow:{rotate:50,stretch:0,depth:100,modifier:1,slideShadows:!0},cube:{slideShadows:!0,shadow:!0,shadowOffset:20,shadowScale:.94},fade:{crossFade:!1},parallax:!1,scrollbar:null,scrollbarHide:!0,keyboardControl:!1,mousewheelControl:!1,mousewheelForceToAxis:!1,hashnav:!1,spaceBetween:0,slidesPerView:1,slidesPerColumn:1,slidesPerColumnFill:"column",slidesPerGroup:1,centeredSlides:!1,touchRatio:1,touchAngle:45,simulateTouch:!0,shortSwipes:!0,longSwipes:!0,longSwipesRatio:.5,longSwipesMs:300,followFinger:!0,onlyExternal:!1,threshold:0,touchMoveStopPropagation:!0,pagination:null,paginationClickable:!1,paginationHide:!1,paginationBulletRender:null,resistance:!0,resistanceRatio:.85,nextButton:null,prevButton:null,watchSlidesProgress:!1,watchSlidesVisibility:!1,grabCursor:!1,preventClicks:!0,preventClicksPropagation:!0,slideToClickedSlide:!1,lazyLoading:!1,lazyLoadingInPrevNext:!1,lazyLoadingOnTransitionStart:!1,preloadImages:!0,updateOnImagesReady:!0,loop:!1,loopAdditionalSlides:0,loopedSlides:null,control:undefined,controlInverse:!1,allowSwipeToPrev:!0,allowSwipeToNext:!0,swipeHandler:null,noSwiping:!0,noSwipingClass:"swiper-no-swiping",slideClass:"swiper-slide",slideActiveClass:"swiper-slide-active",slideVisibleClass:"swiper-slide-visible",slideDuplicateClass:"swiper-slide-duplicate",slideNextClass:"swiper-slide-next",slidePrevClass:"swiper-slide-prev",wrapperClass:"swiper-wrapper",bulletClass:"swiper-pagination-bullet",bulletActiveClass:"swiper-pagination-bullet-active",buttonDisabledClass:"swiper-button-disabled",paginationHiddenClass:"swiper-pagination-hidden",observer:!1,observeParents:!1,a11y:!1,prevSlideMessage:"Previous slide",nextSlideMessage:"Next slide",firstSlideMessage:"This is the first slide",lastSlideMessage:"This is the last slide",runCallbacksOnInit:!0},i=n&&n.virtualTranslate;n=n||{};for(var s in r)if(typeof n[s]=="undefined")n[s]=r[s];else if(typeof n[s]=="object")for(var o in r[s])typeof n[s][o]=="undefined"&&(n[s][o]=r[s][o]);var u=this;u.version="3.0.7",u.params=n,u.classNames=[];var a;typeof Dom7=="undefined"?a=window.Dom7||window.Zepto||window.jQuery:a=Dom7;if(!a)return;u.$=a,u.container=a(t);if(u.container.length===0)return;if(u.container.length>1){u.container.each(function(){new e(this,n)});return}u.container[0].swiper=u,u.container.data("swiper",u),u.classNames.push("swiper-container-"+u.params.direction),u.params.freeMode&&u.classNames.push("swiper-container-free-mode"),u.support.flexbox||(u.classNames.push("swiper-container-no-flexbox"),u.params.slidesPerColumn=1);if(u.params.parallax||u.params.watchSlidesVisibility)u.params.watchSlidesProgress=!0;["cube","coverflow"].indexOf(u.params.effect)>=0&&(u.support.transforms3d?(u.params.watchSlidesProgress=!0,u.classNames.push("swiper-container-3d")):u.params.effect="slide"),u.params.effect!=="slide"&&u.classNames.push("swiper-container-"+u.params.effect),u.params.effect==="cube"&&(u.params.resistanceRatio=0,u.params.slidesPerView=1,u.params.slidesPerColumn=1,u.params.slidesPerGroup=1,u.params.centeredSlides=!1,u.params.spaceBetween=0,u.params.virtualTranslate=!0,u.params.setWrapperSize=!1),u.params.effect==="fade"&&(u.params.slidesPerView=1,u.params.slidesPerColumn=1,u.params.slidesPerGroup=1,u.params.watchSlidesProgress=!0,u.params.spaceBetween=0,typeof i=="undefined"&&(u.params.virtualTranslate=!0)),u.params.grabCursor&&u.support.touch&&(u.params.grabCursor=!1),u.wrapper=u.container.children("."+u.params.wrapperClass),u.params.pagination&&(u.paginationContainer=a(u.params.pagination),u.params.paginationClickable&&u.paginationContainer.addClass("swiper-pagination-clickable")),u.rtl=f()&&(u.container[0].dir.toLowerCase()==="rtl"||u.container.css("direction")==="rtl"),u.rtl&&u.classNames.push("swiper-container-rtl"),u.rtl&&(u.wrongRTL=u.wrapper.css("display")==="-webkit-box"),u.params.slidesPerColumn>1&&u.classNames.push("swiper-container-multirow"),u.device.android&&u.classNames.push("swiper-container-android"),u.container.addClass(u.classNames.join(" ")),u.translate=0,u.progress=0,u.velocity=0,u.lockSwipeToNext=function(){u.params.allowSwipeToNext=!1},u.lockSwipeToPrev=function(){u.params.allowSwipeToPrev=!1},u.lockSwipes=function(){u.params.allowSwipeToNext=u.params.allowSwipeToPrev=!1},u.unlockSwipeToNext=function(){u.params.allowSwipeToNext=!0},u.unlockSwipeToPrev=function(){u.params.allowSwipeToPrev=!0},u.unlockSwipes=function(){u.params.allowSwipeToNext=u.params.allowSwipeToPrev=!0},u.params.grabCursor&&(u.container[0].style.cursor="move",u.container[0].style.cursor="-webkit-grab",u.container[0].style.cursor="-moz-grab",u.container[0].style.cursor="grab"),u.imagesToLoad=[],u.imagesLoaded=0,u.loadImage=function(e,t,n,r){function s(){r&&r()}var i;!e.complete||!n?t?(i=new window.Image,i.onload=s,i.onerror=s,i.src=t):s():s()},u.preloadImages=function(){function e(){if(typeof u=="undefined"||u===null)return;u.imagesLoaded!==undefined&&u.imagesLoaded++,u.imagesLoaded===u.imagesToLoad.length&&(u.params.updateOnImagesReady&&u.update(),u.emit("onImagesReady",u))}u.imagesToLoad=u.container.find("img");for(var t=0;t<u.imagesToLoad.length;t++)u.loadImage(u.imagesToLoad[t],u.imagesToLoad[t].currentSrc||u.imagesToLoad[t].getAttribute("src"),!0,e)},u.autoplayTimeoutId=undefined,u.autoplaying=!1,u.autoplayPaused=!1,u.startAutoplay=function(){if(typeof u.autoplayTimeoutId!="undefined")return!1;if(!u.params.autoplay)return!1;if(u.autoplaying)return!1;u.autoplaying=!0,u.emit("onAutoplayStart",u),l()},u.stopAutoplay=function(e){if(!u.autoplayTimeoutId)return;u.autoplayTimeoutId&&clearTimeout(u.autoplayTimeoutId),u.autoplaying=!1,u.autoplayTimeoutId=undefined,u.emit("onAutoplayStop",u)},u.pauseAutoplay=function(e){if(u.autoplayPaused)return;u.autoplayTimeoutId&&clearTimeout(u.autoplayTimeoutId),u.autoplayPaused=!0,e===0?(u.autoplayPaused=!1,l()):u.wrapper.transitionEnd(function(){if(!u)return;u.autoplayPaused=!1,u.autoplaying?l():u.stopAutoplay()})},u.minTranslate=function(){return-u.snapGrid[0]},u.maxTranslate=function(){return-u.snapGrid[u.snapGrid.length-1]},u.updateContainerSize=function(){var e,t;typeof u.params.width!="undefined"?e=u.params.width:e=u.container[0].clientWidth,typeof u.params.height!="undefined"?t=u.params.height:t=u.container[0].clientHeight;if(e===0&&f()||t===0&&!f())return;u.width=e,u.height=t,u.size=f()?u.width:u.height},u.updateSlidesSize=function(){u.slides=u.wrapper.children("."+u.params.slideClass),u.snapGrid=[],u.slidesGrid=[],u.slidesSizesGrid=[];var e=u.params.spaceBetween,t=0,n,r=0,i=0;typeof e=="string"&&e.indexOf("%")>=0&&(e=parseFloat(e.replace("%",""))/100*u.size),u.virtualSize=-e,u.rtl?u.slides.css({marginLeft:"",marginTop:""}):u.slides.css({marginRight:"",marginBottom:""});var s;u.params.slidesPerColumn>1&&(Math.floor(u.slides.length/u.params.slidesPerColumn)===u.slides.length/u.params.slidesPerColumn?s=u.slides.length:s=Math.ceil(u.slides.length/u.params.slidesPerColumn)*u.params.slidesPerColumn);var o;for(n=0;n<u.slides.length;n++){o=0;var a=u.slides.eq(n);if(u.params.slidesPerColumn>1){var l,c,h,p=u.params.slidesPerColumn,d;u.params.slidesPerColumnFill==="column"?(c=Math.floor(n/p),h=n-c*p,l=c+h*s/p,a.css({"-webkit-box-ordinal-group":l,"-moz-box-ordinal-group":l,"-ms-flex-order":l,"-webkit-order":l,order:l})):(d=s/p,h=Math.floor(n/d),c=n-h*d),a.css({"margin-top":h!==0&&u.params.spaceBetween&&u.params.spaceBetween+"px"}).attr("data-swiper-column",c).attr("data-swiper-row",h)}if(a.css("display")==="none")continue;u.params.slidesPerView==="auto"?o=f()?a.outerWidth(!0):a.outerHeight(!0):(o=(u.size-(u.params.slidesPerView-1)*e)/u.params.slidesPerView,f()?u.slides[n].style.width=o+"px":u.slides[n].style.height=o+"px"),u.slides[n].swiperSlideSize=o,u.slidesSizesGrid.push(o),u.params.centeredSlides?(t=t+o/2+r/2+e,n===0&&(t=t-u.size/2-e),Math.abs(t)<.001&&(t=0),i%u.params.slidesPerGroup===0&&u.snapGrid.push(t),u.slidesGrid.push(t)):(i%u.params.slidesPerGroup===0&&u.snapGrid.push(t),u.slidesGrid.push(t),t=t+o+e),u.virtualSize+=o+e,r=o,i++}u.virtualSize=Math.max(u.virtualSize,u.size);var v;u.rtl&&u.wrongRTL&&(u.params.effect==="slide"||u.params.effect==="coverflow")&&u.wrapper.css({width:u.virtualSize+u.params.spaceBetween+"px"});if(!u.support.flexbox||u.params.setWrapperSize)f()?u.wrapper.css({width:u.virtualSize+u.params.spaceBetween+"px"}):u.wrapper.css({height:u.virtualSize+u.params.spaceBetween+"px"});if(u.params.slidesPerColumn>1){u.virtualSize=(o+u.params.spaceBetween)*s,u.virtualSize=Math.ceil(u.virtualSize/u.params.slidesPerColumn)-u.params.spaceBetween,u.wrapper.css({width:u.virtualSize+u.params.spaceBetween+"px"});if(u.params.centeredSlides){v=[];for(n=0;n<u.snapGrid.length;n++)u.snapGrid[n]<u.virtualSize+u.snapGrid[0]&&v.push(u.snapGrid[n]);u.snapGrid=v}}if(!u.params.centeredSlides){v=[];for(n=0;n<u.snapGrid.length;n++)u.snapGrid[n]<=u.virtualSize-u.size&&v.push(u.snapGrid[n]);u.snapGrid=v,Math.floor(u.virtualSize-u.size)>Math.floor(u.snapGrid[u.snapGrid.length-1])&&u.snapGrid.push(u.virtualSize-u.size)}u.snapGrid.length===0&&(u.snapGrid=[0]),u.params.spaceBetween!==0&&(f()?u.rtl?u.slides.css({marginLeft:e+"px"}):u.slides.css({marginRight:e+"px"}):u.slides.css({marginBottom:e+"px"})),u.params.watchSlidesProgress&&u.updateSlidesOffset()},u.updateSlidesOffset=function(){for(var e=0;e<u.slides.length;e++)u.slides[e].swiperSlideOffset=f()?u.slides[e].offsetLeft:u.slides[e].offsetTop},u.updateSlidesProgress=function(e){typeof e=="undefined"&&(e=u.translate||0);if(u.slides.length===0)return;typeof u.slides[0].swiperSlideOffset=="undefined"&&u.updateSlidesOffset();var t=u.params.centeredSlides?-e+u.size/2:-e;u.rtl&&(t=u.params.centeredSlides?e-u.size/2:e);var n=u.container[0].getBoundingClientRect(),r=f()?"left":"top",i=f()?"right":"bottom";u.slides.removeClass(u.params.slideVisibleClass);for(var s=0;s<u.slides.length;s++){var o=u.slides[s],a=u.params.centeredSlides===!0?o.swiperSlideSize/2:0,l=(t-o.swiperSlideOffset-a)/(o.swiperSlideSize+u.params.spaceBetween);if(u.params.watchSlidesVisibility){var c=-(t-o.swiperSlideOffset-a),h=c+u.slidesSizesGrid[s],p=c>=0&&c<u.size||h>0&&h<=u.size||c<=0&&h>=u.size;p&&u.slides.eq(s).addClass(u.params.slideVisibleClass)}o.progress=u.rtl?-l:l}},u.updateProgress=function(e){typeof e=="undefined"&&(e=u.translate||0);var t=u.maxTranslate()-u.minTranslate();t===0?(u.progress=0,u.isBeginning=u.isEnd=!0):(u.progress=(e-u.minTranslate())/t,u.isBeginning=u.progress<=0,u.isEnd=u.progress>=1),u.isBeginning&&u.emit("onReachBeginning",u),u.isEnd&&u.emit("onReachEnd",u),u.params.watchSlidesProgress&&u.updateSlidesProgress(e),u.emit("onProgress",u,u.progress)},u.updateActiveIndex=function(){var e=u.rtl?u.translate:-u.translate,t,n,r;for(n=0;n<u.slidesGrid.length;n++)typeof u.slidesGrid[n+1]!="undefined"?e>=u.slidesGrid[n]&&e<u.slidesGrid[n+1]-(u.slidesGrid[n+1]-u.slidesGrid[n])/2?t=n:e>=u.slidesGrid[n]&&e<u.slidesGrid[n+1]&&(t=n+1):e>=u.slidesGrid[n]&&(t=n);if(t<0||typeof t=="undefined")t=0;r=Math.floor(t/u.params.slidesPerGroup),r>=u.snapGrid.length&&(r=u.snapGrid.length-1);if(t===u.activeIndex)return;u.snapIndex=r,u.previousIndex=u.activeIndex,u.activeIndex=t,u.updateClasses()},u.updateClasses=function(){u.slides.removeClass(u.params.slideActiveClass+" "+u.params.slideNextClass+" "+u.params.slidePrevClass);var e=u.slides.eq(u.activeIndex);e.addClass(u.params.slideActiveClass),e.next("."+u.params.slideClass).addClass(u.params.slideNextClass),e.prev("."+u.params.slideClass).addClass(u.params.slidePrevClass);if(u.bullets&&u.bullets.length>0){u.bullets.removeClass(u.params.bulletActiveClass);var t;u.params.loop?(t=Math.ceil(u.activeIndex-u.loopedSlides)/u.params.slidesPerGroup,t>u.slides.length-1-u.loopedSlides*2&&(t-=u.slides.length-u.loopedSlides*2),t>u.bullets.length-1&&(t-=u.bullets.length)):typeof u.snapIndex!="undefined"?t=u.snapIndex:t=u.activeIndex||0,u.paginationContainer.length>1?u.bullets.each(function(){a(this).index()===t&&a(this).addClass(u.params.bulletActiveClass)}):u.bullets.eq(t).addClass(u.params.bulletActiveClass)}u.params.loop||(u.params.prevButton&&(u.isBeginning?(a(u.params.prevButton).addClass(u.params.buttonDisabledClass),u.params.a11y&&u.a11y&&u.a11y.disable(a(u.params.prevButton))):(a(u.params.prevButton).removeClass(u.params.buttonDisabledClass),u.params.a11y&&u.a11y&&u.a11y.enable(a(u.params.prevButton)))),u.params.nextButton&&(u.isEnd?(a(u.params.nextButton).addClass(u.params.buttonDisabledClass),u.params.a11y&&u.a11y&&u.a11y.disable(a(u.params.nextButton))):(a(u.params.nextButton).removeClass(u.params.buttonDisabledClass),u.params.a11y&&u.a11y&&u.a11y.enable(a(u.params.nextButton)))))},u.updatePagination=function(){if(!u.params.pagination)return;if(u.paginationContainer&&u.paginationContainer.length>0){var e="",t=u.params.loop?Math.ceil((u.slides.length-u.loopedSlides*2)/u.params.slidesPerGroup):u.snapGrid.length;for(var n=0;n<t;n++)u.params.paginationBulletRender?e+=u.params.paginationBulletRender(n,u.params.bulletClass):e+='<span class="'+u.params.bulletClass+'"></span>';u.paginationContainer.html(e),u.bullets=u.paginationContainer.find("."+u.params.bulletClass)}},u.update=function(e){function t(){r=Math.min(Math.max(u.translate,u.maxTranslate()),u.minTranslate()),u.setWrapperTranslate(r),u.updateActiveIndex(),u.updateClasses()}u.updateContainerSize(),u.updateSlidesSize(),u.updateProgress(),u.updatePagination(),u.updateClasses(),u.params.scrollbar&&u.scrollbar&&u.scrollbar.set();if(e){var n,r;u.params.freeMode?t():(u.params.slidesPerView==="auto"&&u.isEnd&&!u.params.centeredSlides?n=u.slideTo(u.slides.length-1,0,!1,!0):n=u.slideTo(u.activeIndex,0,!1,!0),n||t())}},u.onResize=function(e){u.updateContainerSize(),u.updateSlidesSize(),u.updateProgress(),(u.params.slidesPerView==="auto"||u.params.freeMode||e)&&u.updatePagination(),u.params.scrollbar&&u.scrollbar&&u.scrollbar.set();if(u.params.freeMode){var t=Math.min(Math.max(u.translate,u.maxTranslate()),u.minTranslate());u.setWrapperTranslate(t),u.updateActiveIndex(),u.updateClasses()}else u.updateClasses(),u.params.slidesPerView==="auto"&&u.isEnd&&!u.params.centeredSlides?u.slideTo(u.slides.length-1,0,!1,!0):u.slideTo(u.activeIndex,0,!1,!0)};var c=["mousedown","mousemove","mouseup"];window.navigator.pointerEnabled?c=["pointerdown","pointermove","pointerup"]:window.navigator.msPointerEnabled&&(c=["MSPointerDown","MSPointerMove","MSPointerUp"]),u.touchEvents={start:u.support.touch||!u.params.simulateTouch?"touchstart":c[0],move:u.support.touch||!u.params.simulateTouch?"touchmove":c[1],end:u.support.touch||!u.params.simulateTouch?"touchend":c[2]},(window.navigator.pointerEnabled||window.navigator.msPointerEnabled)&&(u.params.touchEventsTarget==="container"?u.container:u.wrapper).addClass("swiper-wp8-"+u.params.direction),u.initEvents=function(e){var t=e?"off":"on",r=e?"removeEventListener":"addEventListener",i=u.params.touchEventsTarget==="container"?u.container[0]:u.wrapper[0],s=u.support.touch?i:document,o=u.params.nested?!0:!1;u.browser.ie?(i[r](u.touchEvents.start,u.onTouchStart,!1),s[r](u.touchEvents.move,u.onTouchMove,o),s[r](u.touchEvents.end,u.onTouchEnd,!1)):(u.support.touch&&(i[r](u.touchEvents.start,u.onTouchStart,!1),i[r](u.touchEvents.move,u.onTouchMove,o),i[r](u.touchEvents.end,u.onTouchEnd,!1)),n.simulateTouch&&!u.device.ios&&!u.device.android&&(i[r]("mousedown",u.onTouchStart,!1),document[r]("mousemove",u.onTouchMove,o),document[r]("mouseup",u.onTouchEnd,!1))),window[r]("resize",u.onResize),u.params.nextButton&&(a(u.params.nextButton)[t]("click",u.onClickNext),u.params.a11y&&u.a11y&&a(u.params.nextButton)[t]("keydown",u.a11y.onEnterKey)),u.params.prevButton&&(a(u.params.prevButton)[t]("click",u.onClickPrev),u.params.a11y&&u.a11y&&a(u.params.prevButton)[t]("keydown",u.a11y.onEnterKey)),u.params.pagination&&u.params.paginationClickable&&a(u.paginationContainer)[t]("click","."+u.params.bulletClass,u.onClickIndex),(u.params.preventClicks||u.params.preventClicksPropagation)&&i[r]("click",u.preventClicks,!0)},u.attachEvents=function(e){u.initEvents()},u.detachEvents=function(){u.initEvents(!0)},u.allowClick=!0,u.preventClicks=function(e){u.allowClick||(u.params.preventClicks&&e.preventDefault(),u.params.preventClicksPropagation&&(e.stopPropagation(),e.stopImmediatePropagation()))},u.onClickNext=function(e){e.preventDefault(),u.slideNext()},u.onClickPrev=function(e){e.preventDefault(),u.slidePrev()},u.onClickIndex=function(e){e.preventDefault();var t=a(this).index()*u.params.slidesPerGroup;u.params.loop&&(t+=u.loopedSlides),u.slideTo(t)},u.updateClickedSlide=function(e){var t=h(e,"."+u.params.slideClass),n=!1;if(t)for(var r=0;r<u.slides.length;r++)u.slides[r]===t&&(n=!0);if(!t||!n){u.clickedSlide=undefined,u.clickedIndex=undefined;return}u.clickedSlide=t,u.clickedIndex=a(t).index();if(u.params.slideToClickedSlide&&u.clickedIndex!==undefined&&u.clickedIndex!==u.activeIndex){var i=u.clickedIndex,s;if(u.params.loop){s=a(u.clickedSlide).attr("data-swiper-slide-index");if(i>u.slides.length-u.params.slidesPerView)u.fixLoop(),i=u.wrapper.children("."+u.params.slideClass+'[data-swiper-slide-index="'+s+'"]').eq(0).index(),setTimeout(function(){u.slideTo(i)},0);else if(i<u.params.slidesPerView-1){u.fixLoop();var o=u.wrapper.children("."+u.params.slideClass+'[data-swiper-slide-index="'+s+'"]');i=o.eq(o.length-1).index(),setTimeout(function(){u.slideTo(i)},0)}else u.slideTo(i)}else u.slideTo(i)}};var p,d,v,m,g,y,b,w="input, select, textarea, button",E=Date.now(),S,x=[],T;u.animating=!1,u.touches={startX:0,startY:0,currentX:0,currentY:0,diff:0};var N,C;u.onTouchStart=function(e){e.originalEvent&&(e=e.originalEvent),N=e.type==="touchstart";if(!N&&"which"in e&&e.which===3)return;if(u.params.noSwiping&&h(e,"."+u.params.noSwipingClass)){u.allowClick=!0;return}if(u.params.swipeHandler&&!h(e,u.params.swipeHandler))return;p=!0,d=!1,m=undefined,C=undefined,u.touches.startX=u.touches.currentX=e.type==="touchstart"?e.targetTouches[0].pageX:e.pageX,u.touches.startY=u.touches.currentY=e.type==="touchstart"?e.targetTouches[0].pageY:e.pageY,v=Date.now(),u.allowClick=!0,u.updateContainerSize(),u.swipeDirection=undefined,u.params.threshold>0&&(b=!1);if(e.type!=="touchstart"){var t=!0;a(e.target).is(w)&&(t=!1),document.activeElement&&a(document.activeElement).is(w)&&document.activeElement.blur(),t&&e.preventDefault()}u.emit("onTouchStart",u,e)},u.onTouchMove=function(e){e.originalEvent&&(e=e.originalEvent);if(N&&e.type==="mousemove")return;if(e.preventedByNestedSwiper)return;if(u.params.onlyExternal){d=!0,u.allowClick=!1;return}if(N&&document.activeElement&&e.target===document.activeElement&&a(e.target).is(w)){d=!0,u.allowClick=!1;return}u.emit("onTouchMove",u,e);if(e.targetTouches&&e.targetTouches.length>1)return;u.touches.currentX=e.type==="touchmove"?e.targetTouches[0].pageX:e.pageX,u.touches.currentY=e.type==="touchmove"?e.targetTouches[0].pageY:e.pageY;if(typeof m=="undefined"){var t=Math.atan2(Math.abs(u.touches.currentY-u.touches.startY),Math.abs(u.touches.currentX-u.touches.startX))*180/Math.PI;m=f()?t>u.params.touchAngle:90-t>u.params.touchAngle}m&&u.emit("onTouchMoveOpposite",u,e),typeof C=="undefined"&&u.browser.ieTouch&&(u.touches.currentX!==u.touches.startX||u.touches.currentY!==u.touches.startY)&&(C=!0);if(!p)return;if(m){p=!1;return}if(!C&&u.browser.ieTouch)return;u.allowClick=!1,u.emit("onSliderMove",u,e),e.preventDefault(),u.params.touchMoveStopPropagation&&!u.params.nested&&e.stopPropagation(),d||(n.loop&&u.fixLoop(),y=u.getWrapperTranslate(),u.setWrapperTransition(0),u.animating&&u.wrapper.trigger("webkitTransitionEnd transitionend oTransitionEnd MSTransitionEnd msTransitionEnd"),u.params.autoplay&&u.autoplaying&&(u.params.autoplayDisableOnInteraction?u.stopAutoplay():u.pauseAutoplay()),T=!1,u.params.grabCursor&&(u.container[0].style.cursor="move",u.container[0].style.cursor="-webkit-grabbing",u.container[0].style.cursor="-moz-grabbin",u.container[0].style.cursor="grabbing")),d=!0;var r=u.touches.diff=f()?u.touches.currentX-u.touches.startX:u.touches.currentY-u.touches.startY;r*=u.params.touchRatio,u.rtl&&(r=-r),u.swipeDirection=r>0?"prev":"next",g=r+y;var i=!0;r>0&&g>u.minTranslate()?(i=!1,u.params.resistance&&(g=u.minTranslate()-1+Math.pow(-u.minTranslate()+y+r,u.params.resistanceRatio))):r<0&&g<u.maxTranslate()&&(i=!1,u.params.resistance&&(g=u.maxTranslate()+1-Math.pow(u.maxTranslate()-y-r,u.params.resistanceRatio))),i&&(e.preventedByNestedSwiper=!0),!u.params.allowSwipeToNext&&u.swipeDirection==="next"&&g<y&&(g=y),!u.params.allowSwipeToPrev&&u.swipeDirection==="prev"&&g>y&&(g=y);if(!u.params.followFinger)return;if(u.params.threshold>0){if(!(Math.abs(r)>u.params.threshold||b)){g=y;return}if(!b){b=!0,u.touches.startX=u.touches.currentX,u.touches.startY=u.touches.currentY,g=y,u.touches.diff=f()?u.touches.currentX-u.touches.startX:u.touches.currentY-u.touches.startY;return}}(u.params.freeMode||u.params.watchSlidesProgress)&&u.updateActiveIndex(),u.params.freeMode&&(x.length===0&&x.push({position:u.touches[f()?"startX":"startY"],time:v}),x.push({position:u.touches[f()?"currentX":"currentY"],time:(new window.Date).getTime()})),u.updateProgress(g),u.setWrapperTranslate(g)},u.onTouchEnd=function(e){e.originalEvent&&(e=e.originalEvent),u.emit("onTouchEnd",u,e);if(!p)return;u.params.grabCursor&&d&&p&&(u.container[0].style.cursor="move",u.container[0].style.cursor="-webkit-grab",u.container[0].style.cursor="-moz-grab",u.container[0].style.cursor="grab");var t=Date.now(),n=t-v;u.allowClick&&(u.updateClickedSlide(e),u.emit("onTap",u,e),n<300&&t-E>300&&(S&&clearTimeout(S),S=setTimeout(function(){if(!u)return;u.params.paginationHide&&u.paginationContainer.length>0&&!a(e.target).hasClass(u.params.bulletClass)&&u.paginationContainer.toggleClass(u.params.paginationHiddenClass),u.emit("onClick",u,e)},300)),n<300&&t-E<300&&(S&&clearTimeout(S),u.emit("onDoubleTap",u,e))),E=Date.now(),setTimeout(function(){u&&u.allowClick&&(u.allowClick=!0)},0);if(!p||!d||!u.swipeDirection||u.touches.diff===0||g===y){p=d=!1;return}p=d=!1;var r;u.params.followFinger?r=u.rtl?u.translate:-u.translate:r=-g;if(u.params.freeMode){if(r<-u.minTranslate()){u.slideTo(u.activeIndex);return}if(r>-u.maxTranslate()){u.slides.length<u.snapGrid.length?u.slideTo(u.snapGrid.length-1):u.slideTo(u.slides.length-1);return}if(u.params.freeModeMomentum){if(x.length>1){var i=x.pop(),s=x.pop(),o=i.position-s.position,f=i.time-s.time;u.velocity=o/f,u.velocity=u.velocity/2,Math.abs(u.velocity)<.02&&(u.velocity=0);if(f>150||(new window.Date).getTime()-i.time>300)u.velocity=0}else u.velocity=0;x.length=0;var l=1e3*u.params.freeModeMomentumRatio,c=u.velocity*l,h=u.translate+c;u.rtl&&(h=-h);var m=!1,b,w=Math.abs(u.velocity)*20*u.params.freeModeMomentumBounceRatio;if(h<u.maxTranslate())u.params.freeModeMomentumBounce?(h+u.maxTranslate()<-w&&(h=u.maxTranslate()-w),b=u.maxTranslate(),m=!0,T=!0):h=u.maxTranslate();else if(h>u.minTranslate())u.params.freeModeMomentumBounce?(h-u.minTranslate()>w&&(h=u.minTranslate()+w),b=u.minTranslate(),m=!0,T=!0):h=u.minTranslate();else if(u.params.freeModeSticky){var N=0,C;for(N=0;N<u.snapGrid.length;N+=1)if(u.snapGrid[N]>-h){C=N;break}Math.abs(u.snapGrid[C]-h)<Math.abs(u.snapGrid[C-1]-h)||u.swipeDirection==="next"?h=u.snapGrid[C]:h=u.snapGrid[C-1],u.rtl||(h=-h)}if(u.velocity!==0)u.rtl?l=Math.abs((-h-u.translate)/u.velocity):l=Math.abs((h-u.translate)/u.velocity);else if(u.params.freeModeSticky){u.slideReset();return}u.params.freeModeMomentumBounce&&m?(u.updateProgress(b),u.setWrapperTransition(l),u.setWrapperTranslate(h),u.onTransitionStart(),u.animating=!0,u.wrapper.transitionEnd(function(){if(!u||!T)return;u.emit("onMomentumBounce",u),u.setWrapperTransition(u.params.speed),u.setWrapperTranslate(b),u.wrapper.transitionEnd(function(){if(!u)return;u.onTransitionEnd()})})):u.velocity?(u.updateProgress(h),u.setWrapperTransition(l),u.setWrapperTranslate(h),u.onTransitionStart(),u.animating||(u.animating=!0,u.wrapper.transitionEnd(function(){if(!u)return;u.onTransitionEnd()}))):u.updateProgress(h),u.updateActiveIndex()}if(!u.params.freeModeMomentum||n>=u.params.longSwipesMs)u.updateProgress(),u.updateActiveIndex();return}var k,L=0,A=u.slidesSizesGrid[0];for(k=0;k<u.slidesGrid.length;k+=u.params.slidesPerGroup)typeof u.slidesGrid[k+u.params.slidesPerGroup]!="undefined"?r>=u.slidesGrid[k]&&r<u.slidesGrid[k+u.params.slidesPerGroup]&&(L=k,A=u.slidesGrid[k+u.params.slidesPerGroup]-u.slidesGrid[k]):r>=u.slidesGrid[k]&&(L=k,A=u.slidesGrid[u.slidesGrid.length-1]-u.slidesGrid[u.slidesGrid.length-2]);var O=(r-u.slidesGrid[L])/A;if(n>u.params.longSwipesMs){if(!u.params.longSwipes){u.slideTo(u.activeIndex);return}u.swipeDirection==="next"&&(O>=u.params.longSwipesRatio?u.slideTo(L+u.params.slidesPerGroup):u.slideTo(L)),u.swipeDirection==="prev"&&(O>1-u.params.longSwipesRatio?u.slideTo(L+u.params.slidesPerGroup):u.slideTo(L))}else{if(!u.params.shortSwipes){u.slideTo(u.activeIndex);return}u.swipeDirection==="next"&&u.slideTo(L+u.params.slidesPerGroup),u.swipeDirection==="prev"&&u.slideTo(L)}},u._slideTo=function(e,t){return u.slideTo(e,t,!0,!0)},u.slideTo=function(e,t,n,r){typeof n=="undefined"&&(n=!0),typeof e=="undefined"&&(e=0),e<0&&(e=0),u.snapIndex=Math.floor(e/u.params.slidesPerGroup),u.snapIndex>=u.snapGrid.length&&(u.snapIndex=u.snapGrid.length-1);var i=-u.snapGrid[u.snapIndex];if(!u.params.allowSwipeToNext&&i<u.translate)return!1;if(!u.params.allowSwipeToPrev&&i>u.translate)return!1;u.params.autoplay&&u.autoplaying&&(r||!u.params.autoplayDisableOnInteraction?u.pauseAutoplay(t):u.stopAutoplay()),u.updateProgress(i);for(var s=0;s<u.slidesGrid.length;s++)-i>=u.slidesGrid[s]&&(e=s);typeof t=="undefined"&&(t=u.params.speed),u.previousIndex=u.activeIndex||0,u.activeIndex=e;if(i===u.translate)return u.updateClasses(),!1;u.updateClasses(),u.onTransitionStart(n);var o=f()?i:0,a=f()?0:i;return t===0?(u.setWrapperTransition(0),u.setWrapperTranslate(i),u.onTransitionEnd(n)):(u.setWrapperTransition(t),u.setWrapperTranslate(i),u.animating||(u.animating=!0,u.wrapper.transitionEnd(function(){if(!u)return;u.onTransitionEnd(n)}))),!0},u.onTransitionStart=function(e){typeof e=="undefined"&&(e=!0),u.lazy&&u.lazy.onTransitionStart(),e&&(u.emit("onTransitionStart",u),u.activeIndex!==u.previousIndex&&u.emit("onSlideChangeStart",u))},u.onTransitionEnd=function(e){u.animating=!1,u.setWrapperTransition(0),typeof e=="undefined"&&(e=!0),u.lazy&&u.lazy.onTransitionEnd(),e&&(u.emit("onTransitionEnd",u),u.activeIndex!==u.previousIndex&&u.emit("onSlideChangeEnd",u)),u.params.hashnav&&u.hashnav&&u.hashnav.setHash()},u.slideNext=function(e,t,n){if(u.params.loop){if(u.animating)return!1;u.fixLoop();var r=u.container[0].clientLeft;return u.slideTo(u.activeIndex+u.params.slidesPerGroup,t,e,n)}return u.slideTo(u.activeIndex+u.params.slidesPerGroup,t,e,n)},u._slideNext=function(e){return u.slideNext(!0,e,!0)},u.slidePrev=function(e,t,n){if(u.params.loop){if(u.animating)return!1;u.fixLoop();var r=u.container[0].clientLeft;return u.slideTo(u.activeIndex-1,t,e,n)}return u.slideTo(u.activeIndex-1,t,e,n)},u._slidePrev=function(e){return u.slidePrev(!0,e,!0)},u.slideReset=function(e,t,n){return u.slideTo(u.activeIndex,t,e)},u.setWrapperTransition=function(e,t){u.wrapper.transition(e),u.params.effect!=="slide"&&u.effects[u.params.effect]&&u.effects[u.params.effect].setTransition(e),u.params.parallax&&u.parallax&&u.parallax.setTransition(e),u.params.scrollbar&&u.scrollbar&&u.scrollbar.setTransition(e),u.params.control&&u.controller&&u.controller.setTransition(e,t),u.emit("onSetTransition",u,e)},u.setWrapperTranslate=function(e,t,n){var r=0,i=0,s=0;f()?r=u.rtl?-e:e:i=e,u.params.virtualTranslate||(u.support.transforms3d?u.wrapper.transform("translate3d("+r+"px, "+i+"px, "+s+"px)"):u.wrapper.transform("translate("+r+"px, "+i+"px)")),u.translate=f()?r:i,t&&u.updateActiveIndex(),u.params.effect!=="slide"&&u.effects[u.params.effect]&&u.effects[u.params.effect].setTranslate(u.translate),u.params.parallax&&u.parallax&&u.parallax.setTranslate(u.translate),u.params.scrollbar&&u.scrollbar&&u.scrollbar.setTranslate(u.translate),u.params.control&&u.controller&&u.controller.setTranslate(u.translate,n),u.emit("onSetTranslate",u,u.translate)},u.getTranslate=function(e,t){var n,r,i,s;return typeof t=="undefined"&&(t="x"),u.params.virtualTranslate?u.rtl?-u.translate:u.translate:(i=window.getComputedStyle(e,null),window.WebKitCSSMatrix?s=new window.WebKitCSSMatrix(i.webkitTransform==="none"?"":i.webkitTransform):(s=i.MozTransform||i.OTransform||i.MsTransform||i.msTransform||i.transform||i.getPropertyValue("transform").replace("translate(","matrix(1, 0, 0, 1,"),n=s.toString().split(",")),t==="x"&&(window.WebKitCSSMatrix?r=s.m41:n.length===16?r=parseFloat(n[12]):r=parseFloat(n[4])),t==="y"&&(window.WebKitCSSMatrix?r=s.m42:n.length===16?r=parseFloat(n[13]):r=parseFloat(n[5])),u.rtl&&r&&(r=-r),r||0)},u.getWrapperTranslate=function(e){return typeof e=="undefined"&&(e=f()?"x":"y"),u.getTranslate(u.wrapper[0],e)},u.observers=[],u.initObservers=function(){if(u.params.observeParents){var e=u.container.parents();for(var t=0;t<e.length;t++)k(e[t])}k(u.container[0],{childList:!1}),k(u.wrapper[0],{attributes:!1})},u.disconnectObservers=function(){for(var e=0;e<u.observers.length;e++)u.observers[e].disconnect();u.observers=[]},u.createLoop=function(){u.wrapper.children("."+u.params.slideClass+"."+u.params.slideDuplicateClass).remove();var e=u.wrapper.children("."+u.params.slideClass);u.loopedSlides=parseInt(u.params.loopedSlides||u.params.slidesPerView,10),u.loopedSlides=u.loopedSlides+u.params.loopAdditionalSlides,u.loopedSlides>e.length&&(u.loopedSlides=e.length);var t=[],n=[],r;e.each(function(r,i){var s=a(this);r<u.loopedSlides&&n.push(i),r<e.length&&r>=e.length-u.loopedSlides&&t.push(i),s.attr("data-swiper-slide-index",r)});for(r=0;r<n.length;r++)u.wrapper.append(a(n[r].cloneNode(!0)).addClass(u.params.slideDuplicateClass));for(r=t.length-1;r>=0;r--)u.wrapper.prepend(a(t[r].cloneNode(!0)).addClass(u.params.slideDuplicateClass))},u.destroyLoop=function(){u.wrapper.children("."+u.params.slideClass+"."+u.params.slideDuplicateClass).remove(),u.slides.removeAttr("data-swiper-slide-index")},u.fixLoop=function(){var e;if(u.activeIndex<u.loopedSlides)e=u.slides.length-u.loopedSlides*3+u.activeIndex,e+=u.loopedSlides,u.slideTo(e,0,!1,!0);else if(u.params.slidesPerView==="auto"&&u.activeIndex>=u.loopedSlides*2||u.activeIndex>u.slides.length-u.params.slidesPerView*2)e=-u.slides.length+u.activeIndex+u.loopedSlides,e+=u.loopedSlides,u.slideTo(e,0,!1,!0)},u.appendSlide=function(e){u.params.loop&&u.destroyLoop();if(typeof e=="object"&&e.length)for(var t=0;t<e.length;t++)e[t]&&u.wrapper.append(e[t]);else u.wrapper.append(e);u.params.loop&&u.createLoop(),(!u.params.observer||!u.support.observer)&&u.update(!0)},u.prependSlide=function(e){u.params.loop&&u.destroyLoop();var t=u.activeIndex+1;if(typeof e=="object"&&e.length){for(var n=0;n<e.length;n++)e[n]&&u.wrapper.prepend(e[n]);t=u.activeIndex+e.length}else u.wrapper.prepend(e);u.params.loop&&u.createLoop(),(!u.params.observer||!u.support.observer)&&u.update(!0),u.slideTo(t,0,!1)},u.removeSlide=function(e){u.params.loop&&(u.destroyLoop(),u.slides=u.wrapper.children("."+u.params.slideClass));var t=u.activeIndex,n;if(typeof e=="object"&&e.length){for(var r=0;r<e.length;r++)n=e[r],u.slides[n]&&u.slides.eq(n).remove(),n<t&&t--;t=Math.max(t,0)}else n=e,u.slides[n]&&u.slides.eq(n).remove(),n<t&&t--,t=Math.max(t,0);u.params.loop&&u.createLoop(),(!u.params.observer||!u.support.observer)&&u.update(!0),u.params.loop?u.slideTo(t+u.loopedSlides,0,!1):u.slideTo(t,0,!1)},u.removeAllSlides=function(){var e=[];for(var t=0;t<u.slides.length;t++)e.push(t);u.removeSlide(e)},u.effects={fade:{fadeIndex:null,setTranslate:function(){for(var e=0;e<u.slides.length;e++){var t=u.slides.eq(e),n=t[0].swiperSlideOffset,r=-n;u.params.virtualTranslate||(r-=u.translate);var i=0;f()||(i=r,r=0);var s=u.params.fade.crossFade?Math.max(1-Math.abs(t[0].progress),0):1+Math.min(Math.max(t[0].progress,-1),0);s>0&&s<1&&(u.effects.fade.fadeIndex=e),t.css({opacity:s}).transform("translate3d("+r+"px, "+i+"px, 0px)")}},setTransition:function(e){u.slides.transition(e);if(u.params.virtualTranslate&&e!==0){var t=u.effects.fade.fadeIndex!==null?u.effects.fade.fadeIndex:u.activeIndex;!u.params.loop&&!u.params.fade.crossFade&&t===0&&(t=u.slides.length-1),u.slides.eq(t).transitionEnd(function(){if(!u)return;var e=["webkitTransitionEnd","transitionend","oTransitionEnd","MSTransitionEnd","msTransitionEnd"];for(var t=0;t<e.length;t++)u.wrapper.trigger(e[t])})}}},cube:{setTranslate:function(){var e=0,t;u.params.cube.shadow&&(f()?(t=u.wrapper.find(".swiper-cube-shadow"),t.length===0&&(t=a('<div class="swiper-cube-shadow"></div>'),u.wrapper.append(t)),t.css({height:u.width+"px"})):(t=u.container.find(".swiper-cube-shadow"),t.length===0&&(t=a('<div class="swiper-cube-shadow"></div>'),u.container.append(t))));for(var n=0;n<u.slides.length;n++){var r=u.slides.eq(n),i=n*90,s=Math.floor(i/360);u.rtl&&(i=-i,s=Math.floor(-i/360));var o=Math.max(Math.min(r[0].progress,1),-1),l=0,c=0,h=0;n%4===0?(l=-s*4*u.size,h=0):(n-1)%4===0?(l=0,h=-s*4*u.size):(n-2)%4===0?(l=u.size+s*4*u.size,h=u.size):(n-3)%4===0&&(l=-u.size,h=3*u.size+u.size*4*s),u.rtl&&(l=-l),f()||(c=l,l=0);var p="rotateX("+(f()?0:-i)+"deg) rotateY("+(f()?i:0)+"deg) translate3d("+l+"px, "+c+"px, "+h+"px)";o<=1&&o>-1&&(e=n*90+o*90,u.rtl&&(e=-n*90-o*90)),r.transform(p);if(u.params.cube.slideShadows){var d=f()?r.find(".swiper-slide-shadow-left"):r.find(".swiper-slide-shadow-top"),v=f()?r.find(".swiper-slide-shadow-right"):r.find(".swiper-slide-shadow-bottom");d.length===0&&(d=a('<div class="swiper-slide-shadow-'+(f()?"left":"top")+'"></div>'),r.append(d)),v.length===0&&(v=a('<div class="swiper-slide-shadow-'+(f()?"right":"bottom")+'"></div>'),r.append(v));var m=r[0].progress;d.length&&(d[0].style.opacity=-r[0].progress),v.length&&(v[0].style.opacity=r[0].progress)}}u.wrapper.css({"-webkit-transform-origin":"50% 50% -"+u.size/2+"px","-moz-transform-origin":"50% 50% -"+u.size/2+"px","-ms-transform-origin":"50% 50% -"+u.size/2+"px","transform-origin":"50% 50% -"+u.size/2+"px"});if(u.params.cube.shadow)if(f())t.transform("translate3d(0px, "+(u.width/2+u.params.cube.shadowOffset)+"px, "+ -u.width/2+"px) rotateX(90deg) rotateZ(0deg) scale("+u.params.cube.shadowScale+")");else{var g=Math.abs(e)-Math.floor(Math.abs(e)/90)*90,y=1.5-(Math.sin(g*2*Math.PI/360)/2+Math.cos(g*2*Math.PI/360)/2),b=u.params.cube.shadowScale,w=u.params.cube.shadowScale/y,E=u.params.cube.shadowOffset;t.transform("scale3d("+b+", 1, "+w+") translate3d(0px, "+(u.height/2+E)+"px, "+ -u.height/2/w+"px) rotateX(-90deg)")}var S=u.isSafari||u.isUiWebView?-u.size/2:0;u.wrapper.transform("translate3d(0px,0,"+S+"px) rotateX("+(f()?0:e)+"deg) rotateY("+(f()?-e:0)+"deg)")},setTransition:function(e){u.slides.transition(e).find(".swiper-slide-shadow-top, .swiper-slide-shadow-right, .swiper-slide-shadow-bottom, .swiper-slide-shadow-left").transition(e),u.params.cube.shadow&&!f()&&u.container.find(".swiper-cube-shadow").transition(e)}},coverflow:{setTranslate:function(){var e=u.translate,t=f()?-e+u.width/2:-e+u.height/2,n=f()?u.params.coverflow.rotate:-u.params.coverflow.rotate,r=u.params.coverflow.depth;for(var i=0,s=u.slides.length;i<s;i++){var o=u.slides.eq(i),l=u.slidesSizesGrid[i],c=o[0].swiperSlideOffset,h=(t-c-l/2)/l*u.params.coverflow.modifier,p=f()?n*h:0,d=f()?0:n*h,v=-r*Math.abs(h),m=f()?0:u.params.coverflow.stretch*h,g=f()?u.params.coverflow.stretch*h:0;Math.abs(g)<.001&&(g=0),Math.abs(m)<.001&&(m=0),Math.abs(v)<.001&&(v=0),Math.abs(p)<.001&&(p=0),Math.abs(d)<.001&&(d=0);var y="translate3d("+g+"px,"+m+"px,"+v+"px)  rotateX("+d+"deg) rotateY("+p+"deg)";o.transform(y),o[0].style.zIndex=-Math.abs(Math.round(h))+1;if(u.params.coverflow.slideShadows){var b=f()?o.find(".swiper-slide-shadow-left"):o.find(".swiper-slide-shadow-top"),w=f()?o.find(".swiper-slide-shadow-right"):o.find(".swiper-slide-shadow-bottom");b.length===0&&(b=a('<div class="swiper-slide-shadow-'+(f()?"left":"top")+'"></div>'),o.append(b)),w.length===0&&(w=a('<div class="swiper-slide-shadow-'+(f()?"right":"bottom")+'"></div>'),o.append(w)),b.length&&(b[0].style.opacity=h>0?h:0),w.length&&(w[0].style.opacity=-h>0?-h:0)}}if(u.browser.ie){var E=u.wrapper[0].style;E.perspectiveOrigin=t+"px 50%"}},setTransition:function(e){u.slides.transition(e).find(".swiper-slide-shadow-top, .swiper-slide-shadow-right, .swiper-slide-shadow-bottom, .swiper-slide-shadow-left").transition(e)}}},u.lazy={initialImageLoaded:!1,loadImageInSlide:function(e,t){if(typeof e=="undefined")return;typeof t=="undefined"&&(t=!0);if(u.slides.length===0)return;var n=u.slides.eq(e),r=n.find(".swiper-lazy:not(.swiper-lazy-loaded):not(.swiper-lazy-loading)");n.hasClass("swiper-lazy")&&!n.hasClass("swiper-lazy-loaded")&&!n.hasClass("swiper-lazy-loading")&&r.add(n[0]);if(r.length===0)return;r.each(function(){var e=a(this);e.addClass("swiper-lazy-loading");var r=e.attr("data-background"),i=e.attr("data-src");u.loadImage(e[0],i||r,!1,function(){r?(e.css("background-image","url("+r+")"),e.removeAttr("data-background")):(e.attr("src",i),e.removeAttr("data-src")),e.addClass("swiper-lazy-loaded").removeClass("swiper-lazy-loading"),n.find(".swiper-lazy-preloader, .preloader").remove();if(u.params.loop&&t){var s=n.attr("data-swiper-slide-index");if(n.hasClass(u.params.slideDuplicateClass)){var o=u.wrapper.children('[data-swiper-slide-index="'+s+'"]:not(.'+u.params.slideDuplicateClass+")");u.lazy.loadImageInSlide(o.index(),!1)}else{var a=u.wrapper.children("."+u.params.slideDuplicateClass+'[data-swiper-slide-index="'+s+'"]');u.lazy.loadImageInSlide(a.index(),!1)}}u.emit("onLazyImageReady",u,n[0],e[0])}),u.emit("onLazyImageLoad",u,n[0],e[0])})},load:function(){if(u.params.watchSlidesVisibility)u.wrapper.children("."+u.params.slideVisibleClass).each(function(){u.lazy.loadImageInSlide(a(this).index())});else if(u.params.slidesPerView>1)for(var e=u.activeIndex;e<u.activeIndex+u.params.slidesPerView;e++)u.slides[e]&&u.lazy.loadImageInSlide(e);else u.lazy.loadImageInSlide(u.activeIndex);if(u.params.lazyLoadingInPrevNext){var t=u.wrapper.children("."+u.params.slideNextClass);t.length>0&&u.lazy.loadImageInSlide(t.index());var n=u.wrapper.children("."+u.params.slidePrevClass);n.length>0&&u.lazy.loadImageInSlide(n.index())}},onTransitionStart:function(){u.params.lazyLoading&&(u.params.lazyLoadingOnTransitionStart||!u.params.lazyLoadingOnTransitionStart&&!u.lazy.initialImageLoaded)&&u.lazy.load()},onTransitionEnd:function(){u.params.lazyLoading&&!u.params.lazyLoadingOnTransitionStart&&u.lazy.load()}},u.scrollbar={set:function(){if(!u.params.scrollbar)return;var e=u.scrollbar;e.track=a(u.params.scrollbar),e.drag=e.track.find(".swiper-scrollbar-drag"),e.drag.length===0&&(e.drag=a('<div class="swiper-scrollbar-drag"></div>'),e.track.append(e.drag)),e.drag[0].style.width="",e.drag[0].style.height="",e.trackSize=f()?e.track[0].offsetWidth:e.track[0].offsetHeight,e.divider=u.size/u.virtualSize,e.moveDivider=e.divider*(e.trackSize/u.size),e.dragSize=e.trackSize*e.divider,f()?e.drag[0].style.width=e.dragSize+"px":e.drag[0].style.height=e.dragSize+"px",e.divider>=1?e.track[0].style.display="none":e.track[0].style.display="",u.params.scrollbarHide&&(e.track[0].style.opacity=0)},setTranslate:function(){if(!u.params.scrollbar)return;var e,t=u.scrollbar,n=u.translate||0,r,i=t.dragSize;r=(t.trackSize-t.dragSize)*u.progress,u.rtl&&f()?(r=-r,r>0?(i=t.dragSize-r,r=0):-r+t.dragSize>t.trackSize&&(i=t.trackSize+r)):r<0?(i=t.dragSize+r,r=0):r+t.dragSize>t.trackSize&&(i=t.trackSize-r),f()?(u.support.transforms3d?t.drag.transform("translate3d("+r+"px, 0, 0)"):t.drag.transform("translateX("+r+"px)"),t.drag[0].style.width=i+"px"):(u.support.transforms3d?t.drag.transform("translate3d(0px, "+r+"px, 0)"):t.drag.transform("translateY("+r+"px)"),t.drag[0].style.height=i+"px"),u.params.scrollbarHide&&(clearTimeout(t.timeout),t.track[0].style.opacity=1,t.timeout=setTimeout(function(){t.track[0].style.opacity=0,t.track.transition(400)},1e3))},setTransition:function(e){if(!u.params.scrollbar)return;u.scrollbar.drag.transition(e)}},u.controller={setTranslate:function(t,n){function o(e){t=e.rtl&&e.params.direction==="horizontal"?-u.translate:u.translate,i=(e.maxTranslate()-e.minTranslate())/(u.maxTranslate()-u.minTranslate()),s=(t-u.minTranslate())*i+e.minTranslate(),u.params.controlInverse&&(s=e.maxTranslate()-s),e.updateProgress(s),e.setWrapperTranslate(s,!1,u),e.updateActiveIndex()}var r=u.params.control,i,s;if(u.isArray(r))for(var a=0;a<r.length;a++)r[a]!==n&&r[a]instanceof e&&o(r[a]);else r instanceof e&&n!==r&&o(r)},setTransition:function(t,n){function s(e){e.setWrapperTransition(t,u),t!==0&&(e.onTransitionStart(),e.wrapper.transitionEnd(function(){if(!r)return;e.onTransitionEnd()}))}var r=u.params.control,i;if(u.isArray(r))for(i=0;i<r.length;i++)r[i]!==n&&r[i]instanceof e&&s(r[i]);else r instanceof e&&n!==r&&s(r)}},u.hashnav={init:function(){if(!u.params.hashnav)return;u.hashnav.initialized=!0;var e=document.location.hash.replace("#","");if(!e)return;var t=0;for(var n=0,r=u.slides.length;n<r;n++){var i=u.slides.eq(n),s=i.attr("data-hash");if(s===e&&!i.hasClass(u.params.slideDuplicateClass)){var o=i.index();u.slideTo(o,t,u.params.runCallbacksOnInit,!0)}}},setHash:function(){if(!u.hashnav.initialized||!u.params.hashnav)return;document.location.hash=u.slides.eq(u.activeIndex).attr("data-hash")||""}},u.disableKeyboardControl=function(){u.params.keyboardControl=!1,a(document).off("keydown",L)},u.enableKeyboardControl=function(){u.params.keyboardControl=!0,a(document).on("keydown",L)},u._wheelEvent=!1,u._lastWheelScrollTime=(new window.Date).getTime();if(u.params.mousewheelControl){document.onmousewheel!==undefined&&(u._wheelEvent="mousewheel");if(!u._wheelEvent)try{new window.WheelEvent("wheel"),u._wheelEvent="wheel"}catch(A){}u._wheelEvent||(u._wheelEvent="DOMMouseScroll")}u.disableMousewheelControl=function(){return u._wheelEvent?(u.container.off(u._wheelEvent,O),!0):!1},u.enableMousewheelControl=function(){return u._wheelEvent?(u.container.on(u._wheelEvent,O),!0):!1},u.parallax={setTranslate:function(){u.container.children("[data-swiper-parallax], [data-swiper-parallax-x], [data-swiper-parallax-y]").each(function(){M(this,u.progress)}),u.slides.each(function(){var e=a(this);e.find("[data-swiper-parallax], [data-swiper-parallax-x], [data-swiper-parallax-y]").each(function(){var t=Math.min(Math.max(e[0].progress,-1),1);M(this,t)})})},setTransition:function(e){typeof e=="undefined"&&(e=u.params.speed),u.container.find("[data-swiper-parallax], [data-swiper-parallax-x], [data-swiper-parallax-y]").each(function(){var t=a(this),n=parseInt(t.attr("data-swiper-parallax-duration"),10)||e;e===0&&(n=0),t.transition(n)})}},u._plugins=[];for(var _ in u.plugins){var D=u.plugins[_](u,u.params[_]);D&&u._plugins.push(D)}return u.callPlugins=function(e){for(var t=0;t<u._plugins.length;t++)e in u._plugins[t]&&u._plugins[t][e](arguments[1],arguments[2],arguments[3],arguments[4],arguments[5])},u.emitterEventListeners={},u.emit=function(e){u.params[e]&&u.params[e](arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]);var t;if(u.emitterEventListeners[e])for(t=0;t<u.emitterEventListeners[e].length;t++)u.emitterEventListeners[e][t](arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]);u.callPlugins&&u.callPlugins(e,arguments[1],arguments[2],arguments[3],arguments[4],arguments[5])},u.on=function(e,t){return e=P(e),u.emitterEventListeners[e]||(u.emitterEventListeners[e]=[]),u.emitterEventListeners[e].push(t),u},u.off=function(e,t){var n;e=P(e);if(typeof t=="undefined")return u.emitterEventListeners[e]=[],u;if(!u.emitterEventListeners[e]||u.emitterEventListeners[e].length===0)return;for(n=0;n<u.emitterEventListeners[e].length;n++)u.emitterEventListeners[e][n]===t&&u.emitterEventListeners[e].splice(n,1);return u},u.once=function(e,t){e=P(e);var n=function(){t(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4]),u.off(e,n)};return u.on(e,n),u},u.a11y={makeFocusable:function(e){return e[0].tabIndex="0",e},addRole:function(e,t){return e.attr("role",t),e},addLabel:function(e,t){return e.attr("aria-label",t),e},disable:function(e){return e.attr("aria-disabled",!0),e},enable:function(e){return e.attr("aria-disabled",!1),e},onEnterKey:function(e){if(e.keyCode!==13)return;a(e.target).is(u.params.nextButton)?(u.onClickNext(e),u.isEnd?u.a11y.notify(u.params.lastSlideMsg):u.a11y.notify(u.params.nextSlideMsg)):a(e.target).is(u.params.prevButton)&&(u.onClickPrev(e),u.isBeginning?u.a11y.notify(u.params.firstSlideMsg):u.a11y.notify(u.params.prevSlideMsg))},liveRegion:a('<span class="swiper-notification" aria-live="assertive" aria-atomic="true"></span>'),notify:function(e){var t=u.a11y.liveRegion;if(t.length===0)return;t.html(""),t.html(e)},init:function(){if(u.params.nextButton){var e=a(u.params.nextButton);u.a11y.makeFocusable(e),u.a11y.addRole(e,"button"),u.a11y.addLabel(e,u.params.nextSlideMsg)}if(u.params.prevButton){var t=a(u.params.prevButton);u.a11y.makeFocusable(t),u.a11y.addRole(t,"button"),u.a11y.addLabel(t,u.params.prevSlideMsg)}a(u.container).append(u.a11y.liveRegion)},destroy:function(){u.a11y.liveRegion&&u.a11y.liveRegion.length>0&&u.a11y.liveRegion.remove()}},u.init=function(){u.params.loop&&u.createLoop(),u.updateContainerSize(),u.updateSlidesSize(),u.updatePagination(),u.params.scrollbar&&u.scrollbar&&u.scrollbar.set(),u.params.effect!=="slide"&&u.effects[u.params.effect]&&(u.params.loop||u.updateProgress(),u.effects[u.params.effect].setTranslate()),u.params.loop?u.slideTo(u.params.initialSlide+u.loopedSlides,0,u.params.runCallbacksOnInit):(u.slideTo(u.params.initialSlide,0,u.params.runCallbacksOnInit),u.params.initialSlide===0&&(u.parallax&&u.params.parallax&&u.parallax.setTranslate(),u.lazy&&u.params.lazyLoading&&(u.lazy.load(),u.lazy.initialImageLoaded=!0))),u.attachEvents(),u.params.observer&&u.support.observer&&u.initObservers(),u.params.preloadImages&&!u.params.lazyLoading&&u.preloadImages(),u.params.autoplay&&u.startAutoplay(),u.params.keyboardControl&&u.enableKeyboardControl&&u.enableKeyboardControl(),u.params.mousewheelControl&&u.enableMousewheelControl&&u.enableMousewheelControl(),u.params.hashnav&&u.hashnav&&u.hashnav.init(),u.params.a11y&&u.a11y&&u.a11y.init(),u.emit("onInit",u)},u.cleanupStyles=function(){u.container.removeClass(u.classNames.join(" ")).removeAttr("style"),u.wrapper.removeAttr("style"),u.slides&&u.slides.length&&u.slides.removeClass([u.params.slideVisibleClass,u.params.slideActiveClass,u.params.slideNextClass,u.params.slidePrevClass].join(" ")).removeAttr("style").removeAttr("data-swiper-column").removeAttr("data-swiper-row"),u.paginationContainer&&u.paginationContainer.length&&u.paginationContainer.removeClass(u.params.paginationHiddenClass),u.bullets&&u.bullets.length&&u.bullets.removeClass(u.params.bulletActiveClass),u.params.prevButton&&a(u.params.prevButton).removeClass(u.params.buttonDisabledClass),u.params.nextButton&&a(u.params.nextButton).removeClass(u.params.buttonDisabledClass),u.params.scrollbar&&u.scrollbar&&(u.scrollbar.track&&u.scrollbar.track.length&&u.scrollbar.track.removeAttr("style"),u.scrollbar.drag&&u.scrollbar.drag.length&&u.scrollbar.drag.removeAttr("style"))},u.destroy=function(e,t){u.detachEvents(),u.stopAutoplay(),u.params.loop&&u.destroyLoop(),t&&u.cleanupStyles(),u.disconnectObservers(),u.params.keyboardControl&&u.disableKeyboardControl&&u.disableKeyboardControl(),u.params.mousewheelControl&&u.disableMousewheelControl&&u.disableMousewheelControl(),u.params.a11y&&u.a11y&&u.a11y.destroy(),u.emit("onDestroy"),e!==!1&&(u=null)},u.init(),u}return new e(t,n)};e.prototype={isSafari:function(){var e=navigator.userAgent.toLowerCase();return e.indexOf("safari")>=0&&e.indexOf("chrome")<0&&e.indexOf("android")<0}(),isUiWebView:/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(navigator.userAgent),isArray:function(e){return Object.prototype.toString.apply(e)==="[object Array]"},browser:{ie:window.navigator.pointerEnabled||window.navigator.msPointerEnabled,ieTouch:window.navigator.msPointerEnabled&&window.navigator.msMaxTouchPoints>1||window.navigator.pointerEnabled&&window.navigator.maxTouchPoints>1},device:function(){var e=navigator.userAgent,t=e.match(/(Android);?[\s\/]+([\d.]+)?/),n=e.match(/(iPad).*OS\s([\d_]+)/),r=e.match(/(iPod)(.*OS\s([\d_]+))?/),i=!n&&e.match(/(iPhone\sOS)\s([\d_]+)/);return{ios:n||i||n,android:t}}(),support:{touch:window.Modernizr&&Modernizr.touch===!0||function(){return!!("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch)}(),transforms3d:window.Modernizr&&Modernizr.csstransforms3d===!0||function(){var e=document.createElement("div").style;return"webkitPerspective"in e||"MozPerspective"in e||"OPerspective"in e||"MsPerspective"in e||"perspective"in e}(),flexbox:function(){var e=document.createElement("div").style,t="alignItems webkitAlignItems webkitBoxAlign msFlexAlign mozBoxAlign webkitFlexDirection msFlexDirection mozBoxDirection mozBoxOrient webkitBoxDirection webkitBoxOrient".split(" ");for(var n=0;n<t.length;n++)if(t[n]in e)return!0}(),observer:function(){return"MutationObserver"in window||"WebkitMutationObserver"in window}()},plugins:{}};var t=["jQuery","Zepto","Dom7"];for(var r=0;r<t.length;r++)window[t[r]]&&n(window[t[r]]);var i;typeof Dom7=="undefined"?i=window.Dom7||window.Zepto||window.jQuery:i=Dom7,i&&("transitionEnd"in i.fn||(i.fn.transitionEnd=function(e){function s(r){if(r.target!==this)return;e.call(this,r);for(n=0;n<t.length;n++)i.off(t[n],s)}var t=["webkitTransitionEnd","transitionend","oTransitionEnd","MSTransitionEnd","msTransitionEnd"],n,r,i=this;if(e)for(n=0;n<t.length;n++)i.on(t[n],s);return this}),"transform"in i.fn||(i.fn.transform=function(e){for(var t=0;t<this.length;t++){var n=this[t].style;n.webkitTransform=n.MsTransform=n.msTransform=n.MozTransform=n.OTransform=n.transform=e}return this}),"transition"in i.fn||(i.fn.transition=function(e){typeof e!="string"&&(e+="ms");for(var t=0;t<this.length;t++){var n=this[t].style;n.webkitTransitionDuration=n.MsTransitionDuration=n.msTransitionDuration=n.MozTransitionDuration=n.OTransitionDuration=n.transitionDuration=e}return this})),window.Swiper=e}(),typeof module!="undefined"?module.exports=window.Swiper:typeof define=="function"&&define.amd&&define("swiper",[],function(){"use strict";return window.Swiper}),"use strict",define("downloadService",["backbone","dataService","authService","apiService","issueService","stringUtility","dateUtility"],function(e,t,n,r,i,s,o){var u={confirmDownload:{title:"Confirm download",message:"Do you want to download this issue?",cancelButton:"Cancel",okButton:"Yes"},downloadInProgress:{title:"Downloading",message:"This issue is already in progress",cancelButton:"Close"},removeIssue:{title:"Delete",message:"Do you want to remove this issue from your device?",cancelButton:"Cancel",okButton:"Yes"},downloadFail:{title:"Failed to download issue",message:"Please try again at a later time",cancel:"Ok"}},a={setDialogStrings:function(e){e&&(u=e)},tryDownloadIssue:function(e){var n=this,r;if(e.get("downloading")){t.showConfirmationDialog({title:u.downloadInProgress.title,message:u.downloadInProgress.message,type:0,cancelButton:u.downloadInProgress.cancelButton},function(e){});return}r=s.replace(u.confirmDownload.message,{pubdate:o.dateToStringFormat(e.get("pubdate"),"%%weekday%%en den %%date%% %%month%%")}),t.showConfirmationDialog({title:u.confirmDownload.title,message:r,type:1,cancelButton:u.confirmDownload.cancelButton,okButton:u.confirmDownload.okButton},function(r){if(r!==1)return;n.downloadIssue(e,function(e){e.set({downloading:!0,progress:0})},function(n){t.showConfirmationDialog({title:u.downloadFail.title,message:u.downloadFail.message,type:0,cancelButton:u.downloadFail.cancelButton},function(t){e.unset("progress"),e.unset("downloading")})})})},downloadIssue:function(n,s,o){var u=i.fetchIssueById(n.get("id"));u.done(function(n){var i,u=t.getApplicationRootPath(),a=n.get("pubdate"),f=n.get("issueid");t.downloadIssue({issueId:f,url:n.get("files_basepath")+"_issue.json",revision:n.get("revision"),productId:r.getProductId(),callback:function(t,r){i=Math.floor(r);if(!_.isNaN(i)){n.set("progress",i);if(i<100)return;n.set({files_basepath:u+a+"-id-"+t+"/",thumbnails_basepath:u+a+"-id-"+t+"/"}),n.set({downloaded:!0,downloading:!1}),e.trigger("stat:downloadIssue",{issueId:t,issueDate:a,issueRevision:n.get("revision")})}}},function(){s(n)},o)}),u.fail(function(e){console.log(e),o()})},tryRemoveIssue:function(e){var n=this;t.showConfirmationDialog({title:u.removeIssue.title,message:u.removeIssue.message,type:1,cancelButton:u.removeIssue.cancelButton,okButton:u.removeIssue.okButton},function(t){if(t!==1)return;e.set({removing:!0}),setTimeout(function(){n.removeIssue(e,function(e){})},100)},function(){})},removeIssue:function(e,n){t.deleteIssueById(e.get("issueid"),function(t){var r=e.get("api_paths");e.set({files_basepath:r.files_basepath,thumbnails_basepath:r.thumbnails_basepath}),e.set({downloaded:!1,removing:!1}),e.unset("removing",{silent:!0}),e.unset("secretpath",{silent:!0}),n(e)},function(t){var n=e.get("api_paths");e.set({files_basepath:n.files_basepath,thumbnails_basepath:n.thumbnails_basepath}),e.set({downloaded:!1,removing:!1}),e.unset("removing",{silent:!0}),e.unset("secretpath",{silent:!0}),console.log(t)})},tryCancelIssueDownload:function(e){t.cancelDownloadIssue(e.get("issueid"),function(t){if(t!==1)return;e.set({downloading:!1}),e.trigger("downloadCanceled"),e.unset("progress",{silent:!0}),e.unset("downloading",{silent:!0})})}};return a}),define("vendor/text!coverTemplate",[],function(){return'<figure class="cover-object">\n    <div class="issue-overlay-container">\n        <img draggable="false" class="issue-image cover-image" src="<%= thumbnails_basepath + parts.get(partId).get(\'thumbnails\').large %>" />\n    </div>\n</figure>'}),"use strict",define("coverView",["baseView","backbone","downloadService","deviceUtility","vendor/text!coverTemplate"],function(e,t,n,r,i){return e.extend({coverHTMLTemplate:"",events:{tap:"tap","tap .download-icon-container":"downloadIssue","tap .downloaded-icon-container":"deleteIssue","tap .downloading-icon-container":"cancelIssueDownload","tap .remove-icon-container":"removeIconTapped","tap .unpack-icon-container":"unpackIconTapped"},tap:function(){this.issueEntry?t.trigger("tappedIssueEntryCover",{id:this.getIssueId(),partId:this.getPartId()}):t.trigger("tappedCover",this.model)},initialize:function(e){this.init.call(this,e),this.issueId=e.issueId,this.partId=e.partId,this.issueEntry=e.issueEntry,this.progressType=e.viewOptions.progressType||"bar",this.spinnerShowing=!1,this.isDownloaded=this.model.get("downloaded"),this.coverHTMLTemplate=_.template(e.viewTemplate||i),this.bindEvents(),this.addHooks()},downloadIssue:function(e){if(r.isRunningAsHybridApplication)return n.tryDownloadIssue(this.model),e.preventDefault(),e.gesture.preventDefault(),e.stopPropagation(),e.gesture.stopPropagation(),!1},deleteIssue:function(e){if(r.isRunningAsHybridApplication)return n.tryRemoveIssue(this.model),e.preventDefault(),e.gesture.preventDefault(),e.stopPropagation(),e.gesture.stopPropagation(),!1},cancelIssueDownload:function(e){if(r.isRunningAsHybridApplication)return n.tryCancelIssueDownload(this.model),e.preventDefault(),e.gesture.preventDefault(),e.stopPropagation(),e.gesture.stopPropagation(),!1},removeIconTapped:function(e){if(r.isRunningAsHybridApplication)return e.preventDefault(),e.gesture.preventDefault(),e.stopPropagation(),e.gesture.stopPropagation(),!1},unpackIconTapped:function(e){if(r.isRunningAsHybridApplication)return e.preventDefault(),e.gesture.preventDefault(),e.stopPropagation(),e.gesture.stopPropagation(),!1},addHooks:function(){this.addHook.call(this,"afterRender",function(){this.$el.addClass(this.progressType),r.isRunningAsHybridApplication||this.$(".cover-icon-container.bottom-right-icon").remove()})},bindEvents:function(){this.unbindEvents(),this.model.on("change:downloaded",this.changeDownloadedCallback,this),this.model.on("change:progress",this.changeProgressCallback,this),this.model.on("change:downloading",this.changeDownloadingCallback,this),this.model.on("change:removing",this.changeRemovingCallback,this),this.model.on("downloadCanceled",this.changeDownloadCanceledCallback,this),this.model.on("change:unpacking",this.changeUnpackingCallback,this)},unbindEvents:function(){this.model.off("change:downloaded"),this.model.off("change:progress"),this.model.off("change:downloading"),this.model.off("change:removing"),this.model.off("downloadCanceled"),this.model.off("change:unpacking")},changeDownloadedCallback:function(e,t){this.isDownloaded=t,this.setCorrectDownloadIcon(t)},changeProgressCallback:function(e,t){this.isDownloaded||(t>=99?this.triggerUnpackingState(e,t):this.updateProgress(t))},changeDownloadingCallback:function(e,t){t?(this.$el.addClass("downloading-issue"),this.hideIcon("download").showIcon("downloading").showProgressElement()):(this.$el.removeClass("downloading-issue"),this.hideIcon("downloading").hideProgressElement())},changeRemovingCallback:function(e,t){t?this.showIcon("removing").showSpinner():this.hideIcon("removing").hideSpinner()},changeUnpackingCallback:function(e,t){t?this.showIcon("unpack").showSpinner():this.hideIcon("unpack").hideSpinner()},changeDownloadCanceledCallback:function(e){this.showIcon("download")},triggerUnpackingState:function(e,t){t===99&&(this.model.set({unpacking:!0}),this.changeDownloadingCallback(e,!1)),t===100&&(this.model.set({unpacking:!1}),this.model.unset("unpacking",{silent:!0}))},getIssueId:function(){return this.issueId},getPartId:function(){return this.partId},render:function(){var e=this,t,n=this.model.get("thumbnails_basepath"),r=this.model.get("parts").get(this.partId).get("thumbnails");return this.generateTemplateModel(),this.templateModel.partId=this.partId,this.$el.html(this.coverHTMLTemplate(this.templateModel)),t=this.$("img"),t.attr("src")||(this.$el.addClass("invisible").find(".download-icon-btn").addClass("hide-btn"),t.on("load",function(){this.width>256&&r.xlarge&&(this.src=n+r.xlarge),e.$el.delay(400).removeClass("invisible").find(".download-icon-btn").delay(200).removeClass("hide-btn"),t.off("load")}).attr("src",n+r.large)),this.updateCurrentIconState(this.model),this},updateCurrentIconState:function(e){return e.get("downloading")?(this.changeDownloadingCallback(e,!0),e.get("progress")&&this.changeProgressCallback(e,e.get("progress"))):e.get("removing")?this.changeRemovingCallback(e,!0):this.changeDownloadedCallback(e,e.get("downloaded")),this},hideElement:function(e){return this.$(e).addClass("hidden"),this},hideIcon:function(e){return this.$(".cover-icon-container").removeClass(e+"-icon-container"),this},hideProgressElement:function(){return this.progressType==="bar"?this.hideElement(".progress"):this.progressType==="radial"&&this.hideElement(".progress-radial"),this},hideSpinner:function(){return this.spinnerShowing&&(this.progressType==="bar"?this.$(".progress-bar").css("width",0):this.progressType==="radial"&&this.$(".progress-radial").removeClass("progress-spinner"),this.spinnerShowing=!1),this},onProgressChange:function(e){e=e||0,e=e>100?100:e;var t=e>0&&e<100;t&&this.updateProgress(e)},setCorrectDownloadIcon:function(e){return e=e||this.model.get("downloaded"),this.updateDownloadedIcon(e).updateDownloadIcon(e),this},setIndicationOfFailedDownload:function(){return this.$(".downloaded-icon").addClass("failed"),this},showIcon:function(e){return this.$el.attr("state",e).find(".cover-icon-container").addClass(e+"-icon-container"),this},showElement:function(e){return this.$(e).removeClass("hidden"),this},showProgressElement:function(){return this.progressType==="bar"?this.showElement(".progress"):this.progressType==="radial"&&this.showElement(".progress-radial"),this},showSpinner:function(){return this.spinnerShowing||(this.progressType!=="bar"&&this.progressType==="radial"&&this.$(".progress-radial").removeClass(this.currentProgressClass).addClass("progress-spinner"),this.spinnerShowing=!0),this},updateDownloadIcon:function(e){return e?this.hideIcon("download"):this.showIcon("download"),this},updateDownloadedIcon:function(e){return e?this.showIcon("downloaded"):this.hideIcon("downloaded"),this},updateProgress:function(e){if(this.progressType==="bar")this.$(".progress-bar").css("width",e+"%");else if(this.progressType==="radial"){this.currentProgressClass=this.currentProgressClass||"progress-0";var t="progress-"+e;this.$(".progress-radial").removeClass(this.currentProgressClass).addClass(t),this.currentProgressClass=t}}})}),define("vendor/text!components/issueEntry/templates/issueEntryPartView.html",[],function(){return'<figure class="cover-object">\n    <div class="issue-overlay-container">\n        <img draggable="false" class="issue-image cover-image" data-partId="<%= part.id %>" src="<%= basePath + part.thumbnails.large %>" />\n    </div>\n</figure>\n'}),"use strict",define("issueEntryPartView",["baseView","vendor/text!components/issueEntry/templates/issueEntryPartView.html"],function(e,t){return e.extend({className:"cover part-slide",events:{tap:"tap"},tap:function(){Backbone.trigger("tappedIssueEntryCover",{id:this.model.get("issueId"),partId:this.model.get("part").id})},initialize:function(e){this.init.call(this,e),this.template=_.template(t),this.addHook.call(this,"beforeClose",function(){delete this.template})},render:function(){return this.$el.html(this.template(this.templateModel)),this}})}),define("vendor/text!components/issueEntry/templates/coverView.html",[],function(){return'<figure class="cover-object">\n    <div class="issue-overlay-container">\n        <img draggable="false" class="issue-image cover-image" src="<%= thumbnails_basepath + parts.get(partId).get(\'thumbnails\').large %>" />\n    </div>\n</figure>'}),define("vendor/text!components/issueEntry/templates/issueEntryView.html",[],function(){return'<div class="issue-entry-swiper-container">\n    <div class="issue-entry-cover issue-entry-part-list issue-entry-swiper-wrapper"></div>\n</div>\n'}),define("vendor/text!components/issueEntry/templates/issueParts.html",[],function(){return'<li class="part-slide swiper-slide issue-entry-part-item part-item-<%= index %>">\n    <div class="part-slide-image-wrapper">\n        <img draggable="false" class="issue-image cover-image" data-partId="<%= part.id %>" src="<%= basePath + part.thumbnails.large %>" />\n    </div>\n</li>\n'}),"use strict",define("issueEntryView",["backbone","swiper","underscore","jquery","baseView","deviceUtility","coverView","issueEntryPartView","downloadService","vendor/text!components/issueEntry/templates/coverView.html","vendor/text!components/issueEntry/templates/issueEntryView.html","vendor/text!components/issueEntry/templates/issueParts.html"],function(e,t,n,r,i,s,o,u,a,f,l,c){return i.extend({className:"issue-entry",initialize:function(e){this.init(e),this.viewTemplate=n.template(l),this.partsTemplate=n.template(c),this.parts=this.model.get("parts"),this.templateModel.parts=this.parts,this.bindEvents(),this.addHooks(e)},bindEvents:function(){return this.unbindEvents(),e.on("tappedIssueEntryCover",this.tappedCover,this),e.on("done:dateFeature",this.dateFeatureDone,this),e.on("done:downloadIssueIconFeature",this.downloadIssueIconFeatureDone,this),this},unbindEvents:function(){return e.off("tappedIssueEntryCover"),e.off("done:dateFeature",this.dateFeatureDone,this),e.off("done:downloadIssueIconFeature",this.downloadIssueIconFeatureDone,this),this},addHooks:function(e){this.addHook.call(this,"beforeRender",function(){this.$el.addClass("invisible"),this.setApplicationClass("not-scrollable "+e.viewOptions.componentName),e.viewOptions.fixed&&this.setApplicationClass("fixed")}),this.addHook.call(this,"beforeClose",function(){this.removeApplicationClass("not-scrollable "+e.viewOptions.componentName),e.viewOptions.fixed&&this.removeApplicationClass("fixed"),this.swiper&&(this.swiper.destroy(),this.swiper=null),delete this.viewTemplate,delete this.partsTemplate}),this.addHook.call(this,"afterRender",function(){this.$el.removeClass("invisible")})},dateFeatureDone:function(){e.trigger("setDate",this.model.get("pubdate"))},downloadIssueIconFeatureDone:function(t){e.trigger("setDownloaded",this.model.get("downloaded")),t.set("issueModel",this.model),this.model.on("change:downloaded",function(t,n){e.trigger("setDownloaded",n)})},getIssueCoverHTML:function(){var e=new o({className:"cover",issueEntry:!0,strings:this.strings.coverView,viewOptions:this.viewOptions,model:this.model,viewTemplate:f,issueId:this.model.get("id"),partId:this.parts.at(0).get("id")});this.addView.call(this,e,this.$(".issue-entry-cover"))},insertIssueParts:function(){var t;for(var n=1,i=this.parts.length;n<i;n++)t=new u({model:new e.Model({issueId:this.model.get("id"),part:this.parts.at(n).toJSON(),basePath:this.model.get("thumbnails_basepath"),index:n})}),this.addView.call(this,t,this.$(".issue-entry-part-list"));this.$(".issue-entry-part-list").append(r("<div class='clearfix'>"))},tappedCover:function(t){e.trigger("popup:close"),e.trigger("setRoute",{route:this.viewOptions.route+"/"+t.id+"/"+t.partId+"/1",trigger:!0})},render:function(){return this.$el.html(this.viewTemplate(this.templateModel)),this.getIssueCoverHTML(),this.viewOptions.displayCoversForIssueParts&&this.insertIssueParts(),this.scrollTouchFix(this.$(".issue-entry-part-list")),this}})}),"use strict",define("issueEntryComponent",["backbone","app","underscore","baseComponent","stateService","issueService","issueEntryView"],function(e,t,n,r,i,s,o){var u=n.extend({},r);return u.name="issueEntry",u.routes={"entry/:issueId":function(t){var n=s.getIssueModelFromCollectionById(t);if(!n||!u.primary){e.trigger("setRoute",{route:"issues/"+t,trigger:!0});return}u.open({model:n})}},u.view=o,u.features=[],u.open=function(n){var r=this;n=n||{},s.setCurrentIssueModel(n.model),t.renderComponentView(u,n,function(t){r.primary&&e.trigger("header:open",r.viewOptions.headerOptions||{}),u.renderFeatures(),u.ready(n.componentReady)})},u.beforeClose=function(){s.setCurrentIssueModel(!1)},u.closeComponent=function(){t.closeComponent(u),i.removeState(["issueId"])},e.on(u.name+":open",u.open,u),e.on(u.name+":beforeClose",u.beforeClose,u),e.on(u.name+":close",u.closeComponent,u),u}),"use strict",define("baseFeatureView",["baseView"],function(e){return e.extend()}),define("baseFeatureModel",["backbone"],function(e){"use strict";return e.Model.extend({tapped:function(e){this.onTapped(e)},onTapped:function(e){return this}})}),"use strict",define("baseFeature",["backbone","underscore","baseFeatureView","viewUtility","baseFeatureModel"],function(e,t,n,r,i){return{setView:function(e){return this.view=e,this},setModel:function(e){return this.model=e||new i,this},setName:function(e){return this.name=e,this},setCloseEvents:function(e){return t.isArray(e)?this.closeEvents=e:this.closeEvents=[],this},setContexts:function(e){return this.contexts=e,this},setPrepend:function(e){return this.prepend=e,this},setModelDefaults:function(e){return this.model.set(e),this},setStrings:function(e){return this.strings=e,this},render:function(){var e,t={strings:this.strings,model:this.model};return this.strings&&this.strings.tooltip&&typeof this.strings.tooltip=="string"&&(t.attributes={title:this.strings.tooltip}),this.hasOwnProperty("contexts")&&this.contexts.forEach(function(n){t.context=n,e=new this.view(t),r.addView.call(this,e),this.prepend?r.prependView(e):r.appendView(e)},this),this},close:function(){return this.closeEvents.forEach(function(t){e.trigger(t)}),r.close.call(this),this},triggerDone:function(){return e.trigger("done:"+this.name,this.model),this.bindCloseFeature(),this},bindCloseFeature:function(){e.on("closeFeature:"+this.name,this.close,this)},remove:function(){},unbind:function(){},unbindEvents:function(){}}}),"use strict",define("coversIconModel",["backbone","baseFeatureModel"],function(e,t){return t.extend({initialize:function(){e.on("setRoute",function(e){this.setActive(e)},this)},setActive:function(e){e.route&&e.route==="issues"?this.set("active",!0):this.set("active",!1)},onTapped:function(){return e.trigger("setRoute",{route:"issues",trigger:!0}),this}})}),define("vendor/text!features/iconLinks/templates/iconLinkTemplate.html",[],function(){return'<% if (iconName) { %>\n<span class="icon-link-icon"><i class="<%= iconName %>"></i></span>\n<% } %>\n<% if (iconText) { %>\n<span class="icon-link-text"><%= iconText %></span>\n<% } %>\n'}),"use strict",define("coversIconView",["baseFeatureView","underscore","vendor/text!features/iconLinks/templates/iconLinkTemplate.html"],function(e,t,n){return e.extend({className:"covers-icon icon-link ",events:{tap:"tap"},tap:function(){this.model.tapped.call(this.model)},initialize:function(e){this.init(e),this.coversIconHTML=t.template(n),this.bindEvents()},bindEvents:function(){return this.unbindEvents(),this.model.on("change:active",this.render,this),this},unbindEvents:function(){return this.model.off("change:active",this.render,this),this},render:function(){var e=this.model.get("active");return this.$el.html(this.coversIconHTML({iconName:this.model.get("iconName"),iconText:this.strings.iconText})),this.$el.addClass(this.model.get("className")),e?this.$el.addClass("active"):this.$el.removeClass("active"),this}})}),"use strict",define("coversIconFeature",["backbone","underscore","baseFeature","coversIconModel","coversIconView"],function(e,t,n,r,i){return function(){this.feature=t.extend({},n);var e=new r;this.feature.setView.call(this.feature,i).setModel.call(this.feature,e)}}),"use strict",define("textOutletModel",["baseFeatureModel"],function(e){return e.extend({})}),define("vendor/text!features/textOutlet/templates/textOutletTemplate.html",[],function(){return"<%= textContent %>"}),"use strict",define("textOutletView",["baseFeatureView","vendor/text!features/textOutlet/templates/textOutletTemplate.html"],function(e,t){return e.extend({className:"",initialize:function(e){this.init(e),this.outletHTML=_.template(t)},render:function(){return this.$el.addClass(this.model.get("className")),this.$el.html(this.outletHTML({textContent:this.strings.textContent})),this}})}),"use strict",define("textOutletFeature",["underscore","baseFeature","textOutletModel","textOutletView"],function(e,t,n,r){return function(){this.feature=e.extend({},t),this.feature.setView.call(this.feature,r).setModel.call(this.feature,new n)}}),"use strict",define("dateModel",["baseModel","dateUtility"],function(e,t){return e.extend({defaults:{date:t.getDateString()},setDate:function(e){this.set("date",e)}})}),define("vendor/text!features/date/templates/dateTemplate.html",[],function(){return'<% var dateText = StringUtility.replace(strings.formattedPubDate.text, {pubdate: DateUtility.dateToStringFormat(date, dateFormat)}); %>\n<span class="date-display"><%= dateText %></span>'}),"use strict",define("dateView",["baseFeatureView","dateUtility","vendor/text!features/date/templates/dateTemplate.html"],function(e,t,n){return e.extend({className:"date-display-container",id:function(){return"date:"+this.cid},initialize:function(e){this.init(e),this.dateTemplate=_.template(n),this.bindEvents()},bindEvents:function(){this.unbindEvents(),Backbone.on("setDate",this.model.setDate,this.model),this.model.on("change:date",function(){this.generateTemplateModel(),this.render()},this)},unbindEvents:function(){Backbone.off("setDate")},render:function(){return this.$el.html(this.dateTemplate(this.templateModel)),this.$el.addClass(this.model.get("className")),this}})}),"use strict",define("dateFeature",["baseFeature","dateModel","dateView"],function(e,t,n){return function(){this.feature=_.extend({},e),this.feature.setView.call(this.feature,n).setModel.call(this.feature,new t)}}),function(e){function o(){function r(t,n){var r=function(e){t.toLowerCase().indexOf(e)>-1&&i.push(e)},i=[];if(typeof t!="string")return!1;if(e.isArray(n))for(var s=0;s<n.length;s++)r(n[s]);else r(n),n=[n];return n.length===i.length}var t=0,n;if(!s)return;for(var o in document.styleSheets){if(!document.styleSheets[o].disabled){n=document.styleSheets[o].cssRules;if(n)for(var u in n)n[u].cssText&&r(n[u].cssText,s)&&(t+=1);t&&(document.styleSheets[o].disabled=!0,i=document.styleSheets[o])}t=0}}var t=[".ad","adbox","adcontainer","sponsor"],n=3e3,r,i,s;e.blockAdblockCSS=function(u){var a=e("style:empty");if(u.removeEmptyStyleTags){a.remove();return}a.each(function(t,n){e("head").prepend(n)}),u.texts?s=u.texts:s||(s=t),u.block&&(r=window.setInterval(o,u.intervalTime?u.intervalTime:n),o()),u.hasOwnProperty("block")&&!u.block&&(window.clearInterval(r),i&&(i.disabled=!1,s=null))}}(jQuery),define("blockAdblockCSS",["jquery"],function(e){return function(){var t,n;return t||e.blockAdBlockCSS}}(this)),define("vendor/text!core/templates/sidebar.html",[],function(){return'<div class="sidebar-inner"></div>\n'}),"use strict",define("sidebarView",["backbone","deviceUtility","jquery","baseView","vendor/text!core/templates/sidebar.html"],function(e,t,n,r,i){return r.extend({leftPositionedClass:"left-sidebar",rightPositionedClass:"right-sidebar",position:"left",tagName:"aside",className:"sidebar update-on-android",events:{tap:"tap"},initialize:function(t){var r={position:"right"};this.sidebarHTMLTemplate=_.template(i),t=n.extend(r,t),this.hidden=t.hidden,this.position=t.position,this.transitTime=t.transitTime,this.hideOnTap=t.hideOnTap,this.animate=t.animate,this.externalClassName=t.externalClassName,this.bindEvents(),this.notify(this.hidden,!1),e.trigger("sidebar:initialized"),this.addHooks(),this.setApplicationClass("has-sidebar-content")},tap:function(t){(this.hideOnTap||n(t.target).hasClass(this.externalClassName))&&this.closeSidebar()},scroll:function(){e.trigger("sidebarScroll")},addHooks:function(){this.addHook.call(this,"afterRender",function(){this.$(".sidebar-inner").bind("scroll",this.scroll)}),this.addHook.call(this,"beforeClose",function(){this.$(".sidebar-inner").unbind("scroll",this.scroll),this.removeApplicationClass("sidebar-is-hidden has-sidebar-content")})},bindEvents:function(){e.on("sidebar:toggle",this.toggleSidebar,this),e.on("sidebar:open",this.openSidebar,this),e.on("sidebar:close",this.closeSidebar,this),e.on("sidebar:startHiddenOnSmallDevices",this.startHiddenOnSmallDevices,this)},unbindEvents:function(){e.off("sidebar:toggle",this.toggleSidebar,this),e.off("sidebar:open",this.openSidebar,this),e.off("sidebar:close",this.closeSidebar,this),e.off("sidebar:startHiddenOnSmallDevices",this.startHiddenOnSmallDevices,this)},toggleSidebar:function(){this.androidHeightFix(),this.animate&&this.$el.addClass("animate"),this.$el.toggleClass("move-"+this.position),this.hidden=!this.hidden,this.hidden?this.setApplicationClass("sidebar-is-hidden"):this.removeApplicationClass("sidebar-is-hidden"),this.notify(this.hidden,!0)},openSidebar:function(){this.animate&&this.$el.addClass("animate"),this.$el.removeClass("move-"+this.position),this.hidden=!1,this.removeApplicationClass("sidebar-is-hidden"),this.notify(this.hidden,!0)},closeSidebar:function(){this.animate&&this.$el.addClass("animate"),this.$el.addClass("move-"+this.position),this.hidden=!0,this.setApplicationClass("sidebar-is-hidden"),this.notify(this.hidden,!0)},startHiddenOnSmallDevices:function(){this.hidden=!0},androidHeightFix:function(){t.isAndroid()&&this.$("#articles-list").height(n("#reader-container").height()+1)},notify:function(t,n){var r={position:this.position,transitTime:this.transitTime,animate:n};t?e.trigger("sidebar:hide",r):e.trigger("sidebar:show",r)},setPosition:function(e){var t=this.leftPositionedClass;e==="right"&&(this.position="right",this.$(".left-dropdown-list").removeClass("left-dropdown-list").addClass("right-dropdown-list"),t=this.rightPositionedClass),this.hidden&&this.$el.addClass("move-"+this.position),this.$el.addClass(t)},orientationChange:function(){this.resetScrollTouchFix(this.$(".sidebar-inner")),this.androidHeightFix()},render:function(t){var n;return e.trigger("sidebar:beforeRender"),this.$el.html(this.sidebarHTMLTemplate()),this.$el.addClass(this.externalClassName),n=this.$(".sidebar-inner"),n.html(t),this.setPosition(this.position),this.resetScrollTouchFix(n),e.trigger("sidebar:rendered"),e.trigger("sidebar:afterRender"),this}})}),define("IScroll",[],function(){function n(e,n){this.wrapper=typeof e=="string"?document.querySelector(e):e,this.scroller=this.wrapper.children[0],this.scrollerStyle=this.scroller.style,this.options={zoomMin:1,zoomMax:4,startZoom:1,resizeScrollbars:!0,mouseWheelSpeed:20,snapThreshold:.334,floorScale:!1,startX:0,startY:0,scrollY:!0,directionLockThreshold:5,momentum:!0,bounce:!0,bounceTime:600,bounceEasing:"",preventDefault:!0,preventDefaultException:{tagName:/^(INPUT|TEXTAREA|BUTTON|SELECT)$/},HWCompositing:!0,useTransition:!0,useTransform:!0};for(var r in n)this.options[r]=n[r];this.translateZ=this.options.HWCompositing&&t.hasPerspective?" translateZ(0)":"",this.options.useTransition=t.hasTransition&&this.options.useTransition,this.options.useTransform=t.hasTransform&&this.options.useTransform,this.options.eventPassthrough=this.options.eventPassthrough===!0?"vertical":this.options.eventPassthrough,this.options.preventDefault=!this.options.eventPassthrough&&this.options.preventDefault,this.options.scrollY=this.options.eventPassthrough=="vertical"?!1:this.options.scrollY,this.options.scrollX=this.options.eventPassthrough=="horizontal"?!1:this.options.scrollX,this.options.freeScroll=this.options.freeScroll&&!this.options.eventPassthrough,this.options.directionLockThreshold=this.options.eventPassthrough?0:this.options.directionLockThreshold,this.options.bounceEasing=typeof this.options.bounceEasing=="string"?t.ease[this.options.bounceEasing]||t.ease.circular:this.options.bounceEasing,this.options.resizePolling=this.options.resizePolling===undefined?60:this.options.resizePolling,this.options.tap===!0&&(this.options.tap="tap"),this.options.shrinkScrollbars=="scale"&&(this.options.useTransition=!1),this.options.invertWheelDirection=this.options.invertWheelDirection?-1:1,this.x=0,this.y=0,this.directionX=0,this.directionY=0,this._events={},this.scale=Math.min(Math.max(this.options.startZoom,this.options.zoomMin),this.options.zoomMax),this._init(),this.refresh(),this.scrollTo(this.options.startX,this.options.startY),this.enable()}function r(e,t,n){var r=document.createElement("div"),i=document.createElement("div");return n===!0&&(r.style.cssText="position:absolute;z-index:9999",i.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:absolute;background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.9);border-radius:3px"),i.className="iScrollIndicator",e=="h"?(n===!0&&(r.style.cssText+=";height:7px;left:2px;right:2px;bottom:0",i.style.height="100%"),r.className="iScrollHorizontalScrollbar"):(n===!0&&(r.style.cssText+=";width:7px;bottom:2px;top:2px;right:1px",i.style.width="100%"),r.className="iScrollVerticalScrollbar"),r.style.cssText+=";overflow:hidden",t||(r.style.pointerEvents="none"),r.appendChild(i),r}function i(e,n){this.wrapper=typeof n.el=="string"?document.querySelector(n.el):n.el,this.wrapperStyle=this.wrapper.style,this.indicator=this.wrapper.children[0],this.indicatorStyle=this.indicator.style,this.scroller=e,this.options={listenX:!0,listenY:!0,interactive:!1,resize:!0,defaultScrollbars:!1,shrink:!1,fade:!1,speedRatioX:0,speedRatioY:0};for(var r in n)this.options[r]=n[r];this.sizeRatioX=1,this.sizeRatioY=1,this.maxPosX=0,this.maxPosY=0,this.options.interactive&&(this.options.disableTouch||(t.addEvent(this.indicator,"touchstart",this),t.addEvent(document,"touchend",this)),this.options.disablePointer||(t.addEvent(this.indicator,"MSPointerDown",this),t.addEvent(document,"MSPointerUp",this)),this.options.disableMouse||(t.addEvent(this.indicator,"mousedown",this),t.addEvent(document,"mouseup",this))),this.options.fade&&(this.wrapperStyle[t.style.transform]=this.scroller.translateZ,this.wrapperStyle[t.style.transitionDuration]=t.isBadAndroid?"0.001s":"0ms",this.wrapperStyle.opacity="0")}var e=window.requestAnimationFrame,t=function(){function r(e){return n===!1?!1:n===""?e:n+e.charAt(0).toUpperCase()+e.substr(1)}var e={},t=document.createElement("div").style,n=function(){var e=["t","webkitT","MozT","msT","OT"],n,r=0,i=e.length;for(;r<i;r++){n=e[r]+"ransform";if(n in t)return e[r].substr(0,e[r].length-1)}return!1}();e.getTime=Date.now||function(){return(new Date).getTime()},e.extend=function(e,t){for(var n in t)e[n]=t[n]},e.addEvent=function(e,t,n,r){e.addEventListener(t,n,!!r)},e.removeEvent=function(e,t,n,r){e.removeEventListener(t,n,!!r)},e.momentum=function(e,t,n,r,i,s){var o=e-t,u=Math.abs(o)/n,a,f;return s=s===undefined?6e-4:s,a=e+u*u/(2*s)*(o<0?-1:1),f=u/s,a<r?(a=i?r-i/2.5*(u/8):r,o=Math.abs(a-e),f=o/u):a>0&&(a=i?i/2.5*(u/8):0,o=Math.abs(e)+a,f=o/u),{destination:Math.round(a),duration:f}};var i=r("transform");return e.extend(e,{hasTransform:i!==!1,hasPerspective:r("perspective")in t,hasTouch:"ontouchstart"in window,hasPointer:navigator.msPointerEnabled,hasTransition:r("transition")in t}),e.isBadAndroid=/Android /.test(window.navigator.appVersion)&&!/Chrome\/\d/.test(window.navigator.appVersion),e.extend(e.style={},{transform:i,transitionTimingFunction:r("transitionTimingFunction"),transitionDuration:r("transitionDuration"),transitionDelay:r("transitionDelay"),transformOrigin:r("transformOrigin")}),e.hasClass=function(e,t){var n=new RegExp("(^|\\s)"+t+"(\\s|$)");return n.test(e.className)},e.addClass=function(t,n){if(e.hasClass(t,n))return;var r=t.className.split(" ");r.push(n),t.className=r.join(" ")},e.removeClass=function(t,n){if(!e.hasClass(t,n))return;var r=new RegExp("(^|\\s)"+n+"(\\s|$)","g");t.className=t.className.replace(r," ")},e.offset=function(e){var t=-e.offsetLeft,n=-e.offsetTop;while(e=e.offsetParent)t-=e.offsetLeft,n-=e.offsetTop;return{left:t,top:n}},e.preventDefaultException=function(e,t){for(var n in t)if(t[n].test(e[n]))return!0;return!1},e.extend(e.eventType={},{touchstart:1,touchmove:1,touchend:1,mousedown:2,mousemove:2,mouseup:2,MSPointerDown:3,MSPointerMove:3,MSPointerUp:3}),e.extend(e.ease={},{quadratic:{style:"cubic-bezier(0.25, 0.46, 0.45, 0.94)",fn:function(e){return e*(2-e)}},circular:{style:"cubic-bezier(0.1, 0.57, 0.1, 1)",fn:function(e){return Math.sqrt(1- --e*e)}},back:{style:"cubic-bezier(0.175, 0.885, 0.32, 1.275)",fn:function(e){var t=4;return(e-=1)*e*((t+1)*e+t)+1}},bounce:{style:"",fn:function(e){return(e/=1)<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375}},elastic:{style:"",fn:function(e){var t=.22,n=.4;return e===0?0:e==1?1:n*Math.pow(2,-10*e)*Math.sin((e-t/4)*2*Math.PI/t)+1}}}),e.tap=function(e,t){var n=document.createEvent("Event");n.initEvent(t,!0,!0),n.pageX=e.pageX,n.pageY=e.pageY,e.target.dispatchEvent(n)},e.click=function(e){var t=e.target,n;/(SELECT|INPUT|TEXTAREA)/i.test(t.tagName)||(n=document.createEvent("MouseEvents"),n.initMouseEvent("click",!0,!0,e.view,1,t.screenX,t.screenY,t.clientX,t.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,0,null),n._constructed=!0,t.dispatchEvent(n))},e}();return n.prototype={version:"5.1.1",_init:function(){this._initEvents(),this.options.zoom&&this._initZoom(),(this.options.scrollbars||this.options.indicators)&&this._initIndicators(),this.options.mouseWheel&&this._initWheel(),this.options.snap&&this._initSnap(),this.options.keyBindings&&this._initKeys()},destroy:function(){this._initEvents(!0),this._execEvent("destroy")},_transitionEnd:function(e){if(e.target!=this.scroller||!this.isInTransition)return;this._transitionTime(),this.resetPosition(this.options.bounceTime)||(this.isInTransition=!1,this._execEvent("scrollEnd"))},_start:function(e){if(t.eventType[e.type]!=1&&e.button!==0)return;if(!this.enabled||this.initiated&&t.eventType[e.type]!==this.initiated)return;this.options.preventDefault&&!t.isBadAndroid&&!t.preventDefaultException(e.target,this.options.preventDefaultException)&&e.preventDefault();var n=e.touches?e.touches[0]:e,r;this.initiated=t.eventType[e.type],this.moved=!1,this.distX=0,this.distY=0,this.directionX=0,this.directionY=0,this.directionLocked=0,this._transitionTime(),this.startTime=t.getTime(),this.options.useTransition&&this.isInTransition?(this.isInTransition=!1,r=this.getComputedPosition(),this._translate(Math.round(r.x),Math.round(r.y)),this._execEvent("scrollEnd")):!this.options.useTransition&&this.isAnimating&&(this.isAnimating=!1,this._execEvent("scrollEnd")),this.startX=this.x,this.startY=this.y,this.absStartX=this.x,this.absStartY=this.y,this.pointX=n.pageX,this.pointY=n.pageY,this._execEvent("beforeScrollStart")},_move:function(e){if(!this.enabled||t.eventType[e.type]!==this.initiated)return;this.options.preventDefault&&!t.preventDefaultException(e.target,this.options.preventDefaultException)&&e.preventDefault();var n=e.touches?e.touches[0]:e,r=n.pageX-this.pointX,i=n.pageY-this.pointY,s=t.getTime(),o,u,a,f;this.pointX=n.pageX,this.pointY=n.pageY,this.distX+=r,this.distY+=i,a=Math.abs(this.distX),f=Math.abs(this.distY);if(s-this.endTime>300&&a<10&&f<10)return;!this.directionLocked&&!this.options.freeScroll&&(a>f+this.options.directionLockThreshold?this.directionLocked="h":f>=a+this.options.directionLockThreshold?this.directionLocked="v":this.directionLocked="n");if(this.directionLocked=="h"){if(this.options.eventPassthrough=="vertical")e.preventDefault();else if(this.options.eventPassthrough=="horizontal"){this.initiated=!1;return}i=0}else if(this.directionLocked=="v"){if(this.options.eventPassthrough=="horizontal")e.preventDefault();else if(this.options.eventPassthrough=="vertical"){this.initiated=!1;return}r=0}r=this.hasHorizontalScroll?r:0,i=this.hasVerticalScroll?i:0,o=this.x+r,u=this.y+i;if(o>0||o<this.maxScrollX)o=this.options.bounce?this.x+r/3:o>0?0:this.maxScrollX;if(u>0||u<this.maxScrollY)u=this.options.bounce?this.y+i/3:u>0?0:this.maxScrollY;this.directionX=r>0?-1:r<0?1:0,this.directionY=i>0?-1:i<0?1:0,this.moved||this._execEvent("scrollStart"),this.moved=!0,this._translate(o,u),s-this.startTime>300&&(this.startTime=s,this.startX=this.x,this.startY=this.y)},_end:function(e){if(t.eventType[e.type]!==this.initiated)return;this.options.preventDefault&&!t.preventDefaultException(e.target,this.options.preventDefaultException)&&e.preventDefault();var n=e.changedTouches?e.changedTouches[0]:e,r,i,s=t.getTime()-this.startTime,o=Math.round(this.x),u=Math.round(this.y),a=Math.abs(o-this.startX),f=Math.abs(u-this.startY),l=0,c="";this.isInTransition=0,this.initiated=0,this.endTime=t.getTime();if(this.resetPosition(this.options.bounceTime))return;this.scrollTo(o,u);if(!this.moved){this.options.tap&&t.tap(e,this.options.tap),this.options.click&&t.click(e),this._execEvent("scrollCancel");return}if(this._events.flick&&s<200&&a<100&&f<100){this._execEvent("flick");return}this.options.momentum&&s<300&&(r=this.hasHorizontalScroll?t.momentum(this.x,this.startX,s,this.maxScrollX,this.options.bounce?this.wrapperWidth:0,this.options.deceleration):{destination:o,duration:0},i=this.hasVerticalScroll?t.momentum(this.y,this.startY,s,this.maxScrollY,this.options.bounce?this.wrapperHeight:0,this.options.deceleration):{destination:u,duration:0},o=r.destination,u=i.destination,l=Math.max(r.duration,i.duration),this.isInTransition=1);if(this.options.snap){var h=this._nearestSnap(o,u);this.currentPage=h,l=this.options.snapSpeed||Math.max(Math.max(Math.min(Math.abs(o-h.x),1e3),Math.min(Math.abs(u-h.y),1e3)),300),o=h.x,u=h.y,this.directionX=0,this.directionY=0,c=this.options.bounceEasing}if(o!=this.x||u!=this.y){if(o>0||o<this.maxScrollX||u>0||u<this.maxScrollY)c=t.ease.quadratic;this.scrollTo(o,u,l,c);return}this._execEvent("scrollEnd")},_resize:function(){var e=this;clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout(function(){e.refresh()},this.options.resizePolling)},resetPosition:function(e){var t=this.x,n=this.y;return e=e||0,!this.hasHorizontalScroll||this.x>0?t=0:this.x<this.maxScrollX&&(t=this.maxScrollX),!this.hasVerticalScroll||this.y>0?n=0:this.y<this.maxScrollY&&(n=this.maxScrollY),t==this.x&&n==this.y?!1:(this.scrollTo(t,n,e,this.options.bounceEasing),!0)},disable:function(){this.enabled=!1},enable:function(){this.enabled=!0},refresh:function(){var e=this.wrapper.offsetHeight;this.wrapperWidth=this.wrapper.clientWidth,this.wrapperHeight=this.wrapper.clientHeight,this.scrollerWidth=Math.round(this.scroller.offsetWidth*this.scale),this.scrollerHeight=Math.round(this.scroller.offsetHeight*this.scale),this.maxScrollX=this.wrapperWidth-this.scrollerWidth,this.maxScrollY=this.wrapperHeight-this.scrollerHeight,this.hasHorizontalScroll=this.options.scrollX&&this.maxScrollX<0,this.hasVerticalScroll=this.options.scrollY&&this.maxScrollY<0,this.hasHorizontalScroll||(this.maxScrollX=0,this.scrollerWidth=this.wrapperWidth),this.hasVerticalScroll||(this.maxScrollY=0,this.scrollerHeight=this.wrapperHeight),this.endTime=0,this.directionX=0,this.directionY=0,this.wrapperOffset=t.offset(this.wrapper),this._execEvent("refresh"),this.resetPosition()},on:function(e,t){this._events[e]||(this._events[e]=[]),this._events[e].push(t)},off:function(e,t){if(!this._events[e])return;var n=this._events[e].indexOf(t);n>-1&&this._events[e].splice(n,1)},_execEvent:function(e){if(!this._events[e])return;var t=0,n=this._events[e].length;if(!n)return;for(;t<n;t++)this._events[e][t].apply(this,[].slice.call(arguments,1))},scrollBy:function(e,t,n,r){e=this.x+e,t=this.y+t,n=n||0,this.scrollTo(e,t,n,r)},scrollTo:function(e,n,r,i){i=i||t.ease.circular,this.isInTransition=this.options.useTransition&&r>0,!r||this.options.useTransition&&i.style?(this._transitionTimingFunction(i.style),this._transitionTime(r),this._translate(e,n)):this._animate(e,n,r,i.fn)},scrollToElement:function(e,n,r,i,s){e=e.nodeType?e:this.scroller.querySelector(e);if(!e)return;var o=t.offset(e);o.left-=this.wrapperOffset.left,o.top-=this.wrapperOffset.top,r===!0&&(r=Math.round(e.offsetWidth/2-this.wrapper.offsetWidth/2)),i===!0&&(i=Math.round(e.offsetHeight/2-this.wrapper.offsetHeight/2)),o.left-=r||0,o.top-=i||0,o.left=o.left>0?0:o.left<this.maxScrollX?this.maxScrollX:o.left,o.top=o.top>0?0:o.top<this.maxScrollY?this.maxScrollY:o.top,n=n===undefined||n===null||n==="auto"?Math.max(Math.abs(this.x-o.left),Math.abs(this.y-o.top)):n,this.scrollTo(o.left,o.top,n,s)},_transitionTime:function(e){e=e||0,this.scrollerStyle[t.style.transitionDuration]=e+"ms",!e&&t.isBadAndroid&&(this.scrollerStyle[t.style.transitionDuration]="0.001s");if(this.indicators)for(var n=this.indicators.length;n--;)this.indicators[n].transitionTime(e)},_transitionTimingFunction:function(e){this.scrollerStyle[t.style.transitionTimingFunction]=e;if(this.indicators)for(var n=this.indicators.length;n--;)this.indicators[n].transitionTimingFunction(e)},_translate:function(e,n){this.options.useTransform?this.scrollerStyle[t.style.transform]="translate("+e+"px,"+n+"px) scale("+this.scale+") "+this.translateZ:(e=Math.round(e),n=Math.round(n),this.scrollerStyle[t.style.transform]="scale("+this.scale+")",this.scrollerStyle.left=e+"px",this.scrollerStyle.top=n+"px"),this.x=e,this.y=n;if(this.indicators)for(var r=this.indicators.length;r--;)this.indicators[r].updatePosition()},_initEvents:function(e){var n=e?t.removeEvent:t.addEvent,r=this.options.bindToWrapper?this.wrapper:window;n(window,"orientationchange",this),n(window,"resize",this),this.options.click&&n(this.wrapper,"click",this,!0),this.options.disableMouse||(n(this.wrapper,"mousedown",this),n(r,"mousemove",this),n(r,"mousecancel",this),n(r,"mouseup",this)),t.hasPointer&&!this.options.disablePointer&&(n(this.wrapper,"MSPointerDown",this),n(r,"MSPointerMove",this),n(r,"MSPointerCancel",this),n(r,"MSPointerUp",this)),t.hasTouch&&!this.options.disableTouch&&(n(this.wrapper,"touchstart",this),n(r,"touchmove",this),n(r,"touchcancel",this),n(r,"touchend",this)),n(this.scroller,"transitionend",this),n(this.scroller,"webkitTransitionEnd",this),n(this.scroller,"oTransitionEnd",this),n(this.scroller,"MSTransitionEnd",this)},getComputedPosition:function(){var e=window.getComputedStyle(this.scroller,null),n,r;return this.options.useTransform?(e=e[t.style.transform].split(")")[0].split(", "),n=+(e[12]||e[4]),r=+(e[13]||e[5])):(n=+e.left.replace(/[^-\d.]/g,""),r=+e.top.replace(/[^-\d.]/g,"")),{x:n,y:r}},_initIndicators:function(){function a(e){for(var t=o.indicators.length;t--;)e.call(o.indicators[t])}var e=this.options.interactiveScrollbars,t=typeof this.options.scrollbars!="string",n=[],s,o=this;this.indicators=[],this.options.scrollbars&&(this.options.scrollY&&(s={el:r("v",e,this.options.scrollbars),interactive:e,defaultScrollbars:!0,customStyle:t,resize:this.options.resizeScrollbars,shrink:this.options.shrinkScrollbars,fade:this.options.fadeScrollbars,listenX:!1},this.wrapper.appendChild(s.el),n.push(s)),this.options.scrollX&&(s={el:r("h",e,this.options.scrollbars),interactive:e,defaultScrollbars:!0,customStyle:t,resize:this.options.resizeScrollbars,shrink:this.options.shrinkScrollbars,fade:this.options.fadeScrollbars,listenY:!1},this.wrapper.appendChild(s.el),n.push(s))),this.options.indicators&&(n=n.concat(this.options.indicators));for(var u=n.length;u--;)this.indicators.push(new i(this,n[u]));this.options.fadeScrollbars&&(this.on("scrollEnd",function(){a(function(){this.fade()})}),this.on("scrollCancel",function(){a(function(){this.fade()})}),this.on("scrollStart",function(){a(function(){this.fade(1)})}),this.on("beforeScrollStart",function(){a(function(){this.fade(1,!0)})})),this.on("refresh",function(){a(function(){this.refresh()})}),this.on("destroy",function(){a(function(){this.destroy()}),delete this.indicators})},_initZoom:function(){this.scrollerStyle[t.style.transformOrigin]="0 0"},_zoomStart:function(e){var t=Math.abs(e.touches[0].pageX-e.touches[1].pageX),n=Math.abs(e.touches[0].pageY-e.touches[1].pageY);this.touchesDistanceStart=Math.sqrt(t*t+n*n),this.startScale=this.scale,this.originX=Math.abs(e.touches[0].pageX+e.touches[1].pageX)/2+this.wrapperOffset.left-this.x,this.originY=Math.abs(e.touches[0].pageY+e.touches[1].pageY)/2+this.wrapperOffset.top-this.y,this._execEvent("zoomStart")},_zoom:function(e){if(!this.enabled||t.eventType[e.type]!==this.initiated)return;this.options.preventDefault&&e.preventDefault();var n=Math.abs(e.touches[0].pageX-e.touches[1].pageX),r=Math.abs(e.touches[0].pageY-e.touches[1].pageY),i=Math.sqrt(n*n+r*r),s=1/this.touchesDistanceStart*i*this.startScale,o,u,a;this.options.floorScale&&(s=Math.floor(s)),this.scaled=!0,s<this.options.zoomMin?s=1:s>this.options.zoomMax&&(s=this.options.zoomMax),o=s/this.startScale,u=this.originX-this.originX*o+this.startX,a=this.originY-this.originY*o+this.startY,this.scale=s,this.scrollTo(u,a,0)},_zoomEnd:function(e){if(!this.enabled||t.eventType[e.type]!==this.initiated)return;this.options.preventDefault&&e.preventDefault();var n,r,i;this.isInTransition=0,this.initiated=0,this.scale>this.options.zoomMax?this.scale=this.options.zoomMax:this.scale<this.options.zoomMin&&(this.scale=this.options.zoomMin),this.refresh(),i=this.scale/this.startScale,n=this.originX-this.originX*i+this.startX,r=this.originY-this.originY*i+this.startY,n>0?n=0:n<this.maxScrollX&&(n=this.maxScrollX),r>0?r=0:r<this.maxScrollY&&(r=this.maxScrollY),(this.x!=n||this.y!=r)&&this.scrollTo(n,r,this.options.bounceTime),this.scaled=!1,this._execEvent("zoomEnd")},zoom:function(e,t,n,r){e<this.options.zoomMin?e=this.options.zoomMin:e>this.options.zoomMax&&(e=this.options.zoomMax);if(e==this.scale)return;var i=e/this.scale;t=t===undefined?this.wrapperWidth/2:t,n=n===undefined?this.wrapperHeight/2:n,r=r===undefined?0:r,t=t+this.wrapperOffset.left-this.x,n=n+this.wrapperOffset.top-this.y,t*=-1,n=n-n*i+this.y,this.scale=e,this.refresh(),t>0?t=0:t<this.maxScrollX&&(t=this.maxScrollX),n>0?n=0:n<this.maxScrollY&&(n=this.maxScrollY),this.scrollTo(t,n,r)},_wheelZoom:function(e){var t,n,r=this;clearTimeout(this.wheelTimeout),this.wheelTimeout=setTimeout(function(){r._execEvent("zoomEnd")},400);if("deltaX"in e)t=-e.deltaY/Math.abs(e.deltaY);else if("wheelDeltaX"in e)t=e.wheelDeltaY/Math.abs(e.wheelDeltaY);else if("wheelDelta"in e)t=e.wheelDelta/Math.abs(e.wheelDelta);else{if(!("detail"in e))return;t=-e.detail/Math.abs(e.wheelDelta)}n=this.scale+t/5,this.zoom(n,e.pageX,e.pageY,0)},_initWheel:function(){t.addEvent(this.wrapper,"wheel",this),t.addEvent(this.wrapper,"mousewheel",this),t.addEvent(this.wrapper,"DOMMouseScroll",this),this.on("destroy",function(){t.removeEvent(this.wrapper,"wheel",this),t.removeEvent(this.wrapper,"mousewheel",this),t.removeEvent(this.wrapper,"DOMMouseScroll",this)})},_wheel:function(e){if(!this.enabled)return;this.options.preventDefault&&!t.preventDefaultException(e.target,this.options.preventDefaultException)&&e.preventDefault(),e.stopPropagation();var n,r,i,s,o=this;this.wheelTimeout===undefined&&o._execEvent("scrollStart"),clearTimeout(this.wheelTimeout),this.wheelTimeout=setTimeout(function(){o._execEvent("scrollEnd"),o.wheelTimeout=undefined},100);if("deltaX"in e)n=-e.deltaX,r=-e.deltaY;else if("wheelDeltaX"in e)n=e.wheelDeltaX/120*this.options.mouseWheelSpeed,r=e.wheelDeltaY/120*this.options.mouseWheelSpeed;else if("wheelDelta"in e)n=r=e.wheelDelta/120*this.options.mouseWheelSpeed;else{if(!("detail"in e))return;n=r=-e.detail/3*this.options.mouseWheelSpeed}n*=this.options.invertWheelDirection,r*=this.options.invertWheelDirection,this.hasVerticalScroll||(n=r,r=0);if(this.options.snap){i=this.currentPage.pageX,s=this.currentPage.pageY,n>0?i--:n<0&&i++,r>0?s--:r<0&&s++,this.goToPage(i,s);return}i=this.x+Math.round(this.hasHorizontalScroll?n:0),s=this.y+Math.round(this.hasVerticalScroll?r:0),i>0?i=0:i<this.maxScrollX&&(i=this.maxScrollX),s>0?s=0:s<this.maxScrollY&&(s=this.maxScrollY),this.scrollTo(i,s,0)},_initSnap:function(){this.currentPage={},typeof this.options.snap=="string"&&(this.options.snap=this.scroller.querySelectorAll(this.options.snap)),this.on("refresh",function(){var e=0,t,n=0,r,i,s,o=0,u,a=this.options.snapStepX||this.wrapperWidth,f=this.options.snapStepY||this.wrapperHeight,l;this.pages=[];if(!this.wrapperWidth||!this.wrapperHeight||!this.scrollerWidth||!this.scrollerHeight)return;if(this.options.snap===!0){i=Math.round(a/2),s=Math.round(f/2);while(o>-this.scrollerWidth){this.pages[e]=[],t=0,u=0;while(u>-this.scrollerHeight)this.pages[e][t]={x:Math.max(o,this.maxScrollX),y:Math.max(u,this.maxScrollY),width:a,height:f,cx:o-i,cy:u-s},u-=f,t++;o-=a,e++}}else{l=this.options.snap,t=l.length,r=-1;for(;e<t;e++){if(e===0||l[e].offsetLeft<=l[e-1].offsetLeft)n=0,r++;this.pages[n]||(this.pages[n]=[]),o=Math.max(-l[e].offsetLeft,this.maxScrollX),u=Math.max(-l[e].offsetTop,this.maxScrollY),i=o-Math.round(l[e].offsetWidth/2),s=u-Math.round(l[e].offsetHeight/2),this.pages[n][r]={x:o,y:u,width:l[e].offsetWidth,height:l[e].offsetHeight,cx:i,cy:s},o>this.maxScrollX&&n++}}this.goToPage(this.currentPage.pageX||0,this.currentPage.pageY||0,0),this.options.snapThreshold%1===0?(this.snapThresholdX=this.options.snapThreshold,this.snapThresholdY=this.options.snapThreshold):(this.snapThresholdX=Math.round(this.pages[this.currentPage.pageX][this.currentPage.pageY].width*this.options.snapThreshold),this.snapThresholdY=Math.round(this.pages[this.currentPage.pageX][this.currentPage.pageY].height*this.options.snapThreshold))}),this.on("flick",function(){var e=this.options.snapSpeed||Math.max(Math.max(Math.min(Math.abs(this.x-this.startX),1e3),Math.min(Math.abs(this.y-this.startY),1e3)),300);this.goToPage(this.currentPage.pageX+this.directionX,this.currentPage.pageY+this.directionY,e)})},_nearestSnap:function(e,t){if(!this.pages.length)return{x:0,y:0,pageX:0,pageY:0};var n=0,r=this.pages.length,i=0;if(Math.abs(e-this.absStartX)<this.snapThresholdX&&Math.abs(t-this.absStartY)<this.snapThresholdY)return this.currentPage;e>0?e=0:e<this.maxScrollX&&(e=this.maxScrollX),t>0?t=0:t<this.maxScrollY&&(t=this.maxScrollY);for(;n<r;n++)if(e>=this.pages[n][0].cx){e=this.pages[n][0].x;break}r=this.pages[n].length;for(;i<r;i++)if(t>=this.pages[0][i].cy){t=this.pages[0][i].y;break}return n==this.currentPage.pageX&&(n+=this.directionX,n<0?n=0:n>=this.pages.length&&(n=this.pages.length-1),e=this.pages[n][0].x),i==this.currentPage.pageY&&(i+=this.directionY,i<0?i=0:i>=this.pages[0].length&&(i=this.pages[0].length-1),t=this.pages[0][i].y),{x:e,y:t,pageX:n,pageY:i}},goToPage:function(e,t,n,r){r=r||this.options.bounceEasing,e>=this.pages.length?e=this.pages.length-1:e<0&&(e=0),t>=this.pages[e].length?t=this.pages[e].length-1:t<0&&(t=0);var i=this.pages[e][t].x,s=this.pages[e][t].y;n=n===undefined?this.options.snapSpeed||Math.max(Math.max(Math.min(Math.abs(i-this.x),1e3),Math.min(Math.abs(s-this.y),1e3)),300):n,this.currentPage={x:i,y:s,pageX:e,pageY:t},this.scrollTo(i,s,n,r)},next:function(e,t){var n=this.currentPage.pageX,r=this.currentPage.pageY;n++,n>=this.pages.length&&this.hasVerticalScroll&&(n=0,r++),this.goToPage(n,r,e,t)},prev:function(e,t){var n=this.currentPage.pageX,r=this.currentPage.pageY;n--,n<0&&this.hasVerticalScroll&&(n=0,r--),this.goToPage(n,r,e,t)},_initKeys:function(e){var n={pageUp:33,pageDown:34,end:35,home:36,left:37,up:38,right:39,down:40},r;if(typeof this.options.keyBindings=="object")for(r in this.options.keyBindings)typeof this.options.keyBindings[r]=="string"&&(this.options.keyBindings[r]=this.options.keyBindings[r].toUpperCase().charCodeAt(0));else this.options.keyBindings={};for(r in n)this.options.keyBindings[r]=this.options.keyBindings[r]||n[r];t.addEvent(window,"keydown",this),this.on("destroy",function(){t.removeEvent(window,"keydown",this)})},_key:function(e){if(!this.enabled)return;var n=this.options.snap,r=n?this.currentPage.pageX:this.x,i=n?this.currentPage.pageY:this.y,s=t.getTime(),o=this.keyTime||0,u=.25,a;this.options.useTransition&&this.isInTransition&&(a=this.getComputedPosition(),this._translate(Math.round(a.x),Math.round(a.y)),this.isInTransition=!1),this.keyAcceleration=s-o<200?Math.min(this.keyAcceleration+u,50):0;switch(e.keyCode){case this.options.keyBindings.pageUp:this.hasHorizontalScroll&&!this.hasVerticalScroll?r+=n?1:this.wrapperWidth:i+=n?1:this.wrapperHeight;break;case this.options.keyBindings.pageDown:this.hasHorizontalScroll&&!this.hasVerticalScroll?r-=n?1:this.wrapperWidth:i-=n?1:this.wrapperHeight;break;case this.options.keyBindings.end:r=n?this.pages.length-1:this.maxScrollX,i=n?this.pages[0].length-1:this.maxScrollY;break;case this.options.keyBindings.home:r=0,i=0;break;case this.options.keyBindings.left:r+=n?-1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.up:i+=n?1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.right:r-=n?-1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.down:i-=n?1:5+this.keyAcceleration>>0;break;default:return}if(n){this.goToPage(r,i);return}r>0?(r=0,this.keyAcceleration=0):r<this.maxScrollX&&(r=this.maxScrollX,this.keyAcceleration=0),i>0?(i=0,this.keyAcceleration=0):i<this.maxScrollY&&(i=this.maxScrollY,this.keyAcceleration=0),this.scrollTo(r,i,0),this.keyTime=s},_animate:function(n,r,i,s){function c(){var h=t.getTime(),p,d,v;if(h>=l){o.isAnimating=!1,o._translate(n,r),o.resetPosition(o.options.bounceTime)||o._execEvent("scrollEnd");return}h=(h-f)/i,v=s(h),p=(n-u)*v+u,d=(r-a)*v+a,o._translate(p,d),o.isAnimating&&e(c)}var o=this,u=this.x,a=this.y,f=t.getTime(),l=f+i;this.isAnimating=!0,c()},handleEvent:function(e){switch(e.type){case"touchstart":case"MSPointerDown":case"mousedown":this._start(e),this.options.zoom&&e.touches&&e.touches.length>1&&this._zoomStart(e);break;case"touchmove":case"MSPointerMove":case"mousemove":if(this.options.zoom&&e.touches&&e.touches[1]){this._zoom(e);return}this._move(e);break;case"touchend":case"MSPointerUp":case"mouseup":case"touchcancel":case"MSPointerCancel":case"mousecancel":if(this.scaled){this._zoomEnd(e);return}this._end(e);break;case"orientationchange":case"resize":this._resize();break;case"transitionend":case"webkitTransitionEnd":case"oTransitionEnd":case"MSTransitionEnd":this._transitionEnd(e);break;case"wheel":case"DOMMouseScroll":case"mousewheel":if(this.options.wheelAction=="zoom"){this._wheelZoom(e);return}this._wheel(e);break;case"keydown":this._key(e)}}},i.prototype={handleEvent:function(e){switch(e.type){case"touchstart":case"MSPointerDown":case"mousedown":this._start(e);break;case"touchmove":case"MSPointerMove":case"mousemove":this._move(e);break;case"touchend":case"MSPointerUp":case"mouseup":case"touchcancel":case"MSPointerCancel":case"mousecancel":this._end(e)}},destroy:function(){this.options.interactive&&(t.removeEvent(this.indicator,"touchstart",this),t.removeEvent(this.indicator,"MSPointerDown",this),t.removeEvent(this.indicator,"mousedown",this),t.removeEvent(document,"touchmove",this),t.removeEvent(document,"MSPointerMove",this),t.removeEvent(document,"mousemove",this),t.removeEvent(window,"touchend",this),t.removeEvent(window,"MSPointerUp",this),t.removeEvent(window,"mouseup",this)),this.options.defaultScrollbars&&this.wrapper.parentNode.removeChild(this.wrapper)},_start:function(e){var n=e.touches?e.touches[0]:e;e.preventDefault(),e.stopPropagation(),this.transitionTime(),this.initiated=!0,this.moved=!1,this.lastPointX=n.pageX,this.lastPointY=n.pageY,this.startTime=t.getTime(),this.options.disableTouch||t.addEvent(document,"touchmove",this),this.options.disablePointer||t.addEvent(document,"MSPointerMove",this),this.options.disableMouse||t.addEvent(document,"mousemove",this),this.scroller._execEvent("beforeScrollStart")},_move:function(e){var n=e.touches?e.touches[0]:e,r,i,s,o,u=t.getTime();this.moved||this.scroller._execEvent("scrollStart"),this.moved=!0,r=n.pageX-this.lastPointX,this.lastPointX=n.pageX,i=n.pageY-this.lastPointY,this.lastPointY=n.pageY,s=this.x+r,o=this.y+i,this._pos(s,o),e.preventDefault(),e.stopPropagation()},_end:function(e){if(!this.initiated)return;this.initiated=!1,e.preventDefault(),e.stopPropagation(),t.removeEvent(window,"touchmove",this),t.removeEvent(window,"MSPointerMove",this),t.removeEvent(window,"mousemove",this);if(this.scroller.options.snap){var n=this.scroller._nearestSnap(this.scroller.x,this.scroller.y),r=this.options.snapSpeed||Math.max(Math.max(Math.min(Math.abs(this.scroller.x-n.x),1e3),Math.min(Math.abs(this.scroller.y-n.y),1e3)),300);if(this.scroller.x!=n.x||this.scroller.y!=n.y)this.scroller.directionX=0,this.scroller.directionY=0,this.scroller.currentPage=n,this.scroller.scrollTo(n.x,n.y,r,this.scroller.options.bounceEasing)}this.moved&&this.scroller._execEvent("scrollEnd")},transitionTime:function(e){e=e||0,this.indicatorStyle[t.style.transitionDuration]=e+"ms",!e&&t.isBadAndroid&&(this.indicatorStyle[t.style.transitionDuration]="0.001s")},transitionTimingFunction:function(e){this.indicatorStyle[t.style.transitionTimingFunction]=e},refresh:function(){this.transitionTime(),this.options.listenX&&!this.options.listenY?this.indicatorStyle.display=this.scroller.hasHorizontalScroll?"block":"none":this.options.listenY&&!this.options.listenX?this.indicatorStyle.display=this.scroller.hasVerticalScroll?"block":"none":this.indicatorStyle.display=this.scroller.hasHorizontalScroll||this.scroller.hasVerticalScroll?"block":"none",this.scroller.hasHorizontalScroll&&this.scroller.hasVerticalScroll?(t.addClass(this.wrapper,"iScrollBothScrollbars"),t.removeClass(this.wrapper,"iScrollLoneScrollbar"),this.options.defaultScrollbars&&this.options.customStyle&&(this.options.listenX?this.wrapper.style.right="8px":this.wrapper.style.bottom="8px")):(t.removeClass(this.wrapper,"iScrollBothScrollbars"),t.addClass(this.wrapper,"iScrollLoneScrollbar"),this.options.defaultScrollbars&&this.options.customStyle&&(this.options.listenX?this.wrapper.style.right="2px":this.wrapper.style.bottom="2px"));var e=this.wrapper.offsetHeight;this.options.listenX&&(this.wrapperWidth=this.wrapper.clientWidth,this.options.resize?(this.indicatorWidth=Math.max(Math.round(this.wrapperWidth*this.wrapperWidth/(this.scroller.scrollerWidth||this.wrapperWidth||1)),8),this.indicatorStyle.width=this.indicatorWidth+"px"):this.indicatorWidth=this.indicator.clientWidth,this.maxPosX=this.wrapperWidth-this.indicatorWidth,this.options.shrink=="clip"?(this.minBoundaryX=-this.indicatorWidth+8,this.maxBoundaryX=this.wrapperWidth-8):(this.minBoundaryX=0,this.maxBoundaryX=this.maxPosX),this.sizeRatioX=this.options.speedRatioX||this.scroller.maxScrollX&&this.maxPosX/this.scroller.maxScrollX),this.options.listenY&&(this.wrapperHeight=this.wrapper.clientHeight,this.options.resize?(this.indicatorHeight=Math.max(Math.round(this.wrapperHeight*this.wrapperHeight/(this.scroller.scrollerHeight||this.wrapperHeight||1)),8),this.indicatorStyle.height=this.indicatorHeight+"px"):this.indicatorHeight=this.indicator.clientHeight,this.maxPosY=this.wrapperHeight-this.indicatorHeight,this.options.shrink=="clip"?(this.minBoundaryY=-this.indicatorHeight+8,this.maxBoundaryY=this.wrapperHeight-8):(this.minBoundaryY=0,this.maxBoundaryY=this.maxPosY),this.maxPosY=this.wrapperHeight-this.indicatorHeight,this.sizeRatioY=this.options.speedRatioY||this.scroller.maxScrollY&&this.maxPosY/this.scroller.maxScrollY),this.updatePosition()},updatePosition:function(){var e=this.options.listenX&&Math.round(this.sizeRatioX*this.scroller.x)||0,n=this.options.listenY&&Math.round(this.sizeRatioY*this.scroller.y)||0;this.options.ignoreBoundaries||(e<this.minBoundaryX?(this.options.shrink=="scale"&&(this.width=Math.max(this.indicatorWidth+e,8),this.indicatorStyle.width=this.width+"px"),e=this.minBoundaryX):e>this.maxBoundaryX?this.options.shrink=="scale"?(this.width=Math.max(this.indicatorWidth-(e-this.maxPosX),8),this.indicatorStyle.width=this.width+"px",e=this.maxPosX+this.indicatorWidth-this.width):e=this.maxBoundaryX:this.options.shrink=="scale"&&this.width!=this.indicatorWidth&&(this.width=this.indicatorWidth,this.indicatorStyle.width=this.width+"px"),n<this.minBoundaryY?(this.options.shrink=="scale"&&(this.height=Math.max(this.indicatorHeight+n*3,8),this.indicatorStyle.height=this.height+"px"),n=this.minBoundaryY):n>this.maxBoundaryY?this.options.shrink=="scale"?(this.height=Math.max(this.indicatorHeight-(n-this.maxPosY)*3,8),this.indicatorStyle.height=this.height+"px",n=this.maxPosY+this.indicatorHeight-this.height):n=this.maxBoundaryY:this.options.shrink=="scale"&&this.height!=this.indicatorHeight&&(this.height=this.indicatorHeight,this.indicatorStyle.height=this.height+"px")),this.x=e,this.y=n,this.scroller.options.useTransform?this.indicatorStyle[t.style.transform]="translate("+e+"px,"+n+"px)"+this.scroller.translateZ:(this.indicatorStyle.left=e+"px",this.indicatorStyle.top=n+"px")},_pos:function(e,t){e<0?e=0:e>this.maxPosX&&(e=this.maxPosX),t<0?t=0:t>this.maxPosY&&(t=this.maxPosY),e=this.options.listenX?Math.round(e/this.sizeRatioX):this.scroller.x,t=this.options.listenY?Math.round(t/this.sizeRatioY):this.scroller.y,this.scroller.scrollTo(e,t)},fade:function(e,n){if(n&&!this.visible)return;clearTimeout(this.fadeTimeout),this.fadeTimeout=null;var r=e?250:500,i=e?0:300;e=e?"1":"0",this.wrapperStyle[t.style.transitionDuration]=r+"ms",this.fadeTimeout=setTimeout(function(e){this.wrapperStyle.opacity=e,this.visible=+e}.bind(this,e),i)}},n.utils=t,n}),define("vendor/text!core/templates/imageGallery/imageGalleryView.html",[],function(){return'<div class="image-gallery-scroller">\n\n    <div class="image-gallery-pagination-container">\n        <div class="image-gallery-pagination"></div>\n    </div>\n\n    <div class="image-gallery-swiper-container swiper-container">\n        <div class="image-gallery-swiper-wrapper swiper-wrapper">\n\n        </div>\n    </div>\n</div>\n\n<span class="close-image-gallery">\n    <i class="image-gallery-close-icon <%= viewOptions.closeButtonIcon.iconName %>" title="<%= strings.tooltip ? strings.tooltip.closeButton : \'\' %>"></i>\n</span>\n'}),define("vendor/text!core/templates/imageGallery/imageGalleryNavigation.html",[],function(){return'<span class="image-slider-nav-icon image-gallery-left-arrow <%= hoverOnlyClass %>" title="<%= arrowLeftTooltip %>">\n    <i class="<%= arrowLeftClass %>"></i>\n</span>\n\n<span class="image-slider-nav-icon image-gallery-right-arrow <%= hoverOnlyClass %>" title="<%= arrowRightTooltip %>">\n    <i class="<%= arrowRightClass %>"></i>\n</span>\n'}),define("vendor/text!core/templates/imageGallery/imageGallerySlide.html",[],function(){return'<div class="image-gallery-swiper-slide swiper-slide open-image-gallery">\n\n    <span class="gallery-helper"></span>\n\n    <img src="<%= imageSource %>" class="image-gallery-object">\n\n    <% if (displayCaption) { %>\n    <div class="image-gallery-swiper-slide-footer">\n        <div class="caption-container <%= hoverOnlyClass %>">\n\n            <p class="caption-text caption-toggle <%= captionToggleHiddenClass %>">\n                <i class="<%= imageCaptionToggleIcon %> image-gallery-indication-icon"></i>\n                <%= imageCaptionToggleText %>\n            </p>\n\n            <p class="caption-text caption <%= captionHiddenClass %>"><%= imageCaptionText %>\n                <% if (displayPhotographer) { %>\n                <span class="photographer"><%= imageCaptionPhotographer %></span>\n                <% } %>\n            </p>\n\n        </div>\n    </div>\n    <% } %>\n</div>\n'}),"use strict",define("imageGalleryFullscreenView",["backbone","deviceUtility","jquery","IScroll","underscore","baseView","vendor/text!core/templates/imageGallery/imageGalleryView.html","vendor/text!core/templates/imageGallery/imageGalleryNavigation.html","vendor/text!core/templates/imageGallery/imageGallerySlide.html"],function(e,t,n,r,i,s,o,u,a){return s.extend({id:"image-gallery-fullscreen",className:"image-gallery-wrapper",imageGalleryViewHTMLTemplate:i.template(o),imageGalleryNavHTMLTemplate:i.template(u),imageGallerySlideTemplate:i.template(a),events:{"tap .image-gallery-object":"tappedImage","tap .caption-text":"captionText","tap .close-image-gallery":"closeFullscreen","tap .image-gallery-left-arrow":"imageGalleryLeftArrow","tap .image-gallery-right-arrow":"imageGalleryRightArrow"},preventDefault:function(e){return e.preventDefault(),e.stopPropagation(),e.gesture.preventDefault(),e.gesture.stopPropagation(),!1},initialize:function(e){this.init(e),this.captionTogglerIcon=this.viewOptions.captionIcon?this.viewOptions.captionIcon:!1,this.captionHoverOnly=this.viewOptions.caption&&this.viewOptions.caption.hoverOnly,this.useGalleryNavigation=this.viewOptions.galleryNavigation&&this.viewOptions.galleryNavigation.enabled&&!t.hasTouchSupport,this.hoverOnlyNavigation=this.viewOptions.galleryNavigation&&this.viewOptions.galleryNavigation.hoverOnly,this.arrowLeftClass=this.viewOptions.galleryNavigation&&this.viewOptions.galleryNavigation.arrowLeftClass?this.viewOptions.galleryNavigation.arrowLeftClass:"",this.arrowRightClass=this.viewOptions.galleryNavigation&&this.viewOptions.galleryNavigation.arrowRightClass?this.viewOptions.galleryNavigation.arrowRightClass:"",this.keydownHandler=this.keydownHandler.bind(this),this.bootstrapImageGalleryData(e).bindEvents().addHooks()},bootstrapImageGalleryData:function(e){return this.images=e.images,this.sourceId=e.sourceId,this.lastActiveIndex=e.startIndex||0,this.filesBasepath=e.filesBasepath,this.fullscreenContext=e.fullscreenContext,this.viewOptions&&this.viewOptions.hasOwnProperty("caption")&&(this.displayCaption=this.viewOptions.caption.displayCaption,this.showCaptionOnStart=this.viewOptions.caption.showCaptionOnStart,this.displayPhotographer=this.viewOptions.caption.displayPhotographer),this},bindEvents:function(){return this.unbindEvents(),e.on("backButton",this.closeFullscreen,this),window.addEventListener("keydown",this.keydownHandler,!1),this},unbindEvents:function(){return e.off("backButton",this.closeFullscreen,this),window.removeEventListener("keydown",this.keydownHandler,!1),this},imageGalleryLeftArrow:function(e){this.swiper.slidePrev(),this.preventDefault(e)},imageGalleryRightArrow:function(e){this.swiper.slideNext(),this.preventDefault(e)},captionText:function(e){this.toggleCaption(e),this.preventDefault(e)},toggleCaption:function(){this.$(".caption-text").toggleClass("hidden")},drag:function(e){this.zoom&&this.zoom.scale>1&&this.preventDefault(e)},swipe:function(e){this.preventDefault(e)},initializeZoom:function(){var e=this;t.hasTouchSupport&&(this.zoom=new r(this.el,{zoom:!0,mouseWheel:!1,HWCompositing:!0,useTransform:!0,useTransition:!0,freeScroll:!0,scrollY:!0,scrollX:!0}),this.zoom.on("zoomStart",function(){e.destroySwiper()}),this.zoom.on("scrollStart",function(){this.scale>1&&e.destroySwiper()}),this.zoom.on("zoomEnd",function(){this.scale===1?e.removeZoomingState():e.setZoomingState()}))},setZoomingState:function(){return this.destroySwiper(),this.$el.addClass("image-gallery-zooming"),this},removeZoomingState:function(){return this.initializeSwiper(this.lastActiveIndex),this.$el.removeClass("image-gallery-zooming"),this},destroyZoom:function(){this.zoom&&(this.zoom.zoom(1),this.zoom.destroy())},destroySwiper:function(){this.swiper&&(this.lastActiveIndex=this.swiper.activeIndex,this.swiper.destroy(),this.swiper=null)},render:function(){return this.$el.html(this.imageGalleryViewHTMLTemplate(this.templateModel)),e.trigger("imageGalleryFullscreen",{enableOtherKeyboardControls:!1}),this.$el.addClass("fullsized-gallery"),this.useGalleryNavigation&&this.images.length>1&&this.$el.append(this.imageGalleryNavHTMLTemplate({arrowLeftClass:this.arrowLeftClass,arrowRightClass:this.arrowRightClass,hoverOnlyClass:this.hoverOnlyNavigation?"hover-only":"",arrowLeftTooltip:this.strings.tooltip?this.strings.tooltip.arrowLeft:"",arrowRightTooltip:this.strings.tooltip?this.strings.tooltip.arrowRight:""})),this},addHooks:function(){return this.addHook.call(this,"afterRender",function(){var e=this;this.appendImages(this.images),this.initializeZoom(),this.initializeSwiper(this.lastActiveIndex),this.toggleCaption(),window.setTimeout(function(){e.$(".invisible").removeClass("invisible")},200)}),this},tappedImage:function(e){this.toggleImageOnlyState(e),this.preventDefault(e)},closeFullscreen:function(t){return e.trigger("imageGalleryFullscreen",{enableOtherKeyboardControls:!0}),this.removeZoomingState(),this.destroyZoom(),this.trigger("closeFullscreen",{activeIndex:this.swiper.activeIndex}),this},appendImages:function(e){var t=this.$(".image-gallery-swiper-wrapper");return i.each(e,function(e){t.append(this.getImageSlide(e))},this),this},getImageSlide:function(e){var t={imageSource:this.getImgSrc(e),displayCaption:this.displayCaption,displayPhotographer:this.displayPhotographer,hoverOnlyClass:this.captionHoverOnly?"hover-only":"",captionToggleHiddenClass:this.showCaptionOnStart?"hidden":"",captionHiddenClass:this.showCaptionOnStart?"":"hidden",imageCaptionToggleIcon:this.captionTogglerIcon.iconName,imageCaptionToggleText:this.strings.toggleCaption,imageCaptionText:n.trim(e.caption),imageCaptionPhotographer:this.getPhotographer(e)};return this.imageGallerySlideTemplate(t)},getPhotographer:function(e){var t=n.trim(e.photographer);return!this.captionHasPhotographer(e)&&t?this.strings.photo+" "+t:""},captionHasPhotographer:function(e){e.caption=e.caption?e.caption:"";var t=e.caption.toLowerCase(),n=this.strings.photo+" "+e.photographer;return t&&t.indexOf(n.toLowerCase())!==-1},getImgSrc:function(e){return this.filesBasepath+e.files.large.path},getAspectRatio:function(e){return Math.floor(10*e/15)},toggleImageOnlyState:function(e){this.$el.toggleClass("image-only")},initializeSwiper:function(e){if(this.swiper&&this.swiper!==null)return this.swiper.slideTo(this.swiper.activeIndex,0),!1;var n=this.$(".image-gallery-pagination-container"),r;return this.images.length>1?(r=this.$(".image-gallery-pagination")[0],n.removeClass("hidden")):(r="",n.addClass("hidden")),this.swiper=this.$(".image-gallery-swiper-container").swiper({pagination:r,useCSS3Transforms:!t.isBadAndroid(),paginationClickable:!0,keyboardControl:!0,slidesPerView:1,slidesPerGroup:1,autoResize:!1,startIndex:e}),this.swiper.slideTo(e,0),this},keydownHandler:function(e){e.keyCode===27&&this.closeFullscreen(e)}})}),"use strict",define("imageGalleryView",["backbone","swiper","deviceUtility","jquery","underscore","baseView","imageGalleryFullscreenView","vendor/text!core/templates/imageGallery/imageGalleryView.html","vendor/text!core/templates/imageGallery/imageGalleryNavigation.html","vendor/text!core/templates/imageGallery/imageGallerySlide.html"],function(e,t,n,r,i,s,o,u,a,f){var l=!1;return s.extend({className:"image-gallery-wrapper",imageGalleryViewHTMLTemplate:i.template(u),imageGalleryNavHTMLTemplate:i.template(a),imageGallerySlideTemplate:i.template(f),events:{"tap .image-gallery-object":"tappedImage","tap .caption-text":"captionText","tap .image-gallery-left-arrow":"imageGalleryLeftArrow","tap .image-gallery-right-arrow":"imageGalleryRightArrow"},preventDefault:function(e){e.preventDefault(),e.stopPropagation(),e.gesture.preventDefault(),e.gesture.stopPropagation()},initialize:function(e){this.init(e),this.fullscreenOptions=e,this.captionTogglerIcon=this.viewOptions.captionIcon?this.viewOptions.captionIcon:!1,this.captionHoverOnly=this.viewOptions.caption&&this.viewOptions.caption.hoverOnly,this.useGalleryNavigation=this.viewOptions.galleryNavigation&&this.viewOptions.galleryNavigation.enabled&&!n.hasTouchSupport,this.hoverOnlyNavigation=this.viewOptions.galleryNavigation&&this.viewOptions.galleryNavigation.hoverOnly,this.arrowLeftClass=this.viewOptions.galleryNavigation&&this.viewOptions.galleryNavigation.arrowLeftClass?this.viewOptions.galleryNavigation.arrowLeftClass:"",this.arrowRightClass=this.viewOptions.galleryNavigation&&this.viewOptions.galleryNavigation.arrowRightClass?this.viewOptions.galleryNavigation.arrowRightClass:"",this.bootstrapImageGalleryData(e).bindEvents().addHooks()},bootstrapImageGalleryData:function(e){return this.images=e.images,this.sourceId=e.sourceId,this.lastActiveIndex=e.startIndex||0,this.filesBasepath=e.filesBasepath,this.fullscreenContext=e.fullscreenContext,this.viewOptions&&this.viewOptions.hasOwnProperty("caption")&&(this.displayCaption=this.viewOptions.caption.displayCaption,this.showCaptionOnStart=this.viewOptions.caption.showCaptionOnStart||l,this.displayPhotographer=this.viewOptions.caption.displayPhotographer),this},bindEvents:function(){return this.unbindEvents(),e.on("imageGallery:updateDimensions:"+this.sourceId,this.orientationChange,this),e.on("imageGallery:showCaption",this.showCaption,this),e.on("imageGallery:hideCaption",this.hideCaption,this),this},unbindEvents:function(){return e.off("imageGallery:updateDimensions:"+this.sourceId,this.orientationChange,this),e.off("imageGallery:showCaption",this.showCaption,this),e.off("imageGallery:hideCaption",this.hideCaption,this),this},imageGalleryLeftArrow:function(e){return this.preventDefault(e),this.swiper.slidePrev(),!1},imageGalleryRightArrow:function(e){return this.preventDefault(e),this.swiper.slideNext(),!1},captionText:function(e){return this.preventDefault(e),n.isRunningAtMobile()?this.openFullscreen(e):this.toggleCaption(e),!1},toggleCaption:function(t){this.$(".caption").hasClass("hidden")?e.trigger("imageGallery:showCaption"):e.trigger("imageGallery:hideCaption")},showCaption:function(){this.$(".caption").removeClass("hidden"),this.$(".caption-toggle").addClass("hidden"),l=!0},hideCaption:function(){this.$(".caption").addClass("hidden"),this.$(".caption-toggle").removeClass("hidden"),l=!1},destroySwiper:function(){this.swiper&&(this.lastActiveIndex=this.swiper.activeIndex,this.swiper.destroy(),this.swiper=null)},render:function(e){return this.$el.html(this.imageGalleryViewHTMLTemplate(this.templateModel)),this.useGalleryNavigation&&this.images.length>1&&this.$el.append(this.imageGalleryNavHTMLTemplate({arrowLeftClass:this.arrowLeftClass,arrowRightClass:this.arrowRightClass,hoverOnlyClass:this.hoverOnlyNavigation?"hover-only":"",arrowLeftTooltip:this.strings.tooltip?this.strings.tooltip.arrowLeft:"",arrowRightTooltip:this.strings.tooltip?this.strings.tooltip.arrowRight:""})),this},addHooks:function(){return this.addHook.call(this,"afterRender",function(){this.updateDimensions(),this.appendImages(this.images),this.lastActiveIndex=!1,this.initializeSwiper(!0)}),this},tappedImage:function(e){return this.openFullscreen(e),this.preventDefault(e),!1},openFullscreen:function(){var t=this,n=function(r){r&&r.activeIndex&&t.swiper.slideTo(r.activeIndex,0),i.off("closeFullscreen"),i.unbindEvents(),i.close(),i=null,e.off("imageGallery:close",n,t),e.off("closeOpenFullscreen",n,t),e.trigger("willHandleBackButton",!1),t.fullscreen=!1};this.fullscreenOptions.startIndex=this.swiper.activeIndex;var i=new o(this.fullscreenOptions);e.on("imageGallery:close",n,this),e.on("closeOpenFullscreen",n,this),r(this.fullscreenContext).append(i.render().el),i.triggerHook("afterRender"),i.on("closeFullscreen",n,this),e.trigger("willHandleBackButton",!0),this.fullscreen=!0},orientationChange:function(){this.updateDimensions(),this.swiper&&this.swiper.update()},updateDimensions:function(){var e=this.getAspectRatio(r(this.context).width());this.$(".image-gallery-swiper-container").height(e)},appendImages:function(e){var t=this.$(".image-gallery-swiper-wrapper");return i.each(e,function(e){t.append(this.getImageSlide(e))},this),this},getImageSlide:function(e){var t,n;return n={imageSource:this.getImgSrc(e),displayCaption:this.displayCaption,displayPhotographer:this.displayPhotographer,hoverOnlyClass:this.captionHoverOnly?" hover-only":"",captionToggleHiddenClass:this.showCaptionOnStart?" hidden":"",captionHiddenClass:this.showCaptionOnStart?"":" hidden",imageCaptionToggleIcon:this.captionTogglerIcon.iconName,imageCaptionToggleText:this.strings.toggleCaption,imageCaptionText:r.trim(e.caption),imageCaptionPhotographer:this.getPhotographer(e)},t=this.imageGallerySlideTemplate(n),t},getPhotographer:function(e){var t=r.trim(e.photographer);return!this.captionHasPhotographer(e)&&t?this.strings.photo+" "+t:""},captionHasPhotographer:function(e){e.caption=e.caption?e.caption:"";var t=e.caption.toLowerCase(),n=this.strings.photo+" "+e.photographer;return t&&t.indexOf(n.toLowerCase())!==-1},getImgSrc:function(e){return this.filesBasepath+e.files.large.path},getAspectRatio:function(e){return Math.floor(10*e/15)},initializeSwiper:function(e){if(this.swiper&&this.swiper!==null)return this.swiper.slideTo(this.swiper.activeIndex,0),!1;var t="",r=this.$(".image-gallery-pagination-container").addClass("hidden");return this.images.length>1&&(t=this.$(".image-gallery-pagination")[0],r.removeClass("hidden")),this.swiper=this.$(".image-gallery-swiper-container").swiper({pagination:t,useCSS3Transforms:!n.isBadAndroid(),paginationClickable:!0,keyboardControl:!1,slidesPerView:1,slidesPerGroup:1,autoResize:!1}),e&&this.swiper.slideTo(0,0),this}})}),"use strict",define("clientExtensions",[],function(){return{articleView:{refineHTML:function(e){}}}}),define("vendor/text!components/reader/templates/articleShare.html",[],function(){return'<div class="article-share-container hidden">\n    <div class="article-share-header article-inline-share-header">\n        <% if (iconName) { %>\n        <span class="article-share-header-icon"><i class="<%= iconName %>"></i></span>\n        <% } %>\n        <% if (iconText) { %>\n        <span class="article-share-header-text"><%= iconText %></span>\n        <% } %>\n    </div>\n    <div class="article-share-body article-inline-share-body">\n    </div>\n</div>\n'}),"use strict",define("articleView",["backbone","jquery","underscore","deviceUtility","dataService","advertUtility","baseView","imageGalleryView","clientExtensions","vendor/text!components/reader/templates/articleShare.html"],function(e,t,n,r,i,s,o,u,a,f){return o.extend({isActive:!1,allowShare:!1,events:{"tap .toggle-caption":"toggleCaption"},initialize:function(e){e.shareContentDefaults&&(this.shareContentDefaults=e.shareContentDefaults),this.shareTemplate=_.template(f),this.viewOptions=e.viewOptions,this.imageGalleryProperties=e.imageGalleryProperties,this.pubdate=e.pubdate,this.htmlInserted=!1,this.bootstrapArticleData(e).addHooks().bindEvents(e)},addHooks:function(){return this.addHook.call(this,"beforeClose",function(){this.removeStickyHeader()}),this},bootstrapArticleData:function(e){return this.issueIsDownloaded=e.issueIsDownloaded,this.filesBasepath=e.filesBasepath,this.allowShare=e.allowShare||!1,this.parent=e.parent,this.strings=e.strings,this.model.on("change:ad",this.injectAd,this),this},bindEvents:function(t){return this.unbindEvents(),e.on("orientationchange",this.orientationChange,this),t.parent.on("sizeChange",this.updateImagePlaceholder,this),r.isRunningAtMobile()&&t.viewOptions.stickyHeader&&(this.events.scroll=this.stickyMobileHeaderActivator),this},unbindEvents:function(){return e.off("orientationchange",this.orientationChange,this),this},stickyMobileHeaderActivator:function(e){if(r.isRunningAtMobile()){this.lastScrollPos=this.lastScrollPos||0,this.directionChangePoint=this.directionChangePoint||0,this.isScrollingDown=this.isScrollingDown||!1,this.headerHasChanged=this.headerHasChanged||!1;var t=this.$el.scrollTop();this.scrollDirectionHasChanged(t)&&(this.directionChangePoint=t,this.isScrollingDown=!this.isScrollingDown,this.headerHasChanged=!1),!this.headerHasChanged&&this.hasPassedScrollThreshold(t)&&(this.setNewScrollDirection(),this.headerHasChanged=!0),this.lastScrollPos=t}return this},hasPassedScrollThreshold:function(e){return this.isScrollingDown?e>this.directionChangePoint+40:e<this.directionChangePoint-40},scrollDirectionHasChanged:function(e){var t=e>this.lastScrollPos;return t!==this.isScrollingDown},setNewScrollDirection:function(){return this.isScrollingDown?this.addStickyHeader():this.removeStickyHeader(),this},addStickyHeader:function(){return this.setApplicationClass("hidden-sticky-header"),this},removeStickyHeader:function(){return this.removeApplicationClass("hidden-sticky-header"),this},activateStickyMobileHeader:function(){return r.isRunningAtMobile()&&this.setStickyMobileHeaderDefault(),this},setStickyMobileHeaderDefault:function(){return this.lastScrollPos=0,this.directionChangePoint=0,this.isScrollingDown=!1,this.removeStickyHeader(),this},orientationChange:function(){return this.updateImagePlaceholder(),this},updateImagePlaceholder:function(){return this.setImagePlaceholderHeight(),e.trigger("imageGallery:updateDimensions:"+this.getViewId()),this},setImagePlaceholderHeight:function(){if(this.model.get("images").length>0){var e=this.$(".slider-content");this.$(".image-wrapper").height(this.getAspectRatio(e.width()))}return this},render:function(){return this.$el.attr({"data-articleid":this.model.get("id"),tabindex:"-1"}),this},insertHtml:function(){return this.htmlInserted||(this.$el.html(this.getHTML()),this.updateImagePlaceholder(),this.insertImageGallery(),this.showAdvert(),this.htmlInserted=!0),this},removeHtml:function(){return this.removeImageGallery(),this.hideAdvert(),this.$el.empty(),this.htmlInserted=!1,this},insertImageGallery:function(){var e=this.getImages();return e.length&&(this.imageGallery=new u({viewOptions:this.imageGalleryProperties,strings:this.strings.imageGallery,images:e,sourceId:this.getViewId(),startIndex:0,filesBasepath:this.filesBasepath,fullscreenContext:"body",context:this.$(".image-wrapper")}),this.$(".image-wrapper").append(this.imageGallery.render().el),this.imageGallery.triggerHook("afterRender")),this},removeImageGallery:function(){this.imageGallery&&(this.imageGallery.close(),this.imageGallery=null,delete this.imageGallery)},getHTML:function(){return t("<div/>").addClass("slider-content").append(this.refineHTML(t(this.model.get("html"))))},getAspectRatio:function(e){return 10*e/15},getAdvertAspectRatio:function(e){return 17*e/24},getImages:function(){return this.model.get("images")},injectAd:function(e){var n,r=this.model.get("ad"),o=e.find(".article"),u;return r?(u=o.find("p")[1],i.online()&&r.get("urlHtmlAd")?n=t(s.generateIframeAdvertElement(r)):n=t(s.generateImageAdvertElement(r)),u||(u=o),n.insertAfter(u),this.adElement=t(n).find(".ad"),this):!1},showAdvert:function(){var e=this.model.get("ad"),t=this.$(".article-text").width();return e?(e.get("urlHtmlAd")?(this.adElement.attr("src",e.get("urlHtmlAd")),this.adElement.attr("width",t),this.adElement.attr("height",this.getAdvertAspectRatio(t))):(this.adElement.attr("src",this.filesBasepath+e.get("files").large.path),this.adElement.css("max-width","100%"),this.adElement.css("max-height",this.getAdvertAspectRatio(t))),this):!1},hideAdvert:function(){var e=this.model.get("ad");return!e||!this.adElement?!1:(this.adElement.attr("src",""),e.get("urlHtmlAd")?this.adElement.attr({width:"",height:""}):this.adElement.css({width:"",height:""}),this)},refineHTML:function(e){var n,r,i,s,o=!1,u=this.viewOptions.articlePubdate,f,l,c;a.articleView.refineHTML(e),r=e.find(".image-wrapper"),i=e.children(".article"),s=e.children(".fact-container"),u&&(f=u.insertMethod,l=e.find(u.context),n=this.viewHelpers.DateUtility.dateToStringFormat(this.pubdate,u.dateFormat),c=t("<div/>",{"class":"article-pubdate",text:n}),c[f](l)),this.getImages().length>0?r.prependTo(e):r.remove();if(this.model.get("articleType")==="EpaperCombinedShorts")e.addClass("short"),e.find(".byline a").remove(),e.each(function(e,n){if(n.nodeType===3)return;n=t(n),n.children(".article").length===0&&n.addClass("no-article"),n.children(".fact-container").html().length===0&&n.addClass("no-fact")});else{for(var h=0,p=i.length;h<p;h++)if(t(i[h]).html().length>50){o=!0;break}o||e.addClass("no-article"),s.html().length<50&&e.addClass("no-fact")}return this.addShareBox(e),this.injectAd(e),e},addShareBox:function(t){var n;return this.allowShare?(n=this.model.get("articleType").toLowerCase(),t.length>1&&(t=t.last()),t.length===0||n==="epapercombinedshorts"||n==="advert"||n==="grafix"?t:(t.append(this.shareTemplate({iconName:this.shareContentDefaults.iconName||"",iconText:this.strings.shareContentDefaults.iconText||""})),e.trigger("ShareBoxAdded",this,t),t)):t}})}),"use strict",define("listItemView",["jquery","backbone","baseView","deviceUtility"],function(e,t,n,r){var i,s=function(t){if(!t)return"";t=e(t);var n=t.find(".pagedateline"),r=t.find(".headline");return n.length&&r.length?[n.html(),r.html()].join("<br>"):r.length?r.html():n.length?n.html():""};return n.extend({tagName:"li",className:"article-list-item",events:{tap:"tap"},initialize:function(e){var t=this;this.model=e.model,this.options=e,this.isPaketVinjett=this.model.get("articles"),this.$el.attr("data-articleId",this.model.get("id")),this.model.active=function(){t.$el.addClass("active"),t.trigger("activeArticle",{model:this,el:t.$el})},this.model.inactivate=function(){t.$el.removeClass("active").addClass("read")}},tap:function(e){var n=0,s=this;return this.isPaketVinjett?!1:(r.isAndroid()&&(r.isBadAndroid()?n=400:n=200),window.clearTimeout(i),(r.isRunningAtMobile()||s.options.hideOnListElementTap)&&t.trigger("sidebar:close"),i=window.setTimeout(function(){s.model.activate()},n),t.trigger("setTapListItemTimeoutId",i),e.gesture.stopPropagation(),e.stopPropagation(),!1)},render:function(){return this.isPaketVinjett?(this.$el.addClass("vinjett"),this.$el.html(s(this.model.get("html")))):(this.options.related&&this.$el.addClass("related"),this.$el.prepend(this.options.title)),this}})}),"use strict",define("sectionView",["jquery","baseView","listItemView","advertModel"],function(e,t,n,r){return t.extend({tagName:"ol",className:"article-list",initialize:function(e){this.title=this.model.get("title"),this.articleList=this.model.get("articles"),this.hideOnListElementTap=e.hideOnListElementTap},render:function(){return this.$el.attr("data-section",this.title),this.$el.html(this.getArticleList()),this},hasArticles:function(e){return e.get("articles")?!0:!1},getArticleList:function(){this.articleList.each(function(t){var i=!1,s=this,o=function(e){s.trigger("activeArticle",e)},u;if(t instanceof r)return;var a={id:t.get("id"),title:t.get("title"),model:t,hideOnListElementTap:this.hideOnListElementTap};this.hasArticles(t)&&(i=!0,a.articles=t.get("articles")),u=new n(a),u.on("activeArticle",o),this.addView.call(this,u),this.$el.append(u.render().el);if(i){var f=e("<ol/>",{"class":"sub-list"});a.articles.each(function(e){var t=new n({title:e.get("title"),model:e,hideOnListElementTap:this.hideOnListElementTap,related:!0});t.on("activeArticle",o),this.addView.call(this,t),this.$el.append(t.render().el)},this)}},this)}})}),define("vendor/text!features/articleList/templates/listGroup.html",[],function(){return'<div class="list-heading <%= type %>-heading list-toggler">\n    <h3><%= heading %><i class="<%= iconClass %> list-toggler-icon"></i></h3>\n</div>\n<div class="list-body <%= type %>-body">\n</div>'}),define("listGroupView",["baseView","deviceUtility","vendor/text!features/articleList/templates/listGroup.html"],function(e,t,n){"use strict";return e.extend({listgroupTemplate:_.template(n),className:"list-container",events:{"tap .list-toggler":"toggleList","listgroup:toggle":"toggleList"},initialize:function(e){var t=this,n={hidden:!0,heading:"",typClass:""};e=$.extend(n,e),this.init(e),this.body=e.body,this.hidden=e.hidden,this.heading=this.model.get("title"),this.typClass=e.typClass,this.icons=e.icons,this.sectionClassName=e.sectionClassName,this.model.activate=function(){t.showList()},this.model.inactivate=function(){t.hideList()}},render:function(){var e=$.extend(!0,{},{heading:this.heading,type:this.typClass,sectionClassName:this.sectionClassName,iconClass:this.icons.close},this.templateModel);return this.$el.html(this.listgroupTemplate(e)),this.body&&this.$(".list-body").append(this.body.render().el),this.typClass!==""&&this.$el.addClass(this.typClass),this.sectionClassName&&this.$el.addClass(this.sectionClassName),this.setIcon(),this.hidden&&this.hideList(),this},setIcon:function(){this.toggleIcon=this.$(".list-toggler-icon")},showList:function(){return this.toggleIcon.removeClass(this.icons.close).addClass(this.icons.open),this.hidden=!1,this.$el.removeClass("list-hidden"),this},hideList:function(){return this.toggleIcon.removeClass(this.icons.open).addClass(this.icons.close),this.hidden=!0,this.$el.addClass("list-hidden"),this},toggleList:function(e){return this.hidden?this.showList():this.hideList(),e.stopPropagation(),this}})}),function(e){"use strict";typeof define=="function"&&define.amd?define("scrollTo",["jquery"],e):typeof module!="undefined"&&module.exports?module.exports=e(require("jquery")):e(jQuery)}(function(e){"use strict";function n(t){return!t.nodeName||e.inArray(t.nodeName.toLowerCase(),["iframe","#document","html","body"])!==-1}function r(t){return e.isFunction(t)||e.isPlainObject(t)?t:{top:t,left:t}}var t=e.scrollTo=function(t,n,r){return e(window).scrollTo(t,n,r)};return t.defaults={axis:"xy",duration:0,limit:!0},e.fn.scrollTo=function(i,s,o){typeof s=="object"&&(o=s,s=0),typeof o=="function"&&(o={onAfter:o}),i==="max"&&(i=9e9),o=e.extend({},t.defaults,o),s=s||o.duration;var u=o.queue&&o.axis.length>1;return u&&(s/=2),o.offset=r(o.offset),o.over=r(o.over),this.each(function(){function v(t){var n=e.extend({},o,{queue:!0,duration:s,complete:t&&function(){t.call(f,c,o)}});l.animate(h,n)}if(i===null)return;var a=n(this),f=a?this.contentWindow||window:this,l=e(f),c=i,h={},p;switch(typeof c){case"number":case"string":if(/^([+-]=?)?\d+(\.\d+)?(px|%)?$/.test(c)){c=r(c);break}c=a?e(c):e(c,f);case"object":if(c.length===0)return;if(c.is||c.style)p=(c=e(c)).offset()}var d=e.isFunction(o.offset)&&o.offset(f,c)||o.offset;e.each(o.axis.split(""),function(e,n){var r=n==="x"?"Left":"Top",i=r.toLowerCase(),s="scroll"+r,m=l[s](),g=t.max(f,n);if(p)h[s]=p[i]+(a?0:m-l.offset()[i]),o.margin&&(h[s]-=parseInt(c.css("margin"+r),10)||0,h[s]-=parseInt(c.css("border"+r+"Width"),10)||0),h[s]+=d[i]||0,o.over[i]&&(h[s]+=c[n==="x"?"width":"height"]()*o.over[i]);else{var y=c[i];h[s]=y.slice&&y.slice(-1)==="%"?parseFloat(y)/100*g:y}o.limit&&/^\d+$/.test(h[s])&&(h[s]=h[s]<=0?0:Math.min(h[s],g)),!e&&o.axis.length>1&&(m===h[s]?h={}:u&&(v(o.onAfterFirst),h={}))}),v(o.onAfter)})},t.max=function(t,r){var i=r==="x"?"Width":"Height",s="scroll"+i;if(!n(t))return t[s]-e(t)[i.toLowerCase()]();var o="client"+i,u=t.ownerDocument||t.document,a=u.documentElement,f=u.body;return Math.max(a[s],f[s])-Math.min(a[o],f[o])},e.Tween.propHooks.scrollLeft=e.Tween.propHooks.scrollTop={get:function(t){return e(t.elem)[t.prop]()},set:function(t){var n=this.get(t);if(t.options.interrupt&&t._last&&t._last!==n)return e(t.elem).stop();var r=Math.round(t.now);n!==r&&(e(t.elem)[t.prop](r),t._last=this.get(t))}},t}),"use strict",define("baseArticleListView",["backbone","jquery","baseView","sidebarView","deviceUtility","sectionView","listGroupView","scrollTo","issueService","hammer"],function(e,t,n,r,i,s,o,u,a,f){var l;return n.extend({tagName:"nav",id:"articles-list",events:{"tap .li-article:not(.vinjett)":"viewArticle"},initialize:function(e){this.init(e),this.sectionCollection=a.getSectionsFromCurrentIssue(),this.bindEvents()},render:function(){return!i.isRunningAtMobile(),this.$el.html(this.getArticleList()),this.sidebar=new r({hideOnTap:this.model.get("hideOnSidebarTap"),position:this.model.get("position"),transitTime:this.model.get("transitTime"),animate:this.model.get("animate")}),this.sidebar.render(this.$el),f(this.sidebar.$(".sidebar-inner")).on("dragdown dragup swipedown swipeup",this.clearTapListItemTimeoutId),this.addView.call(this,this.sidebar),this.sidebar},bindEvents:function(){return e.on("orientationchange",this.orientationChange,this),e.on("setTapListItemTimeoutId",this.setTapListItemTimeoutId,this),this},unbindEvents:function(){return e.off("orientationchange",this.orientationChange,this),e.off("setTapListItemTimeoutId",this.setTapListItemTimeoutId,this),f(this.sidebar.$(".sidebar-inner")).off("dragdown dragup swipedown swipeup",this.clearTapListItemTimeoutId),this},orientationChange:function(){this.sidebar&&this.sidebar.orientationChange()},setTapListItemTimeoutId:function(e){l=e},clearTapListItemTimeoutId:function(){window.clearTimeout(l)},getArticleList:function(){var e=[];return this.sectionCollection.each(function(t){t.get("articles").length>0&&e.push(this.getSectionGroup(t))},this),e},generateSectionClassName:function(e){return e.toLowerCase().trim().replace(/[^a-z0-9\s]/gi,"").replace(/[_\s]/g,"-")},getSectionGroup:function(e){var t=this.generateSectionClassName(e.get("title")),n=new s({model:e,hideOnListElementTap:this.model.get("hideOnListElementTap")}),r=new o({model:e,typClass:"section",sectionClassName:t,body:n,icons:this.model.get("icons"),strings:this.strings});return n.on("activeArticle",function(t){var r=t.model;this.activeSectionModel&&this.activeSectionModel!==e&&this.activeSectionModel.inactivate(),this.activeSectionModel=e,this.activeSectionModel.activate(),this.activeArticleModel&&this.activeArticleModel!==r&&this.activeArticleModel.inactivate(),this.activeArticleModel=r,t.el.index()>0?this.$el.parent().scrollTo(t.el,500):this.$el.parent().scrollTo(n.$el,500)},this),this.addView.call(this,r),this.addView.call(this,n),r.render().el}})}),"use strict",define("articleListView",["baseArticleListView"],function(e){return e.extend()}),"use strict",define("advertView",["backbone","baseView","jquery","advertUtility","dataService"],function(e,t,n,r,i){return t.extend({className:"reader-slide",isActive:!1,initialize:function(e){this.filesBasepath=e.filesBasepath},render:function(){var e;return this.$el.empty(),this.$el.attr("data-articleid",this.model.get("id")),i.online()&&this.model.get("urlHtmlAd")?e=r.generateIframeAdvertElement(this.model):e=r.generateImageAdvertElement(this.model),this.$el.append(e),this.adElement=n(e).find(".ad"),this},remove:function(){this.$el.empty()},setTemplate:function(e){this.template=_.template(e)},insertHtml:function(){if(!this.htmlInserted){if(i.online()&&this.model.get("urlHtmlAd"))this.adElement.attr("src",this.model.get("urlHtmlAd")),this.adElement.attr("width",this.$el.width()),this.adElement.attr("height",this.$el.height()-this.$(".adLeadin").height());else{var e=this.model.get("files").large,t=parseInt(e.width,10),n=parseInt(e.height,10);this.adElement.attr("src",this.filesBasepath+e.path),t>n?(this.adElement.css("width","100%"),this.adElement.css("height","auto")):(this.adElement.css("width","auto"),this.adElement.css("height",this.$el.height()-this.$(".adLeadin").height()))}this.htmlInserted=!0}},setOffset:function(e,t){t?this.$el.css("-webkit-transform","translate3d("+e+"px, 0, 0)"):this.$el.css("left",e)},activateStickyMobileHeader:function(){return this.setApplicationClass("hidden-sticky-header"),this},removeHtml:function(){this.adElement&&(this.adElement.attr("src",""),i.online()&&this.model.get("urlHtmlAd")?(this.adElement.attr("width",""),this.adElement.attr("height","")):(this.adElement.css("width",""),this.adElement.css("height","")),this.htmlInserted=!1)}})}),"use strict",define("readerView",["backbone","swiper","jquery","blockAdblockCSS","deviceUtility","baseView","sidebarView","articleView","articleListView","issueService","advertView","advertModel"],function(e,t,n,r,i,s,o,u,a,f,l,c){var h;return s.extend({className:"application-page",id:"reader-wrapper",shouldHaveStickyHeader:!1,events:{"blur .swiper-slide-active":function(e){window.requestAnimationFrame(function(){e.currentTarget.focus()})}},initialize:function(e){this.init(e),e.viewOptions.blockAdblockCSS?n.blockAdblockCSS({block:!0}):n.blockAdblockCSS({block:!1}),this.activeIndex=0,this.slides=[],this.reactToSidebar=e.viewOptions.reactToSidebar,e.viewOptions&&e.viewOptions.shareContentDefaults&&(this.shareContentDefaults=e.viewOptions.shareContentDefaults),this.shouldHaveStickyHeader=i.isRunningAtMobile()&&this.viewOptions.articleViewProperties.stickyHeader,this.bootstrapReaderData(e).bindEvents().addHooks(e)},render:function(){return this.$el.append(this.buildReaderSlides()),this},bootstrapReaderData:function(e){var t,n=e.partId||!1,r=this.model.get("parts");return n||r.length>0&&(n=r.first().get("id")),this.issueId=e.issueId,this.model.set("activePartId",n),e.articleId?t=e.articleId:t=this.getFirstArticleIdFromPart(r.get(n)),this.model.set("activeArticleId",t),this},componentDone:function(){this.initializeSwiper(this.model.get("activeArticleId")).updateIssueDetails()},addHooks:function(t){this.addHook.call(this,"beforeRender",function(){this.setApplicationClass("fixed "+t.viewOptions.componentName),t.viewOptions.reactToSidebar&&this.setApplicationClass("react-to-sidebar"),this.shouldHaveStickyHeader&&this.setApplicationClass("scroll-header")}),this.addHook.call(this,"afterRender",function(){this.activeIndex=this.getIndexByArticleId(this.model.get("activeArticleId")),e.trigger("removeLoader")}),this.addHook.call(this,"beforeClose",function(){this.removeApplicationClass("fixed react-to-sidebar scroll-header "+t.viewOptions.componentName),this.slides=[],h&&(h.destroy(),h=null)}),this.addHook.call(this,"afterClose",function(){e.trigger("setHistoryModel",null);for(var t in this)this.hasOwnProperty(t)&&delete this[t]})},getFirstArticleIdFromPart:function(e){var t=e.get("sections"),n,r;if(t){n=t.at(0);if(n){r=n.get("articles");if(r.models.length)return r.at(0).id}}return!1},buildReaderSlides:function(){var e,t=this,r=0,i=n("<div>").attr({id:"reader-container","class":"swiper-container"}),s=n("<div>").attr("class","reader-wrapper swiper-wrapper"),o=function(e){return{className:"reader-slide swiper-slide slide_"+r,model:e,parent:t,allowShare:t.model.get("allowShare"),issueIsDownloaded:t.model.get("downloaded"),filesBasepath:t.model.get("files_basepath"),shareContentDefaults:t.shareContentDefaults,viewOptions:t.viewOptions.articleViewProperties,imageGalleryProperties:t.viewOptions.imageGalleryProperties,strings:{shareContentDefaults:t.strings.shareContentDefaults,imageGallery:t.strings.imageGallery},pubdate:t.model.get("pubdate")}},a=function(e,t,n){this.slides.push(e),this.addView.call(this,e,n),r++};return i.html(s),this.model.get("parts").each(function(n){n.get("sections").each(function(r){r.get("articles").each(function(r){if(r.get("articles")){r.get("articles").each(function(n){e=new u(o(n)),n.activate=function(){t.swipeToArticle(n.get("id"))},a.call(this,e,n,s)},this);return}r instanceof c?e=new l(o(r)):(e=new u(o(r)),r.activate=function(){t.swipeToArticle(r.get("id"))},r.set("partModel",n)),a.call(this,e,r,s)},this)},this)},this),i},bindEvents:function(){return this.unbindEvents(),e.on("readerSlideChangeStart",this.onSlideChangeStart,this),e.on("readerSlideChangeEnd",this.onSlideChangeEnd,this),e.on("orientationchange",this.orientationChange,this),e.on("done:logoFeature",this.logoFeatureDone,this),e.on("done:dateFeature",this.dateFeatureDone,this),e.on("done:socialShareFeature",this.shareFeatureDone,this),e.on("done:articleListFeature",this.articleListFeatureDone,this),e.on("done:pagesIconFeature",this.pagesIconFeatureDone,this),e.on("navigate",this.navigateDone,this),this.reactToSidebar&&(e.on("sidebar:hide",this.sidebarHide,this),e.on("sidebar:show",this.sidebarShow,this)),e.on("textSizeTriggered",this.textsizeChange,this),e.on("imageGalleryFullscreen",this.onImageGalleryFullscreen,this),e.on("userFinishedAuthentication",this.userFinishedAuthentication,this),e.on("scrollTo",this.scrollTo,this),this},unbindEvents:function(){return e.off("readerSlideChangeStart",this.onSlideChangeStart,this),e.off("readerSlideChangeEnd",this.onSlideChangeEnd,this),e.off("orientationchange",this.orientationChange,this),e.off("done:logoFeature",this.logoFeatureDone,this),e.off("done:dateFeature",this.dateFeatureDone,this),e.off("done:socialShareFeature",this.shareFeatureDone,this),e.off("done:articleListFeature",this.articleListFeatureDone,this),e.off("done:pagesIconFeature",this.pagesIconFeatureDone,this),e.off("navigate",this.navigateDone,this),e.off("sidebar:show",this.sidebarShow,this),e.off("sidebar:hide",this.sidebarHide,this),e.off("textSizeTriggered",this.textsizeChange,this),e.off("imageGalleryFullscreen",this.onImageGalleryFullscreen,this),e.off("userFinishedAuthentication",this.userFinishedAuthentication,this),e.off("scrollTo",this.scrollTo,this),this.off("activeSectionChange"),this},scrollTo:function(e){switch(typeof e){case"string":switch(e){case"top":n(".swiper-slide-active").scrollTo("0px",{duration:400,interrupt:!0})}}},onActiveSlide:function(e){var t=e.slide,n=e.current;t.$el.addClass("active-slide").removeClass("inactive-slide current-slide"),t.insertHtml(),n&&t.$el.addClass("current-slide"),t.setImagePlaceholderHeight&&t.setImagePlaceholderHeight(),this.resetScrollTouchFix(t.$el)},onInactiveSlide:function(e){var t=e.slide;t.removeHtml(),t.$el.addClass("inactive-slide").removeClass("active-slide current-slide").css("-webkit-overflow-scrolling","")},userFinishedAuthentication:function(t){t===0&&this.model.get("downloaded")!==!0&&e.trigger("setRoute",{route:"logout",trigger:!0})},articleListFeatureDone:function(){this.updateCurrentArticle()},logoFeatureDone:function(){},dateFeatureDone:function(){e.trigger("setDate",this.model.get("pubdate"))},shareFeatureDone:function(){},pagesIconFeatureDone:function(t){e.trigger("setHistoryModel",{callback:t.onTapped,component:"reader"})},navigateDone:function(e){e.direction==="right"?h.slideNext():h.slidePrev()},onImageGalleryFullscreen:function(e){h&&e.hasOwnProperty("enableOtherKeyboardControls")&&(e.enableOtherKeyboardControls&&!h.params.keyboardControl?h.enableKeyboardControl():!e.enableOtherKeyboardControls&&h.params.keyboardControl&&h.disableKeyboardControl())},hasSidebar:function(){if(this.reactToSidebar){var e=n(".sidebar");return!e.hasClass("move-left")&&!e.hasClass("move-right")}return!1},sidebarHide:function(e){var t=this,r=i.isBadAndroid()?0:e.transitTime,s=e.position==="left"?n(".reader-slide").first():n(".reader-slide").last();window.setTimeout(function(){window.requestAnimationFrame(function(){t.updateSlides(),t.trigger("sizeChange")})},r)},sidebarShow:function(e){var t=this,n,r=i.isBadAndroid()?0:e.transitTime,s="animate";window.setTimeout(function(){window.requestAnimationFrame(function(){t.trigger("sizeChange"),t.updateSlides(),t.trigger("sizeChange")})},r)},textsizeChange:function(){this.textSizeIncreased?this.$("#reader-container").removeClass("increase-text-size"):this.$("#reader-container").addClass("increase-text-size"),this.textSizeIncreased=!this.textSizeIncreased},updateIssueDetails:function(){var t={articleNumber:0,articlesLength:f.getNumberOfCurrentIssueArticles(),section:""},n;return h&&t.articlesLength!==0&&(t.articleNumber=h.activeIndex+1,this.activeArticle&&(n=this.activeArticle.get("section"),n&&(t.section=n),this.setActiveSection(n))),e.trigger("setIssueDetails",t),this},orientationChange:function(){this.updateSlides()},updateSlides:function(){var e=this.hasSidebar(),t,r=n("#application-content"),s=e?n(".sidebar").outerWidth()-parseInt(r.css("left"),10):0;this.reactToSidebar&&(this.$("#reader-container").css("margin-left",s),h&&h.update(!0)),window.requestAnimationFrame(function(){i.isEvenMoreBadAndroid()&&(t=n(".update-on-android"),t.addClass("hidden"),window.setTimeout(function(){t.removeClass("hidden")},100))})},getAspectRatio:function(e){return 10*e/15},getIndexByArticleId:function(e){var t=0,n;return e&&(e=parseInt(e,10),this.slides&&this.slides.forEach(function(r,i){n=r.model,n&&parseInt(n.get("id"),10)===e&&(t=i)})),t},swipeToArticle:function(e){var t=this.getIndexByArticleId(e);return h&&h.slideTo(t,1,!0),this},updateCurrentArticle:function(t){var r=this.slides[t],i,s;return r?(i=r.model,this.shouldHaveStickyHeader&&r.activateStickyMobileHeader(),i.hasOwnProperty("active")&&i.active(),this.activeArticle=i,this.model.set({activeArticleId:i.get("id"),activePageIndex:i.get("pagina")}).setRoute(this.model.toJSON()),r instanceof u&&e.trigger("stat:articleView",i),s=i.get("partModel"),s&&this.model.set("activePartId",s.get("id")),n("div[data-articleid="+r.$el.data("articleid")+"]").focus()):this.activeArticle&&this.activeArticle.inactivate(),this},setActiveSection:function(e){e=e||"",e=this.replaceForeignCharacters(e),e&&e!==this.activeSection&&(this.activeSection=e,this.trigger("activeSectionChange",e))},initializeSwiper:function(t){return h=this.$("#reader-container").swiper({initialSlide:this.getIndexByArticleId(t),slidesPerView:1,HWCompositing:!1,runCallbacksOnInit:!1,keyboardControl:!0,onSlideChangeEnd:function(t){e.trigger("readerSlideChangeEnd",{activeIndex:t.activeIndex,previousIndex:t.previousIndex})}}),this.updateSlides(),this.onSlideChangeEnd(h),this},onSlideChangeEnd:function(e){this.slides.forEach(function(t,n){n===e.activeIndex?this.resetScrollTouchFix(t.$el):t.$el.css("-webkit-overflow-scrolling",""),n!==e.activeIndex&&n!==e.activeIndex-1&&n!==e.activeIndex+1?t.removeHtml():t.insertHtml()},this),this.updateCurrentArticle(e.activeIndex).updateIssueDetails()}})}),"use strict",define("readerComponent",["backbone","app","underscore","issueService","baseComponent","readerView","sessionService"],function(e,t,n,r,i,s,o){var u=n.extend({},i);return u.features=[],u.name="reader",u.routes={"reader/:issueId":function(e){u.open({issueId:e})},"reader/:issueId/:partId":function(e,t){u.open({issueId:e,partId:t})},"reader/:issueId/:partId/:articleId":function(e,t,n){u.open({issueId:e,partId:t,articleId:n})},"preview/:issueId/revision/:revisionId":function(e,t){u.fetchIssuePreview(e,t)}},u.view=s,u.setRoute=function(e,t){var n=u.name+"/"+e.id+"/";e.hasOwnProperty("activePartId")&&(n+=e.activePartId+"/"),e.hasOwnProperty("activeArticleId")&&(n+=e.activeArticleId),u.router.setRoute({route:n,trigger:t})},u.open=function(n,i){var s=this;e.trigger("displayLoader",u.strings.componentView.loadingMessage),window.setTimeout(function(){n=n||{};if(n.issueId){var o=r.fetchIssueById(n.issueId);o.done(function(i){i.setRoute=u.setRoute,n.model=i,r.setCurrentIssueModel(i),t.renderComponentView(u,n,function(t){e.trigger("header:open",s.viewOptions.headerOptions||{}),e.trigger("footer:open",n),e.trigger("info:open"),e.trigger("stat:openIssue",{issueId:i.get("id"),issueDate:i.get("pubdate"),issueMode:"articles",issueRevision:i.get("revision"),issueDownloaded:i.get("downloaded")}),u.renderFeatures(),t.componentDone(),u.ready(n.componentReady),e.trigger("removeLoader")})}),o.fail(function(t){e.trigger("removeLoader")})}else i.setRoute=u.setRoute,n.model=i,t.renderComponentView(u,n,function(t){e.trigger("header:open",s.viewOptions.headerOptions||{}),e.trigger("footer:open",n),e.trigger("info:open"),u.renderFeatures(),t.componentDone()})},100)},u.fetchIssuePreview=function(e,t){r.fetchIssuePreview({issueId:e,revision:t},function(e){var t=window.location;o.put("issueType",e.get("extension")),o.put("previewMode","nonDefault"),t.assign(t.origin+t.pathname+"#reader/"+e.get("id")),t.reload()})},u.beforeClose=function(){},u.closeComponent=function(){t.closeComponent(u)},e.on(u.name+":open",u.open,u),e.on(u.name+":beforeClose",u.beforeClose,u),e.on(u.name+":close",u.closeComponent,u),u}),"use strict",define("toggleArticleListIconModel",["backbone","baseFeatureModel","deviceUtility"],function(e,t,n){return t.extend({initialize:function(){this.set("active",!1),this.bindEvents()},activate:function(){this.set("active",!0)},deActivate:function(){this.set("active",!1)},bindEvents:function(){this.unbindEvents(),this.on("change:subjects",this.onAttributesChange,this),e.on("sidebar:hide",this.deActivate,this),e.on("sidebar:show",this.activate,this)},unbindEvents:function(){this.off("change:subjects"),e.off("sidebar:hide",this.deActivate,this),e.off("sidebar:show",this.activate,this),e.off("sidebar:beforeRender",this.startHiddenOnSmallDevices,this),e.off("sidebar:afterRender",this.closeSidebarIfNotActiveInConfig,this)},onAttributesChange:function(){n.isRunningAtMobile()&&e.on("sidebar:afterRender",this.closeSidebarIfNotActiveOnSmallDevices,this),n.isRunningAtMobile()||e.on("sidebar:afterRender",this.closeSidebarIfNotActiveInConfig,this)},closeSidebarIfNotActiveInConfig:function(){return this.get("startHidden")&&e.trigger("sidebar:close"),this},closeSidebarIfNotActiveOnSmallDevices:function(){return this.get("activeSmallDevices")||e.trigger("sidebar:close"),this},onTapped:function(){return this.get("subjects").forEach(function(t){e.trigger(t+":toggle")}),this},toggleActive:function(){this.set("active",!this.get("active"))}})}),"use strict",define("toggleArticleListIconView",["baseFeatureView","underscore","vendor/text!features/iconLinks/templates/iconLinkTemplate.html"],function(e,t,n){return e.extend({className:"toggle-icon",events:{tap:"tap"},initialize:function(e){this.init(e),this.toggleHTML=t.template(n),this.bindEvents()},tap:function(){this.model.tapped.call(this.model)},bindEvents:function(){return this.unbindEvents(),this.model.on("change:active",this.render,this),this},unbindEvents:function(){return this.model.off("change:active",this.render,this),this},render:function(){var e=this.model.get("active"),t=this.model.get("icons"),n=this.strings&&this.strings.iconText?e?this.strings.iconText.inactivate||"":this.strings.iconText.activate||"":"";return this.$el.html(this.toggleHTML({iconName:e?t.close:t.open,iconText:n})),e?this.$el.addClass("active"):this.$el.removeClass("active"),this.$el.addClass(this.model.get("className")),this}})}),"use strict",define("toggleArticleListIconFeature",["underscore","baseFeature","toggleArticleListIconModel","toggleArticleListIconView"],function(e,t,n,r){return function(){this.feature=e.extend({},t);var i=new n;this.feature.setView.call(this.feature,r).setModel.call(this.feature,i)}}),"use strict",define("textsizeView",["baseFeatureView","localService","hammer","vendor/text!features/iconLinks/templates/iconLinkTemplate.html"],function(e,t,n,r){return e.extend({textSizeTemplate:_.template(r),className:"text-size-icon",events:{tap:function(){this.model.tapped.call(this.model)}},initialize:function(e){this.context=e.context,this.strings=e.strings,this.model=e.model;var n=t.get("textsizeEnabled");n!==null?(n=n==="true"?!0:!1,this.model.set("enabled",n),n&&this.model.triggerEvent()):this.model.set("enabled",!1),this.bindEvents()},bindEvents:function(){this.unbindEvents(),this.model.on("change:enabled",this.render,this)},unbindEvents:function(){this.model.off("change:enabled",this.render,this)},render:function(){var e=this.model.get("enabled");return t.put("textsizeEnabled",e),this.$el.html(this.textSizeTemplate({iconName:e?this.model.get("icons").smaller:this.model.get("icons").larger,iconText:e?this.strings.iconText.smaller:this.strings.iconText.larger})),this.$el.addClass(this.model.get("className")),e?this.$el.addClass("active"):this.$el.removeClass("active"),this}})}),"use strict",define("textsizeModel",["backbone","baseFeatureModel"],function(e,t){return t.extend({defaults:{enabled:!1},toggleEnabled:function(){this.set("enabled",!this.get("enabled"))},triggerEvent:function(){e.trigger("textSizeTriggered",{largerText:this.get("enabled")})},onTapped:function(){return this.toggleEnabled(),this.triggerEvent(),this}})}),"use strict",define("textsizeFeature",["underscore","backbone","baseFeature","textsizeView","textsizeModel"],function(e,t,n,r,i){return function(){this.feature=e.extend({},n);var t=new i;this.feature.setView.call(this.feature,r).setModel.call(this.feature,t)}}),"use strict",define("pagesIconModel",["baseFeatureModel"],function(e){return e.extend({})}),"use strict",define("pagesIconView",["baseFeatureView","underscore","vendor/text!features/iconLinks/templates/iconLinkTemplate.html"],function(e,t,n){return e.extend({className:"pages-icon",events:{tap:"tap"},initialize:function(e){this.init(e),this.model.set("hasBeenPressedOnce",!1),this.pagesIconHTML=t.template(n)},tap:function(){if(this.model.get("hasBeenPressedOnce"))return;this.model.set("hasBeenPressedOnce",!0),this.model.tapped.call(this.model)},render:function(){return this.$el.html(this.pagesIconHTML({iconName:this.model.get("iconName"),iconText:this.strings.iconText})),this.$el.addClass(this.model.get("className")),this}})}),"use strict",define("pagesIconFeature",["underscore","backbone","issueService","baseFeature","pagesIconModel","pagesIconView"],function(e,t,n,r,i,s){var o=function(e,t){var r=n.getCurrentIssueModel(),i=t?r.get("pagesPartId"):r.get("activePartId"),s=e?r.get("pagesPageIndex"):r.get("activePageIndex"),o="pages/"+r.get("id");return i&&(o+="/"+i,s&&(o+="/"+s)),o};return function(){this.feature=e.extend({},r);var n=new i;n.onTapped=function(){return t.trigger("popup:close"),t.trigger("setRoute",{route:o(n.get("usePagesPageIndex"),n.get("usePagesPartId")),trigger:!0}),this},this.feature.setView.call(this.feature,s).setModel.call(this.feature,n)}}),"use strict",define("articleListFeature",["baseFeature","articleListView"],function(e,t){return function(){this.feature=_.extend({},e),this.feature.setView.call(this.feature,t),this.feature.setModel.call(this.feature)}}),"use strict",define("prevNextNavigationModel",["baseFeatureModel"],function(e){return e.extend({defaults:{windowBorderLinks:!1},enable:function(){this.trigger("enable")},disable:function(){this.trigger("disable")}})}),define("vendor/text!features/prevNextNavigation/templates/prevNextNavigationTemplate.html",[],function(){return'<span id="prev-page" class="navigation-icon navigation-el" title="<%= prevIconTooltip %>">\n    <i class="<%= prevIconName %>"></i>\n</span>\n\n<span class="navigation-text navigation-el"><%= navigationText %></span>\n\n<span id="next-page" class="navigation-icon navigation-el" title="<%= nextIconTooltip %>">\n    <i class="<%= nextIconName %>"></i>\n</span>'}),"use strict",define("prevNextNavigationView",["baseFeatureView","backbone","hammer","vendor/text!features/prevNextNavigation/templates/prevNextNavigationTemplate.html"],function(e,t,n,r){return e.extend({className:"navigation-container",events:{"tap #prev-page":"previousPage","tap #next-page":"nextPage"},initialize:function(e){this.init(e),this.enabled=!0,this.prevNextNavigationHTML=_.template(r),this.bindEvents()},previousPage:function(){this.model.tapped.call(this.model,"left")},nextPage:function(){this.model.tapped.call(this.model,"right")},bindEvents:function(){this.unbindEvents(),t.on("enablePageNavigation",this.enable,this),t.on("disablePageNavigation",this.disable,this)},unbindEvents:function(){t.off("enablePageNavigation"),t.off("disablePageNavigation"),t.off("willChangePageByExternal",this.fakeHover,this)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},fakeHover:function(e){e=e||{};if(!e.direction)return;var t=this;this.$(e.direction+"-page").addClass("hover"),window.clearTimeout(this.fakeHoverTimeoutId),this.fakeHoverTimeoutId=window.setTimeout(function(){t.$(".navigation-icon").removeClass("hover")},500)},render:function(){return this.$el.html(this.prevNextNavigationHTML({prevIconName:this.model.get("icons").previous,nextIconName:this.model.get("icons").next,navigationText:this.strings.iconText,prevIconTooltip:this.strings.tooltip?this.strings.tooltip.prevIcon:"",nextIconTooltip:this.strings.tooltip?this.strings.tooltip.nextIcon:""})),this.model.get("className")&&this.$el.addClass(this.model.get("className")),this.model.get("windowBorderLinks")&&this.setApplicationClass("border-links"),this.model.get("forcePositionClass")&&this.$el.addClass(this.model.get("forcePositionClass")),this}})}),"use strict",define("prevNextNavigationFeature",["underscore","backbone","baseFeature","prevNextNavigationModel","prevNextNavigationView"],function(e,t,n,r,i){return function(){this.feature=e.extend({},n);var s=new r;s.onTapped=function(e){return t.trigger("navigate",{direction:e}),this},this.feature.setView.call(this.feature,i).setModel.call(this.feature,s)}}),"use strict",define("pagesFacadeComponent",["deviceUtility"],function(e){var t,n=e.isPdfCompatible(),r=e.isRunningAsHybridApplication;return n?r?t="pdfNative":t="pdf":t="tiled",t}),define("eventView",["backbone","baseView","hammer"],function(e,t,n){var r=function(e){return(e*100<0?0:e*100)+"%"};return t.extend({className:"article-event-layer",onTapped:function(e){},initialize:function(e){this.bootstrapEventData(e),this.bindEvents()},bootstrapEventData:function(t){this.issueId=t.issueId,this.partId=t.partId,this.trigger=t.trigger,this.model=new e.Model(t.model),this.openOverlayElements=t.openOverlayElements},bindEvents:function(){var t=this,r;n(this.$el).on(this.trigger,function(n){if(t.openOverlayElements.length>0)return;n.stopPropagation(),n.gesture.stopPropagation(),$(".article-search-text-box").blur();switch(t.model.get("type")){case"article":r=t.model.get("property").articleId,e.trigger("stat:articleEventLayerTapped",{articleId:r}),e.trigger("reader:open",{issueId:t.issueId,partId:t.partId,articleId:r});break;case"externalLink":e.trigger("openExternalURL",{requestedURL:t.model.get("property").url,requestedTarget:"new"})}return!1})},unbindEvents:function(){$(window).unbind("resize."+this.cid)},render:function(){var e=this.model.get("position");this.$el.css({width:r(e.width),height:r(e.height),top:r(e.top),left:r(e.left)}),this.$el.attr("data-link-type",this.model.get("type"));switch(this.model.get("type")){case"article":this.$el.attr("data-articleid",this.model.get("property").articleId)}return this}})}),function(e,t){"use strict";typeof define=="function"&&define.amd?define("pdfjs-dist/build/pdf",["exports"],t):typeof exports!="undefined"?t(exports):t(e.pdfjsDistBuildPdf={})}(this,function(e){"use strict";var t="1.7.225",n="17d135f",r=typeof document!="undefined"&&document.currentScript?document.currentScript.src:null,i={};(function(){(function(e,t){t(e.pdfjsSharedUtil={})})(this,function(e){function d(e){p=e}function v(){return p}function m(e){p>=c.infos&&console.log("Info: "+e)}function g(e){p>=c.warnings&&console.log("Warning: "+e)}function y(e){console.log("Deprecated API usage: "+e)}function b(e){throw p>=c.errors&&(console.log("Error: "+e),console.log(w())),new Error(e)}function w(){try{throw new Error}catch(e){return e.stack?e.stack.split("\n").slice(2).join("\n"):""}}function E(e,t){e||b(t)}function x(e,t){try{var n=new URL(e);if(!n.origin||n.origin==="null")return!1}catch(r){return!1}var i=new URL(t,n);return n.origin===i.origin}function T(e){if(!e)return!1;switch(e.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function N(e,t){if(!e)return null;try{var n=t?new URL(e,t):new URL(e);if(T(n))return n}catch(r){}return null}function C(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!1}),n}function k(e){var t;return function(){return e&&(t=Object.create(null),e(t),e=null),t}}function F(e){return typeof e!="string"?(g("The argument for removeNullCharacters must be a string."),e):e.replace(j,"")}function I(e){E(e!==null&&typeof e=="object"&&e.length!==undefined,"Invalid argument for bytesToString");var t=e.length,n=8192;if(t<n)return String.fromCharCode.apply(null,e);var r=[];for(var i=0;i<t;i+=n){var s=Math.min(i+n,t),o=e.subarray(i,s);r.push(String.fromCharCode.apply(null,o))}return r.join("")}function q(e){E(typeof e=="string","Invalid argument for stringToBytes");var t=e.length,n=new Uint8Array(t);for(var r=0;r<t;++r)n[r]=e.charCodeAt(r)&255;return n}function R(e){return e.length!==undefined?e.length:(E(e.byteLength!==undefined),e.byteLength)}function U(e){if(e.length===1&&e[0]instanceof Uint8Array)return e[0];var t=0,n,r=e.length,i,s;for(n=0;n<r;n++)i=e[n],s=R(i),t+=s;var o=0,u=new Uint8Array(t);for(n=0;n<r;n++)i=e[n],i instanceof Uint8Array||(typeof i=="string"?i=q(i):i=new Uint8Array(i)),s=i.byteLength,u.set(i,o),o+=s;return u}function z(e){return String.fromCharCode(e>>24&255,e>>16&255,e>>8&255,e&255)}function W(e){var t=1,n=0;while(e>t)t<<=1,n++;return n}function X(e,t){return e[t]<<24>>24}function V(e,t){return e[t]<<8|e[t+1]}function $(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}function J(){var e=new Uint8Array(2);e[0]=1;var t=new Uint16Array(e.buffer);return t[0]===1}function K(){try{return new Function(""),!0}catch(e){return!1}}function tt(e){var t,n=e.length,r=[];if(e[0]===""&&e[1]==="")for(t=2;t<n;t+=2)r.push(String.fromCharCode(e.charCodeAt(t)<<8|e.charCodeAt(t+1)));else for(t=0;t<n;++t){var i=et[e.charCodeAt(t)];r.push(i?String.fromCharCode(i):e.charAt(t))}return r.join("")}function nt(e){return decodeURIComponent(escape(e))}function rt(e){return unescape(encodeURIComponent(e))}function it(e){for(var t in e)return!1;return!0}function st(e){return typeof e=="boolean"}function ot(e){return typeof e=="number"&&(e|0)===e}function ut(e){return typeof e=="number"}function at(e){return typeof e=="string"}function ft(e){return e instanceof Array}function lt(e){return typeof e=="object"&&e!==null&&e.byteLength!==undefined}function ct(e){return e===32||e===9||e===13||e===10}function ht(){var e={};return e.promise=new Promise(function(t,n){e.resolve=t,e.reject=n}),e}function mt(e,t,n){this.sourceName=e,this.targetName=t,this.comObj=n,this.callbackIndex=1,this.postMessageTransfers=!0;var r=this.callbacksCapabilities=Object.create(null),i=this.actionHandler=Object.create(null);this._onComObjOnMessage=function(t){var s=t.data;if(s.targetName!==this.sourceName)return;if(s.isReply){var o=s.callbackId;if(s.callbackId in r){var u=r[o];delete r[o],"error"in s?u.reject(s.error):u.resolve(s.data)}else b("Cannot resolve callback "+o)}else if(s.action in i){var a=i[s.action];if(s.callbackId){var f=this.sourceName,l=s.sourceName;Promise.resolve().then(function(){return a[0].call(a[1],s.data)}).then(function(e){n.postMessage({sourceName:f,targetName:l,isReply:!0,callbackId:s.callbackId,data:e})},function(e){e instanceof Error&&(e+=""),n.postMessage({sourceName:f,targetName:l,isReply:!0,callbackId:s.callbackId,error:e})})}else a[0].call(a[1],s.data)}else b("Unknown action from worker: "+s.action)}.bind(this),n.addEventListener("message",this._onComObjOnMessage)}function gt(e,t,n){var r=new Image;r.onload=function(){n.resolve(e,r)},r.onerror=function(){n.resolve(e,null),g("Error during JPEG image loading")},r.src=t}var t=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:this,n=[.001,0,0,.001,0,0],r={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},i={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},s={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},o={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512},u={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864},a={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},f={UNKNOWN:0,FLATE:1,LZW:2,DCT:3,JPX:4,JBIG:5,A85:6,AHX:7,CCF:8,RL:9},l={UNKNOWN:0,TYPE1:1,TYPE1C:2,CIDFONTTYPE0:3,CIDFONTTYPE0C:4,TRUETYPE:5,CIDFONTTYPE2:6,TYPE3:7,OPENTYPE:8,TYPE0:9,MMTYPE1:10},c={errors:0,warnings:1,infos:5},h={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotations:78,endAnnotations:79,beginAnnotation:80,endAnnotation:81,paintJpegXObject:82,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91},p=c.warnings,S={unknown:"unknown",forms:"forms",javaScript:"javaScript",smask:"smask",shadingPattern:"shadingPattern",font:"font"},L={NEED_PASSWORD:1,INCORRECT_PASSWORD:2},A=function(){function t(e,t){this.name="PasswordException",this.message=e,this.code=t}return t.prototype=new Error,t.constructor=t,t}(),O=function(){function t(e,t){this.name="UnknownErrorException",this.message=e,this.details=t}return t.prototype=new Error,t.constructor=t,t}(),M=function(){function t(e){this.name="InvalidPDFException",this.message=e}return t.prototype=new Error,t.constructor=t,t}(),_=function(){function t(e){this.name="MissingPDFException",this.message=e}return t.prototype=new Error,t.constructor=t,t}(),D=function(){function t(e,t){this.name="UnexpectedResponseException",this.message=e,this.status=t}return t.prototype=new Error,t.constructor=t,t}(),P=function(){function t(e){this.message=e}return t.prototype=new Error,t.prototype.name="NotImplementedException",t.constructor=t,t}(),H=function(){function t(e,t){this.begin=e,this.end=t,this.message="Missing data ["+e+", "+t+")"}return t.prototype=new Error,t.prototype.name="MissingDataException",t.constructor=t,t}(),B=function(){function t(e){this.message=e}return t.prototype=new Error,t.prototype.name="XRefParseException",t.constructor=t,t}(),j=/\x00/g,Q=function(){function t(e,t){this.buffer=e,this.byteLength=e.length,this.length=t===undefined?this.byteLength>>2:t,i(this.length)}function r(e){return{get:function(){var t=this.buffer,n=e<<2;return(t[n]|t[n+1]<<8|t[n+2]<<16|t[n+3]<<24)>>>0},set:function(t){var n=this.buffer,r=e<<2;n[r]=t&255,n[r+1]=t>>8&255,n[r+2]=t>>16&255,n[r+3]=t>>>24&255}}}function i(e){while(n<e)Object.defineProperty(t.prototype,n,r(n)),n++}t.prototype=Object.create(null);var n=0;return t}();e.Uint32ArrayView=Q;var G=[1,0,0,1,0,0],Y=function(){function t(){}var n=["rgb(",0,",",0,",",0,")"];t.makeCssRgb=function(t,r,i){return n[1]=t,n[3]=r,n[5]=i,n.join("")},t.transform=function(t,n){return[t[0]*n[0]+t[2]*n[1],t[1]*n[0]+t[3]*n[1],t[0]*n[2]+t[2]*n[3],t[1]*n[2]+t[3]*n[3],t[0]*n[4]+t[2]*n[5]+t[4],t[1]*n[4]+t[3]*n[5]+t[5]]},t.applyTransform=function(t,n){var r=t[0]*n[0]+t[1]*n[2]+n[4],i=t[0]*n[1]+t[1]*n[3]+n[5];return[r,i]},t.applyInverseTransform=function(t,n){var r=n[0]*n[3]-n[1]*n[2],i=(t[0]*n[3]-t[1]*n[2]+n[2]*n[5]-n[4]*n[3])/r,s=(-t[0]*n[1]+t[1]*n[0]+n[4]*n[1]-n[5]*n[0])/r;return[i,s]},t.getAxialAlignedBoundingBox=function(n,r){var i=t.applyTransform(n,r),s=t.applyTransform(n.slice(2,4),r),o=t.applyTransform([n[0],n[3]],r),u=t.applyTransform([n[2],n[1]],r);return[Math.min(i[0],s[0],o[0],u[0]),Math.min(i[1],s[1],o[1],u[1]),Math.max(i[0],s[0],o[0],u[0]),Math.max(i[1],s[1],o[1],u[1])]},t.inverseTransform=function(t){var n=t[0]*t[3]-t[1]*t[2];return[t[3]/n,-t[1]/n,-t[2]/n,t[0]/n,(t[2]*t[5]-t[4]*t[3])/n,(t[4]*t[1]-t[5]*t[0])/n]},t.apply3dTransform=function(t,n){return[t[0]*n[0]+t[1]*n[1]+t[2]*n[2],t[3]*n[0]+t[4]*n[1]+t[5]*n[2],t[6]*n[0]+t[7]*n[1]+t[8]*n[2]]},t.singularValueDecompose2dScale=function(t){var n=[t[0],t[2],t[1],t[3]],r=t[0]*n[0]+t[1]*n[2],i=t[0]*n[1]+t[1]*n[3],s=t[2]*n[0]+t[3]*n[2],o=t[2]*n[1]+t[3]*n[3],u=(r+o)/2,a=Math.sqrt((r+o)*(r+o)-4*(r*o-s*i))/2,f=u+a||1,l=u-a||1;return[Math.sqrt(f),Math.sqrt(l)]},t.normalizeRect=function(t){var n=t.slice(0);return t[0]>t[2]&&(n[0]=t[2],n[2]=t[0]),t[1]>t[3]&&(n[1]=t[3],n[3]=t[1]),n},t.intersect=function(n,r){function i(e,t){return e-t}var s=[n[0],n[2],r[0],r[2]].sort(i),o=[n[1],n[3],r[1],r[3]].sort(i),u=[];return n=t.normalizeRect(n),r=t.normalizeRect(r),s[0]===n[0]&&s[1]===r[0]||s[0]===r[0]&&s[1]===n[0]?(u[0]=s[1],u[2]=s[2],o[0]===n[1]&&o[1]===r[1]||o[0]===r[1]&&o[1]===n[1]?(u[1]=o[1],u[3]=o[2],u):!1):!1},t.sign=function(t){return t<0?-1:1};var r=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"];return t.toRoman=function(t,n){E(ot(t)&&t>0,"The number should be a positive integer.");var i,s=[];while(t>=1e3)t-=1e3,s.push("M");i=t/100|0,t%=100,s.push(r[i]),i=t/10|0,t%=10,s.push(r[10+i]),s.push(r[20+t]);var o=s.join("");return n?o.toLowerCase():o},t.appendToArray=function(t,n){Array.prototype.push.apply(t,n)},t.prependToArray=function(t,n){Array.prototype.unshift.apply(t,n)},t.extendObj=function(t,n){for(var r in n)t[r]=n[r]},t.getInheritableProperty=function(t,n,r){while(t&&!t.has(n))t=t.get("Parent");return t?r?t.getArray(n):t.get(n):null},t.inherit=function(t,n,r){t.prototype=Object.create(n.prototype),t.prototype.constructor=t;for(var i in r)t.prototype[i]=r[i]},t.loadScript=function(t,n){var r=document.createElement("script"),i=!1;r.setAttribute("src",t),n&&(r.onload=function(){i||n(),i=!0}),document.getElementsByTagName("head")[0].appendChild(r)},t}(),Z=function(){function t(e,t,n,r,i,s){this.viewBox=e,this.scale=t,this.rotation=n,this.offsetX=r,this.offsetY=i;var o=(e[2]+e[0])/2,u=(e[3]+e[1])/2,a,f,l,c;n%=360,n=n<0?n+360:n;switch(n){case 180:a=-1,f=0,l=0,c=1;break;case 90:a=0,f=1,l=1,c=0;break;case 270:a=0,f=-1,l=-1,c=0;break;default:a=1,f=0,l=0,c=-1}s&&(l=-l,c=-c);var h,p,d,v;a===0?(h=Math.abs(u-e[1])*t+r,p=Math.abs(o-e[0])*t+i,d=Math.abs(e[3]-e[1])*t,v=Math.abs(e[2]-e[0])*t):(h=Math.abs(o-e[0])*t+r,p=Math.abs(u-e[1])*t+i,d=Math.abs(e[2]-e[0])*t,v=Math.abs(e[3]-e[1])*t),this.transform=[a*t,f*t,l*t,c*t,h-a*t*o-l*t*u,p-f*t*o-c*t*u],this.width=d,this.height=v,this.fontScale=t}return t.prototype={clone:function(n){n=n||{};var r="scale"in n?n.scale:this.scale,i="rotation"in n?n.rotation:this.rotation;return new t(this.viewBox.slice(),r,i,this.offsetX,this.offsetY,n.dontFlip)},convertToViewportPoint:function(t,n){return Y.applyTransform([t,n],this.transform)},convertToViewportRectangle:function(t){var n=Y.applyTransform([t[0],t[1]],this.transform),r=Y.applyTransform([t[2],t[3]],this.transform);return[n[0],n[1],r[0],r[1]]},convertToPdfPoint:function(t,n){return Y.applyInverseTransform([t,n],this.transform)}},t}(),et=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];(function(){if(t.Promise){typeof t.Promise.all!="function"&&(t.Promise.all=function(e){var n=0,r=[],i,s,o=new t.Promise(function(e,t){i=e,s=t});return e.forEach(function(e,t){n++,e.then(function(e){r[t]=e,n--,n===0&&i(r)},s)}),n===0&&i(r),o}),typeof t.Promise.resolve!="function"&&(t.Promise.resolve=function(e){return new t.Promise(function(t){t(e)})}),typeof t.Promise.reject!="function"&&(t.Promise.reject=function(e){return new t.Promise(function(t,n){n(e)})}),typeof t.Promise.prototype.catch!="function"&&(t.Promise.prototype.catch=function(e){return t.Promise.prototype.then(undefined,e)});return}var n=0,r=1,i=2,s=500,o={handlers:[],running:!1,unhandledRejections:[],pendingRejectionCheck:!1,scheduleHandlers:function(t){if(t._status===n)return;this.handlers=this.handlers.concat(t._handlers),t._handlers=[];if(this.running)return;this.running=!0,setTimeout(this.runHandlers.bind(this),0)},runHandlers:function(){var t=1,n=Date.now()+t;while(this.handlers.length>0){var s=this.handlers.shift(),o=s.thisPromise._status,u=s.thisPromise._value;try{o===r?typeof s.onResolve=="function"&&(u=s.onResolve(u)):typeof s.onReject=="function"&&(u=s.onReject(u),o=r,s.thisPromise._unhandledRejection&&this.removeUnhandeledRejection(s.thisPromise))}catch(a){o=i,u=a}s.nextPromise._updateStatus(o,u);if(Date.now()>=n)break}if(this.handlers.length>0){setTimeout(this.runHandlers.bind(this),0);return}this.running=!1},addUnhandledRejection:function(t){this.unhandledRejections.push({promise:t,time:Date.now()}),this.scheduleRejectionCheck()},removeUnhandeledRejection:function(t){t._unhandledRejection=!1;for(var n=0;n<this.unhandledRejections.length;n++)this.unhandledRejections[n].promise===t&&(this.unhandledRejections.splice(n),n--)},scheduleRejectionCheck:function(){if(this.pendingRejectionCheck)return;this.pendingRejectionCheck=!0,setTimeout(function(){this.pendingRejectionCheck=!1;var t=Date.now();for(var n=0;n<this.unhandledRejections.length;n++)if(t-this.unhandledRejections[n].time>s){var r=this.unhandledRejections[n].promise._value,i="Unhandled rejection: "+r;r.stack&&(i+="\n"+r.stack),g(i),this.unhandledRejections.splice(n),n--}this.unhandledRejections.length&&this.scheduleRejectionCheck()}.bind(this),s)}},u=function(t){this._status=n,this._handlers=[];try{t.call(this,this._resolve.bind(this),this._reject.bind(this))}catch(r){this._reject(r)}};u.all=function(t){function f(e){if(s._status===i)return;a=[],r(e)}var n,r,s=new u(function(e,t){n=e,r=t}),o=t.length,a=[];if(o===0)return n(a),s;for(var l=0,c=t.length;l<c;++l){var h=t[l],p=function(e){return function(t){if(s._status===i)return;a[e]=t,o--,o===0&&n(a)}}(l);u.isPromise(h)?h.then(p,f):p(h)}return s},u.isPromise=function(t){return t&&typeof t.then=="function"},u.resolve=function(t){return new u(function(e){e(t)})},u.reject=function(t){return new u(function(e,n){n(t)})},u.prototype={_status:null,_value:null,_handlers:null,_unhandledRejection:null,_updateStatus:function(t,n){if(this._status===r||this._status===i)return;if(t===r&&u.isPromise(n)){n.then(this._updateStatus.bind(this,r),this._updateStatus.bind(this,i));return}this._status=t,this._value=n,t===i&&this._handlers.length===0&&(this._unhandledRejection=!0,o.addUnhandledRejection(this)),o.scheduleHandlers(this)},_resolve:function(t){this._updateStatus(r,t)},_reject:function(t){this._updateStatus(i,t)},then:function(t,n){var r=new u(function(e,t){this.resolve=e,this.reject=t});return this._handlers.push({thisPromise:this,onResolve:t,onReject:n,nextPromise:r}),o.scheduleHandlers(this),r},"catch":function(t){return this.then(undefined,t)}},t.Promise=u})(),function(){function r(){this.id="$weakmap"+n++}if(t.WeakMap)return;var n=0;r.prototype={has:function(e){return!!Object.getOwnPropertyDescriptor(e,this.id)},get:function(e,t){return this.has(e)?e[this.id]:t},set:function(e,t){Object.defineProperty(e,this.id,{value:t,enumerable:!1,configurable:!0})},"delete":function(e){delete e[this.id]}},t.WeakMap=r}();var pt=function(){function t(e,t,n){while(e.length<n)e+=t;return e}function n(){this.started=Object.create(null),this.times=[],this.enabled=!0}return n.prototype={time:function(t){if(!this.enabled)return;t in this.started&&g("Timer is already running for "+t),this.started[t]=Date.now()},timeEnd:function(t){if(!this.enabled)return;t in this.started||g("Timer has not been started for "+t),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]},toString:function(){var n,r,i=this.times,s="",o=0;for(n=0,r=i.length;n<r;++n){var u=i[n].name;u.length>o&&(o=u.length)}for(n=0,r=i.length;n<r;++n){var a=i[n],f=a.end-a.start;s+=t(a.name," ",o)+" "+f+"ms\n"}return s}},n}(),dt=function(t,n){if(typeof Blob!="undefined")return new Blob([t],{type:n});g('The "Blob" constructor is not supported.')},vt=function(){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";return function(n,r,i){if(!i&&typeof URL!="undefined"&&URL.createObjectURL){var s=dt(n,r);return URL.createObjectURL(s)}var o="data:"+r+";base64,";for(var u=0,a=n.length;u<a;u+=3){var f=n[u]&255,l=n[u+1]&255,c=n[u+2]&255,h=f>>2,p=(f&3)<<4|l>>4,d=u+1<a?(l&15)<<2|c>>6:64,v=u+2<a?c&63:64;o+=t[h]+t[p]+t[d]+t[v]}return o}}();mt.prototype={on:function(t,n,r){var i=this.actionHandler;i[t]&&b('There is already an actionName called "'+t+'"'),i[t]=[n,r]},send:function(t,n,r){var i={sourceName:this.sourceName,targetName:this.targetName,action:t,data:n};this.postMessage(i,r)},sendWithPromise:function(t,n,r){var i=this.callbackIndex++,s={sourceName:this.sourceName,targetName:this.targetName,action:t,data:n,callbackId:i},o=ht();this.callbacksCapabilities[i]=o;try{this.postMessage(s,r)}catch(u){o.reject(u)}return o.promise},postMessage:function(e,t){t&&this.postMessageTransfers?this.comObj.postMessage(e,t):this.comObj.postMessage(e)},destroy:function(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}},function(t){function u(e){return s[e]!==undefined}function a(){m.call(this),this._isInvalid=!0}function f(e){return e===""&&a.call(this),e.toLowerCase()}function l(e){var t=e.charCodeAt(0);return t>32&&t<127&&[34,35,60,62,63,96].indexOf(t)===-1?e:encodeURIComponent(e)}function c(e){var t=e.charCodeAt(0);return t>32&&t<127&&[34,35,60,62,96].indexOf(t)===-1?e:encodeURIComponent(e)}function v(e,t,n){function r(e){b.push(e)}var i=t||"scheme start",v=0,m="",g=!1,y=!1,b=[];e:while((e[v-1]!==h||v===0)&&!this._isInvalid){var w=e[v];switch(i){case"scheme start":if(!w||!p.test(w)){if(!t){m="",i="no scheme";continue}r("Invalid scheme.");break e}m+=w.toLowerCase(),i="scheme";break;case"scheme":if(w&&d.test(w))m+=w.toLowerCase();else{if(w!==":"){if(!t){m="",v=0,i="no scheme";continue}if(h===w)break e;r("Code point not allowed in scheme: "+w);break e}this._scheme=m,m="";if(t)break e;u(this._scheme)&&(this._isRelative=!0),this._scheme==="file"?i="relative":this._isRelative&&n&&n._scheme===this._scheme?i="relative or authority":this._isRelative?i="authority first slash":i="scheme data"}break;case"scheme data":w==="?"?(this._query="?",i="query"):w==="#"?(this._fragment="#",i="fragment"):h!==w&&"	"!==w&&"\n"!==w&&"\r"!==w&&(this._schemeData+=l(w));break;case"no scheme":if(!!n&&!!u(n._scheme)){i="relative";continue}r("Missing scheme."),a.call(this);break;case"relative or authority":if(w!=="/"||e[v+1]!=="/"){r("Expected /, got: "+w),i="relative";continue}i="authority ignore slashes";break;case"relative":this._isRelative=!0,"file"!==this._scheme&&(this._scheme=n._scheme);if(h===w){this._host=n._host,this._port=n._port,this._path=n._path.slice(),this._query=n._query,this._username=n._username,this._password=n._password;break e}if(w==="/"||w==="\\")w==="\\"&&r("\\ is an invalid code point."),i="relative slash";else if(w==="?")this._host=n._host,this._port=n._port,this._path=n._path.slice(),this._query="?",this._username=n._username,this._password=n._password,i="query";else{if(w!=="#"){var E=e[v+1],S=e[v+2];if("file"!==this._scheme||!p.test(w)||E!==":"&&E!=="|"||h!==S&&"/"!==S&&"\\"!==S&&"?"!==S&&"#"!==S)this._host=n._host,this._port=n._port,this._username=n._username,this._password=n._password,this._path=n._path.slice(),this._path.pop();i="relative path";continue}this._host=n._host,this._port=n._port,this._path=n._path.slice(),this._query=n._query,this._fragment="#",this._username=n._username,this._password=n._password,i="fragment"}break;case"relative slash":if(w!=="/"&&w!=="\\"){"file"!==this._scheme&&(this._host=n._host,this._port=n._port,this._username=n._username,this._password=n._password),i="relative path";continue}w==="\\"&&r("\\ is an invalid code point."),this._scheme==="file"?i="file host":i="authority ignore slashes";break;case"authority first slash":if(w!=="/"){r("Expected '/', got: "+w),i="authority ignore slashes";continue}i="authority second slash";break;case"authority second slash":i="authority ignore slashes";if("/"!==w){r("Expected '/', got: "+w);continue}break;case"authority ignore slashes":if("/"!==w&&"\\"!==w){i="authority";continue}r("Expected authority, got: "+w);break;case"authority":if(w==="@"){g&&(r("@ already seen."),m+="%40"),g=!0;for(var x=0;x<m.length;x++){var T=m[x];if(T==="	"||T==="\n"||T==="\r"){r("Invalid whitespace in authority.");continue}if(T===":"&&this._password===null){this._password="";continue}var N=l(T);null!==this._password?this._password+=N:this._username+=N}m=""}else{if(w===h||w==="/"||w==="\\"||w==="?"||w==="#"){v-=m.length,m="",i="host";continue}m+=w}break;case"file host":if(w===h||w==="/"||w==="\\"||w==="?"||w==="#"){m.length!==2||!p.test(m[0])||m[1]!==":"&&m[1]!=="|"?m.length===0?i="relative path start":(this._host=f.call(this,m),m="",i="relative path start"):i="relative path";continue}w==="	"||w==="\n"||w==="\r"?r("Invalid whitespace in file host."):m+=w;break;case"host":case"hostname":if(w===":"&&!y){this._host=f.call(this,m),m="",i="port";if(t==="hostname")break e}else{if(w===h||w==="/"||w==="\\"||w==="?"||w==="#"){this._host=f.call(this,m),m="",i="relative path start";if(t)break e;continue}"	"!==w&&"\n"!==w&&"\r"!==w?(w==="["?y=!0:w==="]"&&(y=!1),m+=w):r("Invalid code point in host/hostname: "+w)}break;case"port":if(/[0-9]/.test(w))m+=w;else{if(w===h||w==="/"||w==="\\"||w==="?"||w==="#"||t){if(""!==m){var C=parseInt(m,10);C!==s[this._scheme]&&(this._port=C+""),m=""}if(t)break e;i="relative path start";continue}w==="	"||w==="\n"||w==="\r"?r("Invalid code point in port: "+w):a.call(this)}break;case"relative path start":w==="\\"&&r("'\\' not allowed in path."),i="relative path";if("/"!==w&&"\\"!==w)continue;break;case"relative path":if(w===h||w==="/"||w==="\\"||!t&&(w==="?"||w==="#")){w==="\\"&&r("\\ not allowed in relative path.");var k;if(k=o[m.toLowerCase()])m=k;m===".."?(this._path.pop(),"/"!==w&&"\\"!==w&&this._path.push("")):m==="."&&"/"!==w&&"\\"!==w?this._path.push(""):"."!==m&&(this._scheme==="file"&&this._path.length===0&&m.length===2&&p.test(m[0])&&m[1]==="|"&&(m=m[0]+":"),this._path.push(m)),m="",w==="?"?(this._query="?",i="query"):w==="#"&&(this._fragment="#",i="fragment")}else"	"!==w&&"\n"!==w&&"\r"!==w&&(m+=l(w));break;case"query":!t&&w==="#"?(this._fragment="#",i="fragment"):h!==w&&"	"!==w&&"\n"!==w&&"\r"!==w&&(this._query+=c(w));break;case"fragment":h!==w&&"	"!==w&&"\n"!==w&&"\r"!==w&&(this._fragment+=w)}v++}}function m(){this._scheme="",this._schemeData="",this._username="",this._password=null,this._host="",this._port="",this._path=[],this._query="",this._fragment="",this._isInvalid=!1,this._isRelative=!1}function g(e,t){t!==undefined&&!(t instanceof g)&&(t=new g(String(t))),this._url=e,m.call(this);var n=e.replace(/^[ \t\r\n\f]+|[ \t\r\n\f]+$/g,"");v.call(this,n,null,t)}var n=!1;try{if(typeof URL=="function"&&typeof URL.prototype=="object"&&"origin"in URL.prototype){var r=new URL("b","http://a");r.pathname="c%20d",n=r.href==="http://a/c%20d"}}catch(i){}if(n)return;var s=Object.create(null);s.ftp=21,s.file=0,s.gopher=70,s.http=80,s.https=443,s.ws=80,s.wss=443;var o=Object.create(null);o["%2e"]=".",o[".%2e"]="..",o["%2e."]="..",o["%2e%2e"]="..";var h,p=/[a-zA-Z]/,d=/[a-zA-Z0-9\+\-\.]/;g.prototype={toString:function(){return this.href},get href(){if(this._isInvalid)return this._url;var e="";if(""!==this._username||null!==this._password)e=this._username+(null!==this._password?":"+this._password:"")+"@";return this.protocol+(this._isRelative?"//"+e+this.host:"")+this.pathname+this._query+this._fragment},set href(e){m.call(this),v.call(this,e)},get protocol(){return this._scheme+":"},set protocol(e){if(this._isInvalid)return;v.call(this,e+":","scheme start")},get host(){return this._isInvalid?"":this._port?this._host+":"+this._port:this._host},set host(e){if(this._isInvalid||!this._isRelative)return;v.call(this,e,"host")},get hostname(){return this._host},set hostname(e){if(this._isInvalid||!this._isRelative)return;v.call(this,e,"hostname")},get port(){return this._port},set port(e){if(this._isInvalid||!this._isRelative)return;v.call(this,e,"port")},get pathname(){return this._isInvalid?"":this._isRelative?"/"+this._path.join("/"):this._schemeData},set pathname(e){if(this._isInvalid||!this._isRelative)return;this._path=[],v.call(this,e,"relative path start")},get search(){return this._isInvalid||!this._query||this._query==="?"?"":this._query},set search(e){if(this._isInvalid||!this._isRelative)return;this._query="?",e[0]==="?"&&(e=e.slice(1)),v.call(this,e,"query")},get hash(){return this._isInvalid||!this._fragment||this._fragment==="#"?"":this._fragment},set hash(e){if(this._isInvalid)return;this._fragment="#",e[0]==="#"&&(e=e.slice(1)),v.call(this,e,"fragment")},get origin(){var e;if(this._isInvalid||!this._scheme)return"";switch(this._scheme){case"data":case"file":case"javascript":case"mailto":return"null"}return e=this.host,e?this._scheme+"://"+e:""}};var y=t.URL;y&&(g.createObjectURL=function(e){return y.createObjectURL.apply(y,arguments)},g.revokeObjectURL=function(e){y.revokeObjectURL(e)}),t.URL=g}(t),e.FONT_IDENTITY_MATRIX=n,e.IDENTITY_MATRIX=G,e.OPS=h,e.VERBOSITY_LEVELS=c,e.UNSUPPORTED_FEATURES=S,e.AnnotationBorderStyleType=a,e.AnnotationFieldFlag=u,e.AnnotationFlag=o,e.AnnotationType=s,e.FontType=l,e.ImageKind=i,e.InvalidPDFException=M,e.MessageHandler=mt,e.MissingDataException=H,e.MissingPDFException=_,e.NotImplementedException=P,e.PageViewport=Z,e.PasswordException=A,e.PasswordResponses=L,e.StatTimer=pt,e.StreamType=f,e.TextRenderingMode=r,e.UnexpectedResponseException=D,e.UnknownErrorException=O,e.Util=Y,e.XRefParseException=B,e.arrayByteLength=R,e.arraysToBytes=U,e.assert=E,e.bytesToString=I,e.createBlob=dt,e.createPromiseCapability=ht,e.createObjectURL=vt,e.deprecated=y,e.error=b,e.getLookupTableFactory=k,e.getVerbosityLevel=v,e.globalScope=t,e.info=m,e.isArray=ft,e.isArrayBuffer=lt,e.isBool=st,e.isEmptyObj=it,e.isInt=ot,e.isNum=ut,e.isString=at,e.isSpace=ct,e.isSameOrigin=x,e.createValidAbsoluteUrl=N,e.isLittleEndian=J,e.isEvalSupported=K,e.loadJpegStream=gt,e.log2=W,e.readInt8=X,e.readUint16=V,e.readUint32=$,e.removeNullCharacters=F,e.setVerbosityLevel=d,e.shadow=C,e.string32=z,e.stringToBytes=q,e.stringToPDFString=tt,e.stringToUTF8String=nt,e.utf8StringToString=rt,e.warn=g}),function(e,t){t(e.pdfjsDisplayDOMUtils={},e.pdfjsSharedUtil)}(this,function(e,t){function c(e,t){var r=t&&t.url;e.href=e.title=r?n(r):"";if(r){var i=t.target;typeof i=="undefined"&&(i=p("externalLinkTarget")),e.target=l[i];var s=t.rel;typeof s=="undefined"&&(s=p("externalLinkRel")),e.rel=s}}function h(e){var t=e.indexOf("#"),n=e.indexOf("?"),r=Math.min(t>0?t:e.length,n>0?n:e.length);return e.substring(e.lastIndexOf("/",r)+1,r)}function p(e){var n=t.globalScope.PDFJS;switch(e){case"pdfBug":return n?n.pdfBug:!1;case"disableAutoFetch":return n?n.disableAutoFetch:!1;case"disableStream":return n?n.disableStream:!1;case"disableRange":return n?n.disableRange:!1;case"disableFontFace":return n?n.disableFontFace:!1;case"disableCreateObjectURL":return n?n.disableCreateObjectURL:!1;case"disableWebGL":return n?n.disableWebGL:!0;case"cMapUrl":return n?n.cMapUrl:null;case"cMapPacked":return n?n.cMapPacked:!1;case"postMessageTransfers":return n?n.postMessageTransfers:!0;case"workerSrc":return n?n.workerSrc:null;case"disableWorker":return n?n.disableWorker:!1;case"maxImageSize":return n?n.maxImageSize:-1;case"imageResourcesPath":return n?n.imageResourcesPath:"";case"isEvalSupported":return n?n.isEvalSupported:!0;case"externalLinkTarget":if(!n)return f.NONE;switch(n.externalLinkTarget){case f.NONE:case f.SELF:case f.BLANK:case f.PARENT:case f.TOP:return n.externalLinkTarget}return r("PDFJS.externalLinkTarget is invalid: "+n.externalLinkTarget),n.externalLinkTarget=f.NONE,f.NONE;case"externalLinkRel":return n?n.externalLinkRel:o;case"enableStats":return!!n&&!!n.enableStats;default:throw new Error("Unknown default setting: "+e)}}function d(){var e=p("externalLinkTarget");switch(e){case f.NONE:return!1;case f.SELF:case f.BLANK:case f.PARENT:case f.TOP:return!0}}function v(e,t){i("isValidUrl(), please use createValidAbsoluteUrl() instead.");var n=t?"http://example.com":null;return s(e,n)!==null}var n=t.removeNullCharacters,r=t.warn,i=t.deprecated,s=t.createValidAbsoluteUrl,o="noopener noreferrer nofollow",u=function(){function r(){}var t=["ms","Moz","Webkit","O"],n=Object.create(null);return r.getProp=function(r,i){if(arguments.length===1&&typeof n[r]=="string")return n[r];i=i||document.documentElement;var s=i.style,o,u;if(typeof s[r]=="string")return n[r]=r;u=r.charAt(0).toUpperCase()+r.slice(1);for(var a=0,f=t.length;a<f;a++){o=t[a]+u;if(typeof s[o]=="string")return n[r]=o}return n[r]="undefined"},r.setProp=function(t,n,r){var i=this.getProp(t);i!=="undefined"&&(n.style[i]=r)},r}(),a;a=function(){var t=document.createElement("canvas");t.width=t.height=1;var n=t.getContext("2d"),r=n.createImageData(1,1);return typeof r.data.buffer!="undefined"};var f={NONE:0,SELF:1,BLANK:2,PARENT:3,TOP:4},l=["","_self","_blank","_parent","_top"];e.CustomStyle=u,e.addLinkAttributes=c,e.isExternalLinkTargetSet=d,e.isValidUrl=v,e.getFilenameFromUrl=h,e.LinkTarget=f,e.hasCanvasTypedArrays=a,e.getDefaultSetting=p,e.DEFAULT_LINK_REL=o}),function(e,t){t(e.pdfjsDisplayFontLoader={},e.pdfjsSharedUtil)}(this,function(e,t){function u(e){this.docId=e,this.styleElement=null,this.nativeFontFaces=[],this.loadTestFontId=0,this.loadingContext={requests:[],nextRequestId:0}}var n=t.assert,r=t.bytesToString,i=t.string32,s=t.shadow,o=t.warn;u.prototype={insertRule:function(t){var n=this.styleElement;n||(n=this.styleElement=document.createElement("style"),n.id="PDFJS_FONT_STYLE_TAG_"+this.docId,document.documentElement.getElementsByTagName("head")[0].appendChild(n));var r=n.sheet;r.insertRule(t,r.cssRules.length)},clear:function(){var t=this.styleElement;t&&(t.parentNode.removeChild(t),t=this.styleElement=null),this.nativeFontFaces.forEach(function(e){document.fonts.delete(e)}),this.nativeFontFaces.length=0}};var a=function(){return atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==")};Object.defineProperty(u.prototype,"loadTestFont",{get:function(){return s(this,"loadTestFont",a())},configurable:!0}),u.prototype.addNativeFontFace=function(t){this.nativeFontFaces.push(t),document.fonts.add(t)},u.prototype.bind=function(t,n){var r=[],i=[],s=[],a=function(e){return e.loaded.catch(function(t){o('Failed to load font "'+e.family+'": '+t)})},f=u.isFontLoadingAPISupported&&!u.isSyncFontLoadingSupported;for(var l=0,c=t.length;l<c;l++){var h=t[l];if(h.attached||h.loading===!1)continue;h.attached=!0;if(f){var p=h.createNativeFontFace();p&&(this.addNativeFontFace(p),s.push(a(p)))}else{var d=h.createFontFaceRule();d&&(this.insertRule(d),r.push(d),i.push(h))}}var v=this.queueLoadingCallback(n);f?Promise.all(s).then(function(){v.complete()}):r.length>0&&!u.isSyncFontLoadingSupported?this.prepareFontLoadEvent(r,i,v):v.complete()},u.prototype.queueLoadingCallback=function(t){function r(){n(!o.end,"completeRequest() cannot be called twice"),o.end=Date.now();while(i.requests.length>0&&i.requests[0].end){var e=i.requests.shift();setTimeout(e.callback,0)}}var i=this.loadingContext,s="pdfjs-font-loading-"+i.nextRequestId++,o={id:s,complete:r,callback:t,started:Date.now()};return i.requests.push(o),o},u.prototype.prepareFontLoadEvent=function(t,n,r){function s(e,t){return e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3)&255}function u(e,t,n,r){var i=e.substr(0,t),s=e.substr(t+n);return i+r+s}function p(e,t){h++;if(h>30){o("Load test font never loaded."),t();return}c.font="30px "+e,c.fillText(".",0,20);var n=c.getImageData(0,0,1,1);if(n.data[3]>0){t();return}setTimeout(p.bind(null,e,t))}var a,f,l=document.createElement("canvas");l.width=1,l.height=1;var c=l.getContext("2d"),h=0,d="lt"+Date.now()+this.loadTestFontId++,v=this.loadTestFont,m=976;v=u(v,m,d.length,d);var g=16,y=1482184792,b=s(v,g);for(a=0,f=d.length-3;a<f;a+=4)b=b-y+s(d,a)|0;a<d.length&&(b=b-y+s(d+"XXX",a)|0),v=u(v,g,4,i(b));var w="url(data:font/opentype;base64,"+btoa(v)+");",E='@font-face { font-family:"'+d+'";src:'+w+"}";this.insertRule(E);var S=[];for(a=0,f=n.length;a<f;a++)S.push(n[a].loadedName);S.push(d);var x=document.createElement("div");x.setAttribute("style","visibility: hidden;width: 10px; height: 10px;position: absolute; top: 0px; left: 0px;");for(a=0,f=S.length;a<f;++a){var T=document.createElement("span");T.textContent="Hi",T.style.fontFamily=S[a],x.appendChild(T)}document.body.appendChild(x),p(d,function(){document.body.removeChild(x),r.complete()})},u.isFontLoadingAPISupported=typeof document!="undefined"&&!!document.fonts;var f=function(){if(typeof navigator=="undefined")return!0;var t=!1,n=/Mozilla\/5.0.*?rv:(\d+).*? Gecko/.exec(navigator.userAgent);return n&&n[1]>=14&&(t=!0),t};Object.defineProperty(u,"isSyncFontLoadingSupported",{get:function(){return s(u,"isSyncFontLoadingSupported",f())},enumerable:!0,configurable:!0});var l={get value(){return s(this,"value",t.isEvalSupported())}},c=function(){function t(e,t){this.compiledGlyphs=Object.create(null);for(var n in e)this[n]=e[n];this.options=t}return t.prototype={createNativeFontFace:function(){if(!this.data)return null;if(this.options.disableFontFace)return this.disableFontFace=!0,null;var t=new FontFace(this.loadedName,this.data,{});return this.options.fontRegistry&&this.options.fontRegistry.registerFont(this),t},createFontFaceRule:function(){if(!this.data)return null;if(this.options.disableFontFace)return this.disableFontFace=!0,null;var t=r(new Uint8Array(this.data)),n=this.loadedName,i="url(data:"+this.mimetype+";base64,"+btoa(t)+");",s='@font-face { font-family:"'+n+'";src:'+i+"}";return this.options.fontRegistry&&this.options.fontRegistry.registerFont(this,i),s},getPathGenerator:function(t,n){if(!(n in this.compiledGlyphs)){var r=t.get(this.loadedName+"_path_"+n),i,s,o;if(this.options.isEvalSupported&&l.value){var u,a="";for(s=0,o=r.length;s<o;s++)i=r[s],i.args!==undefined?u=i.args.join(","):u="",a+="c."+i.cmd+"("+u+");\n";this.compiledGlyphs[n]=new Function("c","size",a)}else this.compiledGlyphs[n]=function(e,t){for(s=0,o=r.length;s<o;s++)i=r[s],i.cmd==="scale"&&(i.args=[t,-t]),e[i.cmd].apply(e,i.args)}}return this.compiledGlyphs[n]}},t}();e.FontFaceObject=c,e.FontLoader=u}),function(e,t){t(e.pdfjsDisplayMetadata={},e.pdfjsSharedUtil)}(this,function(e,t){function r(e){return e.replace(/>\\376\\377([^<]+)/g,function(e,t){var n=t.replace(/\\([0-3])([0-7])([0-7])/g,function(e,t,n,r){return String.fromCharCode(t*64+n*8+r*1)}),r="";for(var i=0;i<n.length;i+=2){var s=n.charCodeAt(i)*256+n.charCodeAt(i+1);r+=s>=32&&s<127&&s!==60&&s!==62&&s!==38?String.fromCharCode(s):"&#x"+(65536+s).toString(16).substring(1)+";"}return">"+r})}function i(e){if(typeof e=="string"){e=r(e);var t=new DOMParser;e=t.parseFromString(e,"application/xml")}else e instanceof Document||n("Metadata: Invalid metadata object");this.metaDocument=e,this.metadata=Object.create(null),this.parse()}var n=t.error;i.prototype={parse:function(){var t=this.metaDocument,n=t.documentElement;if(n.nodeName.toLowerCase()!=="rdf:rdf"){n=n.firstChild;while(n&&n.nodeName.toLowerCase()!=="rdf:rdf")n=n.nextSibling}var r=n?n.nodeName.toLowerCase():null;if(!n||r!=="rdf:rdf"||!n.hasChildNodes())return;var i=n.childNodes,s,o,u,a,f,l,c;for(a=0,l=i.length;a<l;a++){s=i[a];if(s.nodeName.toLowerCase()!=="rdf:description")continue;for(f=0,c=s.childNodes.length;f<c;f++)s.childNodes[f].nodeName.toLowerCase()!=="#text"&&(o=s.childNodes[f],u=o.nodeName.toLowerCase(),this.metadata[u]=o.textContent.trim())}},get:function(t){return this.metadata[t]||null},has:function(t){return typeof this.metadata[t]!="undefined"}},e.Metadata=i}),function(e,t){t(e.pdfjsDisplaySVG={},e.pdfjsSharedUtil)}(this,function(e,t){var n=t.FONT_IDENTITY_MATRIX,r=t.IDENTITY_MATRIX,i=t.ImageKind,s=t.OPS,o=t.Util,u=t.isNum,a=t.isArray,f=t.warn,l=t.createObjectURL,c={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},h=function(){function a(e,t,n){var i=-1;for(var s=t;s<n;s++){var o=(i^e[s])&255,u=r[o];i=i>>>8^u}return i^-1}function f(e,t,n,r){var i=r,s=t.length;n[i]=s>>24&255,n[i+1]=s>>16&255,n[i+2]=s>>8&255,n[i+3]=s&255,i+=4,n[i]=e.charCodeAt(0)&255,n[i+1]=e.charCodeAt(1)&255,n[i+2]=e.charCodeAt(2)&255,n[i+3]=e.charCodeAt(3)&255,i+=4,n.set(t,i),i+=t.length;var o=a(n,r+4,i);n[i]=o>>24&255,n[i+1]=o>>16&255,n[i+2]=o>>8&255,n[i+3]=o&255}function c(e,t,n){var r=1,i=0;for(var s=t;s<n;++s)r=(r+(e[s]&255))%65521,i=(i+r)%65521;return i<<16|r}function h(e,r,s){var o=e.width,u=e.height,a,h,p,d=e.data;switch(r){case i.GRAYSCALE_1BPP:h=0,a=1,p=o+7>>3;break;case i.RGB_24BPP:h=2,a=8,p=o*3;break;case i.RGBA_32BPP:h=6,a=8,p=o*4;break;default:throw new Error("invalid format")}var v=new Uint8Array((1+p)*u),m=0,g=0,y,b;for(y=0;y<u;++y)v[m++]=0,v.set(d.subarray(g,g+p),m),g+=p,m+=p;if(r===i.GRAYSCALE_1BPP){m=0;for(y=0;y<u;y++){m++;for(b=0;b<p;b++)v[m++]^=255}}var w=new Uint8Array([o>>24&255,o>>16&255,o>>8&255,o&255,u>>24&255,u>>16&255,u>>8&255,u&255,a,h,0,0,0]),E=v.length,S=65535,x=Math.ceil(E/S),T=new Uint8Array(2+E+x*5+4),N=0;T[N++]=120,T[N++]=156;var C=0;while(E>S)T[N++]=0,T[N++]=255,T[N++]=255,T[N++]=0,T[N++]=0,T.set(v.subarray(C,C+S),N),N+=S,C+=S,E-=S;T[N++]=1,T[N++]=E&255,T[N++]=E>>8&255,T[N++]=~E&65535&255,T[N++]=(~E&65535)>>8&255,T.set(v.subarray(C),N),N+=v.length-C;var k=c(v,0,v.length);T[N++]=k>>24&255,T[N++]=k>>16&255,T[N++]=k>>8&255,T[N++]=k&255;var L=t.length+n*3+w.length+T.length,A=new Uint8Array(L),O=0;return A.set(t,O),O+=t.length,f("IHDR",w,A,O),O+=n+w.length,f("IDATA",T,A,O),O+=n+T.length,f("IEND",new Uint8Array(0),A,O),l(A,"image/png",s)}var t=new Uint8Array([137,80,78,71,13,10,26,10]),n=12,r=new Int32Array(256);for(var s=0;s<256;s++){var o=s;for(var u=0;u<8;u++)o&1?o=3988292384^o>>1&2147483647:o=o>>1&2147483647;r[s]=o}return function(t,n){var r=t.kind===undefined?i.GRAYSCALE_1BPP:t.kind;return h(t,r,n)}}(),p=function(){function t(){this.fontSizeScale=1,this.fontWeight=c.fontWeight,this.fontSize=0,this.textMatrix=r,this.fontMatrix=n,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=c.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}return t.prototype={clone:function(){return Object.create(this)},setCurrentPoint:function(t,n){this.x=t,this.y=n}},t}(),d=function(){function t(e){var t=[],n=[],r=e.length;for(var i=0;i<r;i++){if(e[i].fn==="save"){t.push({fnId:92,fn:"group",items:[]}),n.push(t),t=t[t.length-1].items;continue}e[i].fn==="restore"?t=n.pop():t.push(e[i])}return t}function i(e){if(e===(e|0))return e.toString();var t=e.toFixed(10),n=t.length-1;if(t[n]!=="0")return t;do n--;while(t[n]==="0");return t.substr(0,t[n]==="."?n:n+1)}function d(e){if(e[4]===0&&e[5]===0){if(e[1]===0&&e[2]===0)return e[0]===1&&e[3]===1?"":"scale("+i(e[0])+" "+i(e[3])+")";if(e[0]===e[3]&&e[1]===-e[2]){var t=Math.acos(e[0])*180/Math.PI;return"rotate("+i(t)+")"}}else if(e[0]===1&&e[1]===0&&e[2]===0&&e[3]===1)return"translate("+i(e[4])+" "+i(e[5])+")";return"matrix("+i(e[0])+" "+i(e[1])+" "+i(e[2])+" "+i(e[3])+" "+i(e[4])+" "+i(e[5])+")"}function v(e,t,n){this.current=new p,this.transformMatrix=r,this.transformStack=[],this.extraStack=[],this.commonObjs=e,this.objs=t,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!n}var m="http://www.w3.org/2000/svg",g="http://www.w3.org/XML/1998/namespace",y="http://www.w3.org/1999/xlink",b=["butt","round","square"],w=["miter","round","bevel"],E=0,S=0;return v.prototype={save:function(){this.transformStack.push(this.transformMatrix);var t=this.current;this.extraStack.push(t),this.current=t.clone()},restore:function(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.tgrp=null},group:function(t){this.save(),this.executeOpTree(t),this.restore()},loadDependencies:function(t){var n=t.fnArray,r=n.length,i=t.argsArray,o=this;for(var u=0;u<r;u++)if(s.dependency===n[u]){var a=i[u];for(var f=0,l=a.length;f<l;f++){var c=a[f],h=c.substring(0,2)==="g_",p;h?p=new Promise(function(e){o.commonObjs.get(c,e)}):p=new Promise(function(e){o.objs.get(c,e)}),this.current.dependencies.push(p)}}return Promise.all(this.current.dependencies)},transform:function(t,n,r,i,s,u){var a=[t,n,r,i,s,u];this.transformMatrix=o.transform(this.transformMatrix,a),this.tgrp=null},getSVG:function(t,n){this.viewport=n;var i=this._initialize(n);return this.loadDependencies(t).then(function(){this.transformMatrix=r;var e=this.convertOpList(t);return this.executeOpTree(e),i}.bind(this))},convertOpList:function(n){var r=n.argsArray,i=n.fnArray,o=i.length,u=[],a=[];for(var f in s)u[s[f]]=f;for(var l=0;l<o;l++){var c=i[l];a.push({fnId:c,fn:u[c],args:r[l]})}return t(a)},executeOpTree:function(t){var n=t.length;for(var r=0;r<n;r++){var i=t[r].fn,o=t[r].fnId,u=t[r].args;switch(o|0){case s.beginText:this.beginText();break;case s.setLeading:this.setLeading(u);break;case s.setLeadingMoveText:this.setLeadingMoveText(u[0],u[1]);break;case s.setFont:this.setFont(u);break;case s.showText:this.showText(u[0]);break;case s.showSpacedText:this.showText(u[0]);break;case s.endText:this.endText();break;case s.moveText:this.moveText(u[0],u[1]);break;case s.setCharSpacing:this.setCharSpacing(u[0]);break;case s.setWordSpacing:this.setWordSpacing(u[0]);break;case s.setHScale:this.setHScale(u[0]);break;case s.setTextMatrix:this.setTextMatrix(u[0],u[1],u[2],u[3],u[4],u[5]);break;case s.setLineWidth:this.setLineWidth(u[0]);break;case s.setLineJoin:this.setLineJoin(u[0]);break;case s.setLineCap:this.setLineCap(u[0]);break;case s.setMiterLimit:this.setMiterLimit(u[0]);break;case s.setFillRGBColor:this.setFillRGBColor(u[0],u[1],u[2]);break;case s.setStrokeRGBColor:this.setStrokeRGBColor(u[0],u[1],u[2]);break;case s.setDash:this.setDash(u[0],u[1]);break;case s.setGState:this.setGState(u[0]);break;case s.fill:this.fill();break;case s.eoFill:this.eoFill();break;case s.stroke:this.stroke();break;case s.fillStroke:this.fillStroke();break;case s.eoFillStroke:this.eoFillStroke();break;case s.clip:this.clip("nonzero");break;case s.eoClip:this.clip("evenodd");break;case s.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case s.paintJpegXObject:this.paintJpegXObject(u[0],u[1],u[2]);break;case s.paintImageXObject:this.paintImageXObject(u[0]);break;case s.paintInlineImageXObject:this.paintInlineImageXObject(u[0]);break;case s.paintImageMaskXObject:this.paintImageMaskXObject(u[0]);break;case s.paintFormXObjectBegin:this.paintFormXObjectBegin(u[0],u[1]);break;case s.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case s.closePath:this.closePath();break;case s.closeStroke:this.closeStroke();break;case s.closeFillStroke:this.closeFillStroke();break;case s.nextLine:this.nextLine();break;case s.transform:this.transform(u[0],u[1],u[2],u[3],u[4],u[5]);break;case s.constructPath:this.constructPath(u[0],u[1]);break;case s.endPath:this.endPath();break;case 92:this.group(t[r].items);break;default:f("Unimplemented operator "+i)}}},setWordSpacing:function(t){this.current.wordSpacing=t},setCharSpacing:function(t){this.current.charSpacing=t},nextLine:function(){this.moveText(0,this.current.leading)},setTextMatrix:function(t,n,r,s,o,u){var a=this.current;this.current.textMatrix=this.current.lineMatrix=[t,n,r,s,o,u],this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,a.xcoords=[],a.tspan=document.createElementNS(m,"svg:tspan"),a.tspan.setAttributeNS(null,"font-family",a.fontFamily),a.tspan.setAttributeNS(null,"font-size",i(a.fontSize)+"px"),a.tspan.setAttributeNS(null,"y",i(-a.y)),a.txtElement=document.createElementNS(m,"svg:text"),a.txtElement.appendChild(a.tspan)},beginText:function(){this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,this.current.textMatrix=r,this.current.lineMatrix=r,this.current.tspan=document.createElementNS(m,"svg:tspan"),this.current.txtElement=document.createElementNS(m,"svg:text"),this.current.txtgrp=document.createElementNS(m,"svg:g"),this.current.xcoords=[]},moveText:function(t,n){var r=this.current;this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=n,r.xcoords=[],r.tspan=document.createElementNS(m,"svg:tspan"),r.tspan.setAttributeNS(null,"font-family",r.fontFamily),r.tspan.setAttributeNS(null,"font-size",i(r.fontSize)+"px"),r.tspan.setAttributeNS(null,"y",i(-r.y))},showText:function(t){var n=this.current,r=n.font,s=n.fontSize;if(s===0)return;var o=n.charSpacing,a=n.wordSpacing,f=n.fontDirection,l=n.textHScale*f,h=t.length,p=r.vertical,v=s*n.fontMatrix[0],m=0,y;for(y=0;y<h;++y){var b=t[y];if(b===null){m+=f*a;continue}if(u(b)){m+=-b*s*.001;continue}n.xcoords.push(n.x+m*l);var w=b.width,E=b.fontChar,S=w*v+o*f;m+=S,n.tspan.textContent+=E}p?n.y-=m*l:n.x+=m*l,n.tspan.setAttributeNS(null,"x",n.xcoords.map(i).join(" ")),n.tspan.setAttributeNS(null,"y",i(-n.y)),n.tspan.setAttributeNS(null,"font-family",n.fontFamily),n.tspan.setAttributeNS(null,"font-size",i(n.fontSize)+"px"),n.fontStyle!==c.fontStyle&&n.tspan.setAttributeNS(null,"font-style",n.fontStyle),n.fontWeight!==c.fontWeight&&n.tspan.setAttributeNS(null,"font-weight",n.fontWeight),n.fillColor!==c.fillColor&&n.tspan.setAttributeNS(null,"fill",n.fillColor),n.txtElement.setAttributeNS(null,"transform",d(n.textMatrix)+" scale(1, -1)"),n.txtElement.setAttributeNS(g,"xml:space","preserve"),n.txtElement.appendChild(n.tspan),n.txtgrp.appendChild(n.txtElement),this._ensureTransformGroup().appendChild(n.txtElement)},setLeadingMoveText:function(t,n){this.setLeading(-n),this.moveText(t,n)},addFontStyle:function(t){this.cssStyle||(this.cssStyle=document.createElementNS(m,"svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.appendChild(this.cssStyle));var n=l(t.data,t.mimetype,this.forceDataSchema);this.cssStyle.textContent+='@font-face { font-family: "'+t.loadedName+'";'+" src: url("+n+"); }\n"},setFont:function(t){var r=this.current,s=this.commonObjs.get(t[0]),o=t[1];this.current.font=s,this.embedFonts&&s.data&&!this.embeddedFonts[s.loadedName]&&(this.addFontStyle(s),this.embeddedFonts[s.loadedName]=s),r.fontMatrix=s.fontMatrix?s.fontMatrix:n;var u=s.black?s.bold?"bolder":"bold":s.bold?"bold":"normal",a=s.italic?"italic":"normal";o<0?(o=-o,r.fontDirection=-1):r.fontDirection=1,r.fontSize=o,r.fontFamily=s.loadedName,r.fontWeight=u,r.fontStyle=a,r.tspan=document.createElementNS(m,"svg:tspan"),r.tspan.setAttributeNS(null,"y",i(-r.y)),r.xcoords=[]},endText:function(){},setLineWidth:function(t){this.current.lineWidth=t},setLineCap:function(t){this.current.lineCap=b[t]},setLineJoin:function(t){this.current.lineJoin=w[t]},setMiterLimit:function(t){this.current.miterLimit=t},setStrokeRGBColor:function(t,n,r){var i=o.makeCssRgb(t,n,r);this.current.strokeColor=i},setFillRGBColor:function(t,n,r){var i=o.makeCssRgb(t,n,r);this.current.fillColor=i,this.current.tspan=document.createElementNS(m,"svg:tspan"),this.current.xcoords=[]},setDash:function(t,n){this.current.dashArray=t,this.current.dashPhase=n},constructPath:function(t,n){var r=this.current,o=r.x,u=r.y;r.path=document.createElementNS(m,"svg:path");var a=[],f=t.length;for(var l=0,c=0;l<f;l++)switch(t[l]|0){case s.rectangle:o=n[c++],u=n[c++];var h=n[c++],p=n[c++],d=o+h,v=u+p;a.push("M",i(o),i(u),"L",i(d),i(u),"L",i(d),i(v),"L",i(o),i(v),"Z");break;case s.moveTo:o=n[c++],u=n[c++],a.push("M",i(o),i(u));break;case s.lineTo:o=n[c++],u=n[c++],a.push("L",i(o),i(u));break;case s.curveTo:o=n[c+4],u=n[c+5],a.push("C",i(n[c]),i(n[c+1]),i(n[c+2]),i(n[c+3]),i(o),i(u)),c+=6;break;case s.curveTo2:o=n[c+2],u=n[c+3],a.push("C",i(o),i(u),i(n[c]),i(n[c+1]),i(n[c+2]),i(n[c+3])),c+=4;break;case s.curveTo3:o=n[c+2],u=n[c+3],a.push("C",i(n[c]),i(n[c+1]),i(o),i(u),i(o),i(u)),c+=4;break;case s.closePath:a.push("Z")}r.path.setAttributeNS(null,"d",a.join(" ")),r.path.setAttributeNS(null,"stroke-miterlimit",i(r.miterLimit)),r.path.setAttributeNS(null,"stroke-linecap",r.lineCap),r.path.setAttributeNS(null,"stroke-linejoin",r.lineJoin),r.path.setAttributeNS(null,"stroke-width",i(r.lineWidth)+"px"),r.path.setAttributeNS(null,"stroke-dasharray",r.dashArray.map(i).join(" ")),r.path.setAttributeNS(null,"stroke-dashoffset",i(r.dashPhase)+"px"),r.path.setAttributeNS(null,"fill","none"),this._ensureTransformGroup().appendChild(r.path),r.element=r.path,r.setCurrentPoint(o,u)},endPath:function(){},clip:function(t){var n=this.current,r="clippath"+E;E++;var i=document.createElementNS(m,"svg:clipPath");i.setAttributeNS(null,"id",r),i.setAttributeNS(null,"transform",d(this.transformMatrix));var s=n.element.cloneNode();t==="evenodd"?s.setAttributeNS(null,"clip-rule","evenodd"):s.setAttributeNS(null,"clip-rule","nonzero"),i.appendChild(s),this.defs.appendChild(i),n.activeClipUrl&&(n.clipGroup=null,this.extraStack.forEach(function(e){e.clipGroup=null})),n.activeClipUrl="url(#"+r+")",this.tgrp=null},closePath:function(){var t=this.current,n=t.path.getAttributeNS(null,"d");n+="Z",t.path.setAttributeNS(null,"d",n)},setLeading:function(t){this.current.leading=-t},setTextRise:function(t){this.current.textRise=t},setHScale:function(t){this.current.textHScale=t/100},setGState:function(t){for(var n=0,r=t.length;n<r;n++){var i=t[n],s=i[0],o=i[1];switch(s){case"LW":this.setLineWidth(o);break;case"LC":this.setLineCap(o);break;case"LJ":this.setLineJoin(o);break;case"ML":this.setMiterLimit(o);break;case"D":this.setDash(o[0],o[1]);break;case"Font":this.setFont(o);break;default:f("Unimplemented graphic state "+s)}}},fill:function(){var t=this.current;t.element.setAttributeNS(null,"fill",t.fillColor)},stroke:function(){var t=this.current;t.element.setAttributeNS(null,"stroke",t.strokeColor),t.element.setAttributeNS(null,"fill","none")},eoFill:function(){var t=this.current;t.element.setAttributeNS(null,"fill",t.fillColor),t.element.setAttributeNS(null,"fill-rule","evenodd")},fillStroke:function(){this.stroke(),this.fill()},eoFillStroke:function(){this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()},closeStroke:function(){this.closePath(),this.stroke()},closeFillStroke:function(){this.closePath(),this.fillStroke()},paintSolidColorImageMask:function(){var t=this.current,n=document.createElementNS(m,"svg:rect");n.setAttributeNS(null,"x","0"),n.setAttributeNS(null,"y","0"),n.setAttributeNS(null,"width","1px"),n.setAttributeNS(null,"height","1px"),n.setAttributeNS(null,"fill",t.fillColor),this._ensureTransformGroup().appendChild(n)},paintJpegXObject:function(t,n,r){var s=this.objs.get(t),o=document.createElementNS(m,"svg:image");o.setAttributeNS(y,"xlink:href",s.src),o.setAttributeNS(null,"width",s.width+"px"),o.setAttributeNS(null,"height",s.height+"px"),o.setAttributeNS(null,"x","0"),o.setAttributeNS(null,"y",i(-r)),o.setAttributeNS(null,"transform","scale("+i(1/n)+" "+i(-1/r)+")"),this._ensureTransformGroup().appendChild(o)},paintImageXObject:function(t){var n=this.objs.get(t);if(!n){f("Dependent image isn't ready yet");return}this.paintInlineImageXObject(n)},paintInlineImageXObject:function(t,n){var r=t.width,s=t.height,o=h(t,this.forceDataSchema),u=document.createElementNS(m,"svg:rect");u.setAttributeNS(null,"x","0"),u.setAttributeNS(null,"y","0"),u.setAttributeNS(null,"width",i(r)),u.setAttributeNS(null,"height",i(s)),this.current.element=u,this.clip("nonzero");var a=document.createElementNS(m,"svg:image");a.setAttributeNS(y,"xlink:href",o),a.setAttributeNS(null,"x","0"),a.setAttributeNS(null,"y",i(-s)),a.setAttributeNS(null,"width",i(r)+"px"),a.setAttributeNS(null,"height",i(s)+"px"),a.setAttributeNS(null,"transform","scale("+i(1/r)+" "+i(-1/s)+")"),n?n.appendChild(a):this._ensureTransformGroup().appendChild(a)},paintImageMaskXObject:function(t){var n=this.current,r=t.width,s=t.height,o=n.fillColor;n.maskId="mask"+S++;var u=document.createElementNS(m,"svg:mask");u.setAttributeNS(null,"id",n.maskId);var a=document.createElementNS(m,"svg:rect");a.setAttributeNS(null,"x","0"),a.setAttributeNS(null,"y","0"),a.setAttributeNS(null,"width",i(r)),a.setAttributeNS(null,"height",i(s)),a.setAttributeNS(null,"fill",o),a.setAttributeNS(null,"mask","url(#"+n.maskId+")"),this.defs.appendChild(u),this._ensureTransformGroup().appendChild(a),this.paintInlineImageXObject(t,u)},paintFormXObjectBegin:function(t,n){a(t)&&t.length===6&&this.transform(t[0],t[1],t[2],t[3],t[4],t[5]);if(a(n)&&n.length===4){var r=n[2]-n[0],s=n[3]-n[1],o=document.createElementNS(m,"svg:rect");o.setAttributeNS(null,"x",n[0]),o.setAttributeNS(null,"y",n[1]),o.setAttributeNS(null,"width",i(r)),o.setAttributeNS(null,"height",i(s)),this.current.element=o,this.clip("nonzero"),this.endPath()}},paintFormXObjectEnd:function(){},_initialize:function(t){var n=document.createElementNS(m,"svg:svg");n.setAttributeNS(null,"version","1.1"),n.setAttributeNS(null,"width",t.width+"px"),n.setAttributeNS(null,"height",t.height+"px"),n.setAttributeNS(null,"preserveAspectRatio","none"),n.setAttributeNS(null,"viewBox","0 0 "+t.width+" "+t.height);var r=document.createElementNS(m,"svg:defs");n.appendChild(r),this.defs=r;var i=document.createElementNS(m,"svg:g");return i.setAttributeNS(null,"transform",d(t.transform)),n.appendChild(i),this.svg=i,n},_ensureClipGroup:function(){if(!this.current.clipGroup){var t=document.createElementNS(m,"svg:g");t.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.appendChild(t),this.current.clipGroup=t}return this.current.clipGroup},_ensureTransformGroup:function(){return this.tgrp||(this.tgrp=document.createElementNS(m,"svg:g"),this.tgrp.setAttributeNS(null,"transform",d(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().appendChild(this.tgrp):this.svg.appendChild(this.tgrp)),this.tgrp}},v}();e.SVGGraphics=d}),function(e,t){t(e.pdfjsDisplayAnnotationLayer={},e.pdfjsSharedUtil,e.pdfjsDisplayDOMUtils)}(this,function(e,t,n){function h(){}var r=t.AnnotationBorderStyleType,i=t.AnnotationType,s=t.Util,o=n.addLinkAttributes,u=n.LinkTarget,a=n.getFilenameFromUrl,f=t.warn,l=n.CustomStyle,c=n.getDefaultSetting;h.prototype={create:function(t){var n=t.data.annotationType;switch(n){case i.LINK:return new d(t);case i.TEXT:return new v(t);case i.WIDGET:var r=t.data.fieldType;switch(r){case"Tx":return new g(t);case"Btn":if(t.data.radioButton)return new b(t);if(t.data.checkBox)return new y(t);f("Unimplemented button widget annotation: pushbutton");break;case"Ch":return new w(t)}return new m(t);case i.POPUP:return new E(t);case i.HIGHLIGHT:return new x(t);case i.UNDERLINE:return new T(t);case i.SQUIGGLY:return new N(t);case i.STRIKEOUT:return new C(t);case i.FILEATTACHMENT:return new k(t);default:return new p(t)}}};var p=function(){function t(e,t){this.isRenderable=t||!1,this.data=e.data,this.layer=e.layer,this.page=e.page,this.viewport=e.viewport,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderInteractiveForms=e.renderInteractiveForms,t&&(this.container=this._createContainer())}return t.prototype={_createContainer:function(){var t=this.data,n=this.page,i=this.viewport,o=document.createElement("section"),u=t.rect[2]-t.rect[0],a=t.rect[3]-t.rect[1];o.setAttribute("data-annotation-id",t.id);var c=s.normalizeRect([t.rect[0],n.view[3]-t.rect[1]+n.view[1],t.rect[2],n.view[3]-t.rect[3]+n.view[1]]);l.setProp("transform",o,"matrix("+i.transform.join(",")+")"),l.setProp("transformOrigin",o,-c[0]+"px "+ -c[1]+"px");if(t.borderStyle.width>0){o.style.borderWidth=t.borderStyle.width+"px",t.borderStyle.style!==r.UNDERLINE&&(u-=2*t.borderStyle.width,a-=2*t.borderStyle.width);var h=t.borderStyle.horizontalCornerRadius,p=t.borderStyle.verticalCornerRadius;if(h>0||p>0){var d=h+"px / "+p+"px";l.setProp("borderRadius",o,d)}switch(t.borderStyle.style){case r.SOLID:o.style.borderStyle="solid";break;case r.DASHED:o.style.borderStyle="dashed";break;case r.BEVELED:f("Unimplemented border style: beveled");break;case r.INSET:f("Unimplemented border style: inset");break;case r.UNDERLINE:o.style.borderBottomStyle="solid";break;default:}t.color?o.style.borderColor=s.makeCssRgb(t.color[0]|0,t.color[1]|0,t.color[2]|0):o.style.borderWidth=0}return o.style.left=c[0]+"px",o.style.top=c[1]+"px",o.style.width=u+"px",o.style.height=a+"px",o},_createPopup:function(t,n,r){n||(n=document.createElement("div"),n.style.height=t.style.height,n.style.width=t.style.width,t.appendChild(n));var i=new S({container:t,trigger:n,color:r.color,title:r.title,contents:r.contents,hideWrapper:!0}),s=i.render();s.style.left=t.style.width,t.appendChild(s)},render:function(){throw new Error("Abstract method AnnotationElement.render called")}},t}(),d=function(){function t(e){p.call(this,e,!0)}return s.inherit(t,p,{render:function(){this.container.className="linkAnnotation";var t=document.createElement("a");return o(t,{url:this.data.url,target:this.data.newWindow?u.BLANK:undefined}),this.data.url||(this.data.action?this._bindNamedAction(t,this.data.action):this._bindLink(t,this.data.dest)),this.container.appendChild(t),this.container},_bindLink:function(t,n){var r=this;t.href=this.linkService.getDestinationHash(n),t.onclick=function(){return n&&r.linkService.navigateTo(n),!1},n&&(t.className="internalLink")},_bindNamedAction:function(t,n){var r=this;t.href=this.linkService.getAnchorUrl(""),t.onclick=function(){return r.linkService.executeNamedAction(n),!1},t.className="internalLink"}}),t}(),v=function(){function t(e){var t=!!(e.data.hasPopup||e.data.title||e.data.contents);p.call(this,e,t)}return s.inherit(t,p,{render:function(){this.container.className="textAnnotation";var t=document.createElement("img");return t.style.height=this.container.style.height,t.style.width=this.container.style.width,t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.alt="[{{type}} Annotation]",t.dataset.l10nId="text_annotation_type",t.dataset.l10nArgs=JSON.stringify({type:this.data.name}),this.data.hasPopup||this._createPopup(this.container,t,this.data),this.container.appendChild(t),this.container}}),t}(),m=function(){function t(e,t){p.call(this,e,t)}return s.inherit(t,p,{render:function(){return this.container}}),t}(),g=function(){function n(e){var t=e.renderInteractiveForms||!e.data.hasAppearance&&!!e.data.fieldValue;m.call(this,e,t)}var t=["left","center","right"];return s.inherit(n,m,{render:function(){this.container.className="textWidgetAnnotation";var n=null;if(this.renderInteractiveForms){this.data.multiLine?(n=document.createElement("textarea"),n.textContent=this.data.fieldValue):(n=document.createElement("input"),n.type="text",n.setAttribute("value",this.data.fieldValue)),n.disabled=this.data.readOnly,this.data.maxLen!==null&&(n.maxLength=this.data.maxLen);if(this.data.comb){var r=this.data.rect[2]-this.data.rect[0],i=r/this.data.maxLen;n.classList.add("comb"),n.style.letterSpacing="calc("+i+"px - 1ch)"}}else{n=document.createElement("div"),n.textContent=this.data.fieldValue,n.style.verticalAlign="middle",n.style.display="table-cell";var s=null;this.data.fontRefName&&(s=this.page.commonObjs.getData(this.data.fontRefName)),this._setTextStyle(n,s)}return this.data.textAlignment!==null&&(n.style.textAlign=t[this.data.textAlignment]),this.container.appendChild(n),this.container},_setTextStyle:function(t,n){var r=t.style;r.fontSize=this.data.fontSize+"px",r.direction=this.data.fontDirection<0?"rtl":"ltr";if(!n)return;r.fontWeight=n.black?n.bold?"900":"bold":n.bold?"bold":"normal",r.fontStyle=n.italic?"italic":"normal";var i=n.loadedName?'"'+n.loadedName+'", ':"",s=n.fallbackName||"Helvetica, sans-serif";r.fontFamily=i+s}}),n}(),y=function(){function t(e){m.call(this,e,e.renderInteractiveForms)}return s.inherit(t,m,{render:function(){this.container.className="buttonWidgetAnnotation checkBox";var t=document.createElement("input");return t.disabled=this.data.readOnly,t.type="checkbox",this.data.fieldValue&&this.data.fieldValue!=="Off"&&t.setAttribute("checked",!0),this.container.appendChild(t),this.container}}),t}(),b=function(){function t(e){m.call(this,e,e.renderInteractiveForms)}return s.inherit(t,m,{render:function(){this.container.className="buttonWidgetAnnotation radioButton";var t=document.createElement("input");return t.disabled=this.data.readOnly,t.type="radio",t.name=this.data.fieldName,this.data.fieldValue===this.data.buttonValue&&t.setAttribute("checked",!0),this.container.appendChild(t),this.container}}),t}(),w=function(){function t(e){m.call(this,e,e.renderInteractiveForms)}return s.inherit(t,m,{render:function(){this.container.className="choiceWidgetAnnotation";var t=document.createElement("select");t.disabled=this.data.readOnly,this.data.combo||(t.size=this.data.options.length,this.data.multiSelect&&(t.multiple=!0));for(var n=0,r=this.data.options.length;n<r;n++){var i=this.data.options[n],s=document.createElement("option");s.textContent=i.displayValue,s.value=i.exportValue,this.data.fieldValue.indexOf(i.displayValue)>=0&&s.setAttribute("selected",!0),t.appendChild(s)}return this.container.appendChild(t),this.container}}),t}(),E=function(){function t(e){var t=!!e.data.title||!!e.data.contents;p.call(this,e,t)}return s.inherit(t,p,{render:function(){this.container.className="popupAnnotation";var t='[data-annotation-id="'+this.data.parentId+'"]',n=this.layer.querySelector(t);if(!n)return this.container;var r=new S({container:this.container,trigger:n,color:this.data.color,title:this.data.title,contents:this.data.contents}),i=parseFloat(n.style.left),s=parseFloat(n.style.width);return l.setProp("transformOrigin",this.container,-(i+s)+"px -"+n.style.top),this.container.style.left=i+s+"px",this.container.appendChild(r.render()),this.container}}),t}(),S=function(){function n(e){this.container=e.container,this.trigger=e.trigger,this.color=e.color,this.title=e.title,this.contents=e.contents,this.hideWrapper=e.hideWrapper||!1,this.pinned=!1}var t=.7;return n.prototype={render:function(){var n=document.createElement("div");n.className="popupWrapper",this.hideElement=this.hideWrapper?n:this.container,this.hideElement.setAttribute("hidden",!0);var r=document.createElement("div");r.className="popup";var i=this.color;if(i){var o=t*(255-i[0])+i[0],u=t*(255-i[1])+i[1],a=t*(255-i[2])+i[2];r.style.backgroundColor=s.makeCssRgb(o|0,u|0,a|0)}var f=this._formatContents(this.contents),l=document.createElement("h1");return l.textContent=this.title,this.trigger.addEventListener("click",this._toggle.bind(this)),this.trigger.addEventListener("mouseover",this._show.bind(this,!1)),this.trigger.addEventListener("mouseout",this._hide.bind(this,!1)),r.addEventListener("click",this._hide.bind(this,!0)),r.appendChild(l),r.appendChild(f),n.appendChild(r),n},_formatContents:function(t){var n=document.createElement("p"),r=t.split(/(?:\r\n?|\n)/);for(var i=0,s=r.length;i<s;++i){var o=r[i];n.appendChild(document.createTextNode(o)),i<s-1&&n.appendChild(document.createElement("br"))}return n},_toggle:function(){this.pinned?this._hide(!0):this._show(!0)},_show:function(t){t&&(this.pinned=!0),this.hideElement.hasAttribute("hidden")&&(this.hideElement.removeAttribute("hidden"),this.container.style.zIndex+=1)},_hide:function(t){t&&(this.pinned=!1),!this.hideElement.hasAttribute("hidden")&&!this.pinned&&(this.hideElement.setAttribute("hidden",!0),this.container.style.zIndex-=1)}},n}(),x=function(){function t(e){var t=!!(e.data.hasPopup||e.data.title||e.data.contents);p.call(this,e,t)}return s.inherit(t,p,{render:function(){return this.container.className="highlightAnnotation",this.data.hasPopup||this._createPopup(this.container,null,this.data),this.container}}),t}(),T=function(){function t(e){var t=!!(e.data.hasPopup||e.data.title||e.data.contents);p.call(this,e,t)}return s.inherit(t,p,{render:function(){return this.container.className="underlineAnnotation",this.data.hasPopup||this._createPopup(this.container,null,this.data),this.container}}),t}(),N=function(){function t(e){var t=!!(e.data.hasPopup||e.data.title||e.data.contents);p.call(this,e,t)}return s.inherit(t,p,{render:function(){return this.container.className="squigglyAnnotation",this.data.hasPopup||this._createPopup(this.container,null,this.data),this.container}}),t}(),C=function(){function t(e){var t=!!(e.data.hasPopup||e.data.title||e.data.contents);p.call(this,e,t)}return s.inherit(t,p,{render:function(){return this.container.className="strikeoutAnnotation",this.data.hasPopup||this._createPopup(this.container,null,this.data),this.container}}),t}(),k=function(){function t(e){p.call(this,e,!0),this.filename=a(e.data.file.filename),this.content=e.data.file.content}return s.inherit(t,p,{render:function(){this.container.className="fileAttachmentAnnotation";var t=document.createElement("div");return t.style.height=this.container.style.height,t.style.width=this.container.style.width,t.addEventListener("dblclick",this._download.bind(this)),!this.data.hasPopup&&(this.data.title||this.data.contents)&&this._createPopup(this.container,t,this.data),this.container.appendChild(t),this.container},_download:function(){if(!this.downloadManager){f("Download cannot be started due to unavailable download manager");return}this.downloadManager.downloadData(this.content,this.filename,"")}}),t}(),L=function(){return{render:function(t){var n=new h;for(var r=0,i=t.annotations.length;r<i;r++){var s=t.annotations[r];if(!s)continue;var o={data:s,layer:t.div,page:t.page,viewport:t.viewport,linkService:t.linkService,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||c("imageResourcesPath"),renderInteractiveForms:t.renderInteractiveForms||!1},u=n.create(o);u.isRenderable&&t.div.appendChild(u.render())}},update:function(t){for(var n=0,r=t.annotations.length;n<r;n++){var i=t.annotations[n],s=t.div.querySelector('[data-annotation-id="'+i.id+'"]');s&&l.setProp("transform",s,"matrix("+t.viewport.transform.join(",")+")")}t.div.removeAttribute("hidden")}}}();e.AnnotationLayer=L}),function(e,t){t(e.pdfjsDisplayTextLayer={},e.pdfjsSharedUtil,e.pdfjsDisplayDOMUtils)}(this,function(e,t,n){var r=t.Util,i=t.createPromiseCapability,s=n.CustomStyle,o=n.getDefaultSetting,u=function(){function u(e){return!n.test(e)}function f(e,t,n){var i=document.createElement("div"),s={style:null,angle:0,canvasWidth:0,isWhitespace:!1,originalTransform:null,paddingBottom:0,paddingLeft:0,paddingRight:0,paddingTop:0,scale:1};e._textDivs.push(i);if(u(t.str)){s.isWhitespace=!0,e._textDivProperties.set(i,s);return}var f=r.transform(e._viewport.transform,t.transform),l=Math.atan2(f[1],f[0]),c=n[t.fontName];c.vertical&&(l+=Math.PI/2);var h=Math.sqrt(f[2]*f[2]+f[3]*f[3]),p=h;c.ascent?p=c.ascent*p:c.descent&&(p=(1+c.descent)*p);var d,v;l===0?(d=f[4],v=f[5]-p):(d=f[4]+p*Math.sin(l),v=f[5]-p*Math.cos(l)),a[1]=d,a[3]=v,a[5]=h,a[7]=c.fontFamily,s.style=a.join(""),i.setAttribute("style",s.style),i.textContent=t.str,o("pdfBug")&&(i.dataset.fontName=t.fontName),l!==0&&(s.angle=l*(180/Math.PI)),t.str.length>1&&(c.vertical?s.canvasWidth=t.height*e._viewport.scale:s.canvasWidth=t.width*e._viewport.scale),e._textDivProperties.set(i,s);if(e._enhanceTextSelection){var m=1,g=0;l!==0&&(m=Math.cos(l),g=Math.sin(l));var y=(c.vertical?t.height:t.width)*e._viewport.scale,b=h,w,E;l!==0?(w=[m,g,-g,m,d,v],E=r.getAxialAlignedBoundingBox([0,0,y,b],w)):E=[d,v,d+y,v+b],e._bounds.push({left:E[0],top:E[1],right:E[2],bottom:E[3],div:i,size:[y,b],m:w})}}function l(e){if(e._canceled)return;var n=e._container,r=e._textDivs,i=e._capability,o=r.length;if(o>t){e._renderingDone=!0,i.resolve();return}var u=document.createElement("canvas");u.mozOpaque=!0;var a=u.getContext("2d",{alpha:!1}),f,l;for(var c=0;c<o;c++){var h=r[c],p=e._textDivProperties.get(h);if(p.isWhitespace)continue;var d=h.style.fontSize,v=h.style.fontFamily;if(d!==f||v!==l)a.font=d+" "+v,f=d,l=v;var m=a.measureText(h.textContent).width;n.appendChild(h);var g="";p.canvasWidth!==0&&m>0&&(p.scale=p.canvasWidth/m,g="scaleX("+p.scale+")"),p.angle!==0&&(g="rotate("+p.angle+"deg) "+g),g!==""&&(p.originalTransform=g,s.setProp("transform",h,g)),e._textDivProperties.set(h,p)}e._renderingDone=!0,i.resolve()}function c(e){var t=e._bounds,n=e._viewport,i=h(n.width,n.height,t);for(var s=0;s<i.length;s++){var o=t[s].div,u=e._textDivProperties.get(o);if(u.angle===0){u.paddingLeft=t[s].left-i[s].left,u.paddingTop=t[s].top-i[s].top,u.paddingRight=i[s].right-t[s].right,u.paddingBottom=i[s].bottom-t[s].bottom,e._textDivProperties.set(o,u);continue}var a=i[s],f=t[s],l=f.m,c=l[0],p=l[1],d=[[0,0],[0,f.size[1]],[f.size[0],0],f.size],v=new Float64Array(64);d.forEach(function(e,t){var n=r.applyTransform(e,l);v[t+0]=c&&(a.left-n[0])/c,v[t+4]=p&&(a.top-n[1])/p,v[t+8]=c&&(a.right-n[0])/c,v[t+12]=p&&(a.bottom-n[1])/p,v[t+16]=p&&(a.left-n[0])/-p,v[t+20]=c&&(a.top-n[1])/c,v[t+24]=p&&(a.right-n[0])/-p,v[t+28]=c&&(a.bottom-n[1])/c,v[t+32]=c&&(a.left-n[0])/-c,v[t+36]=p&&(a.top-n[1])/-p,v[t+40]=c&&(a.right-n[0])/-c,v[t+44]=p&&(a.bottom-n[1])/-p,v[t+48]=p&&(a.left-n[0])/p,v[t+52]=c&&(a.top-n[1])/-c,v[t+56]=p&&(a.right-n[0])/p,v[t+60]=c&&(a.bottom-n[1])/-c});var m=function(e,t,n){var r=0;for(var i=0;i<n;i++){var s=e[t++];s>0&&(r=r?Math.min(s,r):s)}return r},g=1+Math.min(Math.abs(c),Math.abs(p));u.paddingLeft=m(v,32,16)/g,u.paddingTop=m(v,48,16)/g,u.paddingRight=m(v,0,16)/g,u.paddingBottom=m(v,16,16)/g,e._textDivProperties.set(o,u)}}function h(e,t,n){var r=n.map(function(e,t){return{x1:e.left,y1:e.top,x2:e.right,y2:e.bottom,index:t,x1New:undefined,x2New:undefined}});p(e,r);var i=new Array(n.length);return r.forEach(function(e){var t=e.index;i[t]={left:e.x1New,top:0,right:e.x2New,bottom:0}}),n.map(function(t,n){var s=i[n],o=r[n];o.x1=t.top,o.y1=e-s.right,o.x2=t.bottom,o.y2=e-s.left,o.index=n,o.x1New=undefined,o.x2New=undefined}),p(t,r),r.forEach(function(e){var t=e.index;i[t].top=e.x1New,i[t].bottom=e.x2New}),i}function p(e,t){t.sort(function(e,t){return e.x1-t.x1||e.index-t.index});var n={x1:-Infinity,y1:-Infinity,x2:0,y2:Infinity,index:-1,x1New:0,x2New:0},r=[{start:-Infinity,end:Infinity,boundary:n}];t.forEach(function(e){var t=0;while(t<r.length&&r[t].end<=e.y1)t++;var n=r.length-1;while(n>=0&&r[n].start>=e.y2)n--;var i,s,o,u,a=-Infinity;for(o=t;o<=n;o++){i=r[o],s=i.boundary;var f;s.x2>e.x1?f=s.index>e.index?s.x1New:e.x1:s.x2New===undefined?f=(s.x2+e.x1)/2:f=s.x2New,f>a&&(a=f)}e.x1New=a;for(o=t;o<=n;o++)i=r[o],s=i.boundary,s.x2New===undefined?s.x2>e.x1?s.index>e.index&&(s.x2New=s.x2):s.x2New=a:s.x2New>a&&(s.x2New=Math.max(a,s.x2));var l=[],c=null;for(o=t;o<=n;o++){i=r[o],s=i.boundary;var h=s.x2>e.x2?s:e;c===h?l[l.length-1].end=i.end:(l.push({start:i.start,end:i.end,boundary:h}),c=h)}r[t].start<e.y1&&(l[0].start=e.y1,l.unshift({start:r[t].start,end:e.y1,boundary:r[t].boundary})),e.y2<r[n].end&&(l[l.length-1].end=e.y2,l.push({start:e.y2,end:r[n].end,boundary:r[n].boundary}));for(o=t;o<=n;o++){i=r[o],s=i.boundary;if(s.x2New!==undefined)continue;var p=!1;for(u=t-1;!p&&u>=0&&r[u].start>=s.y1;u--)p=r[u].boundary===s;for(u=n+1;!p&&u<r.length&&r[u].end<=s.y2;u++)p=r[u].boundary===s;for(u=0;!p&&u<l.length;u++)p=l[u].boundary===s;p||(s.x2New=a)}Array.prototype.splice.apply(r,[t,n-t+1].concat(l))}),r.forEach(function(t){var n=t.boundary;n.x2New===undefined&&(n.x2New=Math.max(e,n.x2))})}function d(e,t,n,r,s){this._textContent=e,this._container=t,this._viewport=n,this._textDivs=r||[],this._textDivProperties=new WeakMap,this._renderingDone=!1,this._canceled=!1,this._capability=i(),this._renderTimer=null,this._bounds=[],this._enhanceTextSelection=!!s}function v(e){var t=new d(e.textContent,e.container,e.viewport,e.textDivs,e.enhanceTextSelection);return t._render(e.timeout),t}var t=1e5,n=/\S/,a=["left: ",0,"px; top: ",0,"px; font-size: ",0,"px; font-family: ","",";"];return d.prototype={get promise(){return this._capability.promise},cancel:function(){this._canceled=!0,this._renderTimer!==null&&(clearTimeout(this._renderTimer),this._renderTimer=null),this._capability.reject("canceled")},_render:function(t){var n=this._textContent.items,r=this._textContent.styles;for(var i=0,s=n.length;i<s;i++)f(this,n[i],r);if(!t)l(this);else{var o=this;this._renderTimer=setTimeout(function(){l(o),o._renderTimer=null},t)}},expandTextDivs:function(t){if(!this._enhanceTextSelection||!this._renderingDone)return;this._bounds!==null&&(c(this),this._bounds=null);for(var n=0,r=this._textDivs.length;n<r;n++){var i=this._textDivs[n],o=this._textDivProperties.get(i);if(o.isWhitespace)continue;if(t){var u="",a="";o.scale!==1&&(u="scaleX("+o.scale+")"),o.angle!==0&&(u="rotate("+o.angle+"deg) "+u),o.paddingLeft!==0&&(a+=" padding-left: "+o.paddingLeft/o.scale+"px;",u+=" translateX("+ -o.paddingLeft/o.scale+"px)"),o.paddingTop!==0&&(a+=" padding-top: "+o.paddingTop+"px;",u+=" translateY("+ -o.paddingTop+"px)"),o.paddingRight!==0&&(a+=" padding-right: "+o.paddingRight/o.scale+"px;"),o.paddingBottom!==0&&(a+=" padding-bottom: "+o.paddingBottom+"px;"),a!==""&&i.setAttribute("style",o.style+a),u!==""&&s.setProp("transform",i,u)}else i.style.padding=0,s.setProp("transform",i,o.originalTransform||"")}}},v}();e.renderTextLayer=u}),function(e,t){t(e.pdfjsDisplayWebGL={},e.pdfjsSharedUtil,e.pdfjsDisplayDOMUtils)}(this,function(e,t,n){var r=t.shadow,i=n.getDefaultSetting,s=function(){function t(e,t,n){var r=e.createShader(n);e.shaderSource(r,t),e.compileShader(r);var i=e.getShaderParameter(r,e.COMPILE_STATUS);if(!i){var s=e.getShaderInfoLog(r);throw new Error("Error during shader compilation: "+s)}return r}function n(e,n){return t(e,n,e.VERTEX_SHADER)}function s(e,n){return t(e,n,e.FRAGMENT_SHADER)}function o(e,t){var n=e.createProgram();for(var r=0,i=t.length;r<i;++r)e.attachShader(n,t[r]);e.linkProgram(n);var s=e.getProgramParameter(n,e.LINK_STATUS);if(!s){var o=e.getProgramInfoLog(n);throw new Error("Error during program linking: "+o)}return n}function u(e,t,n){e.activeTexture(n);var r=e.createTexture();return e.bindTexture(e.TEXTURE_2D,r),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t),r}function l(){if(a)return;f=document.createElement("canvas"),a=f.getContext("webgl",{premultipliedalpha:!1})}function d(){var e,t;l(),e=f,f=null,t=a,a=null;var r=n(t,c),i=s(t,h),u=o(t,[r,i]);t.useProgram(u);var d={};d.gl=t,d.canvas=e,d.resolutionLocation=t.getUniformLocation(u,"u_resolution"),d.positionLocation=t.getAttribLocation(u,"a_position"),d.backdropLocation=t.getUniformLocation(u,"u_backdrop"),d.subtypeLocation=t.getUniformLocation(u,"u_subtype");var v=t.getAttribLocation(u,"a_texCoord"),m=t.getUniformLocation(u,"u_image"),g=t.getUniformLocation(u,"u_mask"),y=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,y),t.bufferData(t.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),t.STATIC_DRAW),t.enableVertexAttribArray(v),t.vertexAttribPointer(v,2,t.FLOAT,!1,0,0),t.uniform1i(m,0),t.uniform1i(g,1),p=d}function v(e,t,n){var r=e.width,i=e.height;p||d();var s=p,o=s.canvas,a=s.gl;o.width=r,o.height=i,a.viewport(0,0,a.drawingBufferWidth,a.drawingBufferHeight),a.uniform2f(s.resolutionLocation,r,i),n.backdrop?a.uniform4f(s.resolutionLocation,n.backdrop[0],n.backdrop[1],n.backdrop[2],1):a.uniform4f(s.resolutionLocation,0,0,0,0),a.uniform1i(s.subtypeLocation,n.subtype==="Luminosity"?1:0);var f=u(a,e,a.TEXTURE0),l=u(a,t,a.TEXTURE1),c=a.createBuffer();return a.bindBuffer(a.ARRAY_BUFFER,c),a.bufferData(a.ARRAY_BUFFER,new Float32Array([0,0,r,0,0,i,0,i,r,0,r,i]),a.STATIC_DRAW),a.enableVertexAttribArray(s.positionLocation),a.vertexAttribPointer(s.positionLocation,2,a.FLOAT,!1,0,0),a.clearColor(0,0,0,0),a.enable(a.BLEND),a.blendFunc(a.ONE,a.ONE_MINUS_SRC_ALPHA),a.clear(a.COLOR_BUFFER_BIT),a.drawArrays(a.TRIANGLES,0,6),a.flush(),a.deleteTexture(f),a.deleteTexture(l),a.deleteBuffer(c),o}function b(){var e,t;l(),e=f,f=null,t=a,a=null;var r=n(t,m),i=s(t,g),u=o(t,[r,i]);t.useProgram(u);var c={};c.gl=t,c.canvas=e,c.resolutionLocation=t.getUniformLocation(u,"u_resolution"),c.scaleLocation=t.getUniformLocation(u,"u_scale"),c.offsetLocation=t.getUniformLocation(u,"u_offset"),c.positionLocation=t.getAttribLocation(u,"a_position"),c.colorLocation=t.getAttribLocation(u,"a_color"),y=c}function w(e,t,n,r,i){y||b();var s=y,o=s.canvas,u=s.gl;o.width=e,o.height=t,u.viewport(0,0,u.drawingBufferWidth,u.drawingBufferHeight),u.uniform2f(s.resolutionLocation,e,t);var a=0,f,l,c;for(f=0,l=r.length;f<l;f++)switch(r[f].type){case"lattice":c=r[f].coords.length/r[f].verticesPerRow|0,a+=(c-1)*(r[f].verticesPerRow-1)*6;break;case"triangles":a+=r[f].coords.length}var h=new Float32Array(a*2),p=new Uint8Array(a*3),d=i.coords,v=i.colors,m=0,g=0;for(f=0,l=r.length;f<l;f++){var w=r[f],E=w.coords,S=w.colors;switch(w.type){case"lattice":var x=w.verticesPerRow;c=E.length/x|0;for(var T=1;T<c;T++){var N=T*x+1;for(var C=1;C<x;C++,N++)h[m]=d[E[N-x-1]],h[m+1]=d[E[N-x-1]+1],h[m+2]=d[E[N-x]],h[m+3]=d[E[N-x]+1],h[m+4]=d[E[N-1]],h[m+5]=d[E[N-1]+1],p[g]=v[S[N-x-1]],p[g+1]=v[S[N-x-1]+1],p[g+2]=v[S[N-x-1]+2],p[g+3]=v[S[N-x]],p[g+4]=v[S[N-x]+1],p[g+5]=v[S[N-x]+2],p[g+6]=v[S[N-1]],p[g+7]=v[S[N-1]+1],p[g+8]=v[S[N-1]+2],h[m+6]=h[m+2],h[m+7]=h[m+3],h[m+8]=h[m+4],h[m+9]=h[m+5],h[m+10]=d[E[N]],h[m+11]=d[E[N]+1],p[g+9]=p[g+3],p[g+10]=p[g+4],p[g+11]=p[g+5],p[g+12]=p[g+6],p[g+13]=p[g+7],p[g+14]=p[g+8],p[g+15]=v[S[N]],p[g+16]=v[S[N]+1],p[g+17]=v[S[N]+2],m+=12,g+=18}break;case"triangles":for(var k=0,L=E.length;k<L;k++)h[m]=d[E[k]],h[m+1]=d[E[k]+1],p[g]=v[S[k]],p[g+1]=v[S[k]+1],p[g+2]=v[S[k]+2],m+=2,g+=3}}n?u.clearColor(n[0]/255,n[1]/255,n[2]/255,1):u.clearColor(0,0,0,0),u.clear(u.COLOR_BUFFER_BIT);var A=u.createBuffer();u.bindBuffer(u.ARRAY_BUFFER,A),u.bufferData(u.ARRAY_BUFFER,h,u.STATIC_DRAW),u.enableVertexAttribArray(s.positionLocation),u.vertexAttribPointer(s.positionLocation,2,u.FLOAT,!1,0,0);var O=u.createBuffer();return u.bindBuffer(u.ARRAY_BUFFER,O),u.bufferData(u.ARRAY_BUFFER,p,u.STATIC_DRAW),u.enableVertexAttribArray(s.colorLocation),u.vertexAttribPointer(s.colorLocation,3,u.UNSIGNED_BYTE,!1,0,0),u.uniform2f(s.scaleLocation,i.scaleX,i.scaleY),u.uniform2f(s.offsetLocation,i.offsetX,i.offsetY),u.drawArrays(u.TRIANGLES,0,a),u.flush(),u.deleteBuffer(A),u.deleteBuffer(O),o}function E(){p&&p.canvas&&(p.canvas.width=0,p.canvas.height=0),y&&y.canvas&&(y.canvas.width=0,y.canvas.height=0),p=null,y=null}var a,f,c="  attribute vec2 a_position;                                      attribute vec2 a_texCoord;                                                                                                      uniform vec2 u_resolution;                                                                                                      varying vec2 v_texCoord;                                                                                                        void main() {                                                     vec2 clipSpace = (a_position / u_resolution) * 2.0 - 1.0;       gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);                                                                              v_texCoord = a_texCoord;                                      }                                                             ",h="  precision mediump float;                                                                                                        uniform vec4 u_backdrop;                                        uniform int u_subtype;                                          uniform sampler2D u_image;                                      uniform sampler2D u_mask;                                                                                                       varying vec2 v_texCoord;                                                                                                        void main() {                                                     vec4 imageColor = texture2D(u_image, v_texCoord);               vec4 maskColor = texture2D(u_mask, v_texCoord);                 if (u_backdrop.a > 0.0) {                                         maskColor.rgb = maskColor.rgb * maskColor.a +                                   u_backdrop.rgb * (1.0 - maskColor.a);         }                                                               float lum;                                                      if (u_subtype == 0) {                                             lum = maskColor.a;                                            } else {                                                          lum = maskColor.r * 0.3 + maskColor.g * 0.59 +                        maskColor.b * 0.11;                                     }                                                               imageColor.a *= lum;                                            imageColor.rgb *= imageColor.a;                                 gl_FragColor = imageColor;                                    }                                                             ",p=null,m="  attribute vec2 a_position;                                      attribute vec3 a_color;                                                                                                         uniform vec2 u_resolution;                                      uniform vec2 u_scale;                                           uniform vec2 u_offset;                                                                                                          varying vec4 v_color;                                                                                                           void main() {                                                     vec2 position = (a_position + u_offset) * u_scale;              vec2 clipSpace = (position / u_resolution) * 2.0 - 1.0;         gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);                                                                              v_color = vec4(a_color / 255.0, 1.0);                         }                                                             ",g="  precision mediump float;                                                                                                        varying vec4 v_color;                                                                                                           void main() {                                                     gl_FragColor = v_color;                                       }                                                             ",y=null;return{get isEnabled(){if(i("disableWebGL"))return!1;var e=!1;try{l(),e=!!a}catch(t){}return r(this,"isEnabled",e)},composeSMask:v,drawFigures:w,clear:E}}();e.WebGLUtils=s}),function(e,t){t(e.pdfjsDisplayPatternHelper={},e.pdfjsSharedUtil,e.pdfjsDisplayWebGL)}(this,function(e,t,n){function l(e){var t=a[e[0]];return t||o("Unknown IR type: "+e[0]),t.fromIR(e)}var r=t.Util,i=t.info,s=t.isArray,o=t.error,u=n.WebGLUtils,a={};a.RadialAxial={fromIR:function(t){var n=t[1],r=t[2],i=t[3],s=t[4],o=t[5],u=t[6];return{type:"Pattern",getPattern:function(t){var a;n==="axial"?a=t.createLinearGradient(i[0],i[1],s[0],s[1]):n==="radial"&&(a=t.createRadialGradient(i[0],i[1],o,s[0],s[1],u));for(var f=0,l=r.length;f<l;++f){var c=r[f];a.addColorStop(c[0],c[1])}return a}}}};var f=function(){function t(e,t,n,r,i,s,o,u){var a=t.coords,f=t.colors,l=e.data,c=e.width*4,h;a[n+1]>a[r+1]&&(h=n,n=r,r=h,h=s,s=o,o=h),a[r+1]>a[i+1]&&(h=r,r=i,i=h,h=o,o=u,u=h),a[n+1]>a[r+1]&&(h=n,n=r,r=h,h=s,s=o,o=h);var p=(a[n]+t.offsetX)*t.scaleX,d=(a[n+1]+t.offsetY)*t.scaleY,v=(a[r]+t.offsetX)*t.scaleX,m=(a[r+1]+t.offsetY)*t.scaleY,g=(a[i]+t.offsetX)*t.scaleX,y=(a[i+1]+t.offsetY)*t.scaleY;if(d>=y)return;var b=f[s],w=f[s+1],E=f[s+2],S=f[o],x=f[o+1],T=f[o+2],N=f[u],C=f[u+1],k=f[u+2],L=Math.round(d),A=Math.round(y),O,M,_,D,P,H,B,j,F;for(var I=L;I<=A;I++){I<m?(F=I<d?0:d===m?1:(d-I)/(d-m),O=p-(p-v)*F,M=b-(b-S)*F,_=w-(w-x)*F,D=E-(E-T)*F):(F=I>y?1:m===y?0:(m-I)/(m-y),O=v-(v-g)*F,M=S-(S-N)*F,_=x-(x-C)*F,D=T-(T-k)*F),F=I<d?0:I>y?1:(d-I)/(d-y),P=p-(p-g)*F,H=b-(b-N)*F,B=w-(w-C)*F,j=E-(E-k)*F;var q=Math.round(Math.min(O,P)),R=Math.round(Math.max(O,P)),U=c*I+q*4;for(var z=q;z<=R;z++)F=(O-z)/(O-P),F=F<0?0:F>1?1:F,l[U++]=M-(M-H)*F|0,l[U++]=_-(_-B)*F|0,l[U++]=D-(D-j)*F|0,l[U++]=255}}function n(e,n,r){var i=n.coords,s=n.colors,u,a;switch(n.type){case"lattice":var f=n.verticesPerRow,l=Math.floor(i.length/f)-1,c=f-1;for(u=0;u<l;u++){var h=u*f;for(var p=0;p<c;p++,h++)t(e,r,i[h],i[h+1],i[h+f],s[h],s[h+1],s[h+f]),t(e,r,i[h+f+1],i[h+1],i[h+f],s[h+f+1],s[h+1],s[h+f])}break;case"triangles":for(u=0,a=i.length;u<a;u+=3)t(e,r,i[u],i[u+1],i[u+2],s[u],s[u+1],s[u+2]);break;default:o("illigal figure")}}function r(e,t,r,i,s,o,a){var f=1.1,l=3e3,c=2,h=Math.floor(e[0]),p=Math.floor(e[1]),d=Math.ceil(e[2])-h,v=Math.ceil(e[3])-p,m=Math.min(Math.ceil(Math.abs(d*t[0]*f)),l),g=Math.min(Math.ceil(Math.abs(v*t[1]*f)),l),y=d/m,b=v/g,w={coords:r,colors:i,offsetX:-h,offsetY:-p,scaleX:1/y,scaleY:1/b},E=m+c*2,S=g+c*2,x,T,N,C;if(u.isEnabled)x=u.drawFigures(m,g,o,s,w),T=a.getCanvas("mesh",E,S,!1),T.context.drawImage(x,c,c),x=T.canvas;else{T=a.getCanvas("mesh",E,S,!1);var k=T.context,L=k.createImageData(m,g);if(o){var A=L.data;for(N=0,C=A.length;N<C;N+=4)A[N]=o[0],A[N+1]=o[1],A[N+2]=o[2],A[N+3]=255}for(N=0;N<s.length;N++)n(L,s[N],w);k.putImageData(L,c,c),x=T.canvas}return{canvas:x,offsetX:h-c*y,offsetY:p-c*b,scaleX:y,scaleY:b}}return r}();a.Mesh={fromIR:function(t){var n=t[2],i=t[3],s=t[4],o=t[5],u=t[6],a=t[8];return{type:"Pattern",getPattern:function(t,l,c){var h;if(c)h=r.singularValueDecompose2dScale(t.mozCurrentTransform);else{h=r.singularValueDecompose2dScale(l.baseTransform);if(u){var p=r.singularValueDecompose2dScale(u);h=[h[0]*p[0],h[1]*p[1]]}}var d=f(o,h,n,i,s,c?null:a,l.cachedCanvases);return c||(t.setTransform.apply(t,l.baseTransform),u&&t.transform.apply(t,u)),t.translate(d.offsetX,d.offsetY),t.scale(d.scaleX,d.scaleY),t.createPattern(d.canvas,"no-repeat")}}}},a.Dummy={fromIR:function(){return{type:"Pattern",getPattern:function(){return"hotpink"}}}};var c=function(){function u(e,t,n,r,i){this.operatorList=e[2],this.matrix=e[3]||[1,0,0,1,0,0],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.color=t,this.canvasGraphicsFactory=r,this.baseTransform=i,this.type="Pattern",this.ctx=n}var t={COLORED:1,UNCOLORED:2},n=3e3;return u.prototype={createPatternCanvas:function(t){var s=this.operatorList,o=this.bbox,u=this.xstep,a=this.ystep,f=this.paintType,l=this.tilingType,c=this.color,h=this.canvasGraphicsFactory;i("TilingType: "+l);var p=o[0],d=o[1],v=o[2],m=o[3],g=[p,d],y=[p+u,d+a],b=y[0]-g[0],w=y[1]-g[1],E=r.singularValueDecompose2dScale(this.matrix),S=r.singularValueDecompose2dScale(this.baseTransform),x=[E[0]*S[0],E[1]*S[1]];b=Math.min(Math.ceil(Math.abs(b*x[0])),n),w=Math.min(Math.ceil(Math.abs(w*x[1])),n);var T=t.cachedCanvases.getCanvas("pattern",b,w,!0),N=T.context,C=h.createCanvasGraphics(N);C.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(N,f,c),this.setScale(b,w,u,a),this.transformToScale(C);var k=[1,0,0,1,-g[0],-g[1]];return C.transform.apply(C,k),this.clipBbox(C,o,p,d,v,m),C.executeOperatorList(s),T.canvas},setScale:function(t,n,r,i){this.scale=[t/r,n/i]},transformToScale:function(t){var n=this.scale,r=[n[0],0,0,n[1],0,0];t.transform.apply(t,r)},scaleToContext:function(){var t=this.scale;this.ctx.scale(1/t[0],1/t[1])},clipBbox:function(t,n,r,i,o,u){if(n&&s(n)&&n.length===4){var a=o-r,f=u-i;t.ctx.rect(r,i,a,f),t.clip(),t.endPath()}},setFillAndStrokeStyleToContext:function(n,i,s){switch(i){case t.COLORED:var u=this.ctx;n.fillStyle=u.fillStyle,n.strokeStyle=u.strokeStyle;break;case t.UNCOLORED:var a=r.makeCssRgb(s[0],s[1],s[2]);n.fillStyle=a,n.strokeStyle=a;break;default:o("Unsupported paint type: "+i)}},getPattern:function(t,n){var r=this.createPatternCanvas(n);return t=this.ctx,t.setTransform.apply(t,this.baseTransform),t.transform.apply(t,this.matrix),this.scaleToContext(),t.createPattern(r,"repeat")}},u}();e.getShadingPatternFromIR=l,e.TilingPattern=c}),function(e,t){t(e.pdfjsDisplayCanvas={},e.pdfjsSharedUtil,e.pdfjsDisplayDOMUtils,e.pdfjsDisplayPatternHelper,e.pdfjsDisplayWebGL)}(this,function(e,t,n,r,i){function D(e,t){var n=document.createElement("canvas");return n.width=e,n.height=t,n}function P(e){e.mozCurrentTransform||(e._originalSave=e.save,e._originalRestore=e.restore,e._originalRotate=e.rotate,e._originalScale=e.scale,e._originalTranslate=e.translate,e._originalTransform=e.transform,e._originalSetTransform=e.setTransform,e._transformMatrix=e._transformMatrix||[1,0,0,1,0,0],e._transformStack=[],Object.defineProperty(e,"mozCurrentTransform",{get:function(){return this._transformMatrix}}),Object.defineProperty(e,"mozCurrentTransformInverse",{get:function(){var t=this._transformMatrix,n=t[0],r=t[1],i=t[2],s=t[3],o=t[4],u=t[5],a=n*s-r*i,f=r*i-n*s;return[s/a,r/f,i/f,n/a,(s*o-i*u)/f,(r*o-n*u)/a]}}),e.save=function(){var t=this._transformMatrix;this._transformStack.push(t),this._transformMatrix=t.slice(0,6),this._originalSave()},e.restore=function(){var t=this._transformStack.pop();t&&(this._transformMatrix=t,this._originalRestore())},e.translate=function(t,n){var r=this._transformMatrix;r[4]=r[0]*t+r[2]*n+r[4],r[5]=r[1]*t+r[3]*n+r[5],this._originalTranslate(t,n)},e.scale=function(t,n){var r=this._transformMatrix;r[0]=r[0]*t,r[1]=r[1]*t,r[2]=r[2]*n,r[3]=r[3]*n,this._originalScale(t,n)},e.transform=function(n,r,i,s,o,u){var a=this._transformMatrix;this._transformMatrix=[a[0]*n+a[2]*r,a[1]*n+a[3]*r,a[0]*i+a[2]*s,a[1]*i+a[3]*s,a[0]*o+a[2]*u+a[4],a[1]*o+a[3]*u+a[5]],e._originalTransform(n,r,i,s,o,u)},e.setTransform=function(n,r,i,s,o,u){this._transformMatrix=[n,r,i,s,o,u],e._originalSetTransform(n,r,i,s,o,u)},e.rotate=function(t){var n=Math.cos(t),r=Math.sin(t),i=this._transformMatrix;this._transformMatrix=[i[0]*n+i[2]*r,i[1]*n+i[3]*r,i[0]*-r+i[2]*n,i[1]*-r+i[3]*n,i[4],i[5]],this._originalRotate(t)})}function B(e){var t=1e3,n=e.width,r=e.height,i,s,o,u=n+1,a=new Uint8Array(u*(r+1)),f=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),l=n+7&-8,c=e.data,h=new Uint8Array(l*r),p=0,d;for(i=0,d=c.length;i<d;i++){var v=128,m=c[i];while(v>0)h[p++]=m&v?0:255,v>>=1}var g=0;p=0,h[p]!==0&&(a[0]=1,++g);for(s=1;s<n;s++)h[p]!==h[p+1]&&(a[s]=h[p]?2:1,++g),p++;h[p]!==0&&(a[s]=2,++g);for(i=1;i<r;i++){p=i*l,o=i*u,h[p-l]!==h[p]&&(a[o]=h[p]?1:8,++g);var y=(h[p]?4:0)+(h[p-l]?8:0);for(s=1;s<n;s++)y=(y>>2)+(h[p+1]?4:0)+(h[p-l+1]?8:0),f[y]&&(a[o+s]=f[y],++g),p++;h[p-l]!==h[p]&&(a[o+s]=h[p]?2:4,++g);if(g>t)return null}p=l*(r-1),o=i*u,h[p]!==0&&(a[o]=8,++g);for(s=1;s<n;s++)h[p]!==h[p+1]&&(a[o+s]=h[p]?4:8,++g),p++;h[p]!==0&&(a[o+s]=4,++g);if(g>t)return null;var b=new Int32Array([0,u,-1,0,-u,0,0,0,1]),w=[];for(i=0;g&&i<=r;i++){var E=i*u,S=E+n;while(E<S&&!a[E])E++;if(E===S)continue;var x=[E%u,i],T=a[E],N=E,C;do{var k=b[T];do E+=k;while(!a[E]);C=a[E],C!==5&&C!==10?(T=C,a[E]=0):(T=C&51*T>>4,a[E]&=T>>2|T<<2),x.push(E%u),x.push(E/u|0),--g}while(N!==E);w.push(x),--i}var L=function(e){e.save(),e.scale(1/n,-1/r),e.translate(0,-r),e.beginPath();for(var t=0,i=w.length;t<i;t++){var s=w[t];e.moveTo(s[0],s[1]);for(var o=2,u=s.length;o<u;o+=2)e.lineTo(s[o],s[o+1])}e.fill(),e.beginPath(),e.restore()};return L}var s=t.FONT_IDENTITY_MATRIX,o=t.IDENTITY_MATRIX,u=t.ImageKind,a=t.OPS,f=t.TextRenderingMode,l=t.Uint32ArrayView,c=t.Util,h=t.assert,p=t.info,d=t.isNum,v=t.isArray,m=t.isLittleEndian,g=t.error,y=t.shadow,b=t.warn,w=r.TilingPattern,E=r.getShadingPatternFromIR,S=i.WebGLUtils,x=n.hasCanvasTypedArrays,T=16,N=100,C=4096,k=.65,L=!0,A=1e3,O=16,M={get value(){return y(M,"value",x())}},_={get value(){return y(_,"value",m())}},H=function(){function t(){this.cache=Object.create(null)}return t.prototype={getCanvas:function(t,n,r,i){var s;if(this.cache[t]!==undefined)s=this.cache[t],s.canvas.width=n,s.canvas.height=r,s.context.setTransform(1,0,0,1,0,0);else{var o=D(n,r),u=o.getContext("2d");i&&P(u),this.cache[t]=s={canvas:o,context:u}}return s},clear:function(){for(var e in this.cache){var t=this.cache[e];t.canvas.width=0,t.canvas.height=0,delete this.cache[e]}}},t}(),j=function(){function t(e){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=o,this.textMatrixScale=1,this.fontMatrix=s,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=f.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.resumeSMaskCtx=null,this.old=e}return t.prototype={clone:function(){return Object.create(this)},setCurrentPoint:function(t,n){this.x=t,this.y=n}},t}(),F=function(){function r(e,t,n,r){this.ctx=e,this.current=new j,this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=n,this.imageLayer=r,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.cachedCanvases=new H,e&&P(e),this.cachedGetSinglePixelWidth=null}function i(e,t){if(typeof ImageData!="undefined"&&t instanceof ImageData){e.putImageData(t,0,0);return}var n=t.height,r=t.width,i=n%O,s=(n-i)/O,o=i===0?s:s+1,a=e.createImageData(r,O),f=0,c,h=t.data,p=a.data,d,v,m,y;if(t.kind===u.GRAYSCALE_1BPP){var b=h.byteLength,w=M.value?new Uint32Array(p.buffer):new l(p),E=w.length,S=r+7>>3,x=4294967295,T=_.value||!M.value?4278190080:255;for(d=0;d<o;d++){m=d<s?O:i,c=0;for(v=0;v<m;v++){var N=b-f,C=0,k=N>S?r:N*8-7,L=k&-8,A=0,D=0;for(;C<L;C+=8)D=h[f++],w[c++]=D&128?x:T,w[c++]=D&64?x:T,w[c++]=D&32?x:T,w[c++]=D&16?x:T,w[c++]=D&8?x:T,w[c++]=D&4?x:T,w[c++]=D&2?x:T,w[c++]=D&1?x:T;for(;C<k;C++)A===0&&(D=h[f++],A=128),w[c++]=D&A?x:T,A>>=1}while(c<E)w[c++]=0;e.putImageData(a,0,d*O)}}else if(t.kind===u.RGBA_32BPP){v=0,y=r*O*4;for(d=0;d<s;d++)p.set(h.subarray(f,f+y)),f+=y,e.putImageData(a,0,v),v+=O;d<o&&(y=r*i*4,p.set(h.subarray(f,f+y)),e.putImageData(a,0,v))}else if(t.kind===u.RGB_24BPP){m=O,y=r*m;for(d=0;d<o;d++){d>=s&&(m=i,y=r*m),c=0;for(v=y;v--;)p[c++]=h[f++],p[c++]=h[f++],p[c++]=h[f++],p[c++]=255;e.putImageData(a,0,d*O)}}else g("bad image kind: "+t.kind)}function m(e,t){var n=t.height,r=t.width,i=n%O,s=(n-i)/O,o=i===0?s:s+1,u=e.createImageData(r,O),a=0,f=t.data,l=u.data;for(var c=0;c<o;c++){var h=c<s?O:i,p=3;for(var d=0;d<h;d++){var v=0;for(var m=0;m<r;m++){if(!v){var g=f[a++];v=128}l[p]=g&v?0:255,p+=4,v>>=1}}e.putImageData(u,0,c*O)}}function x(e,t){var n=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font"];for(var r=0,i=n.length;r<i;r++){var s=n[r];e[s]!==undefined&&(t[s]=e[s])}e.setLineDash!==undefined&&(t.setLineDash(e.getLineDash()),t.lineDashOffset=e.lineDashOffset)}function D(e,t,n,r){var i=e.length;for(var s=3;s<i;s+=4){var o=e[s];if(o===0)e[s-3]=t,e[s-2]=n,e[s-1]=r;else if(o<255){var u=255-o;e[s-3]=e[s-3]*o+t*u>>8,e[s-2]=e[s-2]*o+n*u>>8,e[s-1]=e[s-1]*o+r*u>>8}}}function F(e,t,n){var r=e.length,i=1/255;for(var s=3;s<r;s+=4){var o=n?n[e[s]]:e[s];t[s]=t[s]*o*i|0}}function I(e,t,n){var r=e.length;for(var i=3;i<r;i+=4){var s=e[i-3]*77+e[i-2]*152+e[i-1]*28;t[i]=n?t[i]*n[s>>8]>>8:t[i]*s>>16}}function q(e,t,n,r,i,s,o){var u=!!s,a=u?s[0]:0,f=u?s[1]:0,l=u?s[2]:0,c;i==="Luminosity"?c=I:c=F;var h=1048576,p=Math.min(r,Math.ceil(h/n));for(var d=0;d<r;d+=p){var v=Math.min(p,r-d),m=e.getImageData(0,d,n,v),g=t.getImageData(0,d,n,v);u&&D(m.data,a,f,l),c(m.data,g.data,o),e.putImageData(g,0,d)}}function R(e,t,n){var r=t.canvas,i=t.context;e.setTransform(t.scaleX,0,0,t.scaleY,t.offsetX,t.offsetY);var s=t.backdrop||null;if(!t.transferMap&&S.isEnabled){var o=S.composeSMask(n.canvas,r,{subtype:t.subtype,backdrop:s});e.setTransform(1,0,0,1,0,0),e.drawImage(o,t.offsetX,t.offsetY);return}q(i,n,r.width,r.height,t.subtype,s,t.transferMap),e.drawImage(r,0,0)}var t=15,n=10,U=["butt","round","square"],z=["miter","round","bevel"],W={},X={};r.prototype={beginDrawing:function(t,n,r){var i=this.ctx.canvas.width,s=this.ctx.canvas.height;this.ctx.save(),this.ctx.fillStyle="rgb(255, 255, 255)",this.ctx.fillRect(0,0,i,s),this.ctx.restore();if(r){var o=this.cachedCanvases.getCanvas("transparent",i,s,!0);this.compositeCtx=this.ctx,this.transparentCanvas=o.canvas,this.ctx=o.context,this.ctx.save(),this.ctx.transform.apply(this.ctx,this.compositeCtx.mozCurrentTransform)}this.ctx.save(),t&&this.ctx.transform.apply(this.ctx,t),this.ctx.transform.apply(this.ctx,n.transform),this.baseTransform=this.ctx.mozCurrentTransform.slice(),this.imageLayer&&this.imageLayer.beginLayout()},executeOperatorList:function(r,i,s,o){var u=r.argsArray,f=r.fnArray,l=i||0,c=u.length;if(c===l)return l;var h=c-l>n&&typeof s=="function",p=h?Date.now()+t:0,d=0,v=this.commonObjs,m=this.objs,g;for(;;){if(o!==undefined&&l===o.nextBreakPoint)return o.breakIt(l,s),l;g=f[l];if(g!==a.dependency)this[g].apply(this,u[l]);else{var y=u[l];for(var b=0,w=y.length;b<w;b++){var E=y[b],S=E[0]==="g"&&E[1]==="_",x=S?v:m;if(!x.isResolved(E))return x.get(E,s),l}}l++;if(l===c)return l;if(h&&++d>n){if(Date.now()>p)return s(),l;d=0}}},endDrawing:function(){this.current.activeSMask!==null&&this.endSMaskGroup(),this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null),this.cachedCanvases.clear(),S.clear(),this.imageLayer&&this.imageLayer.endLayout()},setLineWidth:function(t){this.current.lineWidth=t,this.ctx.lineWidth=t},setLineCap:function(t){this.ctx.lineCap=U[t]},setLineJoin:function(t){this.ctx.lineJoin=z[t]},setMiterLimit:function(t){this.ctx.miterLimit=t},setDash:function(t,n){var r=this.ctx;r.setLineDash!==undefined&&(r.setLineDash(t),r.lineDashOffset=n)},setRenderingIntent:function(t){},setFlatness:function(t){},setGState:function(t){for(var n=0,r=t.length;n<r;n++){var i=t[n],s=i[0],o=i[1];switch(s){case"LW":this.setLineWidth(o);break;case"LC":this.setLineCap(o);break;case"LJ":this.setLineJoin(o);break;case"ML":this.setMiterLimit(o);break;case"D":this.setDash(o[0],o[1]);break;case"RI":this.setRenderingIntent(o);break;case"FL":this.setFlatness(o);break;case"Font":this.setFont(o[0],o[1]);break;case"CA":this.current.strokeAlpha=i[1];break;case"ca":this.current.fillAlpha=i[1],this.ctx.globalAlpha=i[1];break;case"BM":if(o&&o.name&&o.name!=="Normal"){var u=o.name.replace(/([A-Z])/g,function(e){return"-"+e.toLowerCase()}).substring(1);this.ctx.globalCompositeOperation=u,this.ctx.globalCompositeOperation!==u&&b('globalCompositeOperation "'+u+'" is not supported')}else this.ctx.globalCompositeOperation="source-over";break;case"SMask":this.current.activeSMask&&(this.stateStack.length>0&&this.stateStack[this.stateStack.length-1].activeSMask===this.current.activeSMask?this.suspendSMaskGroup():this.endSMaskGroup()),this.current.activeSMask=o?this.tempSMask:null,this.current.activeSMask&&this.beginSMaskGroup(),this.tempSMask=null}}},beginSMaskGroup:function(){var t=this.current.activeSMask,n=t.canvas.width,r=t.canvas.height,i="smaskGroupAt"+this.groupLevel,s=this.cachedCanvases.getCanvas(i,n,r,!0),o=this.ctx,u=o.mozCurrentTransform;this.ctx.save();var a=s.context;a.scale(1/t.scaleX,1/t.scaleY),a.translate(-t.offsetX,-t.offsetY),a.transform.apply(a,u),t.startTransformInverse=a.mozCurrentTransformInverse,x(o,a),this.ctx=a,this.setGState([["BM","Normal"],["ca",1],["CA",1]]),this.groupStack.push(o),this.groupLevel++},suspendSMaskGroup:function(){var t=this.ctx;this.groupLevel--,this.ctx=this.groupStack.pop(),R(this.ctx,this.current.activeSMask,t),this.ctx.restore(),this.ctx.save(),x(t,this.ctx),this.current.resumeSMaskCtx=t;var n=c.transform(this.current.activeSMask.startTransformInverse,t.mozCurrentTransform);this.ctx.transform.apply(this.ctx,n),t.save(),t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,t.canvas.width,t.canvas.height),t.restore()},resumeSMaskGroup:function(){var t=this.current.resumeSMaskCtx,n=this.ctx;this.ctx=t,this.groupStack.push(n),this.groupLevel++},endSMaskGroup:function(){var t=this.ctx;this.groupLevel--,this.ctx=this.groupStack.pop(),R(this.ctx,this.current.activeSMask,t),this.ctx.restore(),x(t,this.ctx);var n=c.transform(this.current.activeSMask.startTransformInverse,t.mozCurrentTransform);this.ctx.transform.apply(this.ctx,n)},save:function(){this.ctx.save();var t=this.current;this.stateStack.push(t),this.current=t.clone(),this.current.resumeSMaskCtx=null},restore:function(){this.current.resumeSMaskCtx&&this.resumeSMaskGroup(),this.current.activeSMask!==null&&(this.stateStack.length===0||this.stateStack[this.stateStack.length-1].activeSMask!==this.current.activeSMask)&&this.endSMaskGroup(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.ctx.restore(),this.pendingClip=null,this.cachedGetSinglePixelWidth=null)},transform:function(t,n,r,i,s,o){this.ctx.transform(t,n,r,i,s,o),this.cachedGetSinglePixelWidth=null},constructPath:function(t,n){var r=this.ctx,i=this.current,s=i.x,o=i.y;for(var u=0,f=0,l=t.length;u<l;u++)switch(t[u]|0){case a.rectangle:s=n[f++],o=n[f++];var c=n[f++],h=n[f++];c===0&&(c=this.getSinglePixelWidth()),h===0&&(h=this.getSinglePixelWidth());var p=s+c,d=o+h;this.ctx.moveTo(s,o),this.ctx.lineTo(p,o),this.ctx.lineTo(p,d),this.ctx.lineTo(s,d),this.ctx.lineTo(s,o),this.ctx.closePath();break;case a.moveTo:s=n[f++],o=n[f++],r.moveTo(s,o);break;case a.lineTo:s=n[f++],o=n[f++],r.lineTo(s,o);break;case a.curveTo:s=n[f+4],o=n[f+5],r.bezierCurveTo(n[f],n[f+1],n[f+2],n[f+3],s,o),f+=6;break;case a.curveTo2:r.bezierCurveTo(s,o,n[f],n[f+1],n[f+2],n[f+3]),s=n[f+2],o=n[f+3],f+=4;break;case a.curveTo3:s=n[f+2],o=n[f+3],r.bezierCurveTo(n[f],n[f+1],s,o,s,o),f+=4;break;case a.closePath:r.closePath()}i.setCurrentPoint(s,o)},closePath:function(){this.ctx.closePath()},stroke:function(t){t=typeof t!="undefined"?t:!0;var n=this.ctx,r=this.current.strokeColor;n.lineWidth=Math.max(this.getSinglePixelWidth()*k,this.current.lineWidth),n.globalAlpha=this.current.strokeAlpha,r&&r.hasOwnProperty("type")&&r.type==="Pattern"?(n.save(),n.strokeStyle=r.getPattern(n,this),n.stroke(),n.restore()):n.stroke(),t&&this.consumePath(),n.globalAlpha=this.current.fillAlpha},closeStroke:function(){this.closePath(),this.stroke()},fill:function(t){t=typeof t!="undefined"?t:!0;var n=this.ctx,r=this.current.fillColor,i=this.current.patternFill,s=!1;i&&(n.save(),this.baseTransform&&n.setTransform.apply(n,this.baseTransform),n.fillStyle=r.getPattern(n,this),s=!0),this.pendingEOFill?(n.mozFillRule!==undefined?(n.mozFillRule="evenodd",n.fill(),n.mozFillRule="nonzero"):n.fill("evenodd"),this.pendingEOFill=!1):n.fill(),s&&n.restore(),t&&this.consumePath()},eoFill:function(){this.pendingEOFill=!0,this.fill()},fillStroke:function(){this.fill(!1),this.stroke(!1),this.consumePath()},eoFillStroke:function(){this.pendingEOFill=!0,this.fillStroke()},closeFillStroke:function(){this.closePath(),this.fillStroke()},closeEOFillStroke:function(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()},endPath:function(){this.consumePath()},clip:function(){this.pendingClip=W},eoClip:function(){this.pendingClip=X},beginText:function(){this.current.textMatrix=o,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0},endText:function(){var t=this.pendingTextPaths,n=this.ctx;if(t===undefined){n.beginPath();return}n.save(),n.beginPath();for(var r=0;r<t.length;r++){var i=t[r];n.setTransform.apply(n,i.transform),n.translate(i.x,i.y),i.addToPath(n,i.fontSize)}n.restore(),n.clip(),n.beginPath(),delete this.pendingTextPaths},setCharSpacing:function(t){this.current.charSpacing=t},setWordSpacing:function(t){this.current.wordSpacing=t},setHScale:function(t){this.current.textHScale=t/100},setLeading:function(t){this.current.leading=-t},setFont:function(t,n){var r=this.commonObjs.get(t),i=this.current;r||g("Can't find font for "+t),i.fontMatrix=r.fontMatrix?r.fontMatrix:s,(i.fontMatrix[0]===0||i.fontMatrix[3]===0)&&b("Invalid font matrix for font "+t),n<0?(n=-n,i.fontDirection=-1):i.fontDirection=1,this.current.font=r,this.current.fontSize=n;if(r.isType3Font)return;var o=r.loadedName||"sans-serif",u=r.black?"900":r.bold?"bold":"normal",a=r.italic?"italic":"normal",f='"'+o+'", '+r.fallbackName,l=n<T?T:n>N?N:n;this.current.fontSizeScale=n/l;var c=a+" "+u+" "+l+"px "+f;this.ctx.font=c},setTextRenderingMode:function(t){this.current.textRenderingMode=t},setTextRise:function(t){this.current.textRise=t},moveText:function(t,n){this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=n},setLeadingMoveText:function(t,n){this.setLeading(-n),this.moveText(t,n)},setTextMatrix:function(t,n,r,i,s,o){this.current.textMatrix=[t,n,r,i,s,o],this.current.textMatrixScale=Math.sqrt(t*t+n*n),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0},nextLine:function(){this.moveText(0,this.current.leading)},paintChar:function(t,n,r){var i=this.ctx,s=this.current,o=s.font,u=s.textRenderingMode,a=s.fontSize/s.fontSizeScale,l=u&f.FILL_STROKE_MASK,c=!!(u&f.ADD_TO_PATH_FLAG),h;if(o.disableFontFace||c)h=o.getPathGenerator(this.commonObjs,t);o.disableFontFace?(i.save(),i.translate(n,r),i.beginPath(),h(i,a),(l===f.FILL||l===f.FILL_STROKE)&&i.fill(),(l===f.STROKE||l===f.FILL_STROKE)&&i.stroke(),i.restore()):((l===f.FILL||l===f.FILL_STROKE)&&i.fillText(t,n,r),(l===f.STROKE||l===f.FILL_STROKE)&&i.strokeText(t,n,r));if(c){var p=this.pendingTextPaths||(this.pendingTextPaths=[]);p.push({transform:i.mozCurrentTransform,x:n,y:r,fontSize:a,addToPath:h})}},get isFontSubpixelAAEnabled(){var e=document.createElement("canvas").getContext("2d");e.scale(1.5,1),e.fillText("I",0,10);var t=e.getImageData(0,0,10,10).data,n=!1;for(var r=3;r<t.length;r+=4)if(t[r]>0&&t[r]<255){n=!0;break}return y(this,"isFontSubpixelAAEnabled",n)},showText:function(t){var n=this.current,r=n.font;if(r.isType3Font)return this.showType3Text(t);var i=n.fontSize;if(i===0)return;var s=this.ctx,o=n.fontSizeScale,u=n.charSpacing,a=n.wordSpacing,l=n.fontDirection,c=n.textHScale*l,h=t.length,p=r.vertical,v=p?1:-1,m=r.defaultVMetrics,g=i*n.fontMatrix[0],y=n.textRenderingMode===f.FILL&&!r.disableFontFace;s.save(),s.transform.apply(s,n.textMatrix),s.translate(n.x,n.y+n.textRise),n.patternFill&&(s.fillStyle=n.fillColor.getPattern(s,this)),l>0?s.scale(c,-1):s.scale(c,1);var b=n.lineWidth,w=n.textMatrixScale;if(w===0||b===0){var E=n.textRenderingMode&f.FILL_STROKE_MASK;if(E===f.STROKE||E===f.FILL_STROKE)this.cachedGetSinglePixelWidth=null,b=this.getSinglePixelWidth()*k}else b/=w;o!==1&&(s.scale(o,o),b/=o),s.lineWidth=b;var S=0,x;for(x=0;x<h;++x){var T=t[x];if(d(T)){S+=v*T*i/1e3;continue}var N=!1,C=(T.isSpace?a:0)+u,L=T.fontChar,A=T.accent,O,M,_,D,P=T.width;if(p){var H,B,j;H=T.vmetric||m,B=T.vmetric?H[1]:P*.5,B=-B*g,j=H[2]*g,P=H?-H[0]:P,O=B/o,M=(S+j)/o}else O=S/o,M=0;if(r.remeasure&&P>0){var F=s.measureText(L).width*1e3/i*o;if(P<F&&this.isFontSubpixelAAEnabled){var I=P/F;N=!0,s.save(),s.scale(I,1),O/=I}else P!==F&&(O+=(P-F)/2e3*i/o)}if(T.isInFont||r.missingFile)y&&!A?s.fillText(L,O,M):(this.paintChar(L,O,M),A&&(_=O+A.offset.x/o,D=M-A.offset.y/o,this.paintChar(A.fontChar,_,D)));var q=P*g+C*l;S+=q,N&&s.restore()}p?n.y-=S*c:n.x+=S*c,s.restore()},showType3Text:function(t){var n=this.ctx,r=this.current,i=r.font,o=r.fontSize,u=r.fontDirection,a=i.vertical?1:-1,l=r.charSpacing,h=r.wordSpacing,p=r.textHScale*u,v=r.fontMatrix||s,m=t.length,g=r.textRenderingMode===f.INVISIBLE,y,w,E,S;if(g||o===0)return;this.cachedGetSinglePixelWidth=null,n.save(),n.transform.apply(n,r.textMatrix),n.translate(r.x,r.y),n.scale(p,u);for(y=0;y<m;++y){w=t[y];if(d(w)){S=a*w*o/1e3,this.ctx.translate(S,0),r.x+=S*p;continue}var x=(w.isSpace?h:0)+l,T=i.charProcOperatorList[w.operatorListId];if(!T){b('Type3 character "'+w.operatorListId+'" is not available');continue}this.processingType3=w,this.save(),n.scale(o,o),n.transform.apply(n,v),this.executeOperatorList(T),this.restore();var N=c.applyTransform([w.width,0],v);E=N[0]*o+x,n.translate(E,0),r.x+=E*p}n.restore(),this.processingType3=null},setCharWidth:function(t,n){},setCharWidthAndBounds:function(t,n,r,i,s,o){this.ctx.rect(r,i,s-r,o-i),this.clip(),this.endPath()},getColorN_Pattern:function(t){var n;if(t[0]==="TilingPattern"){var i=t[1],s=this.baseTransform||this.ctx.mozCurrentTransform.slice(),o=this,u={createCanvasGraphics:function(e){return new r(e,o.commonObjs,o.objs)}};n=new w(t,i,this.ctx,u,s)}else n=E(t);return n},setStrokeColorN:function(){this.current.strokeColor=this.getColorN_Pattern(arguments)},setFillColorN:function(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0},setStrokeRGBColor:function(t,n,r){var i=c.makeCssRgb(t,n,r);this.ctx.strokeStyle=i,this.current.strokeColor=i},setFillRGBColor:function(t,n,r){var i=c.makeCssRgb(t,n,r);this.ctx.fillStyle=i,this.current.fillColor=i,this.current.patternFill=!1},shadingFill:function(t){var n=this.ctx;this.save();var r=E(t);n.fillStyle=r.getPattern(n,this,!0);var i=n.mozCurrentTransformInverse;if(i){var s=n.canvas,o=s.width,u=s.height,a=c.applyTransform([0,0],i),f=c.applyTransform([0,u],i),l=c.applyTransform([o,0],i),h=c.applyTransform([o,u],i),p=Math.min(a[0],f[0],l[0],h[0]),d=Math.min(a[1],f[1],l[1],h[1]),v=Math.max(a[0],f[0],l[0],h[0]),m=Math.max(a[1],f[1],l[1],h[1]);this.ctx.fillRect(p,d,v-p,m-d)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.restore()},beginInlineImage:function(){g("Should not call beginInlineImage")},beginImageData:function(){g("Should not call beginImageData")},paintFormXObjectBegin:function(t,n){this.save(),this.baseTransformStack.push(this.baseTransform),v(t)&&t.length===6&&this.transform.apply(this,t),this.baseTransform=this.ctx.mozCurrentTransform;if(v(n)&&n.length===4){var r=n[2]-n[0],i=n[3]-n[1];this.ctx.rect(n[0],n[1],r,i),this.clip(),this.endPath()}},paintFormXObjectEnd:function(){this.restore(),this.baseTransform=this.baseTransformStack.pop()},beginGroup:function(t){this.save();var n=this.ctx;t.isolated||p("TODO: Support non-isolated groups."),t.knockout&&b("Knockout groups not supported.");var r=n.mozCurrentTransform;t.matrix&&n.transform.apply(n,t.matrix),h(t.bbox,"Bounding box is required.");var i=c.getAxialAlignedBoundingBox(t.bbox,n.mozCurrentTransform),s=[0,0,n.canvas.width,n.canvas.height];i=c.intersect(i,s)||[0,0,0,0];var o=Math.floor(i[0]),u=Math.floor(i[1]),a=Math.max(Math.ceil(i[2])-o,1),f=Math.max(Math.ceil(i[3])-u,1),l=1,d=1;a>C&&(l=a/C,a=C),f>C&&(d=f/C,f=C);var v="groupAt"+this.groupLevel;t.smask&&(v+="_smask_"+this.smaskCounter++%2);var m=this.cachedCanvases.getCanvas(v,a,f,!0),g=m.context;g.scale(1/l,1/d),g.translate(-o,-u),g.transform.apply(g,r),t.smask?this.smaskStack.push({canvas:m.canvas,context:g,offsetX:o,offsetY:u,scaleX:l,scaleY:d,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}):(n.setTransform(1,0,0,1,0,0),n.translate(o,u),n.scale(l,d)),x(n,g),this.ctx=g,this.setGState([["BM","Normal"],["ca",1],["CA",1]]),this.groupStack.push(n),this.groupLevel++,this.current.activeSMask=null},endGroup:function(t){this.groupLevel--;var n=this.ctx;this.ctx=this.groupStack.pop(),this.ctx.imageSmoothingEnabled!==undefined?this.ctx.imageSmoothingEnabled=!1:this.ctx.mozImageSmoothingEnabled=!1,t.smask?this.tempSMask=this.smaskStack.pop():this.ctx.drawImage(n.canvas,0,0),this.restore()},beginAnnotations:function(){this.save(),this.current=new j,this.baseTransform&&this.ctx.setTransform.apply(this.ctx,this.baseTransform)},endAnnotations:function(){this.restore()},beginAnnotation:function(t,n,r){this.save();if(v(t)&&t.length===4){var i=t[2]-t[0],s=t[3]-t[1];this.ctx.rect(t[0],t[1],i,s),this.clip(),this.endPath()}this.transform.apply(this,n),this.transform.apply(this,r)},endAnnotation:function(){this.restore()},paintJpegXObject:function(t,n,r){var i=this.objs.get(t);if(!i){b("Dependent image isn't ready yet");return}this.save();var s=this.ctx;s.scale(1/n,-1/r),s.drawImage(i,0,0,i.width,i.height,0,-r,n,r);if(this.imageLayer){var o=s.mozCurrentTransformInverse,u=this.getCanvasPosition(0,0);this.imageLayer.appendImage({objId:t,left:u[0],top:u[1],width:n/o[0],height:r/o[3]})}this.restore()},paintImageMaskXObject:function(t){var n=this.ctx,r=t.width,i=t.height,s=this.current.fillColor,o=this.current.patternFill,u=this.processingType3;L&&u&&u.compiled===undefined&&(r<=A&&i<=A?u.compiled=B({data:t.data,width:r,height:i}):u.compiled=null);if(u&&u.compiled){u.compiled(n);return}var a=this.cachedCanvases.getCanvas("maskCanvas",r,i),f=a.context;f.save(),m(f,t),f.globalCompositeOperation="source-in",f.fillStyle=o?s.getPattern(f,this):s,f.fillRect(0,0,r,i),f.restore(),this.paintInlineImageXObject(a.canvas)},paintImageMaskXObjectRepeat:function(t,n,r,i){var s=t.width,o=t.height,u=this.current.fillColor,a=this.current.patternFill,f=this.cachedCanvases.getCanvas("maskCanvas",s,o),l=f.context;l.save(),m(l,t),l.globalCompositeOperation="source-in",l.fillStyle=a?u.getPattern(l,this):u,l.fillRect(0,0,s,o),l.restore();var c=this.ctx;for(var h=0,p=i.length;h<p;h+=2)c.save(),c.transform(n,0,0,r,i[h],i[h+1]),c.scale(1,-1),c.drawImage(f.canvas,0,0,s,o,0,-1,1,1),c.restore()},paintImageMaskXObjectGroup:function(t){var n=this.ctx,r=this.current.fillColor,i=this.current.patternFill;for(var s=0,o=t.length;s<o;s++){var u=t[s],a=u.width,f=u.height,l=this.cachedCanvases.getCanvas("maskCanvas",a,f),c=l.context;c.save(),m(c,u),c.globalCompositeOperation="source-in",c.fillStyle=i?r.getPattern(c,this):r,c.fillRect(0,0,a,f),c.restore(),n.save(),n.transform.apply(n,u.transform),n.scale(1,-1),n.drawImage(l.canvas,0,0,a,f,0,-1,1,1),n.restore()}},paintImageXObject:function(t){var n=this.objs.get(t);if(!n){b("Dependent image isn't ready yet");return}this.paintInlineImageXObject(n)},paintImageXObjectRepeat:function(t,n,r,i){var s=this.objs.get(t);if(!s){b("Dependent image isn't ready yet");return}var o=s.width,u=s.height,a=[];for(var f=0,l=i.length;f<l;f+=2)a.push({transform:[n,0,0,r,i[f],i[f+1]],x:0,y:0,w:o,h:u});this.paintInlineImageXObjectGroup(s,a)},paintInlineImageXObject:function(t){var n=t.width,r=t.height,s=this.ctx;this.save(),s.scale(1/n,-1/r);var o=s.mozCurrentTransformInverse,u=o[0],a=o[1],f=Math.max(Math.sqrt(u*u+a*a),1),l=o[2],c=o[3],h=Math.max(Math.sqrt(l*l+c*c),1),p,d;if(t instanceof HTMLElement||!t.data)p=t;else{d=this.cachedCanvases.getCanvas("inlineImage",n,r);var v=d.context;i(v,t),p=d.canvas}var m=n,g=r,y="prescale1";while(f>2&&m>1||h>2&&g>1){var b=m,w=g;f>2&&m>1&&(b=Math.ceil(m/2),f/=m/b),h>2&&g>1&&(w=Math.ceil(g/2),h/=g/w),d=this.cachedCanvases.getCanvas(y,b,w),v=d.context,v.clearRect(0,0,b,w),v.drawImage(p,0,0,m,g,0,0,b,w),p=d.canvas,m=b,g=w,y=y==="prescale1"?"prescale2":"prescale1"}s.drawImage(p,0,0,m,g,0,-r,n,r);if(this.imageLayer){var E=this.getCanvasPosition(0,-r);this.imageLayer.appendImage({imgData:t,left:E[0],top:E[1],width:n/o[0],height:r/o[3]})}this.restore()},paintInlineImageXObjectGroup:function(t,n){var r=this.ctx,s=t.width,o=t.height,u=this.cachedCanvases.getCanvas("inlineImage",s,o),a=u.context;i(a,t);for(var f=0,l=n.length;f<l;f++){var c=n[f];r.save(),r.transform.apply(r,c.transform),r.scale(1,-1),r.drawImage(u.canvas,c.x,c.y,c.w,c.h,0,-1,1,1);if(this.imageLayer){var h=this.getCanvasPosition(c.x,c.y);this.imageLayer.appendImage({imgData:t,left:h[0],top:h[1],width:s,height:o})}r.restore()}},paintSolidColorImageMask:function(){this.ctx.fillRect(0,0,1,1)},paintXObject:function(){b("Unsupported 'paintXObject' command.")},markPoint:function(t){},markPointProps:function(t,n){},beginMarkedContent:function(t){},beginMarkedContentProps:function(t,n){},endMarkedContent:function(){},beginCompat:function(){},endCompat:function(){},consumePath:function(){var t=this.ctx;this.pendingClip&&(this.pendingClip===X?t.mozFillRule!==undefined?(t.mozFillRule="evenodd",t.clip(),t.mozFillRule="nonzero"):t.clip("evenodd"):t.clip(),this.pendingClip=null),t.beginPath()},getSinglePixelWidth:function(t){if(this.cachedGetSinglePixelWidth===null){this.ctx.save();var n=this.ctx.mozCurrentTransformInverse;this.ctx.restore(),this.cachedGetSinglePixelWidth=Math.sqrt(Math.max(n[0]*n[0]+n[1]*n[1],n[2]*n[2]+n[3]*n[3]))}return this.cachedGetSinglePixelWidth},getCanvasPosition:function(t,n){var r=this.ctx.mozCurrentTransform;return[r[0]*t+r[2]*n+r[4],r[1]*t+r[3]*n+r[5]]}};for(var V in a)r.prototype[a[V]]=r.prototype[V];return r}();e.CanvasGraphics=F,e.createScratchCanvas=D}),function(e,t){t(e.pdfjsDisplayAPI={},e.pdfjsSharedUtil,e.pdfjsDisplayFontLoader,e.pdfjsDisplayCanvas,e.pdfjsDisplayMetadata,e.pdfjsDisplayDOMUtils)}(this,function(e,i,s,o,u,a,f){function V(e,t,n,r){var i=new J;arguments.length>1&&S("getDocument is called with pdfDataRangeTransport, passwordCallback or progressCallback argument"),t&&(t instanceof K||(t=Object.create(t),t.length=e.length,t.initialData=e.initialData,t.abort||(t.abort=function(){})),e=Object.create(e),e.range=t),i.onPassword=n||null,i.onProgress=r||null;var s;typeof e=="string"?s={url:e}:k(e)?s={data:e}:e instanceof K?s={range:e}:(typeof e!="object"&&E("Invalid parameter in getDocument, need either Uint8Array, string or a parameter object"),!e.url&&!e.data&&!e.range&&E("Invalid parameter object: need either .data, .range or .url"),s=e);var o={},u=null,a=null;for(var f in s){if(f==="url"&&typeof window!="undefined"){o[f]=(new URL(s[f],window.location)).href;continue}if(f==="range"){u=s[f];continue}if(f==="worker"){a=s[f];continue}if(!(f!=="data"||s[f]instanceof Uint8Array)){var l=s[f];typeof l=="string"?o[f]=O(l):typeof l=="object"&&l!==null&&!isNaN(l.length)?o[f]=new Uint8Array(l):k(l)?o[f]=new Uint8Array(l):E("Invalid PDF binary data: either typed array, string or array-like object is expected in the data property.");continue}o[f]=s[f]}o.rangeChunkSize=o.rangeChunkSize||I,a||(a=new Y,i._worker=a);var h=i.docId;return a.promise.then(function(){if(i.destroyed)throw new Error("Loading aborted");return $(a,o,u,h).then(function(e){if(i.destroyed)throw new Error("Loading aborted");var t=new c(h,e,a.port),n=new Z(t,i,u);i._transport=n,t.send("Ready",null)})}).catch(i._capability.reject),i}function $(e,t,n,r){return e.destroyed?Promise.reject(new Error("Worker was destroyed")):(t.disableAutoFetch=F("disableAutoFetch"),t.disableStream=F("disableStream"),t.chunkedViewerLoading=!!n,n&&(t.length=n.length,t.initialData=n.initialData),e.messageHandler.sendWithPromise("GetDocRequest",{docId:r,source:t,disableRange:F("disableRange"),maxImageSize:F("maxImageSize"),cMapUrl:F("cMapUrl"),cMapPacked:F("cMapPacked"),disableFontFace:F("disableFontFace"),disableCreateObjectURL:F("disableCreateObjectURL"),postMessageTransfers:F("postMessageTransfers")&&!U,docBaseUrl:t.docBaseUrl}).then(function(t){if(e.destroyed)throw new Error("Worker was destroyed");return t}))}var l=i.InvalidPDFException,c=i.MessageHandler,h=i.MissingPDFException,p=i.PageViewport,d=i.PasswordResponses,v=i.PasswordException,m=i.StatTimer,g=i.UnexpectedResponseException,y=i.UnknownErrorException,b=i.Util,w=i.createPromiseCapability,E=i.error,S=i.deprecated,x=i.getVerbosityLevel,T=i.info,N=i.isInt,C=i.isArray,k=i.isArrayBuffer,L=i.isSameOrigin,A=i.loadJpegStream,O=i.stringToBytes,M=i.globalScope,_=i.warn,D=s.FontFaceObject,P=s.FontLoader,H=o.CanvasGraphics,B=o.createScratchCanvas,j=u.Metadata,F=a.getDefaultSetting,I=65536,q=!1,R,U=!1,z=null,W=!1;typeof window=="undefined"&&(q=!0,typeof require.ensure=="undefined"&&(require.ensure=require("node-ensure")),W=!0),typeof __webpack_require__!="undefined"&&(W=!0),typeof requirejs!="undefined"&&requirejs.toUrl&&(R=requirejs.toUrl("pdfjs-dist/build/pdf.worker.js"));var X=typeof requirejs!="undefined"&&requirejs.load;z=W?function(e){require.ensure([],function(){var t=require("./pdf.worker.js");e(t.WorkerMessageHandler)})}:X?function(e){requirejs(["pdfjs-dist/build/pdf.worker"],function(t){e(t.WorkerMessageHandler)})}:null;var J=function(){function n(){this._capability=w(),this._transport=null,this._worker=null,this.docId="d"+t++,this.destroyed=!1,this.onPassword=null,this.onProgress=null,this.onUnsupportedFeature=null}var t=0;return n.prototype={get promise(){return this._capability.promise},destroy:function(){this.destroyed=!0;var e=this._transport?this._transport.destroy():Promise.resolve();return e.then(function(){this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}.bind(this))},then:function(t,n){return this.promise.then.apply(this.promise,arguments)}},n}(),K=function(){function t(e,t){this.length=e,this.initialData=t,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._readyCapability=w()}return t.prototype={addRangeListener:function(t){this._rangeListeners.push(t)},addProgressListener:function(t){this._progressListeners.push(t)},addProgressiveReadListener:function(t){this._progressiveReadListeners.push(t)},onDataRange:function(t,n){var r=this._rangeListeners;for(var i=0,s=r.length;i<s;++i)r[i](t,n)},onDataProgress:function(t){this._readyCapability.promise.then(function(){var e=this._progressListeners;for(var n=0,r=e.length;n<r;++n)e[n](t)}.bind(this))},onDataProgressiveRead:function(t){this._readyCapability.promise.then(function(){var e=this._progressiveReadListeners;for(var n=0,r=e.length;n<r;++n)e[n](t)}.bind(this))},transportReady:function(){this._readyCapability.resolve()},requestDataRange:function(t,n){throw new Error("Abstract method PDFDataRangeTransport.requestDataRange")},abort:function(){}},t}(),Q=function(){function t(e,t,n){this.pdfInfo=e,this.transport=t,this.loadingTask=n}return t.prototype={get numPages(){return this.pdfInfo.numPages},get fingerprint(){return this.pdfInfo.fingerprint},getPage:function(t){return this.transport.getPage(t)},getPageIndex:function(t){return this.transport.getPageIndex(t)},getDestinations:function(){return this.transport.getDestinations()},getDestination:function(t){return this.transport.getDestination(t)},getPageLabels:function(){return this.transport.getPageLabels()},getAttachments:function(){return this.transport.getAttachments()},getJavaScript:function(){return this.transport.getJavaScript()},getOutline:function(){return this.transport.getOutline()},getMetadata:function(){return this.transport.getMetadata()},getData:function(){return this.transport.getData()},getDownloadInfo:function(){return this.transport.downloadInfoCapability.promise},getStats:function(){return this.transport.getStats()},cleanup:function(){this.transport.startCleanup()},destroy:function(){return this.loadingTask.destroy()}},t}(),G=function(){function t(e,t,n){this.pageIndex=e,this.pageInfo=t,this.transport=n,this.stats=new m,this.stats.enabled=F("enableStats"),this.commonObjs=n.commonObjs,this.objs=new et,this.cleanupAfterRender=!1,this.pendingCleanup=!1,this.intentStates=Object.create(null),this.destroyed=!1}return t.prototype={get pageNumber(){return this.pageIndex+1},get rotate(){return this.pageInfo.rotate},get ref(){return this.pageInfo.ref},get userUnit(){return this.pageInfo.userUnit},get view(){return this.pageInfo.view},getViewport:function(t,n){return arguments.length<2&&(n=this.rotate),new p(this.view,t,n,0,0)},getAnnotations:function(t){var n=t&&t.intent||null;if(!this.annotationsPromise||this.annotationsIntent!==n)this.annotationsPromise=this.transport.getAnnotations(this.pageIndex,n),this.annotationsIntent=n;return this.annotationsPromise},render:function(t){function f(e){var t=s.renderTasks.indexOf(o);t>=0&&s.renderTasks.splice(t,1),a.cleanupAfterRender&&(a.pendingCleanup=!0),a._tryCleanup(),e?o.capability.reject(e):o.capability.resolve(),n.timeEnd("Rendering"),n.timeEnd("Overall")}var n=this.stats;n.time("Overall"),this.pendingCleanup=!1;var r=t.intent==="print"?"print":"display",i=t.renderInteractiveForms===!0?!0:!1;this.intentStates[r]||(this.intentStates[r]=Object.create(null));var s=this.intentStates[r];s.displayReadyCapability||(s.receivingOperatorList=!0,s.displayReadyCapability=w(),s.operatorList={fnArray:[],argsArray:[],lastChunk:!1},this.stats.time("Page Request"),this.transport.messageHandler.send("RenderPageRequest",{pageIndex:this.pageNumber-1,intent:r,renderInteractiveForms:i}));var o=new nt(f,t,this.objs,this.commonObjs,s.operatorList,this.pageNumber);o.useRequestAnimationFrame=r!=="print",s.renderTasks||(s.renderTasks=[]),s.renderTasks.push(o);var u=o.task;t.continueCallback&&(S("render is used with continueCallback parameter"),u.onContinue=t.continueCallback);var a=this;return s.displayReadyCapability.promise.then(function(t){if(a.pendingCleanup){f();return}n.time("Rendering"),o.initializeGraphics(t),o.operatorListChanged()},function(t){f(t)}),u},getOperatorList:function(){function t(){if(r.operatorList.lastChunk){r.opListReadCapability.resolve(r.operatorList);var e=r.renderTasks.indexOf(i);e>=0&&r.renderTasks.splice(e,1)}}var n="oplist";this.intentStates[n]||(this.intentStates[n]=Object.create(null));var r=this.intentStates[n],i;return r.opListReadCapability||(i={},i.operatorListChanged=t,r.receivingOperatorList=!0,r.opListReadCapability=w(),r.renderTasks=[],r.renderTasks.push(i),r.operatorList={fnArray:[],argsArray:[],lastChunk:!1},this.transport.messageHandler.send("RenderPageRequest",{pageIndex:this.pageIndex,intent:n})),r.opListReadCapability.promise},getTextContent:function(t){return this.transport.messageHandler.sendWithPromise("GetTextContent",{pageIndex:this.pageNumber-1,normalizeWhitespace:t&&t.normalizeWhitespace===!0?!0:!1,combineTextItems:t&&t.disableCombineTextItems===!0?!1:!0})},_destroy:function(){this.destroyed=!0,this.transport.pageCache[this.pageIndex]=null;var t=[];return Object.keys(this.intentStates).forEach(function(e){if(e==="oplist")return;var n=this.intentStates[e];n.renderTasks.forEach(function(e){var n=e.capability.promise.catch(function(){});t.push(n),e.cancel()})},this),this.objs.clear(),this.annotationsPromise=null,this.pendingCleanup=!1,Promise.all(t)},destroy:function(){S("page destroy method, use cleanup() instead"),this.cleanup()},cleanup:function(){this.pendingCleanup=!0,this._tryCleanup()},_tryCleanup:function(){if(!this.pendingCleanup||Object.keys(this.intentStates).some(function(e){var t=this.intentStates[e];return t.renderTasks.length!==0||t.receivingOperatorList},this))return;Object.keys(this.intentStates).forEach(function(e){delete this.intentStates[e]},this),this.objs.clear(),this.annotationsPromise=null,this.pendingCleanup=!1},_startRenderPage:function(t,n){var r=this.intentStates[n];r.displayReadyCapability&&r.displayReadyCapability.resolve(t)},_renderPageChunk:function(t,n){var r=this.intentStates[n],i,s;for(i=0,s=t.length;i<s;i++)r.operatorList.fnArray.push(t.fnArray[i]),r.operatorList.argsArray.push(t.argsArray[i]);r.operatorList.lastChunk=t.lastChunk;for(i=0;i<r.renderTasks.length;i++)r.renderTasks[i].operatorListChanged();t.lastChunk&&(r.receivingOperatorList=!1,this._tryCleanup())}},t}(),Y=function(){function n(){if(typeof R!="undefined")return R;if(F("workerSrc"))return F("workerSrc");if(r)return r.replace(/\.js$/i,".worker.js");E("No PDFJS.workerSrc specified")}function s(){var e;if(i)return i.promise;i=w();var t=z||function(e){b.loadScript(n(),function(){e(window.pdfjsDistBuildPdfWorker.WorkerMessageHandler)})};return t(i.resolve),i.promise}function o(e){this._listeners=[],this._defer=e,this._deferred=Promise.resolve(undefined)}function u(e){var t="importScripts('"+e+"');";return URL.createObjectURL(new Blob([t]))}function a(e){this.name=e,this.destroyed=!1,this._readyCapability=w(),this._port=null,this._webWorker=null,this._messageHandler=null,this._initialize()}var t=0,i;return o.prototype={postMessage:function(e,t){function n(e){if(typeof e!="object"||e===null)return e;if(r.has(e))return r.get(e);var i,s;if((s=e.buffer)&&k(s)){var o=t&&t.indexOf(s)>=0;return e===s?i=e:o?i=new e.constructor(s,e.byteOffset,e.byteLength):i=new e.constructor(e),r.set(e,i),i}i=C(e)?[]:{},r.set(e,i);for(var u in e){var a,f=e;while(!(a=Object.getOwnPropertyDescriptor(f,u)))f=Object.getPrototypeOf(f);if(typeof a.value=="undefined"||typeof a.value=="function")continue;i[u]=n(a.value)}return i}if(!this._defer){this._listeners.forEach(function(t){t.call(this,{data:e})},this);return}var r=new WeakMap,i={data:n(e)};this._deferred.then(function(){this._listeners.forEach(function(e){e.call(this,i)},this)}.bind(this))},addEventListener:function(e,t){this._listeners.push(t)},removeEventListener:function(e,t){var n=this._listeners.indexOf(t);this._listeners.splice(n,1)},terminate:function(){this._listeners=[]}},a.prototype={get promise(){return this._readyCapability.promise},get port(){return this._port},get messageHandler(){return this._messageHandler},_initialize:function(){if(!q&&!F("disableWorker")&&typeof Worker!="undefined"){var t=n();try{L(window.location.href,t)||(t=u((new URL(t,window.location)).href));var r=new Worker(t),i=new c("main","worker",r),s=function(){r.removeEventListener("error",o),i.destroy(),r.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()}.bind(this),o=function(e){this._webWorker||s()}.bind(this);r.addEventListener("error",o),i.on("test",function(t){r.removeEventListener("error",o);if(this.destroyed){s();return}var n=t&&t.supportTypedArray;n?(this._messageHandler=i,this._port=r,this._webWorker=r,t.supportTransfers||(U=!0),this._readyCapability.resolve(),i.send("configure",{verbosity:x()})):(this._setupFakeWorker(),i.destroy(),r.terminate())}.bind(this)),i.on("console_log",function(e){console.log.apply(console,e)}),i.on("console_error",function(e){console.error.apply(console,e)}),i.on("ready",function(e){r.removeEventListener("error",o);if(this.destroyed){s();return}try{a()}catch(t){this._setupFakeWorker()}}.bind(this));var a=function(){var e=F("postMessageTransfers")&&!U,t=new Uint8Array([e?255:0]);try{i.send("test",t,[t.buffer])}catch(n){T("Cannot use postMessage transfers"),t[0]=0,i.send("test",t)}};a();return}catch(f){T("The worker has been disabled.")}}this._setupFakeWorker()},_setupFakeWorker:function(){!q&&!F("disableWorker")&&(_("Setting up fake worker."),q=!0),s().then(function(e){if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}var n=Uint8Array!==Float32Array,r=new o(n);this._port=r;var i="fake"+t++,s=new c(i+"_worker",i,r);e.setup(s,r);var u=new c(i,i+"_worker",r);this._messageHandler=u,this._readyCapability.resolve()}.bind(this))},destroy:function(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}},a}(),Z=function(){function t(e,t,n){this.messageHandler=e,this.loadingTask=t,this.pdfDataRangeTransport=n,this.commonObjs=new et,this.fontLoader=new P(t.docId),this.destroyed=!1,this.destroyCapability=null,this._passwordCapability=null,this.pageCache=[],this.pagePromises=[],this.downloadInfoCapability=w(),this.setupMessageHandler()}return t.prototype={destroy:function(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=w(),this._passwordCapability&&this._passwordCapability.reject(new Error("Worker was destroyed during onPassword callback"));var t=[];this.pageCache.forEach(function(e){e&&t.push(e._destroy())}),this.pageCache=[],this.pagePromises=[];var n=this,r=this.messageHandler.sendWithPromise("Terminate",null);return t.push(r),Promise.all(t).then(function(){n.fontLoader.clear(),n.pdfDataRangeTransport&&(n.pdfDataRangeTransport.abort(),n.pdfDataRangeTransport=null),n.messageHandler&&(n.messageHandler.destroy(),n.messageHandler=null),n.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise},setupMessageHandler:function(){var t=this.messageHandler,n=this.loadingTask,r=this.pdfDataRangeTransport;r&&(r.addRangeListener(function(e,n){t.send("OnDataRange",{begin:e,chunk:n})}),r.addProgressListener(function(e){t.send("OnDataProgress",{loaded:e})}),r.addProgressiveReadListener(function(e){t.send("OnDataRange",{chunk:e})}),t.on("RequestDataRange",function(t){r.requestDataRange(t.begin,t.end)},this)),t.on("GetDoc",function(t){var n=t.pdfInfo;this.numPages=t.pdfInfo.numPages;var r=this.loadingTask,i=new Q(n,this,r);this.pdfDocument=i,r._capability.resolve(i)},this),t.on("PasswordRequest",function(t){this._passwordCapability=w();if(n.onPassword){var r=function(e){this._passwordCapability.resolve({password:e})}.bind(this);n.onPassword(r,t.code)}else this._passwordCapability.reject(new v(t.message,t.code));return this._passwordCapability.promise},this),t.on("PasswordException",function(t){n._capability.reject(new v(t.message,t.code))},this),t.on("InvalidPDF",function(t){this.loadingTask._capability.reject(new l(t.message))},this),t.on("MissingPDF",function(t){this.loadingTask._capability.reject(new h(t.message))},this),t.on("UnexpectedResponse",function(t){this.loadingTask._capability.reject(new g(t.message,t.status))},this),t.on("UnknownError",function(t){this.loadingTask._capability.reject(new y(t.message,t.details))},this),t.on("DataLoaded",function(t){this.downloadInfoCapability.resolve(t)},this),t.on("PDFManagerReady",function(t){this.pdfDataRangeTransport&&this.pdfDataRangeTransport.transportReady()},this),t.on("StartRenderPage",function(t){if(this.destroyed)return;var n=this.pageCache[t.pageIndex];n.stats.timeEnd("Page Request"),n._startRenderPage(t.transparency,t.intent)},this),t.on("RenderPageChunk",function(t){if(this.destroyed)return;var n=this.pageCache[t.pageIndex];n._renderPageChunk(t.operatorList,t.intent)},this),t.on("commonobj",function(t){if(this.destroyed)return;var n=t[0],r=t[1];if(this.commonObjs.hasData(n))return;switch(r){case"Font":var i=t[2];if("error"in i){var s=i.error;_("Error during font loading: "+s),this.commonObjs.resolve(n,s);break}var o=null;F("pdfBug")&&M.FontInspector&&M.FontInspector.enabled&&(o={registerFont:function(e,t){M.FontInspector.fontAdded(e,t)}});var u=new D(i,{isEvalSuported:F("isEvalSupported"),disableFontFace:F("disableFontFace"),fontRegistry:o});this.fontLoader.bind([u],function(t){this.commonObjs.resolve(n,u)}.bind(this));break;case"FontPath":this.commonObjs.resolve(n,t[2]);break;default:E("Got unknown common object type "+r)}},this),t.on("obj",function(t){if(this.destroyed)return;var n=t[0],r=t[1],i=t[2],s=this.pageCache[r],o;if(s.objs.hasData(n))return;switch(i){case"JpegStream":o=t[3],A(n,o,s.objs);break;case"Image":o=t[3],s.objs.resolve(n,o);var u=8e6;o&&"data"in o&&o.data.length>u&&(s.cleanupAfterRender=!0);break;default:E("Got unknown object type "+i)}},this),t.on("DocProgress",function(t){if(this.destroyed)return;var n=this.loadingTask;n.onProgress&&n.onProgress({loaded:t.loaded,total:t.total})},this),t.on("PageError",function(t){if(this.destroyed)return;var n=this.pageCache[t.pageNum-1],r=n.intentStates[t.intent];r.displayReadyCapability?r.displayReadyCapability.reject(t.error):E(t.error);if(r.operatorList){r.operatorList.lastChunk=!0;for(var i=0;i<r.renderTasks.length;i++)r.renderTasks[i].operatorListChanged()}},this),t.on("UnsupportedFeature",function(t){if(this.destroyed)return;var n=t.featureId,r=this.loadingTask;r.onUnsupportedFeature&&r.onUnsupportedFeature(n),rt.notify(n)},this),t.on("JpegDecode",function(e){if(this.destroyed)return Promise.reject(new Error("Worker was destroyed"));var t=e[0],n=e[1];return n!==3&&n!==1?Promise.reject(new Error("Only 3 components or 1 component can be returned")):new Promise(function(e,r){var i=new Image;i.onload=function(){var t=i.width,r=i.height,s=t*r,o=s*4,u=new Uint8Array(s*n),a=B(t,r),f=a.getContext("2d");f.drawImage(i,0,0);var l=f.getImageData(0,0,t,r).data,c,h;if(n===3)for(c=0,h=0;c<o;c+=4,h+=3)u[h]=l[c],u[h+1]=l[c+1],u[h+2]=l[c+2];else if(n===1)for(c=0,h=0;c<o;c+=4,h++)u[h]=l[c];e({data:u,width:t,height:r})},i.onerror=function(){r(new Error("JpegDecode failed to load image"))},i.src=t})},this)},getData:function(){return this.messageHandler.sendWithPromise("GetData",null)},getPage:function(t,n){if(!N(t)||t<=0||t>this.numPages)return Promise.reject(new Error("Invalid page request"));var r=t-1;if(r in this.pagePromises)return this.pagePromises[r];var i=this.messageHandler.sendWithPromise("GetPage",{pageIndex:r}).then(function(e){if(this.destroyed)throw new Error("Transport destroyed");var t=new G(r,e,this);return this.pageCache[r]=t,t}.bind(this));return this.pagePromises[r]=i,i},getPageIndex:function(t){return this.messageHandler.sendWithPromise("GetPageIndex",{ref:t}).catch(function(e){return Promise.reject(new Error(e))})},getAnnotations:function(t,n){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:n})},getDestinations:function(){return this.messageHandler.sendWithPromise("GetDestinations",null)},getDestination:function(t){return this.messageHandler.sendWithPromise("GetDestination",{id:t})},getPageLabels:function(){return this.messageHandler.sendWithPromise("GetPageLabels",null)},getAttachments:function(){return this.messageHandler.sendWithPromise("GetAttachments",null)},getJavaScript:function(){return this.messageHandler.sendWithPromise("GetJavaScript",null)},getOutline:function(){return this.messageHandler.sendWithPromise("GetOutline",null)},getMetadata:function(){return this.messageHandler.sendWithPromise("GetMetadata",null).then(function(t){return{info:t[0],metadata:t[1]?new j(t[1]):null}})},getStats:function(){return this.messageHandler.sendWithPromise("GetStats",null)},startCleanup:function(){this.messageHandler.sendWithPromise("Cleanup",null).then(function(){for(var t=0,n=this.pageCache.length;t<n;t++){var r=this.pageCache[t];r&&r.cleanup()}this.commonObjs.clear(),this.fontLoader.clear()}.bind(this))}},t}(),et=function(){function t(){this.objs=Object.create(null)}return t.prototype={ensureObj:function(t){if(this.objs[t])return this.objs[t];var n={capability:w(),data:null,resolved:!1};return this.objs[t]=n,n},get:function(t,n){if(n)return this.ensureObj(t).capability.promise.then(n),null;var r=this.objs[t];return(!r||!r.resolved)&&E("Requesting object that isn't resolved yet "+t),r.data},resolve:function(t,n){var r=this.ensureObj(t);r.resolved=!0,r.data=n,r.capability.resolve(n)},isResolved:function(t){var n=this.objs;return n[t]?n[t].resolved:!1},hasData:function(t){return this.isResolved(t)},getData:function(t){var n=this.objs;return!n[t]||!n[t].resolved?null:n[t].data},clear:function(){this.objs=Object.create(null)}},t}(),tt=function(){function t(e){this._internalRenderTask=e,this.onContinue=null}return t.prototype={get promise(){return this._internalRenderTask.capability.promise},cancel:function(){this._internalRenderTask.cancel()},then:function(t,n){return this.promise.then.apply(this.promise,arguments)}},t}(),nt=function(){function t(e,t,n,r,i,s){this.callback=e,this.params=t,this.objs=n,this.commonObjs=r,this.operatorListIdx=null,this.operatorList=i,this.pageNumber=s,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this.useRequestAnimationFrame=!1,this.cancelled=!1,this.capability=w(),this.task=new tt(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this)}return t.prototype={initializeGraphics:function(t){if(this.cancelled)return;F("pdfBug")&&M.StepperManager&&M.StepperManager.enabled&&(this.stepper=M.StepperManager.create(this.pageNumber-1),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());var n=this.params;this.gfx=new H(n.canvasContext,this.commonObjs,this.objs,n.imageLayer),this.gfx.beginDrawing(n.transform,n.viewport,t),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback&&this.graphicsReadyCallback()},cancel:function(){this.running=!1,this.cancelled=!0,this.callback("cancelled")},operatorListChanged:function(){if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}this.stepper&&this.stepper.updateOperatorList(this.operatorList);if(this.running)return;this._continue()},_continue:function(){this.running=!0;if(this.cancelled)return;this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext()},_scheduleNext:function(){this.useRequestAnimationFrame&&typeof window!="undefined"?window.requestAnimationFrame(this._nextBound):Promise.resolve(undefined).then(this._nextBound)},_next:function(){if(this.cancelled)return;this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),this.callback()))}},t}(),rt=function(){var t=[];return{listen:function(e){S("Global UnsupportedManager.listen is used:  use PDFDocumentLoadingTask.onUnsupportedFeature instead"),t.push(e)},notify:function(e){for(var n=0,r=t.length;n<r;n++)t[n](e)}}}();typeof t!="undefined"&&(e.version=t),typeof n!="undefined"&&(e.build=n),e.getDocument=V,e.PDFDataRangeTransport=K,e.PDFWorker=Y,e.PDFDocumentProxy=Q,e.PDFPageProxy=G,e._UnsupportedManager=rt}),function(e,t){t(e.pdfjsDisplayGlobal={},e.pdfjsSharedUtil,e.pdfjsDisplayDOMUtils,e.pdfjsDisplayAPI,e.pdfjsDisplayAnnotationLayer,e.pdfjsDisplayTextLayer,e.pdfjsDisplayMetadata,e.pdfjsDisplaySVG)}(this,function(e,r,i,s,o,u,a,f){var l=r.globalScope,c=r.deprecated,h=r.warn,p=i.LinkTarget,d=i.DEFAULT_LINK_REL,v=typeof window=="undefined";l.PDFJS||(l.PDFJS={});var m=l.PDFJS;typeof t!="undefined"&&(m.version=t),typeof n!="undefined"&&(m.build=n),m.pdfBug=!1,m.verbosity!==undefined&&r.setVerbosityLevel(m.verbosity),delete m.verbosity,Object.defineProperty(m,"verbosity",{get:function(){return r.getVerbosityLevel()},set:function(e){r.setVerbosityLevel(e)},enumerable:!0,configurable:!0}),m.VERBOSITY_LEVELS=r.VERBOSITY_LEVELS,m.OPS=r.OPS,m.UNSUPPORTED_FEATURES=r.UNSUPPORTED_FEATURES,m.isValidUrl=i.isValidUrl,m.shadow=r.shadow,m.createBlob=r.createBlob,m.createObjectURL=function(t,n){return r.createObjectURL(t,n,m.disableCreateObjectURL)},Object.defineProperty(m,"isLittleEndian",{configurable:!0,get:function(){var t=r.isLittleEndian();return r.shadow(m,"isLittleEndian",t)}}),m.removeNullCharacters=r.removeNullCharacters,m.PasswordResponses=r.PasswordResponses,m.PasswordException=r.PasswordException,m.UnknownErrorException=r.UnknownErrorException,m.InvalidPDFException=r.InvalidPDFException,m.MissingPDFException=r.MissingPDFException,m.UnexpectedResponseException=r.UnexpectedResponseException,m.Util=r.Util,m.PageViewport=r.PageViewport,m.createPromiseCapability=r.createPromiseCapability,m.maxImageSize=m.maxImageSize===undefined?-1:m.maxImageSize,m.cMapUrl=m.cMapUrl===undefined?null:m.cMapUrl,m.cMapPacked=m.cMapPacked===undefined?!1:m.cMapPacked,m.disableFontFace=m.disableFontFace===undefined?!1:m.disableFontFace,m.imageResourcesPath=m.imageResourcesPath===undefined?"":m.imageResourcesPath,m.disableWorker=m.disableWorker===undefined?!1:m.disableWorker,m.workerSrc=m.workerSrc===undefined?null:m.workerSrc,m.disableRange=m.disableRange===undefined?!1:m.disableRange,m.disableStream=m.disableStream===undefined?!1:m.disableStream,m.disableAutoFetch=m.disableAutoFetch===undefined?!1:m.disableAutoFetch,m.pdfBug=m.pdfBug===undefined?!1:m.pdfBug,m.postMessageTransfers=m.postMessageTransfers===undefined?!0:m.postMessageTransfers,m.disableCreateObjectURL=m.disableCreateObjectURL===undefined?!1:m.disableCreateObjectURL,m.disableWebGL=m.disableWebGL===undefined?!0:m.disableWebGL,m.externalLinkTarget=m.externalLinkTarget===undefined?p.NONE:m.externalLinkTarget,m.externalLinkRel=m.externalLinkRel===undefined?d:m.externalLinkRel,m.isEvalSupported=m.isEvalSupported===undefined?!0:m.isEvalSupported;var g=m.openExternalLinksInNewWindow;delete m.openExternalLinksInNewWindow,Object.defineProperty(m,"openExternalLinksInNewWindow",{get:function(){return m.externalLinkTarget===p.BLANK},set:function(e){e&&c('PDFJS.openExternalLinksInNewWindow, please use "PDFJS.externalLinkTarget = PDFJS.LinkTarget.BLANK" instead.');if(m.externalLinkTarget!==p.NONE){h("PDFJS.externalLinkTarget is already initialized");return}m.externalLinkTarget=e?p.BLANK:p.NONE},enumerable:!0,configurable:!0}),g&&(m.openExternalLinksInNewWindow=g),m.getDocument=s.getDocument,m.PDFDataRangeTransport=s.PDFDataRangeTransport,m.PDFWorker=s.PDFWorker,Object.defineProperty(m,"hasCanvasTypedArrays",{configurable:!0,get:function(){var t=i.hasCanvasTypedArrays();return r.shadow(m,"hasCanvasTypedArrays",t)}}),m.CustomStyle=i.CustomStyle,m.LinkTarget=p,m.addLinkAttributes=i.addLinkAttributes,m.getFilenameFromUrl=i.getFilenameFromUrl,m.isExternalLinkTargetSet=i.isExternalLinkTargetSet,m.AnnotationLayer=o.AnnotationLayer,m.renderTextLayer=u.renderTextLayer,m.Metadata=a.Metadata,m.SVGGraphics=f.SVGGraphics,m.UnsupportedManager=s._UnsupportedManager,e.globalScope=l,e.isWorker=v,e.PDFJS=l.PDFJS})}).call(i),e.PDFJS=i.pdfjsDisplayGlobal.PDFJS,e.build=i.pdfjsDisplayAPI.build,e.version=i.pdfjsDisplayAPI.version,e.getDocument=i.pdfjsDisplayAPI.getDocument,e.PDFDataRangeTransport=i.pdfjsDisplayAPI.PDFDataRangeTransport,e.PDFWorker=i.pdfjsDisplayAPI.PDFWorker,e.renderTextLayer=i.pdfjsDisplayTextLayer.renderTextLayer,e.AnnotationLayer=i.pdfjsDisplayAnnotationLayer.AnnotationLayer,e.CustomStyle=i.pdfjsDisplayDOMUtils.CustomStyle,e.PasswordResponses=i.pdfjsSharedUtil.PasswordResponses,e.InvalidPDFException=i.pdfjsSharedUtil.InvalidPDFException,e.MissingPDFException=i.pdfjsSharedUtil.MissingPDFException,e.SVGGraphics=i.pdfjsDisplaySVG.SVGGraphics,e.UnexpectedResponseException=i.pdfjsSharedUtil.UnexpectedResponseException,e.OPS=i.pdfjsSharedUtil.OPS,e.UNSUPPORTED_FEATURES=i.pdfjsSharedUtil.UNSUPPORTED_FEATURES,e.isValidUrl=i.pdfjsDisplayDOMUtils.isValidUrl,e.createValidAbsoluteUrl=i.pdfjsSharedUtil.createValidAbsoluteUrl,e.createObjectURL=i.pdfjsSharedUtil.createObjectURL,e.removeNullCharacters=i.pdfjsSharedUtil.removeNullCharacters,e.shadow=i.pdfjsSharedUtil.shadow,e.createBlob=i.pdfjsSharedUtil.createBlob,e.getFilenameFromUrl=i.pdfjsDisplayDOMUtils.getFilenameFromUrl,e.addLinkAttributes=i.pdfjsDisplayDOMUtils.addLinkAttributes}),function(e,t){typeof define=="function"&&define.amd?define("f",[],t):e.forge=t()}(this,function(){var e,t,n;return function(r){function i(e,t){return w.call(e,t)}function s(e,t){var n,r,i,s,o,u,a,f,l,c,h,p=t&&t.split("/"),d=y.map,v=d&&d["*"]||{};if(e&&e.charAt(0)===".")if(t){p=p.slice(0,p.length-1),e=e.split("/"),o=e.length-1,y.nodeIdCompat&&S.test(e[o])&&(e[o]=e[o].replace(S,"")),e=p.concat(e);for(l=0;l<e.length;l+=1){h=e[l];if(h===".")e.splice(l,1),l-=1;else if(h===".."){if(l===1&&(e[2]===".."||e[0]===".."))break;l>0&&(e.splice(l-1,2),l-=2)}}e=e.join("/")}else e.indexOf("./")===0&&(e=e.substring(2));if((p||v)&&d){n=e.split("/");for(l=n.length;l>0;l-=1){r=n.slice(0,l).join("/");if(p)for(c=p.length;c>0;c-=1){i=d[p.slice(0,c).join("/")];if(i){i=i[r];if(i){s=i,u=l;break}}}if(s)break;!a&&v&&v[r]&&(a=v[r],f=l)}!s&&a&&(s=a,u=f),s&&(n.splice(0,u,s),e=n.join("/"))}return e}function o(e,t){return function(){return p.apply(r,E.call(arguments,0).concat([e,t]))}}function u(e){return function(t){return s(t,e)}}function a(e){return function(t){m[e]=t}}function f(e){if(i(g,e)){var t=g[e];delete g[e],b[e]=!0,h.apply(r,t)}if(!i(m,e)&&!i(b,e))throw new Error("No "+e);return m[e]}function l(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function c(e){return function(){return y&&y.config&&y.config[e]||{}}}var h,p,d,v,m={},g={},y={},b={},w=Object.prototype.hasOwnProperty,E=[].slice,S=/\.js$/;d=function(e,t){var n,r=l(e),i=r[0];return e=r[1],i&&(i=s(i,t),n=f(i)),i?n&&n.normalize?e=n.normalize(e,u(t)):e=s(e,t):(e=s(e,t),r=l(e),i=r[0],e=r[1],i&&(n=f(i))),{f:i?i+"!"+e:e,n:e,pr:i,p:n}},v={require:function(e){return o(e)},exports:function(e){var t=m[e];return typeof t!="undefined"?t:m[e]={}},module:function(e){return{id:e,uri:"",exports:m[e],config:c(e)}}},h=function(e,t,n,s){var u,l,c,h,p,y=[],w=typeof n,E;s=s||e;if(w==="undefined"||w==="function"){t=!t.length&&n.length?["require","exports","module"]:t;for(p=0;p<t.length;p+=1){h=d(t[p],s),l=h.f;if(l==="require")y[p]=v.require(e);else if(l==="exports")y[p]=v.exports(e),E=!0;else if(l==="module")u=y[p]=v.module(e);else if(i(m,l)||i(g,l)||i(b,l))y[p]=f(l);else{if(!h.p)throw new Error(e+" missing "+l);h.p.load(h.n,o(s,!0),a(l),{}),y[p]=m[l]}}c=n?n.apply(m[e],y):undefined;if(e)if(u&&u.exports!==r&&u.exports!==m[e])m[e]=u.exports;else if(c!==r||!E)m[e]=c}else e&&(m[e]=n)},e=t=p=function(e,t,n,i,s){if(typeof e=="string")return v[e]?v[e](t):f(d(e,t).f);if(!e.splice){y=e,y.deps&&p(y.deps,y.callback);if(!t)return;t.splice?(e=t,t=n,n=null):e=r}return t=t||function(){},typeof n=="function"&&(n=i,i=s),i?h(r,e,t,n):setTimeout(function(){h(r,e,t,n)},4),p},p.config=function(e){return p(e)},e._defined=m,n=function(e,t,n){t.splice||(n=t,t=[]),!i(m,e)&&!i(g,e)&&(g[e]=[e,t,n])},n.amd={jQuery:!0}}(),n("node_modules/almond/almond",function(){}),function(){function e(e){function t(e){this.data="",this.read=0;if(typeof e=="string")this.data=e;else if(r.isArrayBuffer(e)||r.isArrayBufferView(e)){var n=new Uint8Array(e);try{this.data=String.fromCharCode.apply(null,n)}catch(i){for(var s=0;s<n.length;++s)this.putByte(n[s])}}else if(e instanceof t||typeof e=="object"&&typeof e.data=="string"&&typeof e.read=="number")this.data=e.data,this.read=e.read;this._constructedStringLength=0}function n(e,t){t=t||{},this.read=t.readOffset||0,this.growSize=t.growSize||1024;var n=r.isArrayBuffer(e),i=r.isArrayBufferView(e);if(n||i){n?this.data=new DataView(e):this.data=new DataView(e.buffer,e.byteOffset,e.byteLength),this.write="writeOffset"in t?t.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,e!==null&&e!==undefined&&this.putBytes(e),"writeOffset"in t&&(this.write=t.writeOffset)}var r=e.util=e.util||{};(function(){if(typeof process!="undefined"&&process.nextTick){r.nextTick=process.nextTick,typeof setImmediate=="function"?r.setImmediate=setImmediate:r.setImmediate=r.nextTick;return}if(typeof setImmediate=="function"){r.setImmediate=setImmediate,r.nextTick=function(e){return setImmediate(e)};return}r.setImmediate=function(e){setTimeout(e,0)};if(typeof window!="undefined"&&typeof window.postMessage=="function"){var e="forge.setImmediate",t=[];r.setImmediate=function(n){t.push(n),t.length===1&&window.postMessage(e,"*")};function n(n){if(n.source===window&&n.data===e){n.stopPropagation();var r=t.slice();t.length=0,r.forEach(function(e){e()})}}window.addEventListener("message",n,!0)}if(typeof MutationObserver!="undefined"){var i=Date.now(),s=!0,o=document.createElement("div"),t=[];(new MutationObserver(function(){var e=t.slice();t.length=0,e.forEach(function(e){e()})})).observe(o,{attributes:!0});var u=r.setImmediate;r.setImmediate=function(e){Date.now()-i>15?(i=Date.now(),u(e)):(t.push(e),t.length===1&&o.setAttribute("a",s=!s))}}r.nextTick=r.setImmediate})(),r.isArray=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"},r.isArrayBuffer=function(e){return typeof ArrayBuffer!="undefined"&&e instanceof ArrayBuffer},r.isArrayBufferView=function(e){return e&&r.isArrayBuffer(e.buffer)&&e.byteLength!==undefined},r.ByteBuffer=t,r.ByteStringBuffer=t;var i=4096;r.ByteStringBuffer.prototype._optimizeConstructedString=function(e){this._constructedStringLength+=e,this._constructedStringLength>i&&(this.data.substr(0,1),this._constructedStringLength=0)},r.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read},r.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0},r.ByteStringBuffer.prototype.putByte=function(e){return this.putBytes(String.fromCharCode(e))},r.ByteStringBuffer.prototype.fillWithByte=function(e,t){e=String.fromCharCode(e);var n=this.data;while(t>0)t&1&&(n+=e),t>>>=1,t>0&&(e+=e);return this.data=n,this._optimizeConstructedString(t),this},r.ByteStringBuffer.prototype.putBytes=function(e){return this.data+=e,this._optimizeConstructedString(e.length),this},r.ByteStringBuffer.prototype.putString=function(e){return this.putBytes(r.encodeUtf8(e))},r.ByteStringBuffer.prototype.putInt16=function(e){return this.putBytes(String.fromCharCode(e>>8&255)+String.fromCharCode(e&255))},r.ByteStringBuffer.prototype.putInt24=function(e){return this.putBytes(String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e&255))},r.ByteStringBuffer.prototype.putInt32=function(e){return this.putBytes(String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e&255))},r.ByteStringBuffer.prototype.putInt16Le=function(e){return this.putBytes(String.fromCharCode(e&255)+String.fromCharCode(e>>8&255))},r.ByteStringBuffer.prototype.putInt24Le=function(e){return this.putBytes(String.fromCharCode(e&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255))},r.ByteStringBuffer.prototype.putInt32Le=function(e){return this.putBytes(String.fromCharCode(e&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>24&255))},r.ByteStringBuffer.prototype.putInt=function(e,t){var n="";do t-=8,n+=String.fromCharCode(e>>t&255);while(t>0);return this.putBytes(n)},r.ByteStringBuffer.prototype.putSignedInt=function(e,t){return e<0&&(e+=2<<t-1),this.putInt(e,t)},r.ByteStringBuffer.prototype.putBuffer=function(e){return this.putBytes(e.getBytes())},r.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)},r.ByteStringBuffer.prototype.getInt16=function(){var e=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,e},r.ByteStringBuffer.prototype.getInt24=function(){var e=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,e},r.ByteStringBuffer.prototype.getInt32=function(){var e=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,e},r.ByteStringBuffer.prototype.getInt16Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,e},r.ByteStringBuffer.prototype.getInt24Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,e},r.ByteStringBuffer.prototype.getInt32Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,e},r.ByteStringBuffer.prototype.getInt=function(e){var t=0;do t=(t<<8)+this.data.charCodeAt(this.read++),e-=8;while(e>0);return t},r.ByteStringBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),n=2<<e-2;return t>=n&&(t-=n<<1),t},r.ByteStringBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):e===0?t="":(t=this.read===0?this.data:this.data.slice(this.read),this.clear()),t},r.ByteStringBuffer.prototype.bytes=function(e){return typeof e=="undefined"?this.data.slice(this.read):this.data.slice(this.read,this.read+e)},r.ByteStringBuffer.prototype.at=function(e){return this.data.charCodeAt(this.read+e)},r.ByteStringBuffer.prototype.setAt=function(e,t){return this.data=this.data.substr(0,this.read+e)+String.fromCharCode(t)+this.data.substr(this.read+e+1),this},r.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)},r.ByteStringBuffer.prototype.copy=function(){var e=r.createBuffer(this.data);return e.read=this.read,e},r.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this},r.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this},r.ByteStringBuffer.prototype.truncate=function(e){var t=Math.max(0,this.length()-e);return this.data=this.data.substr(this.read,t),this.read=0,this},r.ByteStringBuffer.prototype.toHex=function(){var e="";for(var t=this.read;t<this.data.length;++t){var n=this.data.charCodeAt(t);n<16&&(e+="0"),e+=n.toString(16)}return e},r.ByteStringBuffer.prototype.toString=function(){return r.decodeUtf8(this.bytes())},r.DataBuffer=n,r.DataBuffer.prototype.length=function(){return this.write-this.read},r.DataBuffer.prototype.isEmpty=function(){return this.length()<=0},r.DataBuffer.prototype.accommodate=function(e,t){if(this.length()>=e)return this;t=Math.max(t||this.growSize,e);var n=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),r=new Uint8Array(this.length()+t);return r.set(n),this.data=new DataView(r.buffer),this},r.DataBuffer.prototype.putByte=function(e){return this.accommodate(1),this.data.setUint8(this.write++,e),this},r.DataBuffer.prototype.fillWithByte=function(e,t){this.accommodate(t);for(var n=0;n<t;++n)this.data.setUint8(e);return this},r.DataBuffer.prototype.putBytes=function(e,t){if(r.isArrayBufferView(e)){var n=new Uint8Array(e.buffer,e.byteOffset,e.byteLength),i=n.byteLength-n.byteOffset;this.accommodate(i);var s=new Uint8Array(this.data.buffer,this.write);return s.set(n),this.write+=i,this}if(r.isArrayBuffer(e)){var n=new Uint8Array(e);this.accommodate(n.byteLength);var s=new Uint8Array(this.data.buffer);return s.set(n,this.write),this.write+=n.byteLength,this}if(e instanceof r.DataBuffer||typeof e=="object"&&typeof e.read=="number"&&typeof e.write=="number"&&r.isArrayBufferView(e.data)){var n=new Uint8Array(e.data.byteLength,e.read,e.length());this.accommodate(n.byteLength);var s=new Uint8Array(e.data.byteLength,this.write);return s.set(n),this.write+=n.byteLength,this}e instanceof r.ByteStringBuffer&&(e=e.data,t="binary"),t=t||"binary";if(typeof e=="string"){var o;if(t==="hex")return this.accommodate(Math.ceil(e.length/2)),o=new Uint8Array(this.data.buffer,this.write),this.write+=r.binary.hex.decode(e,o,this.write),this;if(t==="base64")return this.accommodate(Math.ceil(e.length/4)*3),o=new Uint8Array(this.data.buffer,this.write),this.write+=r.binary.base64.decode(e,o,this.write),this;t==="utf8"&&(e=r.encodeUtf8(e),t="binary");if(t==="binary"||t==="raw")return this.accommodate(e.length),o=new Uint8Array(this.data.buffer,this.write),this.write+=r.binary.raw.decode(o),this;if(t==="utf16")return this.accommodate(e.length*2),o=new Uint16Array(this.data.buffer,this.write),this.write+=r.text.utf16.encode(o),this;throw new Error("Invalid encoding: "+t)}throw Error("Invalid parameter: "+e)},r.DataBuffer.prototype.putBuffer=function(e){return this.putBytes(e),e.clear(),this},r.DataBuffer.prototype.putString=function(e){return this.putBytes(e,"utf16")},r.DataBuffer.prototype.putInt16=function(e){return this.accommodate(2),this.data.setInt16(this.write,e),this.write+=2,this},r.DataBuffer.prototype.putInt24=function(e){return this.accommodate(3),this.data.setInt16(this.write,e>>8&65535),this.data.setInt8(this.write,e>>16&255),this.write+=3,this},r.DataBuffer.prototype.putInt32=function(e){return this.accommodate(4),this.data.setInt32(this.write,e),this.write+=4,this},r.DataBuffer.prototype.putInt16Le=function(e){return this.accommodate(2),this.data.setInt16(this.write,e,!0),this.write+=2,this},r.DataBuffer.prototype.putInt24Le=function(e){return this.accommodate(3),this.data.setInt8(this.write,e>>16&255),this.data.setInt16(this.write,e>>8&65535,!0),this.write+=3,this},r.DataBuffer.prototype.putInt32Le=function(e){return this.accommodate(4),this.data.setInt32(this.write,e,!0),this.write+=4,this},r.DataBuffer.prototype.putInt=function(e,t){this.accommodate(t/8);do t-=8,this.data.setInt8(this.write++,e>>t&255);while(t>0);return this},r.DataBuffer.prototype.putSignedInt=function(e,t){return this.accommodate(t/8),e<0&&(e+=2<<t-1),this.putInt(e,t)},r.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)},r.DataBuffer.prototype.getInt16=function(){var e=this.data.getInt16(this.read);return this.read+=2,e},r.DataBuffer.prototype.getInt24=function(){var e=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,e},r.DataBuffer.prototype.getInt32=function(){var e=this.data.getInt32(this.read);return this.read+=4,e},r.DataBuffer.prototype.getInt16Le=function(){var e=this.data.getInt16(this.read,!0);return this.read+=2,e},r.DataBuffer.prototype.getInt24Le=function(){var e=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,e},r.DataBuffer.prototype.getInt32Le=function(){var e=this.data.getInt32(this.read,!0);return this.read+=4,e},r.DataBuffer.prototype.getInt=function(e){var t=0;do t=(t<<8)+this.data.getInt8(this.read++),e-=8;while(e>0);return t},r.DataBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),n=2<<e-2;return t>=n&&(t-=n<<1),t},r.DataBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):e===0?t="":(t=this.read===0?this.data:this.data.slice(this.read),this.clear()),t},r.DataBuffer.prototype.bytes=function(e){return typeof e=="undefined"?this.data.slice(this.read):this.data.slice(this.read,this.read+e)},r.DataBuffer.prototype.at=function(e){return this.data.getUint8(this.read+e)},r.DataBuffer.prototype.setAt=function(e,t){return this.data.setUint8(e,t),this},r.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)},r.DataBuffer.prototype.copy=function(){return new r.DataBuffer(this)},r.DataBuffer.prototype.compact=function(){if(this.read>0){var e=new Uint8Array(this.data.buffer,this.read),t=new Uint8Array(e.byteLength);t.set(e),this.data=new DataView(t),this.write-=this.read,this.read=0}return this},r.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this},r.DataBuffer.prototype.truncate=function(e){return this.write=Math.max(0,this.length()-e),this.read=Math.min(this.read,this.write),this},r.DataBuffer.prototype.toHex=function(){var e="";for(var t=this.read;t<this.data.byteLength;++t){var n=this.data.getUint8(t);n<16&&(e+="0"),e+=n.toString(16)}return e},r.DataBuffer.prototype.toString=function(e){var t=new Uint8Array(this.data,this.read,this.length());e=e||"utf8";if(e==="binary"||e==="raw")return r.binary.raw.encode(t);if(e==="hex")return r.binary.hex.encode(t);if(e==="base64")return r.binary.base64.encode(t);if(e==="utf8")return r.text.utf8.decode(t);if(e==="utf16")return r.text.utf16.decode(t);throw new Error("Invalid encoding: "+e)},r.createBuffer=function(e,t){return t=t||"raw",e!==undefined&&t==="utf8"&&(e=r.encodeUtf8(e)),new r.ByteBuffer(e)},r.fillString=function(e,t){var n="";while(t>0)t&1&&(n+=e),t>>>=1,t>0&&(e+=e);return n},r.xorBytes=function(e,t,n){var r="",i="",s="",o=0,u=0;for(;n>0;--n,++o)i=e.charCodeAt(o)^t.charCodeAt(o),u>=10&&(r+=s,s="",u=0),s+=String.fromCharCode(i),++u;return r+=s,r},r.hexToBytes=function(e){var t="",n=0;e.length&!0&&(n=1,t+=String.fromCharCode(parseInt(e[0],16)));for(;n<e.length;n+=2)t+=String.fromCharCode(parseInt(e.substr(n,2),16));return t},r.bytesToHex=function(e){return r.createBuffer(e).toHex()},r.int32ToBytes=function(e){return String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e&255)};var s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",o=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];r.encode64=function(e,t){var n="",r="",i,o,u,a=0;while(a<e.length)i=e.charCodeAt(a++),o=e.charCodeAt(a++),u=e.charCodeAt(a++),n+=s.charAt(i>>2),n+=s.charAt((i&3)<<4|o>>4),isNaN(o)?n+="==":(n+=s.charAt((o&15)<<2|u>>6),n+=isNaN(u)?"=":s.charAt(u&63)),t&&n.length>t&&(r+=n.substr(0,t)+"\r\n",n=n.substr(t));return r+=n,r},r.decode64=function(e){e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");var t="",n,r,i,s,u=0;while(u<e.length)n=o[e.charCodeAt(u++)-43],r=o[e.charCodeAt(u++)-43],i=o[e.charCodeAt(u++)-43],s=o[e.charCodeAt(u++)-43],t+=String.fromCharCode(n<<2|r>>4),i!==64&&(t+=String.fromCharCode((r&15)<<4|i>>2),s!==64&&(t+=String.fromCharCode((i&3)<<6|s)));return t},r.encodeUtf8=function(e){return unescape(encodeURIComponent(e))},r.decodeUtf8=function(e){return decodeURIComponent(escape(e))},r.binary={raw:{},hex:{},base64:{}},r.binary.raw.encode=function(e){return String.fromCharCode.apply(null,e)},r.binary.raw.decode=function(e,t,n){var r=t;r||(r=new Uint8Array(e.length)),n=n||0;var i=n;for(var s=0;s<e.length;++s)r[i++]=e.charCodeAt(s);return t?i-n:r},r.binary.hex.encode=r.bytesToHex,r.binary.hex.decode=function(e,t,n){var r=t;r||(r=new Uint8Array(Math.ceil(e.length/2))),n=n||0;var i=0,s=n;e.length&1&&(i=1,r[s++]=parseInt(e[0],16));for(;i<e.length;i+=2)r[s++]=parseInt(e.substr(i,2),16);return t?s-n:r},r.binary.base64.encode=function(e,t){var n="",r="",i,o,u,a=0;while(a<e.byteLength)i=e[a++],o=e[a++],u=e[a++],n+=s.charAt(i>>2),n+=s.charAt((i&3)<<4|o>>4),isNaN(o)?n+="==":(n+=s.charAt((o&15)<<2|u>>6),n+=isNaN(u)?"=":s.charAt(u&63)),t&&n.length>t&&(r+=n.substr(0,t)+"\r\n",n=n.substr(t));return r+=n,r},r.binary.base64.decode=function(e,t,n){var r=t;r||(r=new Uint8Array(Math.ceil(e.length/4)*3)),e=e.replace(/[^A-Za-z0-9\+\/\=]/g,""),n=n||0;var i,s,u,a,f=0,l=n;while(f<e.length)i=o[e.charCodeAt(f++)-43],s=o[e.charCodeAt(f++)-43],u=o[e.charCodeAt(f++)-43],a=o[e.charCodeAt(f++)-43],r[l++]=i<<2|s>>4,u!==64&&(r[l++]=(s&15)<<4|u>>2,a!==64&&(r[l++]=(u&3)<<6|a));return t?l-n:r.subarray(0,l)},r.text={utf8:{},utf16:{}},r.text.utf8.encode=function(e,t,n){e=r.encodeUtf8(e);var i=t;i||(i=new Uint8Array(e.length)),n=n||0;var s=n;for(var o=0;o<e.length;++o)i[s++]=e.charCodeAt(o);return t?s-n:i},r.text.utf8.decode=function(e){return r.decodeUtf8(String.fromCharCode.apply(null,e))},r.text.utf16.encode=function(e,t,n){var r=t;r||(r=new Uint8Array(e.length));var i=new Uint16Array(r);n=n||0;var s=n,o=n;for(var u=0;u<e.length;++u)i[o++]=e.charCodeAt(u),s+=2;return t?s-n:r},r.text.utf16.decode=function(e){return String.fromCharCode.apply(null,new Uint16Array(e))},r.deflate=function(e,t,n){t=r.decode64(e.deflate(r.encode64(t)).rval);if(n){var i=2,s=t.charCodeAt(1);s&32&&(i=6),t=t.substring(i,t.length-4)}return t},r.inflate=function(e,t,n){var i=e.inflate(r.encode64(t)).rval;return i===null?null:r.decode64(i)};var u=function(e,t,n){if(!e)throw new Error("WebStorage not available.");var i;n===null?i=e.removeItem(t):(n=r.encode64(JSON.stringify(n)),i=e.setItem(t,n));if(typeof i!="undefined"&&i.rval!==!0){var s=new Error(i.error.message);throw s.id=i.error.id,s.name=i.error.name,s}},a=function(e,t){if(!e)throw new Error("WebStorage not available.");var n=e.getItem(t);if(e.init)if(n.rval===null){if(n.error){var i=new Error(n.error.message);throw i.id=n.error.id,i.name=n.error.name,i}n=null}else n=n.rval;return n!==null&&(n=JSON.parse(r.decode64(n))),n},f=function(e,t,n,r){var i=a(e,t);i===null&&(i={}),i[n]=r,u(e,t,i)},l=function(e,t,n){var r=a(e,t);return r!==null&&(r=n in r?r[n]:null),r},c=function(e,t,n){var r=a(e,t);if(r!==null&&n in r){delete r[n];var i=!0;for(var s in r){i=!1;break}i&&(r=null),u(e,t,r)}},h=function(e,t){u(e,t,null)},p=function(e,t,n){var r=null;typeof n=="undefined"&&(n=["web","flash"]);var i,s=!1,o=null;for(var u in n){i=n[u];try{if(i==="flash"||i==="both"){if(t[0]===null)throw new Error("Flash local storage not available.");r=e.apply(this,t),s=i==="flash"}if(i==="web"||i==="both")t[0]=localStorage,r=e.apply(this,t),s=!0}catch(a){o=a}if(s)break}if(!s)throw o;return r};r.setItem=function(e,t,n,r,i){p(f,arguments,i)},r.getItem=function(e,t,n,r){return p(l,arguments,r)},r.removeItem=function(e,t,n,r){p(c,arguments,r)},r.clearItems=function(e,t,n){p(h,arguments,n)},r.parseUrl=function(e){var t=/^(https?):\/\/([^:&^\/]*):?(\d*)(.*)$/g;t.lastIndex=0;var n=t.exec(e),r=n===null?null:{full:e,scheme:n[1],host:n[2],port:n[3],path:n[4]};return r&&(r.fullHost=r.host,r.port?r.port!==80&&r.scheme==="http"?r.fullHost+=":"+r.port:r.port!==443&&r.scheme==="https"&&(r.fullHost+=":"+r.port):r.scheme==="http"?r.port=80:r.scheme==="https"&&(r.port=443),r.full=r.scheme+"://"+r.fullHost),r};var d=null;r.getQueryVariables=function(e){var t=function(e){var t={},n=e.split("&");for(var r=0;r<n.length;r++){var i=n[r].indexOf("="),s,o;i>0?(s=n[r].substring(0,i),o=n[r].substring(i+1)):(s=n[r],o=null),s in t||(t[s]=[]),!(s in Object.prototype)&&o!==null&&t[s].push(unescape(o))}return t},n;return typeof e=="undefined"?(d===null&&(typeof window!="undefined"&&window.location&&window.location.search?d=t(window.location.search.substring(1)):d={}),n=d):n=t(e),n},r.parseFragment=function(e){var t=e,n="",i=e.indexOf("?");i>0&&(t=e.substring(0,i),n=e.substring(i+1));var s=t.split("/");s.length>0&&s[0]===""&&s.shift();var o=n===""?{}:r.getQueryVariables(n);return{pathString:t,queryString:n,path:s,query:o}},r.makeRequest=function(e){var t=r.parseFragment(e),n={path:t.pathString,query:t.queryString,getPath:function(e){return typeof e=="undefined"?t.path:t.path[e]},getQuery:function(e,n){var r;return typeof e=="undefined"?r=t.query:(r=t.query[e],r&&typeof n!="undefined"&&(r=r[n])),r},getQueryLast:function(e,t){var r,i=n.getQuery(e);return i?r=i[i.length-1]:r=t,r}};return n},r.makeLink=function(e,t,n){e=jQuery.isArray(e)?e.join("/"):e;var r=jQuery.param(t||{});return n=n||"",e+(r.length>0?"?"+r:"")+(n.length>0?"#"+n:"")},r.setPath=function(e,t,n){if(typeof e=="object"&&e!==null){var r=0,i=t.length;while(r<i){var s=t[r++];if(r==i)e[s]=n;else{var o=s in e;if(!o||o&&typeof e[s]!="object"||o&&e[s]===null)e[s]={};e=e[s]}}}},r.getPath=function(e,t,n){var r=0,i=t.length,s=!0;while(s&&r<i&&typeof e=="object"&&e!==null){var o=t[r++];s=o in e,s&&(e=e[o])}return s?e:n},r.deletePath=function(e,t){if(typeof e=="object"&&e!==null){var n=0,r=t.length;while(n<r){var i=t[n++];if(n==r)delete e[i];else{if(!(i in e&&typeof e[i]=="object"&&e[i]!==null))break;e=e[i]}}}},r.isEmpty=function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},r.format=function(e){var t=/%./g,n,r,i=0,s=[],o=0;while(n=t.exec(e)){r=e.substring(o,t.lastIndex-2),r.length>0&&s.push(r),o=t.lastIndex;var u=n[0][1];switch(u){case"s":case"o":i<arguments.length?s.push(arguments[i++ +1]):s.push("<?>");break;case"%":s.push("%");break;default:s.push("<%"+u+"?>")}}return s.push(e.substring(o)),s.join("")},r.formatNumber=function(e,t,n,r){var i=e,s=isNaN(t=Math.abs(t))?2:t,o=n===undefined?",":n,u=r===undefined?".":r,a=i<0?"-":"",f=parseInt(i=Math.abs(+i||0).toFixed(s),10)+"",l=f.length>3?f.length%3:0;return a+(l?f.substr(0,l)+u:"")+f.substr(l).replace(/(\d{3})(?=\d)/g,"$1"+u)+(s?o+Math.abs(i-f).toFixed(s).slice(2):"")},r.formatSize=function(e){return e>=1073741824?e=r.formatNumber(e/1073741824,2,".","")+" GiB":e>=1048576?e=r.formatNumber(e/1048576,2,".","")+" MiB":e>=1024?e=r.formatNumber(e/1024,0)+" KiB":e=r.formatNumber(e,0)+" bytes",e},r.bytesFromIP=function(e){return e.indexOf(".")!==-1?r.bytesFromIPv4(e):e.indexOf(":")!==-1?r.bytesFromIPv6(e):null},r.bytesFromIPv4=function(e){e=e.split(".");if(e.length!==4)return null;var t=r.createBuffer();for(var n=0;n<e.length;++n){var i=parseInt(e[n],10);if(isNaN(i))return null;t.putByte(i)}return t.getBytes()},r.bytesFromIPv6=function(e){var t=0;e=e.split(":").filter(function(e){return e.length===0&&++t,!0});var n=(8-e.length+t)*2,i=r.createBuffer();for(var s=0;s<8;++s){if(!e[s]||e[s].length===0){i.fillWithByte(0,n),n=0;continue}var o=r.hexToBytes(e[s]);o.length<2&&i.putByte(0),i.putBytes(o)}return i.getBytes()},r.bytesToIP=function(e){return e.length===4?r.bytesToIPv4(e):e.length===16?r.bytesToIPv6(e):null},r.bytesToIPv4=function(e){if(e.length!==4)return null;var t=[];for(var n=0;n<e.length;++n)t.push(e.charCodeAt(n));return t.join(".")},r.bytesToIPv6=function(e){if(e.length!==16)return null;var t=[],n=[],i=0;for(var s=0;s<e.length;s+=2){var o=r.bytesToHex(e[s]+e[s+1]);while(o[0]==="0"&&o!=="0")o=o.substr(1);if(o==="0"){var u=n[n.length-1],a=t.length;!u||a!==u.end+1?n.push({start:a,end:a}):(u.end=a,u.end-u.start>n[i].end-n[i].start&&(i=n.length-1))}t.push(o)}if(n.length>0){var f=n[i];f.end-f.start>0&&(t.splice(f.start,f.end-f.start+1,""),f.start===0&&t.unshift(""),f.end===7&&t.push(""))}return t.join(":")},r.estimateCores=function(e,t){function n(e,u,a){if(u===0){var f=Math.floor(e.reduce(function(e,t){return e+t},0)/e.length);return r.cores=Math.max(1,f),URL.revokeObjectURL(o),t(null,r.cores)}i(a,function(t,r){e.push(s(a,r)),n(e,u-1,a)})}function i(e,t){var n=[],r=[];for(var i=0;i<e;++i){var s=new Worker(o);s.addEventListener("message",function(i){r.push(i.data);if(r.length===e){for(var s=0;s<e;++s)n[s].terminate();t(null,r)}}),n.push(s)}for(var i=0;i<e;++i)n[i].postMessage(i)}function s(e,t){var n=[];for(var r=0;r<e;++r){var i=t[r],s=n[r]=[];for(var o=0;o<e;++o){if(r===o)continue;var u=t[o];(i.st>u.st&&i.st<u.et||u.st>i.st&&u.st<i.et)&&s.push(o)}}return n.reduce(function(e,t){return Math.max(e,t.length)},0)}typeof e=="function"&&(t=e,e={}),e=e||{};if("cores"in r&&!e.update)return t(null,r.cores);if(typeof navigator!="undefined"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return r.cores=navigator.hardwareConcurrency,t(null,r.cores);if(typeof Worker=="undefined")return r.cores=1,t(null,r.cores);if(typeof Blob=="undefined")return r.cores=2,t(null,r.cores);var o=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(e){var t=Date.now(),n=t+4;while(Date.now()<n);self.postMessage({st:t,et:n})})}.toString(),")()"],{type:"application/javascript"}));n([],5,16)}}var r="util";if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),e(forge);var i=!0;n=function(e,n){n(t,module)}}var s,o=function(t,n){n.exports=function(n){var i=s.map(function(e){return t(e)}).concat(e);n=n||{},n.defined=n.defined||{};if(n.defined[r])return n[r];n.defined[r]=!0;for(var o=0;o<i.length;++o)i[o](n);return n[r]}},u=n;n=function(e,t){return s=typeof e=="string"?t.slice(2):e.slice(2),i?(delete n,u.apply(null,Array.prototype.slice.call(arguments,0))):(n=u,n.apply(null,Array.prototype.slice.call(arguments,0)))},n("js/util",["require","module"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){e.cipher=e.cipher||{},e.cipher.algorithms=e.cipher.algorithms||{},e.cipher.createCipher=function(t,n){var r=t;typeof r=="string"&&(r=e.cipher.getAlgorithm(r),r&&(r=r()));if(!r)throw new Error("Unsupported algorithm: "+t);return new e.cipher.BlockCipher({algorithm:r,key:n,decrypt:!1})},e.cipher.createDecipher=function(t,n){var r=t;typeof r=="string"&&(r=e.cipher.getAlgorithm(r),r&&(r=r()));if(!r)throw new Error("Unsupported algorithm: "+t);return new e.cipher.BlockCipher({algorithm:r,key:n,decrypt:!0})},e.cipher.registerAlgorithm=function(t,n){t=t.toUpperCase(),e.cipher.algorithms[t]=n},e.cipher.getAlgorithm=function(t){return t=t.toUpperCase(),t in e.cipher.algorithms?e.cipher.algorithms[t]:null};var t=e.cipher.BlockCipher=function(e){this.algorithm=e.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=e.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=e.decrypt,this.algorithm.initialize(e)};t.prototype.start=function(t){t=t||{};var n={};for(var r in t)n[r]=t[r];n.decrypt=this._decrypt,this._finish=!1,this._input=e.util.createBuffer(),this.output=t.output||e.util.createBuffer(),this.mode.start(n)},t.prototype.update=function(e){e&&this._input.putBuffer(e);while(!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish);this._input.compact()},t.prototype.finish=function(e){e&&this.mode.name==="CBC"&&(this.mode.pad=function(t){return e(this.blockSize,t,!1)},this.mode.unpad=function(t){return e(this.blockSize,t,!0)});var t={};return t.decrypt=this._decrypt,t.overflow=this._input.length()%this.blockSize,!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,t)?!1:(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,t)?!1:this.mode.afterFinish&&!this.mode.afterFinish(this.output,t)?!1:!0)}}var r="cipher";if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),e(forge);var i=!0;n=function(e,n){n(t,module)}}var s,o=function(t,n){n.exports=function(n){var i=s.map(function(e){return t(e)}).concat(e);n=n||{},n.defined=n.defined||{};if(n.defined[r])return n[r];n.defined[r]=!0;for(var o=0;o<i.length;++o)i[o](n);return n[r]}},u=n;n=function(e,t){return s=typeof e=="string"?t.slice(2):e.slice(2),i?(delete n,u.apply(null,Array.prototype.slice.call(arguments,0))):(n=u,n.apply(null,Array.prototype.slice.call(arguments,0)))},n("js/cipher",["require","module","./util"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){function t(t){typeof t=="string"&&(t=e.util.createBuffer(t));if(e.util.isArray(t)&&t.length>4){var n=t;t=e.util.createBuffer();for(var r=0;r<n.length;++r)t.putByte(n[r])}return e.util.isArray(t)||(t=[t.getInt32(),t.getInt32(),t.getInt32(),t.getInt32()]),t}function n(e){e[e.length-1]=e[e.length-1]+1&4294967295}function r(e){return[e/4294967296|0,e&4294967295]}e.cipher=e.cipher||{};var i=e.cipher.modes=e.cipher.modes||{};i.ecb=function(e){e=e||{},this.name="ECB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},i.ecb.prototype.start=function(e){},i.ecb.prototype.encrypt=function(e,t,n){if(e.length()<this.blockSize&&!(n&&e.length()>0))return!0;for(var r=0;r<this._ints;++r)this._inBlock[r]=e.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var r=0;r<this._ints;++r)t.putInt32(this._outBlock[r])},i.ecb.prototype.decrypt=function(e,t,n){if(e.length()<this.blockSize&&!(n&&e.length()>0))return!0;for(var r=0;r<this._ints;++r)this._inBlock[r]=e.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var r=0;r<this._ints;++r)t.putInt32(this._outBlock[r])},i.ecb.prototype.pad=function(e,t){var n=e.length()===this.blockSize?this.blockSize:this.blockSize-e.length();return e.fillWithByte(n,n),!0},i.ecb.prototype.unpad=function(e,t){if(t.overflow>0)return!1;var n=e.length(),r=e.at(n-1);return r>this.blockSize<<2?!1:(e.truncate(r),!0)},i.cbc=function(e){e=e||{},this.name="CBC",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},i.cbc.prototype.start=function(e){if(e.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else{if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=t(e.iv),this._prev=this._iv.slice(0)}},i.cbc.prototype.encrypt=function(e,t,n){if(e.length()<this.blockSize&&!(n&&e.length()>0))return!0;for(var r=0;r<this._ints;++r)this._inBlock[r]=this._prev[r]^e.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var r=0;r<this._ints;++r)t.putInt32(this._outBlock[r]);this._prev=this._outBlock},i.cbc.prototype.decrypt=function(e,t,n){if(e.length()<this.blockSize&&!(n&&e.length()>0))return!0;for(var r=0;r<this._ints;++r)this._inBlock[r]=e.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var r=0;r<this._ints;++r)t.putInt32(this._prev[r]^this._outBlock[r]);this._prev=this._inBlock.slice(0)},i.cbc.prototype.pad=function(e,t){var n=e.length()===this.blockSize?this.blockSize:this.blockSize-e.length();return e.fillWithByte(n,n),!0},i.cbc.prototype.unpad=function(e,t){if(t.overflow>0)return!1;var n=e.length(),r=e.at(n-1);return r>this.blockSize<<2?!1:(e.truncate(r),!0)},i.cfb=function(t){t=t||{},this.name="CFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=e.util.createBuffer(),this._partialBytes=0},i.cfb.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=t(e.iv),this._inBlock=this._iv.slice(0),this._partialBytes=0},i.cfb.prototype.encrypt=function(e,t,n){var r=e.length();if(r===0)return!0;this.cipher.encrypt(this._inBlock,this._outBlock);if(this._partialBytes===0&&r>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=e.getInt32()^this._outBlock[i],t.putInt32(this._inBlock[i]);return}var s=(this.blockSize-r)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=e.getInt32()^this._outBlock[i],this._partialOutput.putInt32(this._partialBlock[i]);if(s>0)e.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes);if(s>0&&!n)return t.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;t.putBytes(this._partialOutput.getBytes(r-this._partialBytes)),this._partialBytes=0},i.cfb.prototype.decrypt=function(e,t,n){var r=e.length();if(r===0)return!0;this.cipher.encrypt(this._inBlock,this._outBlock);if(this._partialBytes===0&&r>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=e.getInt32(),t.putInt32(this._inBlock[i]^this._outBlock[i]);return}var s=(this.blockSize-r)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=e.getInt32(),this._partialOutput.putInt32(this._partialBlock[i]^this._outBlock[i]);if(s>0)e.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes);if(s>0&&!n)return t.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;t.putBytes(this._partialOutput.getBytes(r-this._partialBytes)),this._partialBytes=0},i.ofb=function(t){t=t||{},this.name="OFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=e.util.createBuffer(),this._partialBytes=0},i.ofb.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=t(e.iv),this._inBlock=this._iv.slice(0),this._partialBytes=0},i.ofb.prototype.encrypt=function(e,t,n){var r=e.length();if(e.length()===0)return!0;this.cipher.encrypt(this._inBlock,this._outBlock);if(this._partialBytes===0&&r>=this.blockSize){for(var i=0;i<this._ints;++i)t.putInt32(e.getInt32()^this._outBlock[i]),this._inBlock[i]=this._outBlock[i];return}var s=(this.blockSize-r)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(s>0)e.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._outBlock[i];this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes);if(s>0&&!n)return t.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;t.putBytes(this._partialOutput.getBytes(r-this._partialBytes)),this._partialBytes=0},i.ofb.prototype.decrypt=i.ofb.prototype.encrypt,i.ctr=function(t){t=t||{},this.name="CTR",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=e.util.createBuffer(),this._partialBytes=0},i.ctr.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=t(e.iv),this._inBlock=this._iv.slice(0),this._partialBytes=0},i.ctr.prototype.encrypt=function(e,t,r){var i=e.length();if(i===0)return!0;this.cipher.encrypt(this._inBlock,this._outBlock);if(this._partialBytes===0&&i>=this.blockSize)for(var s=0;s<this._ints;++s)t.putInt32(e.getInt32()^this._outBlock[s]);else{var o=(this.blockSize-i)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(var s=0;s<this._ints;++s)this._partialOutput.putInt32(e.getInt32()^this._outBlock[s]);o>0&&(e.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes);if(o>0&&!r)return t.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;t.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=0}n(this._inBlock)},i.ctr.prototype.decrypt=i.ctr.prototype.encrypt,i.gcm=function(t){t=t||{},this.name="GCM",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=e.util.createBuffer(),this._partialBytes=0,this._R=3774873600},i.gcm.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");var i=e.util.createBuffer(t.iv);this._cipherLength=0;var s;"additionalData"in t?s=e.util.createBuffer(t.additionalData):s=e.util.createBuffer(),"tagLength"in t?this._tagLength=t.tagLength:this._tagLength=128,this._tag=null;if(t.decrypt){this._tag=e.util.createBuffer(t.tag).getBytes();if(this._tag.length!==this._tagLength/8)throw new Error("Authentication tag does not match tag length.")}this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var o=i.length();if(o===12)this._j0=[i.getInt32(),i.getInt32(),i.getInt32(),1];else{this._j0=[0,0,0,0];while(i.length()>0)this._j0=this.ghash(this._hashSubkey,this._j0,[i.getInt32(),i.getInt32(),i.getInt32(),i.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(r(o*8)))}this._inBlock=this._j0.slice(0),n(this._inBlock),this._partialBytes=0,s=e.util.createBuffer(s),this._aDataLength=r(s.length()*8);var u=s.length()%this.blockSize;u&&s.fillWithByte(0,this.blockSize-u),this._s=[0,0,0,0];while(s.length()>0)this._s=this.ghash(this._hashSubkey,this._s,[s.getInt32(),s.getInt32(),s.getInt32(),s.getInt32()])},i.gcm.prototype.encrypt=function(e,t,r){var i=e.length();if(i===0)return!0;this.cipher.encrypt(this._inBlock,this._outBlock);if(this._partialBytes===0&&i>=this.blockSize){for(var s=0;s<this._ints;++s)t.putInt32(this._outBlock[s]^=e.getInt32());this._cipherLength+=this.blockSize}else{var o=(this.blockSize-i)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(var s=0;s<this._ints;++s)this._partialOutput.putInt32(e.getInt32()^this._outBlock[s]);if(o===0||r){if(r){var u=i%this.blockSize;this._cipherLength+=u,this._partialOutput.truncate(this.blockSize-u)}else this._cipherLength+=this.blockSize;for(var s=0;s<this._ints;++s)this._outBlock[s]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes);if(o>0&&!r)return e.read-=this.blockSize,t.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;t.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),n(this._inBlock)},i.gcm.prototype.decrypt=function(e,t,r){var i=e.length();if(i<this.blockSize&&!(r&&i>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),n(this._inBlock),this._hashBlock[0]=e.getInt32(),this._hashBlock[1]=e.getInt32(),this._hashBlock[2]=e.getInt32(),this._hashBlock[3]=e.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var s=0;s<this._ints;++s)t.putInt32(this._outBlock[s]^this._hashBlock[s]);i<this.blockSize?this._cipherLength+=i%this.blockSize:this._cipherLength+=this.blockSize},i.gcm.prototype.afterFinish=function(t,n){var i=!0;n.decrypt&&n.overflow&&t.truncate(this.blockSize-n.overflow),this.tag=e.util.createBuffer();var s=this._aDataLength.concat(r(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,s);var o=[];this.cipher.encrypt(this._j0,o);for(var u=0;u<this._ints;++u)this.tag.putInt32(this._s[u]^o[u]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),n.decrypt&&this.tag.bytes()!==this._tag&&(i=!1),i},i.gcm.prototype.multiply=function(e,t){var n=[0,0,0,0],r=t.slice(0);for(var i=0;i<128;++i){var s=e[i/32|0]&1<<31-i%32;s&&(n[0]^=r[0],n[1]^=r[1],n[2]^=r[2],n[3]^=r[3]),this.pow(r,r)}return n},i.gcm.prototype.pow=function(e,t){var n=e[3]&1;for(var r=3;r>0;--r)t[r]=e[r]>>>1|(e[r-1]&1)<<31;t[0]=e[0]>>>1,n&&(t[0]^=this._R)},i.gcm.prototype.tableMultiply=function(e){var t=[0,0,0,0];for(var n=0;n<32;++n){var r=n/8|0,i=e[r]>>>(7-n%8)*4&15,s=this._m[n][i];t[0]^=s[0],t[1]^=s[1],t[2]^=s[2],t[3]^=s[3]}return t},i.gcm.prototype.ghash=function(e,t,n){return t[0]^=n[0],t[1]^=n[1],t[2]^=n[2],t[3]^=n[3],this.tableMultiply(t)},i.gcm.prototype.generateHashTable=function(e,t){var n=8/t,r=4*n,i=16*n,s=new Array(i);for(var o=0;o<i;++o){var u=[0,0,0,0],a=o/r|0,f=(r-1-o%r)*t;u[a]=1<<t-1<<f,s[o]=this.generateSubHashTable(this.multiply(u,e),t)}return s},i.gcm.prototype.generateSubHashTable=function(e,t){var n=1<<t,r=n>>>1,i=new Array(n);i[r]=e.slice(0);var s=r>>>1;while(s>0)this.pow(i[2*s],i[s]=[]),s>>=1;s=2;while(s<r){for(var o=1;o<s;++o){var u=i[s],a=i[o];i[s+o]=[u[0]^a[0],u[1]^a[1],u[2]^a[2],u[3]^a[3]]}s*=2}i[0]=[0,0,0,0];for(s=r+1;s<n;++s){var f=i[s^r];i[s]=[e[0]^f[0],e[1]^f[1],e[2]^f[2],e[3]^f[3]]}return i}}var r="cipherModes";if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),e(forge);var i=!0;n=function(e,n){n(t,module)}}var s,o=function(t,n){n.exports=function(n){var i=s.map(function(e){return t(e)}).concat(e);n=n||{},n.defined=n.defined||{};if(n.defined[r])return n[r];n.defined[r]=!0;for(var o=0;o<i.length;++o)i[o](n);return n[r]}},u=n;n=function(e,t){return s=typeof e=="string"?t.slice(2):e.slice(2),i?(delete n,u.apply(null,Array.prototype.slice.call(arguments,0))):(n=u,n.apply(null,Array.prototype.slice.call(arguments,0)))},n("js/cipherModes",["require","module","./util"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){function t(t,n){var r=function(){return new e.aes.Algorithm(t,n)};e.cipher.registerAlgorithm(t,r)}function n(){o=!0,l=[0,1,2,4,8,16,32,64,128,27,54];var e=new Array(256);for(var t=0;t<128;++t)e[t]=t<<1,e[t+128]=t+128<<1^283;a=new Array(256),f=new Array(256),c=new Array(4),h=new Array(4);for(var t=0;t<4;++t)c[t]=new Array(256),h[t]=new Array(256);var n=0,r=0,i,s,u,p,d,v,m;for(var t=0;t<256;++t){p=r^r<<1^r<<2^r<<3^r<<4,p=p>>8^p&255^99,a[n]=p,f[p]=n,d=e[p],i=e[n],s=e[i],u=e[s],v=d<<24^p<<16^p<<8^(p^d),m=(i^s^u)<<24^(n^u)<<16^(n^s^u)<<8^(n^i^u);for(var g=0;g<4;++g)c[g][n]=v,h[g][p]=m,v=v<<24|v>>>8,m=m<<24|m>>>8;n===0?n=r=1:(n=i^e[e[e[i^u]]],r^=e[e[r]])}}function r(e,t){var n=e.slice(0),r,i=1,s=n.length,o=s+6+1,f=u*o;for(var c=s;c<f;++c)r=n[c-1],c%s===0?(r=a[r>>>16&255]<<24^a[r>>>8&255]<<16^a[r&255]<<8^a[r>>>24]^l[i]<<24,i++):s>6&&c%s===4&&(r=a[r>>>24]<<24^a[r>>>16&255]<<16^a[r>>>8&255]<<8^a[r&255]),n[c]=n[c-s]^r;if(t){var p,d=h[0],v=h[1],m=h[2],g=h[3],y=n.slice(0);f=n.length;for(var c=0,b=f-u;c<f;c+=u,b-=u)if(c===0||c===f-u)y[c]=n[b],y[c+1]=n[b+3],y[c+2]=n[b+2],y[c+3]=n[b+1];else for(var w=0;w<u;++w)p=n[b+w],y[c+(3&-w)]=d[a[p>>>24]]^v[a[p>>>16&255]]^m[a[p>>>8&255]]^g[a[p&255]];n=y}return n}function i(e,t,n,r){var i=e.length/4-1,s,o,u,l,p;r?(s=h[0],o=h[1],u=h[2],l=h[3],p=f):(s=c[0],o=c[1],u=c[2],l=c[3],p=a);var d,v,m,g,y,b,w;d=t[0]^e[0],v=t[r?3:1]^e[1],m=t[2]^e[2],g=t[r?1:3]^e[3];var E=3;for(var S=1;S<i;++S)y=s[d>>>24]^o[v>>>16&255]^u[m>>>8&255]^l[g&255]^e[++E],b=s[v>>>24]^o[m>>>16&255]^u[g>>>8&255]^l[d&255]^e[++E],w=s[m>>>24]^o[g>>>16&255]^u[d>>>8&255]^l[v&255]^e[++E],g=s[g>>>24]^o[d>>>16&255]^u[v>>>8&255]^l[m&255]^e[++E],d=y,v=b,m=w;n[0]=p[d>>>24]<<24^p[v>>>16&255]<<16^p[m>>>8&255]<<8^p[g&255]^e[++E],n[r?3:1]=p[v>>>24]<<24^p[m>>>16&255]<<16^p[g>>>8&255]<<8^p[d&255]^e[++E],n[2]=p[m>>>24]<<24^p[g>>>16&255]<<16^p[d>>>8&255]<<8^p[v&255]^e[++E],n[r?1:3]=p[g>>>24]<<24^p[d>>>16&255]<<16^p[v>>>8&255]<<8^p[m&255]^e[++E]}function s(t){t=t||{};var n=(t.mode||"CBC").toUpperCase(),r="AES-"+n,i;t.decrypt?i=e.cipher.createDecipher(r,t.key):i=e.cipher.createCipher(r,t.key);var s=i.start;return i.start=function(t,n){var r=null;n instanceof e.util.ByteBuffer&&(r=n,n={}),n=n||{},n.output=r,n.iv=t,s.call(i,n)},i}e.aes=e.aes||{},e.aes.startEncrypting=function(e,t,n,r){var i=s({key:e,output:n,decrypt:!1,mode:r});return i.start(t),i},e.aes.createEncryptionCipher=function(e,t){return s({key:e,output:null,decrypt:!1,mode:t})},e.aes.startDecrypting=function(e,t,n,r){var i=s({key:e,output:n,decrypt:!0,mode:r});return i.start(t),i},e.aes.createDecryptionCipher=function(e,t){return s({key:e,output:null,decrypt:!0,mode:t})},e.aes.Algorithm=function(e,t){o||n();var r=this;r.name=e,r.mode=new t({blockSize:16,cipher:{encrypt:function(e,t){return i(r._w,e,t,!1)},decrypt:function(e,t){return i(r._w,e,t,!0)}}}),r._init=!1},e.aes.Algorithm.prototype.initialize=function(t){if(this._init)return;var n=t.key,i;if(typeof n!="string"||n.length!==16&&n.length!==24&&n.length!==32){if(e.util.isArray(n)&&(n.length===16||n.length===24||n.length===32)){i=n,n=e.util.createBuffer();for(var s=0;s<i.length;++s)n.putByte(i[s])}}else n=e.util.createBuffer(n);if(!e.util.isArray(n)){i=n,n=[];var o=i.length();if(o===16||o===24||o===32){o>>>=2;for(var s=0;s<o;++s)n.push(i.getInt32())}}if(!e.util.isArray(n)||n.length!==4&&n.length!==6&&n.length!==8)throw new Error("Invalid key parameter.");var u=this.mode.name,a=["CFB","OFB","CTR","GCM"].indexOf(u)!==-1;this._w=r(n,t.decrypt&&!a),this._init=!0},e.aes._expandKey=function(e,t){return o||n(),r(e,t)},e.aes._updateBlock=i,t("AES-CBC",e.cipher.modes.cbc),t("AES-CFB",e.cipher.modes.cfb),t("AES-OFB",e.cipher.modes.ofb),t("AES-CTR",e.cipher.modes.ctr),t("AES-GCM",e.cipher.modes.gcm);var o=!1,u=4,a,f,l,c,h}var r="aes";if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),e(forge);var i=!0;n=function(e,n){n(t,module)}}var s,o=function(t,n){n.exports=function(n){var i=s.map(function(e){return t(e)}).concat(e);n=n||{},n.defined=n.defined||{};if(n.defined[r])return n[r];n.defined[r]=!0;for(var o=0;o<i.length;++o)i[o](n);return n[r]}},u=n;n=function(e,t){return s=typeof e=="string"?t.slice(2):e.slice(2),i?(delete n,u.apply(null,Array.prototype.slice.call(arguments,0))):(n=u,n.apply(null,Array.prototype.slice.call(arguments,0)))},n("js/aes",["require","module","./cipher","./cipherModes","./util"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){e.pki=e.pki||{};var t=e.pki.oids=e.oids=e.oids||{};t["1.2.840.113549.1.1.1"]="rsaEncryption",t.rsaEncryption="1.2.840.113549.1.1.1",t["1.2.840.113549.1.1.4"]="md5WithRSAEncryption",t.md5WithRSAEncryption="1.2.840.113549.1.1.4",t["1.2.840.113549.1.1.5"]="sha1WithRSAEncryption",t.sha1WithRSAEncryption="1.2.840.113549.1.1.5",t["1.2.840.113549.1.1.7"]="RSAES-OAEP",t["RSAES-OAEP"]="1.2.840.113549.1.1.7",t["1.2.840.113549.1.1.8"]="mgf1",t.mgf1="1.2.840.113549.1.1.8",t["1.2.840.113549.1.1.9"]="pSpecified",t.pSpecified="1.2.840.113549.1.1.9",t["1.2.840.113549.1.1.10"]="RSASSA-PSS",t["RSASSA-PSS"]="1.2.840.113549.1.1.10",t["1.2.840.113549.1.1.11"]="sha256WithRSAEncryption",t.sha256WithRSAEncryption="1.2.840.113549.1.1.11",t["1.2.840.113549.1.1.12"]="sha384WithRSAEncryption",t.sha384WithRSAEncryption="1.2.840.113549.1.1.12",t["1.2.840.113549.1.1.13"]="sha512WithRSAEncryption",t.sha512WithRSAEncryption="1.2.840.113549.1.1.13",t["1.3.14.3.2.7"]="desCBC",t.desCBC="1.3.14.3.2.7",t["1.3.14.3.2.26"]="sha1",t.sha1="1.3.14.3.2.26",t["2.16.840.1.101.3.4.2.1"]="sha256",t.sha256="2.16.840.1.101.3.4.2.1",t["2.16.840.1.101.3.4.2.2"]="sha384",t.sha384="2.16.840.1.101.3.4.2.2",t["2.16.840.1.101.3.4.2.3"]="sha512",t.sha512="2.16.840.1.101.3.4.2.3",t["1.2.840.113549.2.5"]="md5",t.md5="1.2.840.113549.2.5",t["1.2.840.113549.1.7.1"]="data",t.data="1.2.840.113549.1.7.1",t["1.2.840.113549.1.7.2"]="signedData",t.signedData="1.2.840.113549.1.7.2",t["1.2.840.113549.1.7.3"]="envelopedData",t.envelopedData="1.2.840.113549.1.7.3",t["1.2.840.113549.1.7.4"]="signedAndEnvelopedData",t.signedAndEnvelopedData="1.2.840.113549.1.7.4",t["1.2.840.113549.1.7.5"]="digestedData",t.digestedData="1.2.840.113549.1.7.5",t["1.2.840.113549.1.7.6"]="encryptedData",t.encryptedData="1.2.840.113549.1.7.6",t["1.2.840.113549.1.9.1"]="emailAddress",t.emailAddress="1.2.840.113549.1.9.1",t["1.2.840.113549.1.9.2"]="unstructuredName",t.unstructuredName="1.2.840.113549.1.9.2",t["1.2.840.113549.1.9.3"]="contentType",t.contentType="1.2.840.113549.1.9.3",t["1.2.840.113549.1.9.4"]="messageDigest",t.messageDigest="1.2.840.113549.1.9.4",t["1.2.840.113549.1.9.5"]="signingTime",t.signingTime="1.2.840.113549.1.9.5",t["1.2.840.113549.1.9.6"]="counterSignature",t.counterSignature="1.2.840.113549.1.9.6",t["1.2.840.113549.1.9.7"]="challengePassword",t.challengePassword="1.2.840.113549.1.9.7",t["1.2.840.113549.1.9.8"]="unstructuredAddress",t.unstructuredAddress="1.2.840.113549.1.9.8",t["1.2.840.113549.1.9.14"]="extensionRequest",t.extensionRequest="1.2.840.113549.1.9.14",t["1.2.840.113549.1.9.20"]="friendlyName",t.friendlyName="1.2.840.113549.1.9.20",t["1.2.840.113549.1.9.21"]="localKeyId",t.localKeyId="1.2.840.113549.1.9.21",t["1.2.840.113549.1.9.22.1"]="x509Certificate",t.x509Certificate="1.2.840.113549.1.9.22.1",t["1.2.840.113549.1.12.10.1.1"]="keyBag",t.keyBag="1.2.840.113549.1.12.10.1.1",t["1.2.840.113549.1.12.10.1.2"]="pkcs8ShroudedKeyBag",t.pkcs8ShroudedKeyBag="1.2.840.113549.1.12.10.1.2",t["1.2.840.113549.1.12.10.1.3"]="certBag",t.certBag="1.2.840.113549.1.12.10.1.3",t["1.2.840.113549.1.12.10.1.4"]="crlBag",t.crlBag="1.2.840.113549.1.12.10.1.4",t["1.2.840.113549.1.12.10.1.5"]="secretBag",t.secretBag="1.2.840.113549.1.12.10.1.5",t["1.2.840.113549.1.12.10.1.6"]="safeContentsBag",t.safeContentsBag="1.2.840.113549.1.12.10.1.6",t["1.2.840.113549.1.5.13"]="pkcs5PBES2",t.pkcs5PBES2="1.2.840.113549.1.5.13",t["1.2.840.113549.1.5.12"]="pkcs5PBKDF2",t.pkcs5PBKDF2="1.2.840.113549.1.5.12",t["1.2.840.113549.1.12.1.1"]="pbeWithSHAAnd128BitRC4",t.pbeWithSHAAnd128BitRC4="1.2.840.113549.1.12.1.1",t["1.2.840.113549.1.12.1.2"]="pbeWithSHAAnd40BitRC4",t.pbeWithSHAAnd40BitRC4="1.2.840.113549.1.12.1.2",t["1.2.840.113549.1.12.1.3"]="pbeWithSHAAnd3-KeyTripleDES-CBC",t["pbeWithSHAAnd3-KeyTripleDES-CBC"]="1.2.840.113549.1.12.1.3",t["1.2.840.113549.1.12.1.4"]="pbeWithSHAAnd2-KeyTripleDES-CBC",t["pbeWithSHAAnd2-KeyTripleDES-CBC"]="1.2.840.113549.1.12.1.4",t["1.2.840.113549.1.12.1.5"]="pbeWithSHAAnd128BitRC2-CBC",t["pbeWithSHAAnd128BitRC2-CBC"]="1.2.840.113549.1.12.1.5",t["1.2.840.113549.1.12.1.6"]="pbewithSHAAnd40BitRC2-CBC",t["pbewithSHAAnd40BitRC2-CBC"]="1.2.840.113549.1.12.1.6",t["1.2.840.113549.3.7"]="des-EDE3-CBC",t["des-EDE3-CBC"]="1.2.840.113549.3.7",t["2.16.840.1.101.3.4.1.2"]="aes128-CBC",t["aes128-CBC"]="2.16.840.1.101.3.4.1.2",t["2.16.840.1.101.3.4.1.22"]="aes192-CBC",t["aes192-CBC"]="2.16.840.1.101.3.4.1.22",t["2.16.840.1.101.3.4.1.42"]="aes256-CBC",t["aes256-CBC"]="2.16.840.1.101.3.4.1.42",t["2.5.4.3"]="commonName",t.commonName="2.5.4.3",t["2.5.4.5"]="serialName",t.serialName="2.5.4.5",t["2.5.4.6"]="countryName",t.countryName="2.5.4.6",t["2.5.4.7"]="localityName",t.localityName="2.5.4.7",t["2.5.4.8"]="stateOrProvinceName",t.stateOrProvinceName="2.5.4.8",t["2.5.4.10"]="organizationName",t.organizationName="2.5.4.10",t["2.5.4.11"]="organizationalUnitName",t.organizationalUnitName="2.5.4.11",t["2.16.840.1.113730.1.1"]="nsCertType",t.nsCertType="2.16.840.1.113730.1.1",t["2.5.29.1"]="authorityKeyIdentifier",t["2.5.29.2"]="keyAttributes",t["2.5.29.3"]="certificatePolicies",t["2.5.29.4"]="keyUsageRestriction",t["2.5.29.5"]="policyMapping",t["2.5.29.6"]="subtreesConstraint",t["2.5.29.7"]="subjectAltName",t["2.5.29.8"]="issuerAltName",t["2.5.29.9"]="subjectDirectoryAttributes",t["2.5.29.10"]="basicConstraints",t["2.5.29.11"]="nameConstraints",t["2.5.29.12"]="policyConstraints",t["2.5.29.13"]="basicConstraints",t["2.5.29.14"]="subjectKeyIdentifier",t.subjectKeyIdentifier="2.5.29.14",t["2.5.29.15"]="keyUsage",t.keyUsage="2.5.29.15",t["2.5.29.16"]="privateKeyUsagePeriod",t["2.5.29.17"]="subjectAltName",t.subjectAltName="2.5.29.17",t["2.5.29.18"]="issuerAltName",t.issuerAltName="2.5.29.18",t["2.5.29.19"]="basicConstraints",t.basicConstraints="2.5.29.19",t["2.5.29.20"]="cRLNumber",t["2.5.29.21"]="cRLReason",t["2.5.29.22"]="expirationDate",t["2.5.29.23"]="instructionCode",t["2.5.29.24"]="invalidityDate",t["2.5.29.25"]="cRLDistributionPoints",t["2.5.29.26"]="issuingDistributionPoint",t["2.5.29.27"]="deltaCRLIndicator",t["2.5.29.28"]="issuingDistributionPoint",t["2.5.29.29"]="certificateIssuer",t["2.5.29.30"]="nameConstraints",t["2.5.29.31"]="cRLDistributionPoints",t["2.5.29.32"]="certificatePolicies",t["2.5.29.33"]="policyMappings",t["2.5.29.34"]="policyConstraints",t["2.5.29.35"]="authorityKeyIdentifier",t["2.5.29.36"]="policyConstraints",t["2.5.29.37"]="extKeyUsage",t.extKeyUsage="2.5.29.37",t["2.5.29.46"]="freshestCRL",t["2.5.29.54"]="inhibitAnyPolicy",t["1.3.6.1.5.5.7.3.1"]="serverAuth",t.serverAuth="1.3.6.1.5.5.7.3.1",t["1.3.6.1.5.5.7.3.2"]="clientAuth",t.clientAuth="1.3.6.1.5.5.7.3.2",t["1.3.6.1.5.5.7.3.3"]="codeSigning",t.codeSigning="1.3.6.1.5.5.7.3.3",t["1.3.6.1.5.5.7.3.4"]="emailProtection",t.emailProtection="1.3.6.1.5.5.7.3.4",t["1.3.6.1.5.5.7.3.8"]="timeStamping",t.timeStamping="1.3.6.1.5.5.7.3.8"}var r="oids";if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),e(forge);var i=!0;n=function(e,n){n(t,module)}}var s,o=function(t,n){n.exports=function(n){var i=s.map(function(e){return t(e)}).concat(e);n=n||{},n.defined=n.defined||{};if(n.defined[r])return n[r];n.defined[r]=!0;for(var o=0;o<i.length;++o)i[o](n);return n[r]}},u=n;n=function(e,t){return s=typeof e=="string"?t.slice(2):e.slice(2),i?(delete n,u.apply(null,Array.prototype.slice.call(arguments,0))):(n=u,n.apply(null,Array.prototype.slice.call(arguments,0)))},n("js/oids",["require","module"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){var t=e.asn1=e.asn1||{};t.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192},t.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30},t.create=function(t,n,r,i){if(e.util.isArray(i)){var s=[];for(var o=0;o<i.length;++o)i[o]!==undefined&&s.push(i[o]);i=s}return{tagClass:t,type:n,constructed:r,composed:r||e.util.isArray(i),value:i}};var n=function(e){var t=e.getByte();if(t===128)return undefined;var n,r=t&128;return r?n=e.getInt((t&127)<<3):n=t,n};t.fromDer=function(r,i){i===undefined&&(i=!0),typeof r=="string"&&(r=e.util.createBuffer(r));if(r.length()<2){var s=new Error("Too few bytes to parse DER.");throw s.bytes=r.length(),s}var o=r.getByte(),u=o&192,a=o&31,f=n(r);if(r.length()<f){if(i){var s=new Error("Too few bytes to read ASN.1 value.");throw s.detail=r.length()+" < "+f,s}f=r.length()}var l,c=(o&32)===32,h=c;if(!h&&u===t.Class.UNIVERSAL&&a===t.Type.BITSTRING&&f>1){var p=r.read,d=r.getByte();if(d===0){o=r.getByte();var v=o&192;if(v===t.Class.UNIVERSAL||v===t.Class.CONTEXT_SPECIFIC)try{var m=n(r);h=m===f-(r.read-p),h&&(++p,--f)}catch(g){}}r.read=p}if(h){l=[];if(f===undefined)for(;;){if(r.bytes(2)===String.fromCharCode(0,0)){r.getBytes(2);break}l.push(t.fromDer(r,i))}else{var y=r.length();while(f>0)l.push(t.fromDer(r,i)),f-=y-r.length(),y=r.length()}}else{if(f===undefined){if(i)throw new Error("Non-constructed ASN.1 object of indefinite length.");f=r.length()}if(a===t.Type.BMPSTRING){l="";for(var b=0;b<f;b+=2)l+=String.fromCharCode(r.getInt16())}else l=r.getBytes(f)}return t.create(u,a,c,l)},t.toDer=function(n){var r=e.util.createBuffer(),i=n.tagClass|n.type,s=e.util.createBuffer();if(n.composed){n.constructed?i|=32:s.putByte(0);for(var o=0;o<n.value.length;++o)n.value[o]!==undefined&&s.putBuffer(t.toDer(n.value[o]))}else if(n.type===t.Type.BMPSTRING)for(var o=0;o<n.value.length;++o)s.putInt16(n.value.charCodeAt(o));else s.putBytes(n.value);r.putByte(i);if(s.length()<=127)r.putByte(s.length()&127);else{var u=s.length(),a="";do a+=String.fromCharCode(u&255),u>>>=8;while(u>0);r.putByte(a.length|128);for(var o=a.length-1;o>=0;--o)r.putByte(a.charCodeAt(o))}return r.putBuffer(s),r},t.oidToDer=function(t){var n=t.split("."),r=e.util.createBuffer();r.putByte(40*parseInt(n[0],10)+parseInt(n[1],10));var i,s,o,u;for(var a=2;a<n.length;++a){i=!0,s=[],o=parseInt(n[a],10);do u=o&127,o>>>=7,i||(u|=128),s.push(u),i=!1;while(o>0);for(var f=s.length-1;f>=0;--f)r.putByte(s[f])}return r},t.derToOid=function(t){var n;typeof t=="string"&&(t=e.util.createBuffer(t));var r=t.getByte();n=Math.floor(r/40)+"."+r%40;var i=0;while(t.length()>0)r=t.getByte(),i<<=7,r&128?i+=r&127:(n+="."+(i+r),i=0);return n},t.utcTimeToDate=function(e){var t=new Date,n=parseInt(e.substr(0,2),10);n=n>=50?1900+n:2e3+n;var r=parseInt(e.substr(2,2),10)-1,i=parseInt(e.substr(4,2),10),s=parseInt(e.substr(6,2),10),o=parseInt(e.substr(8,2),10),u=0;if(e.length>11){var a=e.charAt(10),f=10;a!=="+"&&a!=="-"&&(u=parseInt(e.substr(10,2),10),f+=2)}t.setUTCFullYear(n,r,i),t.setUTCHours(s,o,u,0);if(f){a=e.charAt(f);if(a==="+"||a==="-"){var l=parseInt(e.substr(f+1,2),10),c=parseInt(e.substr(f+4,2),10),h=l*60+c;h*=6e4,a==="+"?t.setTime(+t-h):t.setTime(+t+h)}}return t},t.generalizedTimeToDate=function(e){var t=new Date,n=parseInt(e.substr(0,4),10),r=parseInt(e.substr(4,2),10)-1,i=parseInt(e.substr(6,2),10),s=parseInt(e.substr(8,2),10),o=parseInt(e.substr(10,2),10),u=parseInt(e.substr(12,2),10),a=0,f=0,l=!1;e.charAt(e.length-1)==="Z"&&(l=!0);var c=e.length-5,h=e.charAt(c);if(h==="+"||h==="-"){var p=parseInt(e.substr(c+1,2),10),d=parseInt(e.substr(c+4,2),10);f=p*60+d,f*=6e4,h==="+"&&(f*=-1),l=!0}return e.charAt(14)==="."&&(a=parseFloat(e.substr(14),10)*1e3),l?(t.setUTCFullYear(n,r,i),t.setUTCHours(s,o,u,a),t.setTime(+t+f)):(t.setFullYear(n,r,i),t.setHours(s,o,u,a)),t},t.dateToUtcTime=function(e){var t="",n=[];n.push((""+e.getUTCFullYear()).substr(2)),n.push(""+(e.getUTCMonth()+1)),n.push(""+e.getUTCDate()),n.push(""+e.getUTCHours()),n.push(""+e.getUTCMinutes()),n.push(""+e.getUTCSeconds());for(var r=0;r<n.length;++r)n[r].length<2&&(t+="0"),t+=n[r];return t+="Z",t},t.integerToDer=function(t){var n=e.util.createBuffer();if(t>=-128&&t<128)return n.putSignedInt(t,8);if(t>=-32768&&t<32768)return n.putSignedInt(t,16);if(t>=-8388608&&t<8388608)return n.putSignedInt(t,24);if(t>=-2147483648&&t<2147483648)return n.putSignedInt(t,32);var r=new Error("Integer too large; max is 32-bits.");throw r.integer=t,r},t.derToInteger=function(t){typeof t=="string"&&(t=e.util.createBuffer(t));var n=t.length()*8;if(n>32)throw new Error("Integer too large; max is 32-bits.");return t.getSignedInt(n)},t.validate=function(n,r,i,s){var o=!1;if(n.tagClass!==r.tagClass&&typeof r.tagClass!="undefined"||n.type!==r.type&&typeof r.type!="undefined")s&&(n.tagClass!==r.tagClass&&s.push("["+r.name+"] "+'Expected tag class "'+r.tagClass+'", got "'+n.tagClass+'"'),n.type!==r.type&&s.push("["+r.name+"] "+'Expected type "'+r.type+'", got "'+n.type+'"'));else if(n.constructed===r.constructed||typeof r.constructed=="undefined"){o=!0;if(r.value&&e.util.isArray(r.value)){var u=0;for(var a=0;o&&a<r.value.length;++a)o=r.value[a].optional||!1,n.value[u]&&(o=t.validate(n.value[u],r.value[a],i,s),o?++u:r.value[a].optional&&(o=!0)),!o&&s&&s.push("["+r.name+"] "+'Tag class "'+r.tagClass+'", type "'+r.type+'" expected value length "'+r.value.length+'", got "'+n.value.length+'"')}o&&i&&(r.capture&&(i[r.capture]=n.value),r.captureAsn1&&(i[r.captureAsn1]=n))}else s&&s.push("["+r.name+"] "+'Expected constructed "'+r.constructed+'", got "'+n.constructed+'"');return o};var r=/[^\\u0000-\\u00ff]/;t.prettyPrint=function(n,i,s){var o="";i=i||0,s=s||2,i>0&&(o+="\n");var u="";for(var a=0;a<i*s;++a)u+=" ";o+=u+"Tag: ";switch(n.tagClass){case t.Class.UNIVERSAL:o+="Universal:";break;case t.Class.APPLICATION:o+="Application:";break;case t.Class.CONTEXT_SPECIFIC:o+="Context-Specific:";break;case t.Class.PRIVATE:o+="Private:"}if(n.tagClass===t.Class.UNIVERSAL){o+=n.type;switch(n.type){case t.Type.NONE:o+=" (None)";break;case t.Type.BOOLEAN:o+=" (Boolean)";break;case t.Type.BITSTRING:o+=" (Bit string)";break;case t.Type.INTEGER:o+=" (Integer)";break;case t.Type.OCTETSTRING:o+=" (Octet string)";break;case t.Type.NULL:o+=" (Null)";break;case t.Type.OID:o+=" (Object Identifier)";break;case t.Type.ODESC:o+=" (Object Descriptor)";break;case t.Type.EXTERNAL:o+=" (External or Instance of)";break;case t.Type.REAL:o+=" (Real)";break;case t.Type.ENUMERATED:o+=" (Enumerated)";break;case t.Type.EMBEDDED:o+=" (Embedded PDV)";break;case t.Type.UTF8:o+=" (UTF8)";break;case t.Type.ROID:o+=" (Relative Object Identifier)";break;case t.Type.SEQUENCE:o+=" (Sequence)";break;case t.Type.SET:o+=" (Set)";break;case t.Type.PRINTABLESTRING:o+=" (Printable String)";break;case t.Type.IA5String:o+=" (IA5String (ASCII))";break;case t.Type.UTCTIME:o+=" (UTC time)";break;case t.Type.GENERALIZEDTIME:o+=" (Generalized time)";break;case t.Type.BMPSTRING:o+=" (BMP String)"}}else o+=n.type;o+="\n",o+=u+"Constructed: "+n.constructed+"\n";if(n.composed){var f=0,l="";for(var a=0;a<n.value.length;++a)n.value[a]!==undefined&&(f+=1,l+=t.prettyPrint(n.value[a],i+1,s),a+1<n.value.length&&(l+=","));o+=u+"Sub values: "+f+l}else{o+=u+"Value: ";if(n.type===t.Type.OID){var c=t.derToOid(n.value);o+=c,e.pki&&e.pki.oids&&c in e.pki.oids&&(o+=" ("+e.pki.oids[c]+") ")}if(n.type===t.Type.INTEGER)try{o+=t.derToInteger(n.value)}catch(h){o+="0x"+e.util.bytesToHex(n.value)}else n.type===t.Type.OCTETSTRING?(r.test(n.value)||(o+="("+n.value+") "),o+="0x"+e.util.bytesToHex(n.value)):n.type===t.Type.UTF8?o+=e.util.decodeUtf8(n.value):n.type===t.Type.PRINTABLESTRING||n.type===t.Type.IA5String?o+=n.value:r.test(n.value)?o+="0x"+e.util.bytesToHex(n.value):n.value.length===0?o+="[null]":o+=n.value}return o}}var r="asn1";if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),e(forge);var i=!0;n=function(e,n){n(t,module)}}var s,o=function(t,n){n.exports=function(n){var i=s.map(function(e){return t(e)}).concat(e);n=n||{},n.defined=n.defined||{};if(n.defined[r])return n[r];n.defined[r]=!0;for(var o=0;o<i.length;++o)i[o](n);return n[r]}},u=n;n=function(e,t){return s=typeof e=="string"?t.slice(2):e.slice(2),i?(delete n,u.apply(null,Array.prototype.slice.call(arguments,0))):(n=u,n.apply(null,Array.prototype.slice.call(arguments,0)))},n("js/asn1",["require","module","./util","./oids"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){function t(){i=String.fromCharCode(128),i+=e.util.fillString(String.fromCharCode(0),64),s=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,1,6,11,0,5,10,15,4,9,14,3,8,13,2,7,12,5,8,11,14,1,4,7,10,13,0,3,6,9,12,15,2,0,7,14,5,12,3,10,1,8,15,6,13,4,11,2,9],o=[7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21],u=new Array(64);for(var t=0;t<64;++t)u[t]=Math.floor(Math.abs(Math.sin(t+1))*4294967296);a=!0}function n(e,t,n){var r,i,a,f,l,c,h,p,d=n.length();while(d>=64){i=e.h0,a=e.h1,f=e.h2,l=e.h3;for(p=0;p<16;++p)t[p]=n.getInt32Le(),c=l^a&(f^l),r=i+c+u[p]+t[p],h=o[p],i=l,l=f,f=a,a+=r<<h|r>>>32-h;for(;p<32;++p)c=f^l&(a^f),r=i+c+u[p]+t[s[p]],h=o[p],i=l,l=f,f=a,a+=r<<h|r>>>32-h;for(;p<48;++p)c=a^f^l,r=i+c+u[p]+t[s[p]],h=o[p],i=l,l=f,f=a,a+=r<<h|r>>>32-h;for(;p<64;++p)c=f^(a|~l),r=i+c+u[p]+t[s[p]],h=o[p],i=l,l=f,f=a,a+=r<<h|r>>>32-h;e.h0=e.h0+i|0,e.h1=e.h1+a|0,e.h2=e.h2+f|0,e.h3=e.h3+l|0,d-=64}}var r=e.md5=e.md5||{};e.md=e.md||{},e.md.algorithms=e.md.algorithms||{},e.md.md5=e.md.algorithms.md5=r,r.create=function(){a||t();var r=null,s=e.util.createBuffer(),o=new Array(16),u={algorithm:"md5",blockLength:64,digestLength:16,messageLength:0,messageLength64:[0,0]};return u.start=function(){return u.messageLength=0,u.messageLength64=[0,0],s=e.util.createBuffer(),r={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878},u},u.start(),u.update=function(t,i){return i==="utf8"&&(t=e.util.encodeUtf8(t)),u.messageLength+=t.length,u.messageLength64[0]+=t.length/4294967296>>>0,u.messageLength64[1]+=t.length>>>0,s.putBytes(t),n(r,o,s),(s.read>2048||s.length()===0)&&s.compact(),u},u.digest=function(){var t=e.util.createBuffer();t.putBytes(s.bytes()),t.putBytes(i.substr(0,64-(u.messageLength64[1]+8&63))),t.putInt32Le(u.messageLength64[1]<<3),t.putInt32Le(u.messageLength64[0]<<3|u.messageLength64[0]>>>28);var a={h0:r.h0,h1:r.h1,h2:r.h2,h3:r.h3};n(a,o,t);var f=e.util.createBuffer();return f.putInt32Le(a.h0),f.putInt32Le(a.h1),f.putInt32Le(a.h2),f.putInt32Le(a.h3),f},u};var i=null,s=null,o=null,u=null,a=!1}var r="md5";if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),e(forge);var i=!0;n=function(e,n){n(t,module)}}var s,o=function(t,n){n.exports=function(n){var i=s.map(function(e){return t(e)}).concat(e);n=n||{},n.defined=n.defined||{};if(n.defined[r])return n[r];n.defined[r]=!0;for(var o=0;o<i.length;++o)i[o](n);return n[r]}},u=n;n=function(e,t){return s=typeof e=="string"?t.slice(2):e.slice(2),i?(delete n,u.apply(null,Array.prototype.slice.call(arguments,0))):(n=u,n.apply(null,Array.prototype.slice.call(arguments,0)))},n("js/md5",["require","module","./util"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){function t(){i=String.fromCharCode(128),i+=e.util.fillString(String.fromCharCode(0),64),s=!0}function n(e,t,n){var r,i,s,o,u,a,f,l,c=n.length();while(c>=64){i=e.h0,s=e.h1,o=e.h2,u=e.h3,a=e.h4;for(l=0;l<16;++l)r=n.getInt32(),t[l]=r,f=u^s&(o^u),r=(i<<5|i>>>27)+f+a+1518500249+r,a=u,u=o,o=s<<30|s>>>2,s=i,i=r;for(;l<20;++l)r=t[l-3]^t[l-8]^t[l-14]^t[l-16],r=r<<1|r>>>31,t[l]=r,f=u^s&(o^u),r=(i<<5|i>>>27)+f+a+1518500249+r,a=u,u=o,o=s<<30|s>>>2,s=i,i=r;for(;l<32;++l)r=t[l-3]^t[l-8]^t[l-14]^t[l-16],r=r<<1|r>>>31,t[l]=r,f=s^o^u,r=(i<<5|i>>>27)+f+a+1859775393+r,a=u,u=o,o=s<<30|s>>>2,s=i,i=r;for(;l<40;++l)r=t[l-6]^t[l-16]^t[l-28]^t[l-32],r=r<<2|r>>>30,t[l]=r,f=s^o^u,r=(i<<5|i>>>27)+f+a+1859775393+r,a=u,u=o,o=s<<30|s>>>2,s=i,i=r;for(;l<60;++l)r=t[l-6]^t[l-16]^t[l-28]^t[l-32],r=r<<2|r>>>30,t[l]=r,f=s&o|u&(s^o),r=(i<<5|i>>>27)+f+a+2400959708+r,a=u,u=o,o=s<<30|s>>>2,s=i,i=r;for(;l<80;++l)r=t[l-6]^t[l-16]^t[l-28]^t[l-32],r=r<<2|r>>>30,t[l]=r,f=s^o^u,r=(i<<5|i>>>27)+f+a+3395469782+r,a=u,u=o,o=s<<30|s>>>2,s=i,i=r;e.h0=e.h0+i|0,e.h1=e.h1+s|0,e.h2=e.h2+o|0,e.h3=e.h3+u|0,e.h4=e.h4+a|0,c-=64}}var r=e.sha1=e.sha1||{};e.md=e.md||{},e.md.algorithms=e.md.algorithms||{},e.md.sha1=e.md.algorithms.sha1=r,r.create=function(){s||t();var r=null,o=e.util.createBuffer(),u=new Array(80),a={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,messageLength64:[0,0]};return a.start=function(){return a.messageLength=0,a.messageLength64=[0,0],o=e.util.createBuffer(),r={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},a},a.start(),a.update=function(t,i){return i==="utf8"&&(t=e.util.encodeUtf8(t)),a.messageLength+=t.length,a.messageLength64[0]+=t.length/4294967296>>>0,a.messageLength64[1]+=t.length>>>0,o.putBytes(t),n(r,u,o),(o.read>2048||o.length()===0)&&o.compact(),a},a.digest=function(){var t=e.util.createBuffer();t.putBytes(o.bytes()),t.putBytes(i.substr(0,64-(a.messageLength64[1]+8&63))),t.putInt32(a.messageLength64[0]<<3|a.messageLength64[0]>>>28),t.putInt32(a.messageLength64[1]<<3);var s={h0:r.h0,h1:r.h1,h2:r.h2,h3:r.h3,h4:r.h4};n(s,u,t);var f=e.util.createBuffer();return f.putInt32(s.h0),f.putInt32(s.h1),f.putInt32(s.h2),f.putInt32(s.h3),f.putInt32(s.h4),f},a};var i=null,s=!1}var r="sha1";if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),e(forge);var i=!0;n=function(e,n){n(t,module)}}var s,o=function(t,n){n.exports=function(n){var i=s.map(function(e){return t(e)}).concat(e);n=n||{},n.defined=n.defined||{};if(n.defined[r])return n[r];n.defined[r]=!0;for(var o=0;o<i.length;++o)i[o](n);return n[r]}},u=n;n=function(e,t){return s=typeof e=="string"?t.slice(2):e.slice(2),i?(delete n,u.apply(null,Array.prototype.slice.call(arguments,0))):(n=u,n.apply(null,Array.prototype.slice.call(arguments,0)))},n("js/sha1",["require","module","./util"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){function t(){i=String.fromCharCode(128),i+=e.util.fillString(String.fromCharCode(0),64),o=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],s=!0}function n(e,t,n){var r,i,s,u,a,f,l,c,h,p,d,v,m,g,y,b=n.length();while(b>=64){for(l=0;l<16;++l)t[l]=n.getInt32();for(;l<64;++l)r=t[l-2],r=(r>>>17|r<<15)^(r>>>19|r<<13)^r>>>10,i=t[l-15],i=(i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3,t[l]=r+t[l-7]+i+t[l-16]|0;c=e.h0,h=e.h1,p=e.h2,d=e.h3,v=e.h4,m=e.h5,g=e.h6,y=e.h7;for(l=0;l<64;++l)u=(v>>>6|v<<26)^(v>>>11|v<<21)^(v>>>25|v<<7),a=g^v&(m^g),s=(c>>>2|c<<30)^(c>>>13|c<<19)^(c>>>22|c<<10),f=c&h|p&(c^h),r=y+u+a+o[l]+t[l],i=s+f,y=g,g=m,m=v,v=d+r|0,d=p,p=h,h=c,c=r+i|0;e.h0=e.h0+c|0,e.h1=e.h1+h|0,e.h2=e.h2+p|0,e.h3=e.h3+d|0,e.h4=e.h4+v|0,e.h5=e.h5+m|0,e.h6=e.h6+g|0,e.h7=e.h7+y|0,b-=64}}var r=e.sha256=e.sha256||{};e.md=e.md||{},e.md.algorithms=e.md.algorithms||{},e.md.sha256=e.md.algorithms.sha256=r,r.create=function(){s||t();var r=null,o=e.util.createBuffer(),u=new Array(64),a={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,messageLength64:[0,0]};return a.start=function(){return a.messageLength=0,a.messageLength64=[0,0],o=e.util.createBuffer(),r={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},a},a.start(),a.update=function(t,i){return i==="utf8"&&(t=e.util.encodeUtf8(t)),a.messageLength+=t.length,a.messageLength64[0]+=t.length/4294967296>>>0,a.messageLength64[1]+=t.length>>>0,o.putBytes(t),n(r,u,o),(o.read>2048||o.length()===0)&&o.compact(),a},a.digest=function(){var t=e.util.createBuffer();t.putBytes(o.bytes()),t.putBytes(i.substr(0,64-(a.messageLength64[1]+8&63))),t.putInt32(a.messageLength64[0]<<3|a.messageLength64[0]>>>28),t.putInt32(a.messageLength64[1]<<3);var s={h0:r.h0,h1:r.h1,h2:r.h2,h3:r.h3,h4:r.h4,h5:r.h5,h6:r.h6,h7:r.h7};n(s,u,t);var f=e.util.createBuffer();return f.putInt32(s.h0),f.putInt32(s.h1),f.putInt32(s.h2),f.putInt32(s.h3),f.putInt32(s.h4),f.putInt32(s.h5),f.putInt32(s.h6),f.putInt32(s.h7),f},a};var i=null,s=!1,o=null}var r="sha256";if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),e(forge);var i=!0;n=function(e,n){n(t,module)}}var s,o=function(t,n){n.exports=function(n){var i=s.map(function(e){return t(e)}).concat(e);n=n||{},n.defined=n.defined||{};if(n.defined[r])return n[r];n.defined[r]=!0;for(var o=0;o<i.length;++o)i[o](n);return n[r]}},u=n;n=function(e,t){return s=typeof e=="string"?t.slice(2):e.slice(2),i?(delete n,u.apply(null,Array.prototype.slice.call(arguments,0))):(n=u,n.apply(null,Array.prototype.slice.call(arguments,0)))},n("js/sha256",["require","module","./util"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){function t(){s=String.fromCharCode(128),s+=e.util.fillString(String.fromCharCode(0),128),u=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],a={},a["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],a["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],a["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],a["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],o=!0}function n(e,t,n){var r,i,s,o,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I=n.length();while(I>=128){for(_=0;_<16;++_)t[_][0]=n.getInt32()>>>0,t[_][1]=n.getInt32()>>>0;for(;_<80;++_)H=t[_-2],D=H[0],P=H[1],r=((D>>>19|P<<13)^(P>>>29|D<<3)^D>>>6)>>>0,i=((D<<13|P>>>19)^(P<<3|D>>>29)^(D<<26|P>>>6))>>>0,j=t[_-15],D=j[0],P=j[1],s=((D>>>1|P<<31)^(D>>>8|P<<24)^D>>>7)>>>0,o=((D<<31|P>>>1)^(D<<24|P>>>8)^(D<<25|P>>>7))>>>0,B=t[_-7],F=t[_-16],P=i+B[1]+o+F[1],t[_][0]=r+B[0]+s+F[0]+(P/4294967296>>>0)>>>0,t[_][1]=P>>>0;m=e[0][0],g=e[0][1],y=e[1][0],b=e[1][1],w=e[2][0],E=e[2][1],S=e[3][0],x=e[3][1],T=e[4][0],N=e[4][1],C=e[5][0],k=e[5][1],L=e[6][0],A=e[6][1],O=e[7][0],M=e[7][1];for(_=0;_<80;++_)l=((T>>>14|N<<18)^(T>>>18|N<<14)^(N>>>9|T<<23))>>>0,c=((T<<18|N>>>14)^(T<<14|N>>>18)^(N<<23|T>>>9))>>>0,h=(L^T&(C^L))>>>0,p=(A^N&(k^A))>>>0,a=((m>>>28|g<<4)^(g>>>2|m<<30)^(g>>>7|m<<25))>>>0,f=((m<<4|g>>>28)^(g<<30|m>>>2)^(g<<25|m>>>7))>>>0,d=(m&y|w&(m^y))>>>0,v=(g&b|E&(g^b))>>>0,P=M+c+p+u[_][1]+t[_][1],r=O+l+h+u[_][0]+t[_][0]+(P/4294967296>>>0)>>>0,i=P>>>0,P=f+v,s=a+d+(P/4294967296>>>0)>>>0,o=P>>>0,O=L,M=A,L=C,A=k,C=T,k=N,P=x+i,T=S+r+(P/4294967296>>>0)>>>0,N=P>>>0,S=w,x=E,w=y,E=b,y=m,b=g,P=i+o,m=r+s+(P/4294967296>>>0)>>>0,g=P>>>0;P=e[0][1]+g,e[0][0]=e[0][0]+m+(P/4294967296>>>0)>>>0,e[0][1]=P>>>0,P=e[1][1]+b,e[1][0]=e[1][0]+y+(P/4294967296>>>0)>>>0,e[1][1]=P>>>0,P=e[2][1]+E,e[2][0]=e[2][0]+w+(P/4294967296>>>0)>>>0,e[2][1]=P>>>0,P=e[3][1]+x,e[3][0]=e[3][0]+S+(P/4294967296>>>0)>>>0,e[3][1]=P>>>0,P=e[4][1]+N,e[4][0]=e[4][0]+T+(P/4294967296>>>0)>>>0,e[4][1]=P>>>0,P=e[5][1]+k,e[5][0]=e[5][0]+C+(P/4294967296>>>0)>>>0,e[5][1]=P>>>0,P=e[6][1]+A,e[6][0]=e[6][0]+L+(P/4294967296>>>0)>>>0,e[6][1]=P>>>0,P=e[7][1]+M,e[7][0]=e[7][0]+O+(P/4294967296>>>0)>>>0,e[7][1]=P>>>0,I-=128}}var r=e.sha512=e.sha512||{};e.md=e.md||{},e.md.algorithms=e.md.algorithms||{},e.md.sha512=e.md.algorithms.sha512=r;var i=e.sha384=e.sha512.sha384=e.sha512.sha384||{};i.create=function(){return r.create("SHA-384")},e.md.sha384=e.md.algorithms.sha384=i,e.sha512.sha256=e.sha512.sha256||{create:function(){return r.create("SHA-512/256")}},e.md["sha512/256"]=e.md.algorithms["sha512/256"]=e.sha512.sha256,e.sha512.sha224=e.sha512.sha224||{create:function(){return r.create("SHA-512/224")}},e.md["sha512/224"]=e.md.algorithms["sha512/224"]=e.sha512.sha224,r.create=function(r){o||t(),typeof r=="undefined"&&(r="SHA-512");if(r in a){var i=a[r],u=null,f=e.util.createBuffer(),l=new Array(80);for(var c=0;c<80;++c)l[c]=new Array(2);var h={algorithm:r.replace("-","").toLowerCase(),blockLength:128,digestLength:64,messageLength:0,messageLength128:[0,0,0,0]};return h.start=function(){h.messageLength=0,h.messageLength128=[0,0,0,0],f=e.util.createBuffer(),u=new Array(i.length);for(var t=0;t<i.length;++t)u[t]=i[t].slice(0);return h},h.start(),h.update=function(t,r){r==="utf8"&&(t=e.util.encodeUtf8(t)),h.messageLength+=t.length;var i=t.length;i=[i/4294967296>>>0,i>>>0];for(var s=3;s>=0;--s)h.messageLength128[s]+=i[1],i[1]=i[0]+(h.messageLength128[s]/4294967296>>>0),h.messageLength128[s]=h.messageLength128[s]>>>0,i[0]=i[1]/4294967296>>>0;return f.putBytes(t),n(u,l,f),(f.read>2048||f.length()===0)&&f.compact(),h},h.digest=function(){var t=e.util.createBuffer();t.putBytes(f.bytes()),t.putBytes(s.substr(0,128-(h.messageLength128[3]+16&127)));var i=[];for(var o=0;o<3;++o)i[o]=h.messageLength128[o]<<3|h.messageLength128[o-1]>>>28;i[3]=h.messageLength128[3]<<3,t.putInt32(i[0]),t.putInt32(i[1]),t.putInt32(i[2]),t.putInt32(i[3]);var a=new Array(u.length);for(var o=0;o<u.length;++o)a[o]=u[o].slice(0);n(a,l,t);var c=e.util.createBuffer(),p;r==="SHA-512"?p=a.length:r==="SHA-384"?p=a.length-2:p=a.length-4;for(var o=0;o<p;++o)c.putInt32(a[o][0]),(o!==p-1||r!=="SHA-512/224")&&c.putInt32(a[o][1]);return c},h}throw new Error("Invalid SHA-512 algorithm: "+r)};var s=null,o=!1,u=null,a=null}var r="sha512";if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),e(forge);var i=!0;n=function(e,n){n(t,module)}}var s,o=function(t,n){n.exports=function(n){var i=s.map(function(e){return t(e)}).concat(e);n=n||{},n.defined=n.defined||{};if(n.defined[r])return n[r];n.defined[r]=!0;for(var o=0;o<i.length;++o)i[o](n);return n[r]}},u=n;n=function(e,t){return s=typeof e=="string"?t.slice(2):e.slice(2),i?(delete n,u.apply(null,Array.prototype.slice.call(arguments,0))):(n=u,n.apply(null,Array.prototype.slice.call(arguments,0)))},n("js/sha512",["require","module","./util"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){e.md=e.md||{},e.md.algorithms={md5:e.md5,sha1:e.sha1,sha256:e.sha256},e.md.md5=e.md5,e.md.sha1=e.sha1,e.md.sha256=e.sha256}var r="md";if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),e(forge);var i=!0;n=function(e,n){n(t,module)}}var s,o=function(t,n){n.exports=function(n){var i=s.map(function(e){return t(e)}).concat(e);n=n||{},n.defined=n.defined||{};if(n.defined[r])return n[r];n.defined[r]=!0;for(var o=0;o<i.length;++o)i[o](n);return n[r]}},u=n;n=function(e,t){return s=typeof e=="string"?t.slice(2):e.slice(2),i?(delete n,u.apply(null,Array.prototype.slice.call(arguments,0))):(n=u,n.apply(null,Array.prototype.slice.call(arguments,0)))},n("js/md",["require","module","./md5","./sha1","./sha256","./sha512"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){var t=e.hmac=e.hmac||{};t.create=function(){var t=null,n=null,r=null,i=null,s={};return s.start=function(s,o){if(s!==null)if(typeof s=="string"){s=s.toLowerCase();if(!(s in e.md.algorithms))throw new Error('Unknown hash algorithm "'+s+'"');n=e.md.algorithms[s].create()}else n=s;if(o===null)o=t;else{if(typeof o=="string")o=e.util.createBuffer(o);else if(e.util.isArray(o)){var u=o;o=e.util.createBuffer();for(var a=0;a<u.length;++a)o.putByte(u[a])}var f=o.length();f>n.blockLength&&(n.start(),n.update(o.bytes()),o=n.digest()),r=e.util.createBuffer(),i=e.util.createBuffer(),f=o.length();for(var a=0;a<f;++a){var u=o.at(a);r.putByte(54^u),i.putByte(92^u)}if(f<n.blockLength){var u=n.blockLength-f;for(var a=0;a<u;++a)r.putByte(54),i.putByte(92)}t=o,r=r.bytes(),i=i.bytes()}n.start(),n.update(r)},s.update=function(e){n.update(e)},s.getMac=function(){var e=n.digest().bytes();return n.start(),n.update(i),n.update(e),n.digest()},s.digest=s.getMac,s}}var r="hmac";if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),e(forge);var i=!0;n=function(e,n){n(t,module)}}var s,o=function(t,n){n.exports=function(n){var i=s.map(function(e){return t(e)}).concat(e);n=n||{},n.defined=n.defined||{};if(n.defined[r])return n[r];n.defined[r]=!0;for(var o=0;o<i.length;++o)i[o](n);return n[r]}},u=n;n=function(e,t){return s=typeof e=="string"?t.slice(2):e.slice(2),i?(delete n,u.apply(null,Array.prototype.slice.call(arguments,0))):(n=u,n.apply(null,Array.prototype.slice.call(arguments,0)))},n("js/hmac",["require","module","./md","./util"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){function t(e){var t=e.name+": ",n=[],r=function(e,t){return" "+t};for(var i=0;i<e.values.length;++i)n.push(e.values[i].replace(/^(\S+\r\n)/,r));t+=n.join(",")+"\r\n";var s=0,o=-1;for(var i=0;i<t.length;++i,++s)if(s>65&&o!==-1){var u=t[o];u===","?(++o,t=t.substr(0,o)+"\r\n "+t.substr(o)):t=t.substr(0,o)+"\r\n"+u+t.substr(o+1),s=i-o-1,o=-1,++i}else if(t[i]===" "||t[i]==="	"||t[i]===",")o=i;return t}function n(e){return e.replace(/^\s+/,"")}var r=e.pem=e.pem||{};r.encode=function(n,r){r=r||{};var i="-----BEGIN "+n.type+"-----\r\n",s;n.procType&&(s={name:"Proc-Type",values:[String(n.procType.version),n.procType.type]},i+=t(s)),n.contentDomain&&(s={name:"Content-Domain",values:[n.contentDomain]},i+=t(s)),n.dekInfo&&(s={name:"DEK-Info",values:[n.dekInfo.algorithm]},n.dekInfo.parameters&&s.values.push(n.dekInfo.parameters),i+=t(s));if(n.headers)for(var o=0;o<n.headers.length;++o)i+=t(n.headers[o]);return n.procType&&(i+="\r\n"),i+=e.util.encode64(n.body,r.maxline||64)+"\r\n",i+="-----END "+n.type+"-----\r\n",i},r.decode=function(t){var r=[],i=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,s=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,o=/\r?\n/,u;for(;;){u=i.exec(t);if(!u)break;var a={type:u[1],procType:null,contentDomain:null,dekInfo:null,headers:[],body:e.util.decode64(u[3])};r.push(a);if(!u[2])continue;var f=u[2].split(o),l=0;while(u&&l<f.length){var c=f[l].replace(/\s+$/,"");for(var h=l+1;h<f.length;++h){var p=f[h];if(!/\s/.test(p[0]))break;c+=p,l=h}u=c.match(s);if(u){var d={name:u[1],values:[]},v=u[2].split(",");for(var m=0;m<v.length;++m)d.values.push(n(v[m]));if(!a.procType){if(d.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(d.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');a.procType={version:v[0],type:v[1]}}else if(!a.contentDomain&&d.name==="Content-Domain")a.contentDomain=v[0]||"";else if(!a.dekInfo&&d.name==="DEK-Info"){if(d.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');a.dekInfo={algorithm:v[0],parameters:v[1]||null}}else a.headers.push(d)}++l}if(a.procType==="ENCRYPTED"&&!a.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}if(r.length===0)throw new Error("Invalid PEM formatted message.");return r}}var r="pem";if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),e(forge);var i=!0;n=function(e,n){n(t,module)}}var s,o=function(t,n){n.exports=function(n){var i=s.map(function(e){return t(e)}).concat(e);n=n||{},n.defined=n.defined||{};if(n.defined[r])return n[r];n.defined[r]=!0;for(var o=0;o<i.length;++o)i[o](n);return n[r]}},u=n;n=function(e,t){return s=typeof e=="string"?t.slice(2):e.slice(2),i?(delete n,u.apply(null,Array.prototype.slice.call(arguments,0))):(n=u,n.apply(null,Array.prototype.slice.call(arguments,0)))},n("js/pem",["require","module","./util"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){function t(t,n){var r=function(){return new e.des.Algorithm(t,n)};e.cipher.registerAlgorithm(t,r)}function n(e){var t=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],n=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],r=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],i=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],s=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],o=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],u=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],a=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],f=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],l=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],c=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],h=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],p=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],d=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],v=e.length()>8?3:1,m=[],g=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],y=0,b;for(var w=0;w<v;w++){var E=e.getInt32(),S=e.getInt32();b=(E>>>4^S)&252645135,S^=b,E^=b<<4,b=(S>>>-16^E)&65535,E^=b,S^=b<<-16,b=(E>>>2^S)&858993459,S^=b,E^=b<<2,b=(S>>>-16^E)&65535,E^=b,S^=b<<-16,b=(E>>>1^S)&1431655765,S^=b,E^=b<<1,b=(S>>>8^E)&16711935,E^=b,S^=b<<8,b=(E>>>1^S)&1431655765,S^=b,E^=b<<1,b=E<<8|S>>>20&240,E=S<<24|S<<8&16711680|S>>>8&65280|S>>>24&240,S=b;for(var x=0;x<g.length;++x){g[x]?(E=E<<2|E>>>26,S=S<<2|S>>>26):(E=E<<1|E>>>27,S=S<<1|S>>>27),E&=-15,S&=-15;var T=t[E>>>28]|n[E>>>24&15]|r[E>>>20&15]|i[E>>>16&15]|s[E>>>12&15]|o[E>>>8&15]|u[E>>>4&15],N=a[S>>>28]|f[S>>>24&15]|l[S>>>20&15]|c[S>>>16&15]|h[S>>>12&15]|p[S>>>8&15]|d[S>>>4&15];b=(N>>>16^T)&65535,m[y++]=T^b,m[y++]=N^b<<16}}return m}function r(e,t,n,r){var i=e.length===32?3:9,p;i===3?p=r?[30,-2,-2]:[0,32,2]:p=r?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var d,v=t[0],m=t[1];d=(v>>>4^m)&252645135,m^=d,v^=d<<4,d=(v>>>16^m)&65535,m^=d,v^=d<<16,d=(m>>>2^v)&858993459,v^=d,m^=d<<2,d=(m>>>8^v)&16711935,v^=d,m^=d<<8,d=(v>>>1^m)&1431655765,m^=d,v^=d<<1,v=v<<1|v>>>31,m=m<<1|m>>>31;for(var g=0;g<i;g+=3){var y=p[g+1],b=p[g+2];for(var w=p[g];w!=y;w+=b){var E=m^e[w],S=(m>>>4|m<<28)^e[w+1];d=v,v=m,m=d^(o[E>>>24&63]|a[E>>>16&63]|l[E>>>8&63]|h[E&63]|s[S>>>24&63]|u[S>>>16&63]|f[S>>>8&63]|c[S&63])}d=v,v=m,m=d}v=v>>>1|v<<31,m=m>>>1|m<<31,d=(v>>>1^m)&1431655765,m^=d,v^=d<<1,d=(m>>>8^v)&16711935,v^=d,m^=d<<8,d=(m>>>2^v)&858993459,v^=d,m^=d<<2,d=(v>>>16^m)&65535,m^=d,v^=d<<16,d=(v>>>4^m)&252645135,m^=d,v^=d<<4,n[0]=v,n[1]=m}function i(t){t=t||{};var n=(t.mode||"CBC").toUpperCase(),r="DES-"+n,i;t.decrypt?i=e.cipher.createDecipher(r,t.key):i=e.cipher.createCipher(r,t.key);var s=i.start;return i.start=function(t,n){var r=null;n instanceof e.util.ByteBuffer&&(r=n,n={}),n=n||{},n.output=r,n.iv=t,s.call(i,n)},i}e.des=e.des||{},e.des.startEncrypting=function(e,t,n,r){var s=i({key:e,output:n,decrypt:!1,mode:r||(t===null?"ECB":"CBC")});return s.start(t),s},e.des.createEncryptionCipher=function(e,t){return i({key:e,output:null,decrypt:!1,mode:t})},e.des.startDecrypting=function(e,t,n,r){var s=i({key:e,output:n,decrypt:!0,mode:r||(t===null?"ECB":"CBC")});return s.start(t),s},e.des.createDecryptionCipher=function(e,t){return i({key:e,output:null,decrypt:!0,mode:t})},e.des.Algorithm=function(e,t){var n=this;n.name=e,n.mode=new t({blockSize:8,cipher:{encrypt:function(e,t){return r(n._keys,e,t,!1)},decrypt:function(e,t){return r(n._keys,e,t,!0)}}}),n._init=!1},e.des.Algorithm.prototype.initialize=function(t){if(this._init)return;var r=e.util.createBuffer(t.key);if(this.name.indexOf("3DES")===0&&r.length()!==24)throw new Error("Invalid Triple-DES key size: "+r.length()*8);this._keys=n(r),this._init=!0},t("DES-ECB",e.cipher.modes.ecb),t("DES-CBC",e.cipher.modes.cbc),t("DES-CFB",e.cipher.modes.cfb),t("DES-OFB",e.cipher.modes.ofb),t("DES-CTR",e.cipher.modes.ctr),t("3DES-ECB",e.cipher.modes.ecb),t("3DES-CBC",e.cipher.modes.cbc),t("3DES-CFB",e.cipher.modes.cfb),t("3DES-OFB",e.cipher.modes.ofb),t("3DES-CTR",e.cipher.modes.ctr);var s=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],o=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],u=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],a=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],f=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],l=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],c=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],h=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696]}var r="des";if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),e(forge);var i=!0;n=function(e,n){n(t,module)}}var s,o=function(t,n){n.exports=function(n){var i=s.map(function(e){return t(e)}).concat(e);n=n||{},n.defined=n.defined||{};if(n.defined[r])return n[r];n.defined[r]=!0;for(var o=0;o<i.length;++o)i[o](n);return n[r]}},u=n;n=function(e,t){return s=typeof e=="string"?t.slice(2):e.slice(2),i?(delete n,u.apply(null,Array.prototype.slice.call(arguments,0))):(n=u,n.apply(null,Array.prototype.slice.call(arguments,0)))},n("js/des",["require","module","./cipher","./cipherModes","./util"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){var n=e.pkcs5=e.pkcs5||{},r=typeof process!="undefined"&&process.versions&&process.versions.node,i;r&&!e.disableNativeCode&&(i=t("crypto")),e.pbkdf2=n.pbkdf2=function(t,n,s,o,u,a){function f(){if(w>p)return a(null,m);v.start(null,null),v.update(n),v.update(e.util.int32ToBytes(w)),g=b=v.digest().getBytes(),E=2,l()}function l(){if(E<=s)return v.start(null,null),v.update(b),y=v.digest().getBytes(),g=e.util.xorBytes(g,y,c),b=y,++E,e.util.setImmediate(l);m+=w<p?g:g.substr(0,d),++w,f()}typeof u=="function"&&(a=u,u=null);if(r&&!e.disableNativeCode&&i.pbkdf2&&(u===null||typeof u!="object")&&(i.pbkdf2Sync.length>4||!u||u==="sha1"))return typeof u!="string"&&(u="sha1"),n=new Buffer(n,"binary"),a?i.pbkdf2Sync.length===4?i.pbkdf2(t,n,s,o,function(e,t){if(e)return a(e);a(null,t.toString("binary"))}):i.pbkdf2(t,n,s,o,u,function(e,t){if(e)return a(e);a(null,t.toString("binary"))}):i.pbkdf2Sync.length===4?i.pbkdf2Sync(t,n,s,o).toString("binary"):i.pbkdf2Sync(t,n,s,o,u).toString("binary");if(typeof u=="undefined"||u===null)u=e.md.sha1.create();if(typeof u=="string"){if(!(u in e.md.algorithms))throw new Error("Unknown hash algorithm: "+u);u=e.md[u].create()}var c=u.digestLength;if(o>4294967295*c){var h=new Error("Derived key is too long.");if(a)return a(h);throw h}var p=Math.ceil(o/c),d=o-(p-1)*c,v=e.hmac.create();v.start(u,t);var m="",g,y,b;if(!a){for(var w=1;w<=p;++w){v.start(null,null),v.update(n),v.update(e.util.int32ToBytes(w)),g=b=v.digest().getBytes();for(var E=2;E<=s;++E)v.start(null,null),v.update(b),y=v.digest().getBytes(),g=e.util.xorBytes(g,y,c),b=y;m+=w<p?g:g.substr(0,d)}return m}var w=1,E;f()}}var r="pbkdf2";if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),e(forge);var i=!0;n=function(e,n){n(t,module)}}var s,o=function(t,n){n.exports=function(n){var i=s.map(function(e){return t(e)}).concat(e);n=n||{},n.defined=n.defined||{};if(n.defined[r])return n[r];n.defined[r]=!0;for(var o=0;o<i.length;++o)i[o](n);return n[r]}},u=n;n=function(e,t){return s=typeof e=="string"?t.slice(2):e.slice(2),i?(delete n,u.apply(null,Array.prototype.slice.call(arguments,0))):(n=u,n.apply(null,Array.prototype.slice.call(arguments,0)))},n("js/pbkdf2",["require","module","./hmac","./md","./util"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){var n=typeof process!="undefined"&&process.versions&&process.versions.node,r=null;!e.disableNativeCode&&n&&!process.versions["node-webkit"]&&(r=t("crypto"));var i=e.prng=e.prng||{};i.create=function(t){function n(e){if(u.pools[0].messageLength>=32)return s(),e();var t=32-u.pools[0].messageLength<<5;u.seedFile(t,function(t,n){if(t)return e(t);u.collect(n),s(),e()})}function i(){if(u.pools[0].messageLength>=32)return s();var e=32-u.pools[0].messageLength<<5;u.collect(u.seedFileSync(e)),s()}function s(){var e=u.plugin.md.create();e.update(u.pools[0].digest().getBytes()),u.pools[0].start();var t=1;for(var n=1;n<32;++n)t=t===31?2147483648:t<<2,t%u.reseeds===0&&(e.update(u.pools[n].digest().getBytes()),u.pools[n].start());var r=e.digest().getBytes();e.start(),e.update(r);var i=e.digest().getBytes();u.key=u.plugin.formatKey(r),u.seed=u.plugin.formatSeed(i),u.reseeds=u.reseeds===4294967295?0:u.reseeds+1,u.generated=0}function o(t){var n=null;if(typeof window!="undefined"){var r=window.crypto||window.msCrypto;r&&r.getRandomValues&&(n=function(e){return r.getRandomValues(e)})}var i=e.util.createBuffer();if(n)while(i.length()<t){var s=Math.max(1,Math.min(t-i.length(),65536)/4),o=new Uint32Array(Math.floor(s));try{n(o);for(var u=0;u<o.length;++u)i.putInt32(o[u])}catch(a){if(!(typeof QuotaExceededError!="undefined"&&a instanceof QuotaExceededError))throw a}}if(i.length()<t){var f,l,c,h=Math.floor(Math.random()*65536);while(i.length()<t){l=16807*(h&65535),f=16807*(h>>16),l+=(f&32767)<<16,l+=f>>15,l=(l&2147483647)+(l>>31),h=l&4294967295;for(var u=0;u<3;++u)c=h>>>(u<<3),c^=Math.floor(Math.random()*256),i.putByte(String.fromCharCode(c&255))}}return i.getBytes(t)}var u={plugin:t,key:null,seed:null,time:null,reseeds:0,generated:0},a=t.md,f=new Array(32);for(var l=0;l<32;++l)f[l]=a.create();return u.pools=f,u.pool=0,u.generate=function(t,r){function i(c){if(c)return r(c);if(l.length()>=t)return r(null,l.getBytes(t));u.generated>1048575&&(u.key=null);if(u.key===null)return e.util.nextTick(function(){n(i)});var h=s(u.key,u.seed);u.generated+=h.length,l.putBytes(h),u.key=a(s(u.key,o(u.seed))),u.seed=f(s(u.key,u.seed)),e.util.setImmediate(i)}if(!r)return u.generateSync(t);var s=u.plugin.cipher,o=u.plugin.increment,a=u.plugin.formatKey,f=u.plugin.formatSeed,l=e.util.createBuffer();u.key=null,i()},u.generateSync=function(t){var n=u.plugin.cipher,r=u.plugin.increment,s=u.plugin.formatKey,o=u.plugin.formatSeed;u.key=null;var a=e.util.createBuffer();while(a.length()<t){u.generated>1048575&&(u.key=null),u.key===null&&i();var f=n(u.key,u.seed);u.generated+=f.length,a.putBytes(f),u.key=s(n(u.key,r(u.seed))),u.seed=o(n(u.key,u.seed))}return a.getBytes(t)},r?(u.seedFile=function(e,t){r.randomBytes(e,function(e,n){if(e)return t(e);t(null,n.toString())})},u.seedFileSync=function(e){return r.randomBytes(e).toString()}):(u.seedFile=function(e,t){try{t(null,o(e))}catch(n){t(n)}},u.seedFileSync=o),u.collect=function(e){var t=e.length;for(var n=0;n<t;++n)u.pools[u.pool].update(e.substr(n,1)),u.pool=u.pool===31?0:u.pool+1},u.collectInt=function(e,t){var n="";for(var r=0;r<t;r+=8)n+=String.fromCharCode(e>>r&255);u.collect(n)},u.registerWorker=function(e){if(e===self)u.seedFile=function(e,t){function n(e){var r=e.data;r.forge&&r.forge.prng&&(self.removeEventListener("message",n),t(r.forge.prng.err,r.forge.prng.bytes))}self.addEventListener("message",n),self.postMessage({forge:{prng:{needed:e}}})};else{var t=function(t){var n=t.data;n.forge&&n.forge.prng&&u.seedFile(n.forge.prng.needed,function(t,n){e.postMessage({forge:{prng:{err:t,bytes:n}}})})};e.addEventListener("message",t)}},u}}var r="prng";if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),e(forge);var i=!0;n=function(e,n){n(t,module)}}var s,o=function(t,n){n.exports=function(n){var i=s.map(function(e){return t(e)}).concat(e);n=n||{},n.defined=n.defined||{};if(n.defined[r])return n[r];n.defined[r]=!0;for(var o=0;o<i.length;++o)i[o](n);return n[r]}},u=n;n=function(e,t){return s=typeof e=="string"?t.slice(2):e.slice(2),i?(delete n,u.apply(null,Array.prototype.slice.call(arguments,0))):(n=u,n.apply(null,Array.prototype.slice.call(arguments,0)))},n("js/prng",["require","module","./md","./util"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){if(e.random&&e.random.getBytes)return;(function(t){function n(){var t=e.prng.create(r);return t.getBytes=function(e,n){return t.generate(e,n)},t.getBytesSync=function(e){return t.generate(e)},t}var r={},i=new Array(4),s=e.util.createBuffer();r.formatKey=function(t){var n=e.util.createBuffer(t);return t=new Array(4),t[0]=n.getInt32(),t[1]=n.getInt32(),t[2]=n.getInt32(),t[3]=n.getInt32(),e.aes._expandKey(t,!1)},r.formatSeed=function(t){var n=e.util.createBuffer(t);return t=new Array(4),t[0]=n.getInt32(),t[1]=n.getInt32(),t[2]=n.getInt32(),t[3]=n.getInt32(),t},r.cipher=function(t,n){return e.aes._updateBlock(t,n,i,!1),s.putInt32(i[0]),s.putInt32(i[1]),s.putInt32(i[2]),s.putInt32(i[3]),s.getBytes()},r.increment=function(e){return++e[3],e},r.md=e.md.sha256;var o=n(),u=typeof process!="undefined"&&process.versions&&process.versions.node,a=null;if(typeof window!="undefined"){var f=window.crypto||window.msCrypto;f&&f.getRandomValues&&(a=function(e){return f.getRandomValues(e)})}if(e.disableNativeCode||!u&&!a){typeof window=="undefined"||window.document===undefined,o.collectInt(+(new Date),32);if(typeof navigator!="undefined"){var l="";for(var c in navigator)try{typeof navigator[c]=="string"&&(l+=navigator[c])}catch(h){}o.collect(l),l=null}t&&(t().mousemove(function(e){o.collectInt(e.clientX,16),o.collectInt(e.clientY,16)}),t().keypress(function(e){o.collectInt(e.charCode,8)}))}if(!e.random)e.random=o;else for(var c in o)e.random[c]=o[c];e.random.createInstance=n})(typeof jQuery!="undefined"?jQuery:null)}var r="random";if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),e(forge);var i=!0;n=function(e,n){n(t,module)}}var s,o=function(t,n){n.exports=function(n){var i=s.map(function(e){return t(e)}).concat(e);n=n||{},n.defined=n.defined||{};if(n.defined[r])return n[r];n.defined[r]=!0;for(var o=0;o<i.length;++o)i[o](n);return n[r]}},u=n;n=function(e,t){return s=typeof e=="string"?t.slice(2):e.slice(2),i?(delete n,u.apply(null,Array.prototype.slice.call(arguments,0))):(n=u,n.apply(null,Array.prototype.slice.call(arguments,0)))},n("js/random",["require","module","./aes","./md","./prng","./util"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){var t=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],n=[1,2,3,5],r=function(e,t){return e<<t&65535|(e&65535)>>16-t},i=function(e,t){return(e&65535)>>t|e<<16-t&65535};e.rc2=e.rc2||{},e.rc2.expandKey=function(n,r){typeof n=="string"&&(n=e.util.createBuffer(n)),r=r||128;var i=n,s=n.length(),o=r,u=Math.ceil(o/8),a=255>>(o&7),f;for(f=s;f<128;f++)i.putByte(t[i.at(f-1)+i.at(f-s)&255]);i.setAt(128-u,t[i.at(128-u)&a]);for(f=127-u;f>=0;f--)i.setAt(f,t[i.at(f+1)^i.at(f+u)]);return i};var s=function(t,s,o){var u=!1,a=null,f=null,l=null,c,h,p,d,v=[];t=e.rc2.expandKey(t,s);for(p=0;p<64;p++)v.push(t.getInt16Le());o?(c=function(e){for(p=0;p<4;p++)e[p]+=v[d]+(e[(p+3)%4]&e[(p+2)%4])+(~e[(p+3)%4]&e[(p+1)%4]),e[p]=r(e[p],n[p]),d++},h=function(e){for(p=0;p<4;p++)e[p]+=v[e[(p+3)%4]&63]}):(c=function(e){for(p=3;p>=0;p--)e[p]=i(e[p],n[p]),e[p]-=v[d]+(e[(p+3)%4]&e[(p+2)%4])+(~e[(p+3)%4]&e[(p+1)%4]),d--},h=function(e){for(p=3;p>=0;p--)e[p]-=v[e[(p+3)%4]&63]});var m=function(e){var t=[];for(p=0;p<4;p++){var n=a.getInt16Le();l!==null&&(o?n^=l.getInt16Le():l.putInt16Le(n)),t.push(n&65535)}d=o?0:63;for(var r=0;r<e.length;r++)for(var i=0;i<e[r][0];i++)e[r][1](t);for(p=0;p<4;p++)l!==null&&(o?l.putInt16Le(t[p]):t[p]^=l.getInt16Le()),f.putInt16Le(t[p])},g=null;return g={start:function(t,n){t&&typeof t=="string"&&(t=e.util.createBuffer(t)),u=!1,a=e.util.createBuffer(),f=n||new e.util.createBuffer,l=t,g.output=f},update:function(e){u||a.putBuffer(e);while(a.length()>=8)m([[5,c],[1,h],[6,c],[1,h],[5,c]])},finish:function(e){var t=!0;if(o)if(e)t=e(8,a,!o);else{var n=a.length()===8?8:8-a.length();a.fillWithByte(n,n)}t&&(u=!0,g.update());if(!o){t=a.length()===0;if(t)if(e)t=e(8,f,!o);else{var r=f.length(),i=f.at(r-1);i>r?t=!1:f.truncate(i)}}return t}},g};e.rc2.startEncrypting=function(t,n,r){var i=e.rc2.createEncryptionCipher(t,128);return i.start(n,r),i},e.rc2.createEncryptionCipher=function(e,t){return s(e,t,!0)},e.rc2.startDecrypting=function(t,n,r){var i=e.rc2.createDecryptionCipher(t,128);return i.start(n,r),i},e.rc2.createDecryptionCipher=function(e,t){return s(e,t,!1)}}var r="rc2";if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),e(forge);var i=!0;n=function(e,n){n(t,module)}}var s,o=function(t,n){n.exports=function(n){var i=s.map(function(e){return t(e)}).concat(e);n=n||{},n.defined=n.defined||{};if(n.defined[r])return n[r];n.defined[r]=!0;for(var o=0;o<i.length;++o)i[o](n);return n[r]}},u=n;n=function(e,t){return s=typeof e=="string"?t.slice(2):e.slice(2),i?(delete n,u.apply(null,Array.prototype.slice.call(arguments,0))):(n=u,n.apply(null,Array.prototype.slice.call(arguments,0)))},n("js/rc2",["require","module","./util"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){function t(e,t,n){this.data=[],e!=null&&("number"==typeof e?this.fromNumber(e,t,n):t==null&&"string"!=typeof e?this.fromString(e,256):this.fromString(e,t))}function n(){return new t(null)}function r(e,t,n,r,i,s){while(--s>=0){var o=t*this.data[e++]+n.data[r]+i;i=Math.floor(o/67108864),n.data[r++]=o&67108863}return i}function i(e,t,n,r,i,s){var o=t&32767,u=t>>15;while(--s>=0){var a=this.data[e]&32767,f=this.data[e++]>>15,l=u*a+f*o;a=o*a+((l&32767)<<15)+n.data[r]+(i&1073741823),i=(a>>>30)+(l>>>15)+u*f+(i>>>30),n.data[r++]=a&1073741823}return i}function s(e,t,n,r,i,s){var o=t&16383,u=t>>14;while(--s>=0){var a=this.data[e]&16383,f=this.data[e++]>>14,l=u*a+f*o;a=o*a+((l&16383)<<14)+n.data[r]+i,i=(a>>28)+(l>>14)+u*f,n.data[r++]=a&268435455}return i}function o(e){return rn.charAt(e)}function u(e,t){var n=sn[e.charCodeAt(t)];return n==null?-1:n}function a(e){for(var t=this.t-1;t>=0;--t)e.data[t]=this.data[t];e.t=this.t,e.s=this.s}function f(e){this.t=1,this.s=e<0?-1:0,e>0?this.data[0]=e:e<-1?this.data[0]=e+this.DV:this.t=0}function l(e){var t=n();return t.fromInt(e),t}function c(e,n){var r;if(n==16)r=4;else if(n==8)r=3;else if(n==256)r=8;else if(n==2)r=1;else if(n==32)r=5;else{if(n!=4){this.fromRadix(e,n);return}r=2}this.t=0,this.s=0;var i=e.length,s=!1,o=0;while(--i>=0){var a=r==8?e[i]&255:u(e,i);if(a<0){e.charAt(i)=="-"&&(s=!0);continue}s=!1,o==0?this.data[this.t++]=a:o+r>this.DB?(this.data[this.t-1]|=(a&(1<<this.DB-o)-1)<<o,this.data[this.t++]=a>>this.DB-o):this.data[this.t-1]|=a<<o,o+=r,o>=this.DB&&(o-=this.DB)}r==8&&(e[0]&128)!=0&&(this.s=-1,o>0&&(this.data[this.t-1]|=(1<<this.DB-o)-1<<o)),this.clamp(),s&&t.ZERO.subTo(this,this)}function h(){var e=this.s&this.DM;while(this.t>0&&this.data[this.t-1]==e)--this.t}function p(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(e==16)t=4;else if(e==8)t=3;else if(e==2)t=1;else if(e==32)t=5;else{if(e!=4)return this.toRadix(e);t=2}var n=(1<<t)-1,r,i=!1,s="",u=this.t,a=this.DB-u*this.DB%t;if(u-->0){a<this.DB&&(r=this.data[u]>>a)>0&&(i=!0,s=o(r));while(u>=0)a<t?(r=(this.data[u]&(1<<a)-1)<<t-a,r|=this.data[--u]>>(a+=this.DB-t)):(r=this.data[u]>>(a-=t)&n,a<=0&&(a+=this.DB,--u)),r>0&&(i=!0),i&&(s+=o(r))}return i?s:"0"}function d(){var e=n();return t.ZERO.subTo(this,e),e}function v(){return this.s<0?this.negate():this}function m(e){var t=this.s-e.s;if(t!=0)return t;var n=this.t;t=n-e.t;if(t!=0)return this.s<0?-t:t;while(--n>=0)if((t=this.data[n]-e.data[n])!=0)return t;return 0}function g(e){var t=1,n;return(n=e>>>16)!=0&&(e=n,t+=16),(n=e>>8)!=0&&(e=n,t+=8),(n=e>>4)!=0&&(e=n,t+=4),(n=e>>2)!=0&&(e=n,t+=2),(n=e>>1)!=0&&(e=n,t+=1),t}function y(){return this.t<=0?0:this.DB*(this.t-1)+g(this.data[this.t-1]^this.s&this.DM)}function b(e,t){var n;for(n=this.t-1;n>=0;--n)t.data[n+e]=this.data[n];for(n=e-1;n>=0;--n)t.data[n]=0;t.t=this.t+e,t.s=this.s}function w(e,t){for(var n=e;n<this.t;++n)t.data[n-e]=this.data[n];t.t=Math.max(this.t-e,0),t.s=this.s}function E(e,t){var n=e%this.DB,r=this.DB-n,i=(1<<r)-1,s=Math.floor(e/this.DB),o=this.s<<n&this.DM,u;for(u=this.t-1;u>=0;--u)t.data[u+s+1]=this.data[u]>>r|o,o=(this.data[u]&i)<<n;for(u=s-1;u>=0;--u)t.data[u]=0;t.data[s]=o,t.t=this.t+s+1,t.s=this.s,t.clamp()}function S(e,t){t.s=this.s;var n=Math.floor(e/this.DB);if(n>=this.t){t.t=0;return}var r=e%this.DB,i=this.DB-r,s=(1<<r)-1;t.data[0]=this.data[n]>>r;for(var o=n+1;o<this.t;++o)t.data[o-n-1]|=(this.data[o]&s)<<i,t.data[o-n]=this.data[o]>>r;r>0&&(t.data[this.t-n-1]|=(this.s&s)<<i),t.t=this.t-n,t.clamp()}function x(e,t){var n=0,r=0,i=Math.min(e.t,this.t);while(n<i)r+=this.data[n]-e.data[n],t.data[n++]=r&this.DM,r>>=this.DB;if(e.t<this.t){r-=e.s;while(n<this.t)r+=this.data[n],t.data[n++]=r&this.DM,r>>=this.DB;r+=this.s}else{r+=this.s;while(n<e.t)r-=e.data[n],t.data[n++]=r&this.DM,r>>=this.DB;r-=e.s}t.s=r<0?-1:0,r<-1?t.data[n++]=this.DV+r:r>0&&(t.data[n++]=r),t.t=n,t.clamp()}function T(e,n){var r=this.abs(),i=e.abs(),s=r.t;n.t=s+i.t;while(--s>=0)n.data[s]=0;for(s=0;s<i.t;++s)n.data[s+r.t]=r.am(0,i.data[s],n,s,0,r.t);n.s=0,n.clamp(),this.s!=e.s&&t.ZERO.subTo(n,n)}function N(e){var t=this.abs(),n=e.t=2*t.t;while(--n>=0)e.data[n]=0;for(n=0;n<t.t-1;++n){var r=t.am(n,t.data[n],e,2*n,0,1);(e.data[n+t.t]+=t.am(n+1,2*t.data[n],e,2*n+1,r,t.t-n-1))>=t.DV&&(e.data[n+t.t]-=t.DV,e.data[n+t.t+1]=1)}e.t>0&&(e.data[e.t-1]+=t.am(n,t.data[n],e,2*n,0,1)),e.s=0,e.clamp()}function C(e,r,i){var s=e.abs();if(s.t<=0)return;var o=this.abs();if(o.t<s.t){r!=null&&r.fromInt(0),i!=null&&this.copyTo(i);return}i==null&&(i=n());var u=n(),a=this.s,f=e.s,l=this.DB-g(s.data[s.t-1]);l>0?(s.lShiftTo(l,u),o.lShiftTo(l,i)):(s.copyTo(u),o.copyTo(i));var c=u.t,h=u.data[c-1];if(h==0)return;var p=h*(1<<this.F1)+(c>1?u.data[c-2]>>this.F2:0),d=this.FV/p,v=(1<<this.F1)/p,m=1<<this.F2,y=i.t,b=y-c,w=r==null?n():r;u.dlShiftTo(b,w),i.compareTo(w)>=0&&(i.data[i.t++]=1,i.subTo(w,i)),t.ONE.dlShiftTo(c,w),w.subTo(u,u);while(u.t<c)u.data[u.t++]=0;while(--b>=0){var E=i.data[--y]==h?this.DM:Math.floor(i.data[y]*d+(i.data[y-1]+m)*v);if((i.data[y]+=u.am(0,E,i,b,0,c))<E){u.dlShiftTo(b,w),i.subTo(w,i);while(i.data[y]<--E)i.subTo(w,i)}}r!=null&&(i.drShiftTo(c,r),a!=f&&t.ZERO.subTo(r,r)),i.t=c,i.clamp(),l>0&&i.rShiftTo(l,i),a<0&&t.ZERO.subTo(i,i)}function k(e){var r=n();return this.abs().divRemTo(e,null,r),this.s<0&&r.compareTo(t.ZERO)>0&&e.subTo(r,r),r}function L(e){this.m=e}function A(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e}function O(e){return e}function M(e){e.divRemTo(this.m,null,e)}function _(e,t,n){e.multiplyTo(t,n),this.reduce(n)}function D(e,t){e.squareTo(t),this.reduce(t)}function P(){if(this.t<1)return 0;var e=this.data[0];if((e&1)==0)return 0;var t=e&3;return t=t*(2-(e&15)*t)&15,t=t*(2-(e&255)*t)&255,t=t*(2-((e&65535)*t&65535))&65535,t=t*(2-e*t%this.DV)%this.DV,t>0?this.DV-t:-t}function H(e){this.m=e,this.mp=e.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function B(e){var r=n();return e.abs().dlShiftTo(this.m.t,r),r.divRemTo(this.m,null,r),e.s<0&&r.compareTo(t.ZERO)>0&&this.m.subTo(r,r),r}function j(e){var t=n();return e.copyTo(t),this.reduce(t),t}function F(e){while(e.t<=this.mt2)e.data[e.t++]=0;for(var t=0;t<this.m.t;++t){var n=e.data[t]&32767,r=n*this.mpl+((n*this.mph+(e.data[t]>>15)*this.mpl&this.um)<<15)&e.DM;n=t+this.m.t,e.data[n]+=this.m.am(0,r,e,t,0,this.m.t);while(e.data[n]>=e.DV)e.data[n]-=e.DV,e.data[++n]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)}function I(e,t){e.squareTo(t),this.reduce(t)}function q(e,t,n){e.multiplyTo(t,n),this.reduce(n)}function R(){return(this.t>0?this.data[0]&1:this.s)==0}function U(e,r){if(e>4294967295||e<1)return t.ONE;var i=n(),s=n(),o=r.convert(this),u=g(e)-1;o.copyTo(i);while(--u>=0){r.sqrTo(i,s);if((e&1<<u)>0)r.mulTo(s,o,i);else{var a=i;i=s,s=a}}return r.revert(i)}function z(e,t){var n;return e<256||t.isEven()?n=new L(t):n=new H(t),this.exp(e,n)}function W(){var e=n();return this.copyTo(e),e}function X(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function V(){return this.t==0?this.s:this.data[0]<<24>>24}function $(){return this.t==0?this.s:this.data[0]<<16>>16}function J(e){return Math.floor(Math.LN2*this.DB/Math.log(e))}function K(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function Q(e){e==null&&(e=10);if(this.signum()==0||e<2||e>36)return"0";var t=this.chunkSize(e),r=Math.pow(e,t),i=l(r),s=n(),o=n(),u="";this.divRemTo(i,s,o);while(s.signum()>0)u=(r+o.intValue()).toString(e).substr(1)+u,s.divRemTo(i,s,o);return o.intValue().toString(e)+u}function G(e,n){this.fromInt(0),n==null&&(n=10);var r=this.chunkSize(n),i=Math.pow(n,r),s=!1,o=0,a=0;for(var f=0;f<e.length;++f){var l=u(e,f);if(l<0){e.charAt(f)=="-"&&this.signum()==0&&(s=!0);continue}a=n*a+l,++o>=r&&(this.dMultiply(i),this.dAddOffset(a,0),o=0,a=0)}o>0&&(this.dMultiply(Math.pow(n,o)),this.dAddOffset(a,0)),s&&t.ZERO.subTo(this,this)}function Y(e,n,r){if("number"==typeof n)if(e<2)this.fromInt(1);else{this.fromNumber(e,r),this.testBit(e-1)||this.bitwiseTo(t.ONE.shiftLeft(e-1),ot,this),this.isEven()&&this.dAddOffset(1,0);while(!this.isProbablePrime(n))this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(t.ONE.shiftLeft(e-1),this)}else{var i=new Array,s=e&7;i.length=(e>>3)+1,n.nextBytes(i),s>0?i[0]&=(1<<s)-1:i[0]=0,this.fromString(i,256)}}function Z(){var e=this.t,t=new Array;t[0]=this.s;var n=this.DB-e*this.DB%8,r,i=0;if(e-->0){n<this.DB&&(r=this.data[e]>>n)!=(this.s&this.DM)>>n&&(t[i++]=r|this.s<<this.DB-n);while(e>=0){n<8?(r=(this.data[e]&(1<<n)-1)<<8-n,r|=this.data[--e]>>(n+=this.DB-8)):(r=this.data[e]>>(n-=8)&255,n<=0&&(n+=this.DB,--e)),(r&128)!=0&&(r|=-256),i==0&&(this.s&128)!=(r&128)&&++i;if(i>0||r!=this.s)t[i++]=r}}return t}function et(e){return this.compareTo(e)==0}function tt(e){return this.compareTo(e)<0?this:e}function nt(e){return this.compareTo(e)>0?this:e}function rt(e,t,n){var r,i,s=Math.min(e.t,this.t);for(r=0;r<s;++r)n.data[r]=t(this.data[r],e.data[r]);if(e.t<this.t){i=e.s&this.DM;for(r=s;r<this.t;++r)n.data[r]=t(this.data[r],i);n.t=this.t}else{i=this.s&this.DM;for(r=s;r<e.t;++r)n.data[r]=t(i,e.data[r]);n.t=e.t}n.s=t(this.s,e.s),n.clamp()}function it(e,t){return e&t}function st(e){var t=n();return this.bitwiseTo(e,it,t),t}function ot(e,t){return e|t}function ut(e){var t=n();return this.bitwiseTo(e,ot,t),t}function at(e,t){return e^t}function ft(e){var t=n();return this.bitwiseTo(e,at,t),t}function lt(e,t){return e&~t}function ct(e){var t=n();return this.bitwiseTo(e,lt,t),t}function ht(){var e=n();for(var t=0;t<this.t;++t)e.data[t]=this.DM&~this.data[t];return e.t=this.t,e.s=~this.s,e}function pt(e){var t=n();return e<0?this.rShiftTo(-e,t):this.lShiftTo(e,t),t}function dt(e){var t=n();return e<0?this.lShiftTo(-e,t):this.rShiftTo(e,t),t}function vt(e){if(e==0)return-1;var t=0;return(e&65535)==0&&(e>>=16,t+=16),(e&255)==0&&(e>>=8,t+=8),(e&15)==0&&(e>>=4,t+=4),(e&3)==0&&(e>>=2,t+=2),(e&1)==0&&++t,t}function mt(){for(var e=0;e<this.t;++e)if(this.data[e]!=0)return e*this.DB+vt(this.data[e]);return this.s<0?this.t*this.DB:-1}function gt(e){var t=0;while(e!=0)e&=e-1,++t;return t}function yt(){var e=0,t=this.s&this.DM;for(var n=0;n<this.t;++n)e+=gt(this.data[n]^t);return e}function bt(e){var t=Math.floor(e/this.DB);return t>=this.t?this.s!=0:(this.data[t]&1<<e%this.DB)!=0}function wt(e,n){var r=t.ONE.shiftLeft(e);return this.bitwiseTo(r,n,r),r}function Et(e){return this.changeBit(e,ot)}function St(e){return this.changeBit(e,lt)}function xt(e){return this.changeBit(e,at)}function Tt(e,t){var n=0,r=0,i=Math.min(e.t,this.t);while(n<i)r+=this.data[n]+e.data[n],t.data[n++]=r&this.DM,r>>=this.DB;if(e.t<this.t){r+=e.s;while(n<this.t)r+=this.data[n],t.data[n++]=r&this.DM,r>>=this.DB;r+=this.s}else{r+=this.s;while(n<e.t)r+=e.data[n],t.data[n++]=r&this.DM,r>>=this.DB;r+=e.s}t.s=r<0?-1:0,r>0?t.data[n++]=r:r<-1&&(t.data[n++]=this.DV+r),t.t=n,t.clamp()}function Nt(e){var t=n();return this.addTo(e,t),t}function Ct(e){var t=n();return this.subTo(e,t),t}function kt(e){var t=n();return this.multiplyTo(e,t),t}function Lt(e){var t=n();return this.divRemTo(e,t,null),t}function At(e){var t=n();return this.divRemTo(e,null,t),t}function Ot(e){var t=n(),r=n();return this.divRemTo(e,t,r),new Array(t,r)}function Mt(e){this.data[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()}function _t(e,t){if(e==0)return;while(this.t<=t)this.data[this.t++]=0;this.data[t]+=e;while(this.data[t]>=this.DV)this.data[t]-=this.DV,++t>=this.t&&(this.data[this.t++]=0),++this.data[t]}function Dt(){}function Pt(e){return e}function Ht(e,t,n){e.multiplyTo(t,n)}function Bt(e,t){e.squareTo(t)}function jt(e){return this.exp(e,new Dt)}function Ft(e,t,n){var r=Math.min(this.t+e.t,t);n.s=0,n.t=r;while(r>0)n.data[--r]=0;var i;for(i=n.t-this.t;r<i;++r)n.data[r+this.t]=this.am(0,e.data[r],n,r,0,this.t);for(i=Math.min(e.t,t);r<i;++r)this.am(0,e.data[r],n,r,0,t-r);n.clamp()}function It(e,t,n){--t;var r=n.t=this.t+e.t-t;n.s=0;while(--r>=0)n.data[r]=0;for(r=Math.max(t-this.t,0);r<e.t;++r)n.data[this.t+r-t]=this.am(t-r,e.data[r],n,0,0,this.t+r-t);n.clamp(),n.drShiftTo(1,n)}function qt(e){this.r2=n(),this.q3=n(),t.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e}function Rt(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var t=n();return e.copyTo(t),this.reduce(t),t}function Ut(e){return e}function zt(e){e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);while(e.compareTo(this.r2)<0)e.dAddOffset(1,this.m.t+1);e.subTo(this.r2,e);while(e.compareTo(this.m)>=0)e.subTo(this.m,e)}function Wt(e,t){e.squareTo(t),this.reduce(t)}function Xt(e,t,n){e.multiplyTo(t,n),this.reduce(n)}function Vt(e,t){var r=e.bitLength(),i,s=l(1),o;if(r<=0)return s;r<18?i=1:r<48?i=3:r<144?i=4:r<768?i=5:i=6,r<8?o=new L(t):t.isEven()?o=new qt(t):o=new H(t);var u=new Array,a=3,f=i-1,c=(1<<i)-1;u[1]=o.convert(this);if(i>1){var h=n();o.sqrTo(u[1],h);while(a<=c)u[a]=n(),o.mulTo(h,u[a-2],u[a]),a+=2}var p=e.t-1,d,v=!0,m=n(),y;r=g(e.data[p])-1;while(p>=0){r>=f?d=e.data[p]>>r-f&c:(d=(e.data[p]&(1<<r+1)-1)<<f-r,p>0&&(d|=e.data[p-1]>>this.DB+r-f)),a=i;while((d&1)==0)d>>=1,--a;(r-=a)<0&&(r+=this.DB,--p);if(v)u[d].copyTo(s),v=!1;else{while(a>1)o.sqrTo(s,m),o.sqrTo(m,s),a-=2;a>0?o.sqrTo(s,m):(y=s,s=m,m=y),o.mulTo(m,u[d],s)}while(p>=0&&(e.data[p]&1<<r)==0)o.sqrTo(s,m),y=s,s=m,m=y,--r<0&&(r=this.DB-1,--p)}return o.revert(s)}function $t(e){var t=this.s<0?this.negate():this.clone(),n=e.s<0?e.negate():e.clone();if(t.compareTo(n)<0){var r=t;t=n,n=r}var i=t.getLowestSetBit(),s=n.getLowestSetBit();if(s<0)return t;i<s&&(s=i),s>0&&(t.rShiftTo(s,t),n.rShiftTo(s,n));while(t.signum()>0)(i=t.getLowestSetBit())>0&&t.rShiftTo(i,t),(i=n.getLowestSetBit())>0&&n.rShiftTo(i,n),t.compareTo(n)>=0?(t.subTo(n,t),t.rShiftTo(1,t)):(n.subTo(t,n),n.rShiftTo(1,n));return s>0&&n.lShiftTo(s,n),n}function Jt(e){if(e<=0)return 0;var t=this.DV%e,n=this.s<0?e-1:0;if(this.t>0)if(t==0)n=this.data[0]%e;else for(var r=this.t-1;r>=0;--r)n=(t*n+this.data[r])%e;return n}function Kt(e){var n=e.isEven();if(this.isEven()&&n||e.signum()==0)return t.ZERO;var r=e.clone(),i=this.clone(),s=l(1),o=l(0),u=l(0),a=l(1);while(r.signum()!=0){while(r.isEven()){r.rShiftTo(1,r);if(n){if(!s.isEven()||!o.isEven())s.addTo(this,s),o.subTo(e,o);s.rShiftTo(1,s)}else o.isEven()||o.subTo(e,o);o.rShiftTo(1,o)}while(i.isEven()){i.rShiftTo(1,i);if(n){if(!u.isEven()||!a.isEven())u.addTo(this,u),a.subTo(e,a);u.rShiftTo(1,u)}else a.isEven()||a.subTo(e,a);a.rShiftTo(1,a)}r.compareTo(i)>=0?(r.subTo(i,r),n&&s.subTo(u,s),o.subTo(a,o)):(i.subTo(r,i),n&&u.subTo(s,u),a.subTo(o,a))}return i.compareTo(t.ONE)!=0?t.ZERO:a.compareTo(e)>=0?a.subtract(e):a.signum()<0?(a.addTo(e,a),a.signum()<0?a.add(e):a):a}function Qt(e){var t,n=this.abs();if(n.t==1&&n.data[0]<=an[an.length-1]){for(t=0;t<an.length;++t)if(n.data[0]==an[t])return!0;return!1}if(n.isEven())return!1;t=1;while(t<an.length){var r=an[t],i=t+1;while(i<an.length&&r<fn)r*=an[i++];r=n.modInt(r);while(t<i)if(r%an[t++]==0)return!1}return n.millerRabin(e)}function Gt(e){var n=this.subtract(t.ONE),r=n.getLowestSetBit();if(r<=0)return!1;var i=n.shiftRight(r),s=Yt(),o;for(var u=0;u<e;++u){do o=new t(this.bitLength(),s);while(o.compareTo(t.ONE)<=0||o.compareTo(n)>=0);var a=o.modPow(i,this);if(a.compareTo(t.ONE)!=0&&a.compareTo(n)!=0){var f=1;while(f++<r&&a.compareTo(n)!=0){a=a.modPowInt(2,this);if(a.compareTo(t.ONE)==0)return!1}if(a.compareTo(n)!=0)return!1}}return!0}function Yt(){return{nextBytes:function(e){for(var t=0;t<e.length;++t)e[t]=Math.floor(Math.random()*256)}}}var Zt,en=0xdeadbeefcafe,tn=(en&16777215)==15715070;typeof navigator=="undefined"?(t.prototype.am=s,Zt=28):tn&&navigator.appName=="Microsoft Internet Explorer"?(t.prototype.am=i,Zt=30):tn&&navigator.appName!="Netscape"?(t.prototype.am=r,Zt=26):(t.prototype.am=s,Zt=28),t.prototype.DB=Zt,t.prototype.DM=(1<<Zt)-1,t.prototype.DV=1<<Zt;var nn=52;t.prototype.FV=Math.pow(2,nn),t.prototype.F1=nn-Zt,t.prototype.F2=2*Zt-nn;var rn="0123456789abcdefghijklmnopqrstuvwxyz",sn=new Array,on,un;on="0".charCodeAt(0);for(un=0;un<=9;++un)sn[on++]=un;on="a".charCodeAt(0);for(un=10;un<36;++un)sn[on++]=un;on="A".charCodeAt(0);for(un=10;un<36;++un)sn[on++]=un;L.prototype.convert=A,L.prototype.revert=O,L.prototype.reduce=M,L.prototype.mulTo=_,L.prototype.sqrTo=D,H.prototype.convert=B,H.prototype.revert=j,H.prototype.reduce=F,H.prototype.mulTo=q,H.prototype.sqrTo=I,t.prototype.copyTo=a,t.prototype.fromInt=f,t.prototype.fromString=c,t.prototype.clamp=h,t.prototype.dlShiftTo=b,t.prototype.drShiftTo=w,t.prototype.lShiftTo=E,t.prototype.rShiftTo=S,t.prototype.subTo=x,t.prototype.multiplyTo=T,t.prototype.squareTo=N,t.prototype.divRemTo=C,t.prototype.invDigit=P,t.prototype.isEven=R,t.prototype.exp=U,t.prototype.toString=p,t.prototype.negate=d,t.prototype.abs=v,t.prototype.compareTo=m,t.prototype.bitLength=y,t.prototype.mod=k,t.prototype.modPowInt=z,t.ZERO=l(0),t.ONE=l(1),Dt.prototype.convert=Pt,Dt.prototype.revert=Pt,Dt.prototype.mulTo=Ht,Dt.prototype.sqrTo=Bt,qt.prototype.convert=Rt,qt.prototype.revert=Ut,qt.prototype.reduce=zt,qt.prototype.mulTo=Xt,qt.prototype.sqrTo=Wt;var an=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],fn=(1<<26)/an[an.length-1];t.prototype.chunkSize=J,t.prototype.toRadix=Q,t.prototype.fromRadix=G,t.prototype.fromNumber=Y,t.prototype.bitwiseTo=rt,t.prototype.changeBit=wt,t.prototype.addTo=Tt,t.prototype.dMultiply=Mt,t.prototype.dAddOffset=_t,t.prototype.multiplyLowerTo=Ft,t.prototype.multiplyUpperTo=It,t.prototype.modInt=Jt,t.prototype.millerRabin=Gt,t.prototype.clone=W,t.prototype.intValue=X,t.prototype.byteValue=V,t.prototype.shortValue=$,t.prototype.signum=K,t.prototype.toByteArray=Z,t.prototype.equals=et,t.prototype.min=tt,t.prototype.max=nt,t.prototype.and=st,t.prototype.or=ut,t.prototype.xor=ft,t.prototype.andNot=ct,t.prototype.not=ht,t.prototype.shiftLeft=pt,t.prototype.shiftRight=dt,t.prototype.getLowestSetBit=mt,t.prototype.bitCount=yt,t.prototype.testBit=bt,t.prototype.setBit=Et,t.prototype.clearBit=St,t.prototype.flipBit=xt,t.prototype.add=Nt,t.prototype.subtract=Ct,t.prototype.multiply=kt,t.prototype.divide=Lt,t.prototype.remainder=At,t.prototype.divideAndRemainder=Ot,t.prototype.modPow=Vt,t.prototype.modInverse=Kt,t.prototype.pow=jt,t.prototype.gcd=$t,t.prototype.isProbablePrime=Qt,e.jsbn=e.jsbn||{},e.jsbn.BigInteger=t}var r="jsbn";if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),e(forge);var i=!0;n=function(e,n){n(t,module)}}var s,o=function(t,n){n.exports=function(n){var i=s.map(function(e){return t(e)}).concat(e);n=n||{},n.defined=n.defined||{};if(n.defined[r])return n[r];n.defined[r]=!0;for(var o=0;o<i.length;++o)i[o](n);return n[r]}},u=n;n=function(e,t){return s=typeof e=="string"?t.slice(2):e.slice(2),i?(delete n,u.apply(null,Array.prototype.slice.call(arguments,0))):(n=u,n.apply(null,Array.prototype.slice.call(arguments,0)))},n("js/jsbn",["require","module"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){function t(t,n,r){r||(r=e.md.sha1.create());var i="",s=Math.ceil(n/r.digestLength);for(var o=0;o<s;++o){var u=String.fromCharCode(o>>24&255,o>>16&255,o>>8&255,o&255);r.start(),r.update(t+u),i+=r.digest().getBytes()}return i.substring(0,n)}var n=e.pkcs1=e.pkcs1||{};n.encode_rsa_oaep=function(n,r,i){var s,o,u,a;typeof i=="string"?(s=i,o=arguments[3]||undefined,u=arguments[4]||undefined):i&&(s=i.label||undefined,o=i.seed||undefined,u=i.md||undefined,i.mgf1&&i.mgf1.md&&(a=i.mgf1.md)),u?u.start():u=e.md.sha1.create(),a||(a=u);var f=Math.ceil(n.n.bitLength()/8),l=f-2*u.digestLength-2;if(r.length>l){var c=new Error("RSAES-OAEP input message length is too long.");throw c.length=r.length,c.maxLength=l,c}s||(s=""),u.update(s,"raw");var h=u.digest(),p="",d=l-r.length;for(var v=0;v<d;v++)p+="\0";var m=h.getBytes()+p+""+r;if(!o)o=e.random.getBytes(u.digestLength);else if(o.length!==u.digestLength){var c=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw c.seedLength=o.length,c.digestLength=u.digestLength,c}var g=t(o,f-u.digestLength-1,a),y=e.util.xorBytes(m,g,m.length),b=t(y,u.digestLength,a),w=e.util.xorBytes(o,b,o.length);return"\0"+w+y},n.decode_rsa_oaep=function(n,r,i){var s,o,u;typeof i=="string"?(s=i,o=arguments[3]||undefined):i&&(s=i.label||undefined,o=i.md||undefined,i.mgf1&&i.mgf1.md&&(u=i.mgf1.md));var a=Math.ceil(n.n.bitLength()/8);if(r.length!==a){var f=new Error("RSAES-OAEP encoded message length is invalid.");throw f.length=r.length,f.expectedLength=a,f}o===undefined?o=e.md.sha1.create():o.start(),u||(u=o);if(a<2*o.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");s||(s=""),o.update(s,"raw");var l=o.digest().getBytes(),c=r.charAt(0),h=r.substring(1,o.digestLength+1),p=r.substring(1+o.digestLength),d=t(p,o.digestLength,u),v=e.util.xorBytes(h,d,h.length),m=t(v,a-o.digestLength-1,u),g=e.util.xorBytes(p,m,p.length),y=g.substring(0,o.digestLength),f=c!=="\0";for(var b=0;b<o.digestLength;++b)f|=l.charAt(b)!==y.charAt(b);var w=1,E=o.digestLength;for(var S=o.digestLength;S<g.length;S++){var x=g.charCodeAt(S),T=x&1^1,N=w?65534:0;f|=x&N,w&=T,E+=w}if(f||g.charCodeAt(E)!==1)throw new Error("Invalid RSAES-OAEP padding.");return g.substring(E+1)}}var r="pkcs1";if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),e(forge);var i=!0;n=function(e,n){n(t,module)}}var s,o=function(t,n){n.exports=function(n){var i=s.map(function(e){return t(e)}).concat(e);n=n||{},n.defined=n.defined||{};if(n.defined[r])return n[r];n.defined[r]=!0;for(var o=0;o<i.length;++o)i[o](n);return n[r]}},u=n;n=function(e,t){return s=typeof e=="string"?t.slice(2):e.slice(2),i?(delete n,u.apply(null,Array.prototype.slice.call(arguments,0))):(n=u,n.apply(null,Array.prototype.slice.call(arguments,0)))},n("js/pkcs1",["require","module","./util","./random","./sha1"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){function t(e,t,i,s){return"workers"in i?r(e,t,i,s):n(e,t,i,s)}function n(t,r,o,u){var f=i(t,r),l=0,c=s(f.bitLength());"millerRabinTests"in o&&(c=o.millerRabinTests);var h=10;"maxBlockTime"in o&&(h=o.maxBlockTime);var p=+(new Date);do{f.bitLength()>t&&(f=i(t,r));if(f.isProbablePrime(c))return u(null,f);f.dAddOffset(a[l++%8],0)}while(h<0||+(new Date)-p<h);e.util.setImmediate(function(){n(t,r,o,u)})}function r(t,r,s,o){function a(){function e(e){if(d)return;--a;var s=e.data;if(s.found){for(var l=0;l<n.length;++l)n[l].terminate();return d=!0,o(null,new u(s.prime,16))}f.bitLength()>t&&(f=i(t,r));var p=f.toString(16);e.target.postMessage({hex:p,workLoad:c}),f.dAddOffset(h,0)}l=Math.max(1,l);var n=[];for(var s=0;s<l;++s)n[s]=new Worker(p);var a=l;for(var s=0;s<l;++s)n[s].addEventListener("message",e);var d=!1}if(typeof Worker=="undefined")return n(t,r,s,o);var f=i(t,r),l=s.workers,c=s.workLoad||100,h=c*30/8,p=s.workerScript||"forge/prime.worker.js";if(l===-1)return e.util.estimateCores(function(e,t){e&&(t=2),l=t-1,a()});a()}function i(e,t){var n=new u(e,t),r=e-1;return n.testBit(r)||n.bitwiseTo(u.ONE.shiftLeft(r),l,n),n.dAddOffset(31-n.mod(f).byteValue(),0),n}function s(e){return e<=100?27:e<=150?18:e<=200?15:e<=250?12:e<=300?9:e<=350?8:e<=400?7:e<=500?6:e<=600?5:e<=800?4:e<=1250?3:2}if(e.prime)return;var o=e.prime=e.prime||{},u=e.jsbn.BigInteger,a=[6,4,2,4,2,4,6,2],f=new u(null);f.fromInt(30);var l=function(e,t){return e|t};o.generateProbablePrime=function(n,r,i){typeof r=="function"&&(i=r,r={}),r=r||{};var s=r.algorithm||"PRIMEINC";typeof s=="string"&&(s={name:s}),s.options=s.options||{};var o=r.prng||e.random,u={nextBytes:function(e){var t=o.getBytesSync(e.length);for(var n=0;n<e.length;++n)e[n]=t.charCodeAt(n)}};if(s.name==="PRIMEINC")return t(n,u,s.options,i);throw new Error("Invalid prime generation algorithm: "+s.name)}}var r="prime";if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),e(forge);var i=!0;n=function(e,n){n(t,module)}}var s,o=function(t,n){n.exports=function(n){var i=s.map(function(e){return t(e)}).concat(e);n=n||{},n.defined=n.defined||{};if(n.defined[r])return n[r];n.defined[r]=!0;for(var o=0;o<i.length;++o)i[o](n);return n[r]}},u=n;n=function(e,t){return s=typeof e=="string"?t.slice(2):e.slice(2),i?(delete n,u.apply(null,Array.prototype.slice.call(arguments,0))):(n=u,n.apply(null,Array.prototype.slice.call(arguments,0)))},n("js/prime",["require","module","./util","./jsbn","./random"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){function t(t,n,r){var i=e.util.createBuffer(),s=Math.ceil(n.n.bitLength()/8);if(t.length>s-11){var o=new Error("Message is too long for PKCS#1 v1.5 padding.");throw o.length=t.length,o.max=s-11,o}i.putByte(0),i.putByte(r);var u=s-3-t.length,a;if(r===0||r===1){a=r===0?0:255;for(var f=0;f<u;++f)i.putByte(a)}else while(u>0){var l=0,c=e.random.getBytes(u);for(var f=0;f<u;++f)a=c.charCodeAt(f),a===0?++l:i.putByte(a);u=l}return i.putByte(0),i.putBytes(t),i}function n(t,n,r,i){var s=Math.ceil(n.n.bitLength()/8),o=e.util.createBuffer(t),u=o.getByte(),a=o.getByte();if(u!==0||r&&a!==0&&a!==1||!r&&a!=2||r&&a===0&&typeof i=="undefined")throw new Error("Encryption block is invalid.");var f=0;if(a===0){f=s-3-i;for(var l=0;l<f;++l)if(o.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(a===1){f=0;while(o.length()>1){if(o.getByte()!==255){--o.read;break}++f}}else if(a===2){f=0;while(o.length()>1){if(o.getByte()===0){--o.read;break}++f}}var c=o.getByte();if(c!==0||f!==s-3-o.length())throw new Error("Encryption block is invalid.");return o.getBytes()}function r(t,n,r){function i(){s(t.pBits,function(e,n){if(e)return r(e);t.p=n;if(t.q!==null)return u(e,t.q);s(t.qBits,u)})}function s(t,n){e.prime.generateProbablePrime(t,f,n)}function u(e,n){if(e)return r(e);t.q=n;if(t.p.compareTo(t.q)<0){var f=t.p;t.p=t.q,t.q=f}if(t.p.subtract(o.ONE).gcd(t.e).compareTo(o.ONE)!==0){t.p=null,i();return}if(t.q.subtract(o.ONE).gcd(t.e).compareTo(o.ONE)!==0){t.q=null,s(t.qBits,u);return}t.p1=t.p.subtract(o.ONE),t.q1=t.q.subtract(o.ONE),t.phi=t.p1.multiply(t.q1);if(t.phi.gcd(t.e).compareTo(o.ONE)!==0){t.p=t.q=null,i();return}t.n=t.p.multiply(t.q);if(t.n.bitLength()!==t.bits){t.q=null,s(t.qBits,u);return}var l=t.e.modInverse(t.phi);t.keys={privateKey:a.rsa.setPrivateKey(t.n,t.e,l,t.p,t.q,l.mod(t.p1),l.mod(t.q1),t.q.modInverse(t.p)),publicKey:a.rsa.setPublicKey(t.n,t.e)},r(null,t.keys)}typeof n=="function"&&(r=n,n={}),n=n||{};var f={algorithm:{name:n.algorithm||"PRIMEINC",options:{workers:n.workers||2,workLoad:n.workLoad||100,workerScript:n.workerScript}}};"prng"in n&&(f.prng=n.prng),i()}function i(t){var n=t.toString(16);return n[0]>="8"&&(n="00"+n),e.util.hexToBytes(n)}function s(e){return e<=100?27:e<=150?18:e<=200?15:e<=250?12:e<=300?9:e<=350?8:e<=400?7:e<=500?6:e<=600?5:e<=800?4:e<=1250?3:2}if(typeof o=="undefined")var o=e.jsbn.BigInteger;var u=e.asn1;e.pki=e.pki||{},e.pki.rsa=e.rsa=e.rsa||{};var a=e.pki,f=[6,4,2,4,2,4,6,2],l={name:"PrivateKeyInfo",tagClass:u.Class.UNIVERSAL,type:u.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:u.Class.UNIVERSAL,type:u.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:u.Class.UNIVERSAL,type:u.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:u.Class.UNIVERSAL,type:u.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:u.Class.UNIVERSAL,type:u.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},c={name:"RSAPrivateKey",tagClass:u.Class.UNIVERSAL,type:u.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:u.Class.UNIVERSAL,type:u.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:u.Class.UNIVERSAL,type:u.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:u.Class.UNIVERSAL,type:u.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:u.Class.UNIVERSAL,type:u.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:u.Class.UNIVERSAL,type:u.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:u.Class.UNIVERSAL,type:u.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:u.Class.UNIVERSAL,type:u.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:u.Class.UNIVERSAL,type:u.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:u.Class.UNIVERSAL,type:u.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},h={name:"RSAPublicKey",tagClass:u.Class.UNIVERSAL,type:u.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:u.Class.UNIVERSAL,type:u.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:u.Class.UNIVERSAL,type:u.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},p=e.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:u.Class.UNIVERSAL,type:u.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:u.Class.UNIVERSAL,type:u.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:u.Class.UNIVERSAL,type:u.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:u.Class.UNIVERSAL,type:u.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:u.Class.UNIVERSAL,type:u.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},d=function(e){var t;if(e.algorithm in a.oids){t=a.oids[e.algorithm];var n=u.oidToDer(t).getBytes(),r=u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,!0,[]),i=u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,!0,[]);i.value.push(u.create(u.Class.UNIVERSAL,u.Type.OID,!1,n)),i.value.push(u.create(u.Class.UNIVERSAL,u.Type.NULL,!1,""));var s=u.create(u.Class.UNIVERSAL,u.Type.OCTETSTRING,!1,e.digest().getBytes());return r.value.push(i),r.value.push(s),u.toDer(r).getBytes()}var o=new Error("Unknown message digest algorithm.");throw o.algorithm=e.algorithm,o},v=function(t,n,r){if(r)return t.modPow(n.e,n.n);if(!n.p||!n.q)return t.modPow(n.d,n.n);n.dP||(n.dP=n.d.mod(n.p.subtract(o.ONE))),n.dQ||(n.dQ=n.d.mod(n.q.subtract(o.ONE))),n.qInv||(n.qInv=n.q.modInverse(n.p));var i;do i=(new o(e.util.bytesToHex(e.random.getBytes(n.n.bitLength()/8)),16)).mod(n.n);while(i.equals(o.ZERO));t=t.multiply(i.modPow(n.e,n.n)).mod(n.n);var s=t.mod(n.p).modPow(n.dP,n.p),u=t.mod(n.q).modPow(n.dQ,n.q);while(s.compareTo(u)<0)s=s.add(n.p);var a=s.subtract(u).multiply(n.qInv).mod(n.p).multiply(n.q).add(u);return a=a.multiply(i.modInverse(n.n)).mod(n.n),a};a.rsa.encrypt=function(n,r,i){var s=i,u,a=Math.ceil(r.n.bitLength()/8);i!==!1&&i!==!0?(s=i===2,u=t(n,r,i)):(u=e.util.createBuffer(),u.putBytes(n));var f=new o(u.toHex(),16),l=v(f,r,s),c=l.toString(16),h=e.util.createBuffer(),p=a-Math.ceil(c.length/2);while(p>0)h.putByte(0),--p;return h.putBytes(e.util.hexToBytes(c)),h.getBytes()},a.rsa.decrypt=function(t,r,i,s){var u=Math.ceil(r.n.bitLength()/8);if(t.length!==u){var a=new Error("Encrypted message length is invalid.");throw a.length=t.length,a.expected=u,a}var f=new o(e.util.createBuffer(t).toHex(),16);if(f.compareTo(r.n)>=0)throw new Error("Encrypted message is invalid.");var l=v(f,r,i),c=l.toString(16),h=e.util.createBuffer(),p=u-Math.ceil(c.length/2);while(p>0)h.putByte(0),--p;return h.putBytes(e.util.hexToBytes(c)),s!==!1?n(h.getBytes(),r,i):h.getBytes()},a.rsa.createKeyPairGenerationState=function(t,n,r){typeof t=="string"&&(t=parseInt(t,10)),t=t||2048,r=r||{};var i=r.prng||e.random,s={nextBytes:function(e){var t=i.getBytesSync(e.length);for(var n=0;n<e.length;++n)e[n]=t.charCodeAt(n)}},u=r.algorithm||"PRIMEINC",a;if(u!=="PRIMEINC")throw new Error("Invalid key generation algorithm: "+u);return a={algorithm:u,state:0,bits:t,rng:s,eInt:n||65537,e:new o(null),p:null,q:null,qBits:t>>1,pBits:t-(t>>1),pqState:0,num:null,keys:null},a.e.fromInt(a.eInt),a},a.rsa.stepKeyPairGenerationState=function(e,t){"algorithm"in e||(e.algorithm="PRIMEINC");var n=new o(null);n.fromInt(30);var r=0,i=function(e,t){return e|t},u=+(new Date),l,c=0;while(e.keys===null&&(t<=0||c<t)){if(e.state===0){var h=e.p===null?e.pBits:e.qBits,p=h-1;e.pqState===0?(e.num=new o(h,e.rng),e.num.testBit(p)||e.num.bitwiseTo(o.ONE.shiftLeft(p),i,e.num),e.num.dAddOffset(31-e.num.mod(n).byteValue(),0),r=0,++e.pqState):e.pqState===1?e.num.bitLength()>h?e.pqState=0:e.num.isProbablePrime(s(e.num.bitLength()))?++e.pqState:e.num.dAddOffset(f[r++%8],0):e.pqState===2?e.pqState=e.num.subtract(o.ONE).gcd(e.e).compareTo(o.ONE)===0?3:0:e.pqState===3&&(e.pqState=0,e.p===null?e.p=e.num:e.q=e.num,e.p!==null&&e.q!==null&&++e.state,e.num=null)}else if(e.state===1)e.p.compareTo(e.q)<0&&(e.num=e.p,e.p=e.q,e.q=e.num),++e.state;else if(e.state===2)e.p1=e.p.subtract(o.ONE),e.q1=e.q.subtract(o.ONE),e.phi=e.p1.multiply(e.q1),++e.state;else if(e.state===3)e.phi.gcd(e.e).compareTo(o.ONE)===0?++e.state:(e.p=null,e.q=null,e.state=0);else if(e.state===4)e.n=e.p.multiply(e.q),e.n.bitLength()===e.bits?++e.state:(e.q=null,e.state=0);else if(e.state===5){var d=e.e.modInverse(e.phi);e.keys={privateKey:a.rsa.setPrivateKey(e.n,e.e,d,e.p,e.q,d.mod(e.p1),d.mod(e.q1),e.q.modInverse(e.p)),publicKey:a.rsa.setPublicKey(e.n,e.e)}}l=+(new Date),c+=l-u,u=l}return e.keys!==null},a.rsa.generateKeyPair=function(e,t,n,i){arguments.length===1?typeof e=="object"?(n=e,e=undefined):typeof e=="function"&&(i=e,e=undefined):arguments.length===2?typeof e=="number"?typeof t=="function"?(i=t,t=undefined):typeof t!="number"&&(n=t,t=undefined):(n=e,i=t,e=undefined,t=undefined):arguments.length===3&&(typeof t=="number"?typeof n=="function"&&(i=n,n=undefined):(i=n,n=t,t=undefined)),n=n||{},e===undefined&&(e=n.bits||2048),t===undefined&&(t=n.e||65537);var s=a.rsa.createKeyPairGenerationState(e,t,n);if(!i)return a.rsa.stepKeyPairGenerationState(s,0),s.keys;r(s,n,i)},a.setRsaPublicKey=a.rsa.setPublicKey=function(r,i){var s={n:r,e:i};return s.encrypt=function(n,r,i){typeof r=="string"?r=r.toUpperCase():r===undefined&&(r="RSAES-PKCS1-V1_5");if(r==="RSAES-PKCS1-V1_5")r={encode:function(e,n,r){return t(e,n,2).getBytes()}};else if(r==="RSA-OAEP"||r==="RSAES-OAEP")r={encode:function(t,n){return e.pkcs1.encode_rsa_oaep(n,t,i)}};else if(["RAW","NONE","NULL",null].indexOf(r)!==-1)r={encode:function(e){return e}};else if(typeof r=="string")throw new Error('Unsupported encryption scheme: "'+r+'".');var o=r.encode(n,s,!0);return a.rsa.encrypt(o,s,!0)},s.verify=function(e,t,r){typeof r=="string"?r=r.toUpperCase():r===undefined&&(r="RSASSA-PKCS1-V1_5");if(r==="RSASSA-PKCS1-V1_5")r={verify:function(e,t){t=n(t,s,!0);var r=u.fromDer(t);return e===r.value[1].value}};else if(r==="NONE"||r==="NULL"||r===null)r={verify:function(e,t){return t=n(t,s,!0),e===t}};var i=a.rsa.decrypt(t,s,!0,!1);return r.verify(e,i,s.n.bitLength())},s},a.setRsaPrivateKey=a.rsa.setPrivateKey=function(t,r,i,s,o,u,f,l){var c={n:t,e:r,d:i,p:s,q:o,dP:u,dQ:f,qInv:l};return c.decrypt=function(t,r,i){typeof r=="string"?r=r.toUpperCase():r===undefined&&(r="RSAES-PKCS1-V1_5");var s=a.rsa.decrypt(t,c,!1,!1);if(r==="RSAES-PKCS1-V1_5")r={decode:n};else if(r==="RSA-OAEP"||r==="RSAES-OAEP")r={decode:function(t,n){return e.pkcs1.decode_rsa_oaep(n,t,i)}};else{if(["RAW","NONE","NULL",null].indexOf(r)===-1)throw new Error('Unsupported encryption scheme: "'+r+'".');r={decode:function(e){return e}}}return r.decode(s,c,!1)},c.sign=function(e,t){var n=!1;typeof t=="string"&&(t=t.toUpperCase());if(t===undefined||t==="RSASSA-PKCS1-V1_5")t={encode:d},n=1;else if(t==="NONE"||t==="NULL"||t===null)t={encode:function(){return e}},n=1;var r=t.encode(e,c.n.bitLength());return a.rsa.encrypt(r,c,n)},c},a.wrapRsaPrivateKey=function(e){return u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,!0,[u.create(u.Class.UNIVERSAL,u.Type.INTEGER,!1,u.integerToDer(0).getBytes()),u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,!0,[u.create(u.Class.UNIVERSAL,u.Type.OID,!1,u.oidToDer(a.oids.rsaEncryption).getBytes()),u.create(u.Class.UNIVERSAL,u.Type.NULL,!1,"")]),u.create(u.Class.UNIVERSAL,u.Type.OCTETSTRING,!1,u.toDer(e).getBytes())])},a.privateKeyFromAsn1=function(t){var n={},r=[];u.validate(t,l,n,r)&&(t=u.fromDer(e.util.createBuffer(n.privateKey))),n={},r=[];if(!u.validate(t,c,n,r)){var i=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw i.errors=r,i}var s,f,h,p,d,v,m,g;return s=e.util.createBuffer(n.privateKeyModulus).toHex(),f=e.util.createBuffer(n.privateKeyPublicExponent).toHex(),h=e.util.createBuffer(n.privateKeyPrivateExponent).toHex(),p=e.util.createBuffer(n.privateKeyPrime1).toHex(),d=e.util.createBuffer(n.privateKeyPrime2).toHex(),v=e.util.createBuffer(n.privateKeyExponent1).toHex(),m=e.util.createBuffer(n.privateKeyExponent2).toHex(),g=e.util.createBuffer(n.privateKeyCoefficient).toHex(),a.setRsaPrivateKey(new o(s,16),new o(f,16),new o(h,16),new o(p,16),new o(d,16),new o(v,16),new o(m,16),new o(g,16))},a.privateKeyToAsn1=a.privateKeyToRSAPrivateKey=function(e){return u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,!0,[u.create(u.Class.UNIVERSAL,u.Type.INTEGER,!1,u.integerToDer(0).getBytes()),u.create(u.Class.UNIVERSAL,u.Type.INTEGER,!1,i(e.n)),u.create(u.Class.UNIVERSAL,u.Type.INTEGER,!1,i(e.e)),u.create(u.Class.UNIVERSAL,u.Type.INTEGER,!1,i(e.d)),u.create(u.Class.UNIVERSAL,u.Type.INTEGER,!1,i(e.p)),u.create(u.Class.UNIVERSAL,u.Type.INTEGER,!1,i(e.q)),u.create(u.Class.UNIVERSAL,u.Type.INTEGER,!1,i(e.dP)),u.create(u.Class.UNIVERSAL,u.Type.INTEGER,!1,i(e.dQ)),u.create(u.Class.UNIVERSAL,u.Type.INTEGER,!1,i(e.qInv))])},a.publicKeyFromAsn1=function(t){var n={},r=[];if(u.validate(t,p,n,r)){var i=u.derToOid(n.publicKeyOid);if(i!==a.oids.rsaEncryption){var s=new Error("Cannot read public key. Unknown OID.");throw s.oid=i,s}t=n.rsaPublicKey}r=[];if(!u.validate(t,h,n,r)){var s=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw s.errors=r,s}var f=e.util.createBuffer(n.publicKeyModulus).toHex(),l=e.util.createBuffer(n.publicKeyExponent).toHex();return a.setRsaPublicKey(new o(f,16),new o(l,16))},a.publicKeyToAsn1=a.publicKeyToSubjectPublicKeyInfo=function(e){return u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,!0,[u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,!0,[u.create(u.Class.UNIVERSAL,u.Type.OID,!1,u.oidToDer(a.oids.rsaEncryption).getBytes()),u.create(u.Class.UNIVERSAL,u.Type.NULL,!1,"")]),u.create(u.Class.UNIVERSAL,u.Type.BITSTRING,!1,[a.publicKeyToRSAPublicKey(e)])])},a.publicKeyToRSAPublicKey=function(e){return u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,!0,[u.create(u.Class.UNIVERSAL,u.Type.INTEGER,!1,i(e.n)),u.create(u.Class.UNIVERSAL,u.Type.INTEGER,!1,i(e.e))])}}var r="rsa";if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),e(forge);var i=!0;n=function(e,n){n(t,module)}}var s,o=function(t,n){n.exports=function(n){var i=s.map(function(e){return t(e)}).concat(e);n=n||{},n.defined=n.defined||{};if(n.defined[r])return n[r];n.defined[r]=!0;for(var o=0;o<i.length;++o)i[o](n);return n[r]}},u=n;n=function(e,t){return s=typeof e=="string"?t.slice(2):e.slice(2),i?(delete n,u.apply(null,Array.prototype.slice.call(arguments,0))):(n=u,n.apply(null,Array.prototype.slice.call(arguments,0)))},n("js/rsa",["require","module","./asn1","./jsbn","./oids","./pkcs1","./prime","./random","./util"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){function t(e,t){return e.start().update(t).digest().getBytes()}if(typeof n=="undefined")var n=e.jsbn.BigInteger;var r=e.asn1,i=e.pki=e.pki||{};i.pbe=e.pbe=e.pbe||{};var s=i.oids,o={name:"EncryptedPrivateKeyInfo",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:r.Class.UNIVERSAL,type:r.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:r.Class.UNIVERSAL,type:r.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},u={name:"PBES2Algorithms",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:r.Class.UNIVERSAL,type:r.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:r.Class.UNIVERSAL,type:r.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:r.Class.UNIVERSAL,type:r.Type.INTEGER,onstructed:!0,capture:"kdfIterationCount"}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:r.Class.UNIVERSAL,type:r.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:r.Class.UNIVERSAL,type:r.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},a={name:"pkcs-12PbeParams",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:r.Class.UNIVERSAL,type:r.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:r.Class.UNIVERSAL,type:r.Type.INTEGER,constructed:!1,capture:"iterations"}]};i.encryptPrivateKeyInfo=function(t,n,o){o=o||{},o.saltSize=o.saltSize||8,o.count=o.count||2048,o.algorithm=o.algorithm||"aes128";var u=e.random.getBytesSync(o.saltSize),a=o.count,f=r.integerToDer(a),l,c,h;if(o.algorithm.indexOf("aes")===0||o.algorithm==="des"){var p,d,v;switch(o.algorithm){case"aes128":l=16,p=16,d=s["aes128-CBC"],v=e.aes.createEncryptionCipher;break;case"aes192":l=24,p=16,d=s["aes192-CBC"],v=e.aes.createEncryptionCipher;break;case"aes256":l=32,p=16,d=s["aes256-CBC"],v=e.aes.createEncryptionCipher;break;case"des":l=8,p=8,d=s.desCBC,v=e.des.createEncryptionCipher;break;default:var m=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw m.algorithm=o.algorithm,m}var g=e.pkcs5.pbkdf2(n,u,a,l),y=e.random.getBytesSync(p),b=v(g);b.start(y),b.update(r.toDer(t)),b.finish(),h=b.output.getBytes(),c=r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,!0,[r.create(r.Class.UNIVERSAL,r.Type.OID,!1,r.oidToDer(s.pkcs5PBES2).getBytes()),r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,!0,[r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,!0,[r.create(r.Class.UNIVERSAL,r.Type.OID,!1,r.oidToDer(s.pkcs5PBKDF2).getBytes()),r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,!0,[r.create(r.Class.UNIVERSAL,r.Type.OCTETSTRING,!1,u),r.create(r.Class.UNIVERSAL,r.Type.INTEGER,!1,f.getBytes())])]),r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,!0,[r.create(r.Class.UNIVERSAL,r.Type.OID,!1,r.oidToDer(d).getBytes()),r.create(r.Class.UNIVERSAL,r.Type.OCTETSTRING,!1,y)])])])}else{if(o.algorithm!=="3des"){var m=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw m.algorithm=o.algorithm,m}l=24;var w=new e.util.ByteBuffer(u),g=i.pbe.generatePkcs12Key(n,w,1,a,l),y=i.pbe.generatePkcs12Key(n,w,2,a,l),b=e.des.createEncryptionCipher(g);b.start(y),b.update(r.toDer(t)),b.finish(),h=b.output.getBytes(),c=r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,!0,[r.create(r.Class.UNIVERSAL,r.Type.OID,!1,r.oidToDer(s["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,!0,[r.create(r.Class.UNIVERSAL,r.Type.OCTETSTRING,!1,u),r.create(r.Class.UNIVERSAL,r.Type.INTEGER,!1,f.getBytes())])])}var E=r.create(r.Class.UNIVERSAL,r.Type.SEQUENCE,!0,[c,r.create(r.Class.UNIVERSAL,r.Type.OCTETSTRING,!1,h)]);return E},i.decryptPrivateKeyInfo=function(t,n){var s=null,u={},a=[];if(!r.validate(t,o,u,a)){var f=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw f.errors=a,f}var l=r.derToOid(u.encryptionOid),c=i.pbe.getCipher(l,u.encryptionParams,n),h=e.util.createBuffer(u.encryptedData);return c.update(h),c.finish()&&(s=r.fromDer(c.output)),s},i.encryptedPrivateKeyToPem=function(t,n){var i={type:"ENCRYPTED PRIVATE KEY",body:r.toDer(t).getBytes()};return e.pem.encode(i,{maxline:n})},i.encryptedPrivateKeyFromPem=function(t){var n=e.pem.decode(t)[0];if(n.type!=="ENCRYPTED PRIVATE KEY"){var i=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw i.headerType=n.type,i}if(n.procType&&n.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return r.fromDer(n.body)},i.encryptRsaPrivateKey=function(t,n,s){s=s||{};if(!s.legacy){var o=i.wrapRsaPrivateKey(i.privateKeyToAsn1(t));return o=i.encryptPrivateKeyInfo(o,n,s),i.encryptedPrivateKeyToPem(o)}var u,a,f,l;switch(s.algorithm){case"aes128":u="AES-128-CBC",f=16,a=e.random.getBytesSync(16),l=e.aes.createEncryptionCipher;break;case"aes192":u="AES-192-CBC",f=24,a=e.random.getBytesSync(16),l=e.aes.createEncryptionCipher;break;case"aes256":u="AES-256-CBC",f=32,a=e.random.getBytesSync(16),l=e.aes.createEncryptionCipher;break;case"3des":u="DES-EDE3-CBC",f=24,a=e.random.getBytesSync(8),l=e.des.createEncryptionCipher;break;case"des":u="DES-CBC",f=8,a=e.random.getBytesSync(8),l=e.des.createEncryptionCipher;break;default:var c=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+s.algorithm+'".');throw c.algorithm=s.algorithm,c}var h=e.pbe.opensslDeriveBytes(n,a.substr(0,8),f),p=l(h);p.start(a),p.update(r.toDer(i.privateKeyToAsn1(t))),p.finish();var d={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:u,parameters:e.util.bytesToHex(a).toUpperCase()},body:p.output.getBytes()};return e.pem.encode(d)},i.decryptRsaPrivateKey=function(t,n){var s=null,o=e.pem.decode(t)[0];if(o.type!=="ENCRYPTED PRIVATE KEY"&&o.type!=="PRIVATE KEY"&&o.type!=="RSA PRIVATE KEY"){var u=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw u.headerType=u,u}if(o.procType&&o.procType.type==="ENCRYPTED"){var a,f;switch(o.dekInfo.algorithm){case"DES-CBC":a=8,f=e.des.createDecryptionCipher;break;case"DES-EDE3-CBC":a=24,f=e.des.createDecryptionCipher;break;case"AES-128-CBC":a=16,f=e.aes.createDecryptionCipher;break;case"AES-192-CBC":a=24,f=e.aes.createDecryptionCipher;break;case"AES-256-CBC":a=32,f=e.aes.createDecryptionCipher;break;case"RC2-40-CBC":a=5,f=function(t){return e.rc2.createDecryptionCipher(t,40)};break;case"RC2-64-CBC":a=8,f=function(t){return e.rc2.createDecryptionCipher(t,64)};break;case"RC2-128-CBC":a=16,f=function(t){return e.rc2.createDecryptionCipher(t,128)};break;default:var u=new Error('Could not decrypt private key; unsupported encryption algorithm "'+o.dekInfo.algorithm+'".');throw u.algorithm=o.dekInfo.algorithm,u}var l=e.util.hexToBytes(o.dekInfo.parameters),c=e.pbe.opensslDeriveBytes(n,l.substr(0,8),a),h=f(c);h.start(l),h.update(e.util.createBuffer(o.body));if(!h.finish())return s;s=h.output.getBytes()}else s=o.body;return o.type==="ENCRYPTED PRIVATE KEY"?s=i.decryptPrivateKeyInfo(r.fromDer(s),n):s=r.fromDer(s),s!==null&&(s=i.privateKeyFromAsn1(s)),s},i.pbe.generatePkcs12Key=function(t,n,r,i,s,o){var u,a;if(typeof o=="undefined"||o===null)o=e.md.sha1.create();var f=o.digestLength,l=o.blockLength,c=new e.util.ByteBuffer,h=new e.util.ByteBuffer;if(t!==null&&t!==undefined){for(a=0;a<t.length;a++)h.putInt16(t.charCodeAt(a));h.putInt16(0)}var p=h.length(),d=n.length(),v=new e.util.ByteBuffer;v.fillWithByte(r,l);var m=l*Math.ceil(d/l),g=new e.util.ByteBuffer;for(a=0;a<m;a++)g.putByte(n.at(a%d));var y=l*Math.ceil(p/l),b=new e.util.ByteBuffer;for(a=0;a<y;a++)b.putByte(h.at(a%p));var w=g;w.putBuffer(b);var E=Math.ceil(s/f);for(var S=1;S<=E;S++){var x=new e.util.ByteBuffer;x.putBytes(v.bytes()),x.putBytes(w.bytes());for(var T=0;T<i;T++)o.start(),o.update(x.getBytes()),x=o.digest();var N=new e.util.ByteBuffer;for(a=0;a<l;a++)N.putByte(x.at(a%f));var C=Math.ceil(d/l)+Math.ceil(p/l),k=new e.util.ByteBuffer;for(u=0;u<C;u++){var L=new e.util.ByteBuffer(w.getBytes(l)),A=511;for(a=N.length()-1;a>=0;a--)A>>=8,A+=N.at(a)+L.at(a),L.setAt(a,A&255);k.putBuffer(L)}w=k,c.putBuffer(x)}return c.truncate(c.length()-s),c},i.pbe.getCipher=function(e,t,n){switch(e){case i.oids.pkcs5PBES2:return i.pbe.getCipherForPBES2(e,t,n);case i.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case i.oids["pbewithSHAAnd40BitRC2-CBC"]:return i.pbe.getCipherForPKCS12PBE(e,t,n);default:var r=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw r.oid=e,r.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],r}},i.pbe.getCipherForPBES2=function(t,n,s){var o={},a=[];if(!r.validate(n,u,o,a)){var f=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw f.errors=a,f}t=r.derToOid(o.kdfOid);if(t!==i.oids.pkcs5PBKDF2){var f=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw f.oid=t,f.supportedOids=["pkcs5PBKDF2"],f}t=r.derToOid(o.encOid);if(t!==i.oids["aes128-CBC"]&&t!==i.oids["aes192-CBC"]&&t!==i.oids["aes256-CBC"]&&t!==i.oids["des-EDE3-CBC"]&&t!==i.oids.desCBC){var f=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw f.oid=t,f.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],f}var l=o.kdfSalt,c=e.util.createBuffer(o.kdfIterationCount);c=c.getInt(c.length()<<3);var h,p;switch(i.oids[t]){case"aes128-CBC":h=16,p=e.aes.createDecryptionCipher;break;case"aes192-CBC":h=24,p=e.aes.createDecryptionCipher;break;case"aes256-CBC":h=32,p=e.aes.createDecryptionCipher;break;case"des-EDE3-CBC":h=24,p=e.des.createDecryptionCipher;break;case"desCBC":h=8,p=e.des.createDecryptionCipher}var d=e.pkcs5.pbkdf2(s,l,c,h),v=o.encIv,m=p(d);return m.start(v),m},i.pbe.getCipherForPKCS12PBE=function(t,n,s){var o={},u=[];if(!r.validate(n,a,o,u)){var f=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw f.errors=u,f}var l=e.util.createBuffer(o.salt),c=e.util.createBuffer(o.iterations);c=c.getInt(c.length()<<3);var h,p,d;switch(t){case i.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:h=24,p=8,d=e.des.startDecrypting;break;case i.oids["pbewithSHAAnd40BitRC2-CBC"]:h=5,p=8,d=function(t,n){var r=e.rc2.createDecryptionCipher(t,40);return r.start(n,null),r};break;default:var f=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw f.oid=t,f}var v=i.pbe.generatePkcs12Key(s,l,1,c,h),m=i.pbe.generatePkcs12Key(s,l,2,c,p);return d(v,m)},i.pbe.opensslDeriveBytes=function(n,r,i,s){if(typeof s=="undefined"||s===null)s=e.md.md5.create();r===null&&(r="");var o=[t(s,n+r)];for(var u=16,a=1;u<i;++a,u+=16)o.push(t(s,o[a-1]+n+r));return o.join("").substr(0,i)}}var r="pbe";if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),e(forge);var i=!0;n=function(e,n){n(t,module)}}var s,o=function(t,n){n.exports=function(n){var i=s.map(function(e){return t(e)}).concat(e);n=n||{},n.defined=n.defined||{};if(n.defined[r])return n[r];n.defined[r]=!0;for(var o=0;o<i.length;++o)i[o](n);return n[r]}},u=n;n=function(e,t){return s=typeof e=="string"?t.slice(2):e.slice(2),i?(delete n,u.apply(null,Array.prototype.slice.call(arguments,0))):(n=u,n.apply(null,Array.prototype.slice.call(arguments,0)))},n("js/pbe",["require","module","./aes","./asn1","./des","./md","./oids","./pem","./pbkdf2","./random","./rc2","./rsa","./util"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){var t=e.asn1,n=e.pkcs7asn1=e.pkcs7asn1||{};e.pkcs7=e.pkcs7||{},e.pkcs7.asn1=n;var r={name:"ContentInfo",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:t.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};n.contentInfoValidator=r;var i={name:"EncryptedContentInfo",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:t.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:t.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};n.envelopedDataValidator={name:"EnvelopedData",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:t.Class.UNIVERSAL,type:t.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:t.Class.UNIVERSAL,type:t.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(i)},n.encryptedDataValidator={name:"EncryptedData",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:t.Class.UNIVERSAL,type:t.Type.INTEGER,constructed:!1,capture:"version"}].concat(i)};var s={name:"SignerInfo",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.Version",tagClass:t.Class.UNIVERSAL,type:t.Type.INTEGER,constructed:!1},{name:"SignerInfo.IssuerAndSerialNumber",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0},{name:"SignerInfo.DigestAlgorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0},{name:"SignerInfo.AuthenticatedAttributes",tagClass:t.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.DigestEncryptionAlgorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0},{name:"SignerInfo.EncryptedDigest",tagClass:t.Class.UNIVERSAL,type:t.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.UnauthenticatedAttributes",tagClass:t.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0}]};n.signedDataValidator={name:"SignedData",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:t.Class.UNIVERSAL,type:t.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:t.Class.UNIVERSAL,type:t.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},r,{name:"SignedData.Certificates",tagClass:t.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:t.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:t.Class.UNIVERSAL,type:t.Type.SET,capture:"signerInfos",optional:!0,value:[s]}]},n.recipientInfoValidator={name:"RecipientInfo",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:t.Class.UNIVERSAL,type:t.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:t.Class.UNIVERSAL,type:t.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:t.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter"}]},{name:"RecipientInfo.encryptedKey",tagClass:t.Class.UNIVERSAL,type:t.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]}}var r="pkcs7asn1";if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),e(forge);var i=!0;n=function(e,n){n(t,module)}}var s,o=function(t,n){n.exports=function(n){var i=s.map(function(e){return t(e)}).concat(e);n=n||{},n.defined=n.defined||{};if(n.defined[r])return n[r];n.defined[r]=!0;for(var o=0;o<i.length;++o)i[o](n);return n[r]}},u=n;n=function(e,t){return s=typeof e=="string"?t.slice(2):e.slice(2),i?(delete n,u.apply(null,Array.prototype.slice.call(arguments,0))):(n=u,n.apply(null,Array.prototype.slice.call(arguments,0)))},n("js/pkcs7asn1",["require","module","./asn1","./util"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){e.mgf=e.mgf||{};var t=e.mgf.mgf1=e.mgf1=e.mgf1||{};t.create=function(t){var n={generate:function(n,r){var i=new e.util.ByteBuffer,s=Math.ceil(r/t.digestLength);for(var o=0;o<s;o++){var u=new e.util.ByteBuffer;u.putInt32(o),t.start(),t.update(n+u.getBytes()),i.putBuffer(t.digest())}return i.truncate(i.length()-r),i.getBytes()}};return n}}var r="mgf1";if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),e(forge);var i=!0;n=function(e,n){n(t,module)}}var s,o=function(t,n){n.exports=function(n){var i=s.map(function(e){return t(e)}).concat(e);n=n||{},n.defined=n.defined||{};if(n.defined[r])return n[r];n.defined[r]=!0;for(var o=0;o<i.length;++o)i[o](n);return n[r]}},u=n;n=function(e,t){return s=typeof e=="string"?t.slice(2):e.slice(2),i?(delete n,u.apply(null,Array.prototype.slice.call(arguments,0))):(n=u,n.apply(null,Array.prototype.slice.call(arguments,0)))},n("js/mgf1",["require","module","./util"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){e.mgf=e.mgf||{},e.mgf.mgf1=e.mgf1}var r="mgf";if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),e(forge);var i=!0;n=function(e,n){n(t,module)}}var s,o=function(t,n){n.exports=function(n){var i=s.map(function(e){return t(e)}).concat(e);n=n||{},n.defined=n.defined||{};if(n.defined[r])return n[r];n.defined[r]=!0;for(var o=0;o<i.length;++o)i[o](n);return n[r]}},u=n;n=function(e,t){return s=typeof e=="string"?t.slice(2):e.slice(2),i?(delete n,u.apply(null,Array.prototype.slice.call(arguments,0))):(n=u,n.apply(null,Array.prototype.slice.call(arguments,0)))},n("js/mgf",["require","module","./mgf1"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){var t=e.pss=e.pss||{};t.create=function(t){arguments.length===3&&(t={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var n=t.md,r=t.mgf,i=n.digestLength,s=t.salt||null;typeof s=="string"&&(s=e.util.createBuffer(s));var o;if("saltLength"in t)o=t.saltLength;else{if(s===null)throw new Error("Salt length not specified or specific salt not given.");o=s.length()}if(s!==null&&s.length()!==o)throw new Error("Given salt length does not match length of given salt.");var u=t.prng||e.random,a={};return a.encode=function(t,a){var f,l=a-1,c=Math.ceil(l/8),h=t.digest().getBytes();if(c<i+o+2)throw new Error("Message is too long to encrypt.");var p;s===null?p=u.getBytesSync(o):p=s.bytes();var d=new e.util.ByteBuffer;d.fillWithByte(0,8),d.putBytes(h),d.putBytes(p),n.start(),n.update(d.getBytes());var v=n.digest().getBytes(),m=new e.util.ByteBuffer;m.fillWithByte(0,c-o-i-2),m.putByte(1),m.putBytes(p);var g=m.getBytes(),y=c-i-1,b=r.generate(v,y),w="";for(f=0;f<y;f++)w+=String.fromCharCode(g.charCodeAt(f)^b.charCodeAt(f));var E=65280>>8*c-l&255;return w=String.fromCharCode(w.charCodeAt(0)&~E)+w.substr(1),w+v+String.fromCharCode(188)},a.verify=function(t,s,u){var a,f=u-1,l=Math.ceil(f/8);s=s.substr(-l);if(l<i+o+2)throw new Error("Inconsistent parameters to PSS signature verification.");if(s.charCodeAt(l-1)!==188)throw new Error("Encoded message does not end in 0xBC.");var c=l-i-1,h=s.substr(0,c),p=s.substr(c,i),d=65280>>8*l-f&255;if((h.charCodeAt(0)&d)!==0)throw new Error("Bits beyond keysize not zero as expected.");var v=r.generate(p,c),m="";for(a=0;a<c;a++)m+=String.fromCharCode(h.charCodeAt(a)^v.charCodeAt(a));m=String.fromCharCode(m.charCodeAt(0)&~d)+m.substr(1);var g=l-i-o-2;for(a=0;a<g;a++)if(m.charCodeAt(a)!==0)throw new Error("Leftmost octets not zero as expected");if(m.charCodeAt(g)!==1)throw new Error("Inconsistent PSS signature, 0x01 marker not found");var y=m.substr(-o),b=new e.util.ByteBuffer;b.fillWithByte(0,8),b.putBytes(t),b.putBytes(y),n.start(),n.update(b.getBytes());var w=n.digest().getBytes();return p===w},a}}var r="pss";if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),e(forge);var i=!0;n=function(e,n){n(t,module)}}var s,o=function(t,n){n.exports=function(n){var i=s.map(function(e){return t(e)}).concat(e);n=n||{},n.defined=n.defined||{};if(n.defined[r])return n[r];n.defined[r]=!0;for(var o=0;o<i.length;++o)i[o](n);return n[r]}},u=n;n=function(e,t){return s=typeof e=="string"?t.slice(2):e.slice(2),i?(delete n,u.apply(null,Array.prototype.slice.call(arguments,0))):(n=u,n.apply(null,Array.prototype.slice.call(arguments,0)))},n("js/pss",["require","module","./random","./util"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){function t(e,t){typeof t=="string"&&(t={shortName:t});var n=null,r;for(var i=0;n===null&&i<e.attributes.length;++i)r=e.attributes[i],t.type&&t.type===r.type?n=r:t.name&&t.name===r.name?n=r:t.shortName&&t.shortName===r.shortName&&(n=r);return n}function n(t){var n=a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[]),r,i,s=t.attributes;for(var o=0;o<s.length;++o){r=s[o];var u=r.value,f=a.Type.PRINTABLESTRING;"valueTagClass"in r&&(f=r.valueTagClass,f===a.Type.UTF8&&(u=e.util.encodeUtf8(u))),i=a.create(a.Class.UNIVERSAL,a.Type.SET,!0,[a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.OID,!1,a.oidToDer(r.type).getBytes()),a.create(a.Class.UNIVERSAL,f,!1,u)])]),n.value.push(i)}return n}function r(t){var n={};for(var r=0;r<t.length;++r){var i=t[r];if(i.shortName&&(i.valueTagClass===a.Type.UTF8||i.valueTagClass===a.Type.PRINTABLESTRING||i.valueTagClass===a.Type.IA5STRING)){var s=i.value;i.valueTagClass===a.Type.UTF8&&(s=e.util.encodeUtf8(i.value)),i.shortName in n?e.util.isArray(n[i.shortName])?n[i.shortName].push(s):n[i.shortName]=[n[i.shortName],s]:n[i.shortName]=s}}return n}function i(e){var t;for(var n=0;n<e.length;++n){t=e[n],typeof t.name=="undefined"&&(t.type&&t.type in f.oids?t.name=f.oids[t.type]:t.shortName&&t.shortName in c&&(t.name=f.oids[c[t.shortName]]));if(typeof t.type=="undefined"){if(!(t.name&&t.name in f.oids)){var r=new Error("Attribute type not specified.");throw r.attribute=t,r}t.type=f.oids[t.name]}typeof t.shortName=="undefined"&&t.name&&t.name in c&&(t.shortName=c[t.name]);if(t.type===l.extensionRequest){t.valueConstructed=!0,t.valueTagClass=a.Type.SEQUENCE;if(!t.value&&t.extensions){t.value=[];for(var i=0;i<t.extensions.length;++i)t.value.push(f.certificateExtensionToAsn1(s(t.extensions[i])))}}if(typeof t.value=="undefined"){var r=new Error("Attribute value not specified.");throw r.attribute=t,r}}}function s(t,n){n=n||{},typeof t.name=="undefined"&&t.id&&t.id in f.oids&&(t.name=f.oids[t.id]);if(typeof t.id=="undefined"){if(!(t.name&&t.name in f.oids)){var r=new Error("Extension ID not specified.");throw r.extension=t,r}t.id=f.oids[t.name]}if(typeof t.value!="undefined")return;if(t.name==="keyUsage"){var i=0,s=0,o=0;t.digitalSignature&&(s|=128,i=7),t.nonRepudiation&&(s|=64,i=6),t.keyEncipherment&&(s|=32,i=5),t.dataEncipherment&&(s|=16,i=4),t.keyAgreement&&(s|=8,i=3),t.keyCertSign&&(s|=4,i=2),t.cRLSign&&(s|=2,i=1),t.encipherOnly&&(s|=1,i=0),t.decipherOnly&&(o|=128,i=7);var u=String.fromCharCode(i);o!==0?u+=String.fromCharCode(s)+String.fromCharCode(o):s!==0&&(u+=String.fromCharCode(s)),t.value=a.create(a.Class.UNIVERSAL,a.Type.BITSTRING,!1,u)}else if(t.name==="basicConstraints")t.value=a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[]),t.cA&&t.value.value.push(a.create(a.Class.UNIVERSAL,a.Type.BOOLEAN,!1,String.fromCharCode(255))),"pathLenConstraint"in t&&t.value.value.push(a.create(a.Class.UNIVERSAL,a.Type.INTEGER,!1,a.integerToDer(t.pathLenConstraint).getBytes()));else if(t.name==="extKeyUsage"){t.value=a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[]);var c=t.value.value;for(var h in t){if(t[h]!==!0)continue;h in l?c.push(a.create(a.Class.UNIVERSAL,a.Type.OID,!1,a.oidToDer(l[h]).getBytes())):h.indexOf(".")!==-1&&c.push(a.create(a.Class.UNIVERSAL,a.Type.OID,!1,a.oidToDer(h).getBytes()))}}else if(t.name==="nsCertType"){var i=0,s=0;t.client&&(s|=128,i=7),t.server&&(s|=64,i=6),t.email&&(s|=32,i=5),t.objsign&&(s|=16,i=4),t.reserved&&(s|=8,i=3),t.sslCA&&(s|=4,i=2),t.emailCA&&(s|=2,i=1),t.objCA&&(s|=1,i=0);var u=String.fromCharCode(i);s!==0&&(u+=String.fromCharCode(s)),t.value=a.create(a.Class.UNIVERSAL,a.Type.BITSTRING,!1,u)}else if(t.name==="subjectAltName"||t.name==="issuerAltName"){t.value=a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[]);var p;for(var d=0;d<t.altNames.length;++d){p=t.altNames[d];var u=p.value;if(p.type===7&&p.ip){u=e.util.bytesFromIP(p.ip);if(u===null){var r=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw r.extension=t,r}}else p.type===8&&(p.oid?u=a.oidToDer(a.oidToDer(p.oid)):u=a.oidToDer(u));t.value.value.push(a.create(a.Class.CONTEXT_SPECIFIC,p.type,!1,u))}}else if(t.name==="subjectKeyIdentifier"&&n.cert){var v=n.cert.generateSubjectKeyIdentifier();t.subjectKeyIdentifier=v.toHex(),t.value=a.create(a.Class.UNIVERSAL,a.Type.OCTETSTRING,!1,v.getBytes())}if(typeof t.value=="undefined"){var r=new Error("Extension value not specified.");throw r.extension=t,r}return t}function o(e,t){switch(e){case l["RSASSA-PSS"]:var n=[];return t.hash.algorithmOid!==undefined&&n.push(a.create(a.Class.CONTEXT_SPECIFIC,0,!0,[a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.OID,!1,a.oidToDer(t.hash.algorithmOid).getBytes()),a.create(a.Class.UNIVERSAL,a.Type.NULL,!1,"")])])),t.mgf.algorithmOid!==undefined&&n.push(a.create(a.Class.CONTEXT_SPECIFIC,1,!0,[a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.OID,!1,a.oidToDer(t.mgf.algorithmOid).getBytes()),a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.OID,!1,a.oidToDer(t.mgf.hash.algorithmOid).getBytes()),a.create(a.Class.UNIVERSAL,a.Type.NULL,!1,"")])])])),t.saltLength!==undefined&&n.push(a.create(a.Class.CONTEXT_SPECIFIC,2,!0,[a.create(a.Class.UNIVERSAL,a.Type.INTEGER,!1,a.integerToDer(t.saltLength).getBytes())])),a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,n);default:return a.create(a.Class.UNIVERSAL,a.Type.NULL,!1,"")}}function u(t){var n=a.create(a.Class.CONTEXT_SPECIFIC,0,!0,[]);if(t.attributes.length===0)return n;var r=t.attributes;for(var i=0;i<r.length;++i){var s=r[i],o=s.value,u=a.Type.UTF8;"valueTagClass"in s&&(u=s.valueTagClass),u===a.Type.UTF8&&(o=e.util.encodeUtf8(o));var f=!1;"valueConstructed"in s&&(f=s.valueConstructed);var l=a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.OID,!1,a.oidToDer(s.type).getBytes()),a.create(a.Class.UNIVERSAL,a.Type.SET,!0,[a.create(a.Class.UNIVERSAL,u,f,o)])]);n.value.push(l)}return n}var a=e.asn1,f=e.pki=e.pki||{},l=f.oids,c={};c.CN=l.commonName,c.commonName="CN",c.C=l.countryName,c.countryName="C",c.L=l.localityName,c.localityName="L",c.ST=l.stateOrProvinceName,c.stateOrProvinceName="ST",c.O=l.organizationName,c.organizationName="O",c.OU=l.organizationalUnitName,c.organizationalUnitName="OU",c.E=l.emailAddress,c.emailAddress="E";var h=e.pki.rsa.publicKeyValidator,p={name:"Certificate",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:a.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:a.Class.UNIVERSAL,type:a.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:a.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:a.Class.UNIVERSAL,type:a.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:a.Class.UNIVERSAL,type:a.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:a.Class.UNIVERSAL,type:a.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:a.Class.UNIVERSAL,type:a.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},h,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:a.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:a.Class.UNIVERSAL,type:a.Type.BITSTRING,constructed:!1,capture:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:a.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:a.Class.UNIVERSAL,type:a.Type.BITSTRING,constructed:!1,capture:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:a.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:a.Class.UNIVERSAL,type:a.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:a.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:a.Class.UNIVERSAL,type:a.Type.BITSTRING,constructed:!1,capture:"certSignature"}]},d={name:"rsapss",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:a.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:a.Class.UNIVERSAL,type:a.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:a.Class.UNIVERSAL,type:a.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:a.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:a.Class.UNIVERSAL,type:a.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:a.Class.UNIVERSAL,type:a.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:a.Class.UNIVERSAL,type:a.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:a.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:a.Class.UNIVERSAL,type:a.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:a.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:a.Class.UNIVERSAL,type:a.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},v={name:"CertificationRequestInfo",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},h,{name:"CertificationRequestInfo.attributes",tagClass:a.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:a.Class.UNIVERSAL,type:a.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:a.Class.UNIVERSAL,type:a.Type.SET,constructed:!0}]}]}]},m={name:"CertificationRequest",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[v,{name:"CertificationRequest.signatureAlgorithm",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:a.Class.UNIVERSAL,type:a.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:a.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:a.Class.UNIVERSAL,type:a.Type.BITSTRING,constructed:!1,capture:"csrSignature"}]};f.RDNAttributesAsArray=function(e,t){var n=[],r,i,s;for(var o=0;o<e.value.length;++o){r=e.value[o];for(var u=0;u<r.value.length;++u)s={},i=r.value[u],s.type=a.derToOid(i.value[0].value),s.value=i.value[1].value,s.valueTagClass=i.value[1].type,s.type in l&&(s.name=l[s.type],s.name in c&&(s.shortName=c[s.name])),t&&(t.update(s.type),t.update(s.value)),n.push(s)}return n},f.CRIAttributesAsArray=function(e){var t=[];for(var n=0;n<e.length;++n){var r=e[n],i=a.derToOid(r.value[0].value),s=r.value[1].value;for(var o=0;o<s.length;++o){var u={};u.type=i,u.value=s[o].value,u.valueTagClass=s[o].type,u.type in l&&(u.name=l[u.type],u.name in c&&(u.shortName=c[u.name]));if(u.type===l.extensionRequest){u.extensions=[];for(var h=0;h<u.value.length;++h)u.extensions.push(f.certificateExtensionFromAsn1(u.value[h]))}t.push(u)}}return t};var g=function(e,t,n){var r={};if(e!==l["RSASSA-PSS"])return r;n&&(r={hash:{algorithmOid:l.sha1},mgf:{algorithmOid:l.mgf1,hash:{algorithmOid:l.sha1}},saltLength:20});var i={},s=[];if(!a.validate(t,d,i,s)){var o=new Error("Cannot read RSASSA-PSS parameter block.");throw o.errors=s,o}return i.hashOid!==undefined&&(r.hash=r.hash||{},r.hash.algorithmOid=a.derToOid(i.hashOid)),i.maskGenOid!==undefined&&(r.mgf=r.mgf||{},r.mgf.algorithmOid=a.derToOid(i.maskGenOid),r.mgf.hash=r.mgf.hash||{},r.mgf.hash.algorithmOid=a.derToOid(i.maskGenHashOid)),i.saltLength!==undefined&&(r.saltLength=i.saltLength.charCodeAt(0)),r};f.certificateFromPem=function(t,n,r){var i=e.pem.decode(t)[0];if(i.type!=="CERTIFICATE"&&i.type!=="X509 CERTIFICATE"&&i.type!=="TRUSTED CERTIFICATE"){var s=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw s.headerType=i.type,s}if(i.procType&&i.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var o=a.fromDer(i.body,r);return f.certificateFromAsn1(o,n)},f.certificateToPem=function(t,n){var r={type:"CERTIFICATE",body:a.toDer(f.certificateToAsn1(t)).getBytes()};return e.pem.encode(r,{maxline:n})},f.publicKeyFromPem=function(t){var n=e.pem.decode(t)[0];if(n.type!=="PUBLIC KEY"&&n.type!=="RSA PUBLIC KEY"){var r=new Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');throw r.headerType=n.type,r}if(n.procType&&n.procType.type==="ENCRYPTED")throw new Error("Could not convert public key from PEM; PEM is encrypted.");var i=a.fromDer(n.body);return f.publicKeyFromAsn1(i)},f.publicKeyToPem=function(t,n){var r={type:"PUBLIC KEY",body:a.toDer(f.publicKeyToAsn1(t)).getBytes()};return e.pem.encode(r,{maxline:n})},f.publicKeyToRSAPublicKeyPem=function(t,n){var r={type:"RSA PUBLIC KEY",body:a.toDer(f.publicKeyToRSAPublicKey(t)).getBytes()};return e.pem.encode(r,{maxline:n})},f.getPublicKeyFingerprint=function(t,n){n=n||{};var r=n.md||e.md.sha1.create(),i=n.type||"RSAPublicKey",s;switch(i){case"RSAPublicKey":s=a.toDer(f.publicKeyToRSAPublicKey(t)).getBytes();break;case"SubjectPublicKeyInfo":s=a.toDer(f.publicKeyToAsn1(t)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+n.type+'".')}r.start(),r.update(s);var o=r.digest();if(n.encoding==="hex"){var u=o.toHex();return n.delimiter?u.match(/.{2}/g).join(n.delimiter):u}if(n.encoding==="binary")return o.getBytes();if(n.encoding)throw new Error('Unknown encoding "'+n.encoding+'".');return o},f.certificationRequestFromPem=function(t,n,r){var i=e.pem.decode(t)[0];if(i.type!=="CERTIFICATE REQUEST"){var s=new Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".');throw s.headerType=i.type,s}if(i.procType&&i.procType.type==="ENCRYPTED")throw new Error("Could not convert certification request from PEM; PEM is encrypted.");var o=a.fromDer(i.body,r);return f.certificationRequestFromAsn1(o,n)},f.certificationRequestToPem=function(t,n){var r={type:"CERTIFICATE REQUEST",body:a.toDer(f.certificationRequestToAsn1(t)).getBytes()};return e.pem.encode(r,{maxline:n})},f.createCertificate=function(){var n={};return n.version=2,n.serialNumber="00",n.signatureOid=null,n.signature=null,n.siginfo={},n.siginfo.algorithmOid=null,n.validity={},n.validity.notBefore=new Date,n.validity.notAfter=new Date,n.issuer={},n.issuer.getField=function(e){return t(n.issuer,e)},n.issuer.addField=function(e){i([e]),n.issuer.attributes.push(e)},n.issuer.attributes=[],n.issuer.hash=null,n.subject={},n.subject.getField=function(e){return t(n.subject,e)},n.subject.addField=function(e){i([e]),n.subject.attributes.push(e)},n.subject.attributes=[],n.subject.hash=null,n.extensions=[],n.publicKey=null,n.md=null,n.setSubject=function(e,t){i(e),n.subject.attributes=e,delete n.subject.uniqueId,t&&(n.subject.uniqueId=t),n.subject.hash=null},n.setIssuer=function(e,t){i(e),n.issuer.attributes=e,delete n.issuer.uniqueId,t&&(n.issuer.uniqueId=t),n.issuer.hash=null},n.setExtensions=function(e){for(var t=0;t<e.length;++t)s(e[t],{cert:n});n.extensions=e},n.getExtension=function(e){typeof e=="string"&&(e={name:e});var t=null,r;for(var i=0;t===null&&i<n.extensions.length;++i)r=n.extensions[i],e.id&&r.id===e.id?t=r:e.name&&r.name===e.name&&(t=r);return t},n.sign=function(t,r){n.md=r||e.md.sha1.create();var i=l[n.md.algorithm+"WithRSAEncryption"];if(!i){var s=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw s.algorithm=n.md.algorithm,s}n.signatureOid=n.siginfo.algorithmOid=i,n.tbsCertificate=f.getTBSCertificate(n);var o=a.toDer(n.tbsCertificate);n.md.update(o.getBytes()),n.signature=t.sign(n.md)},n.verify=function(t){var r=!1;if(!n.issued(t)){var i=t.issuer,s=n.subject,o=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.");throw o.expectedIssuer=i.attributes,o.actualIssuer=s.attributes,o}var u=t.md;if(u===null){if(t.signatureOid in l){var c=l[t.signatureOid];switch(c){case"sha1WithRSAEncryption":u=e.md.sha1.create();break;case"md5WithRSAEncryption":u=e.md.md5.create();break;case"sha256WithRSAEncryption":u=e.md.sha256.create();break;case"RSASSA-PSS":u=e.md.sha256.create()}}if(u===null){var o=new Error("Could not compute certificate digest. Unknown signature OID.");throw o.signatureOid=t.signatureOid,o}var h=t.tbsCertificate||f.getTBSCertificate(t),p=a.toDer(h);u.update(p.getBytes())}if(u!==null){var d;switch(t.signatureOid){case l.sha1WithRSAEncryption:d=undefined;break;case l["RSASSA-PSS"]:var v,m;v=l[t.signatureParameters.mgf.hash.algorithmOid];if(v===undefined||e.md[v]===undefined){var o=new Error("Unsupported MGF hash function.");throw o.oid=t.signatureParameters.mgf.hash.algorithmOid,o.name=v,o}m=l[t.signatureParameters.mgf.algorithmOid];if(m===undefined||e.mgf[m]===undefined){var o=new Error("Unsupported MGF function.");throw o.oid=t.signatureParameters.mgf.algorithmOid,o.name=m,o}m=e.mgf[m].create(e.md[v].create()),v=l[t.signatureParameters.hash.algorithmOid];if(v===undefined||e.md[v]===undefined)throw{message:"Unsupported RSASSA-PSS hash function.",oid:t.signatureParameters.hash.algorithmOid,name:v};d=e.pss.create(e.md[v].create(),m,t.signatureParameters.saltLength)}r=n.publicKey.verify(u.digest().getBytes(),t.signature,d)}return r},n.isIssuer=function(e){var t=!1,r=n.issuer,i=e.subject;if(r.hash&&i.hash)t=r.hash===i.hash;else if(r.attributes.length===i.attributes.length){t=!0;var s,o;for(var u=0;t&&u<r.attributes.length;++u){s=r.attributes[u],o=i.attributes[u];if(s.type!==o.type||s.value!==o.value)t=!1}}return t},n.issued=function(e){return e.isIssuer(n)},n.generateSubjectKeyIdentifier=function(){return f.getPublicKeyFingerprint(n.publicKey,{type:"RSAPublicKey"})},n.verifySubjectKeyIdentifier=function(){var t=l.subjectKeyIdentifier;for(var r=0;r<n.extensions.length;++r){var i=n.extensions[r];if(i.id===t){var s=n.generateSubjectKeyIdentifier().getBytes();return e.util.hexToBytes(i.subjectKeyIdentifier)===s}}return!1},n},f.certificateFromAsn1=function(n,r){var s={},o=[];if(!a.validate(n,p,s,o)){var u=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.");throw u.errors=o,u}if(typeof s.certSignature!="string"){var c="\0";for(var h=0;h<s.certSignature.length;++h)c+=a.toDer(s.certSignature[h]).getBytes();s.certSignature=c}var d=a.derToOid(s.publicKeyOid);if(d!==f.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var v=f.createCertificate();v.version=s.certVersion?s.certVersion.charCodeAt(0):0;var m=e.util.createBuffer(s.certSerialNumber);v.serialNumber=m.toHex(),v.signatureOid=e.asn1.derToOid(s.certSignatureOid),v.signatureParameters=g(v.signatureOid,s.certSignatureParams,!0),v.siginfo.algorithmOid=e.asn1.derToOid(s.certinfoSignatureOid),v.siginfo.parameters=g(v.siginfo.algorithmOid,s.certinfoSignatureParams,!1);var y=e.util.createBuffer(s.certSignature);++y.read,v.signature=y.getBytes();var b=[];s.certValidity1UTCTime!==undefined&&b.push(a.utcTimeToDate(s.certValidity1UTCTime)),s.certValidity2GeneralizedTime!==undefined&&b.push(a.generalizedTimeToDate(s.certValidity2GeneralizedTime)),s.certValidity3UTCTime!==undefined&&b.push(a.utcTimeToDate(s.certValidity3UTCTime)),s.certValidity4GeneralizedTime!==undefined&&b.push(a.generalizedTimeToDate(s.certValidity4GeneralizedTime));if(b.length>2)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(b.length<2)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");v.validity.notBefore=b[0],v.validity.notAfter=b[1],v.tbsCertificate=s.tbsCertificate;if(r){v.md=null;if(v.signatureOid in l){var d=l[v.signatureOid];switch(d){case"sha1WithRSAEncryption":v.md=e.md.sha1.create();break;case"md5WithRSAEncryption":v.md=e.md.md5.create();break;case"sha256WithRSAEncryption":v.md=e.md.sha256.create();break;case"RSASSA-PSS":v.md=e.md.sha256.create()}}if(v.md===null){var u=new Error("Could not compute certificate digest. Unknown signature OID.");throw u.signatureOid=v.signatureOid,u}var w=a.toDer(v.tbsCertificate);v.md.update(w.getBytes())}var E=e.md.sha1.create();v.issuer.getField=function(e){return t(v.issuer,e)},v.issuer.addField=function(e){i([e]),v.issuer.attributes.push(e)},v.issuer.attributes=f.RDNAttributesAsArray(s.certIssuer,E),s.certIssuerUniqueId&&(v.issuer.uniqueId=s.certIssuerUniqueId),v.issuer.hash=E.digest().toHex();var S=e.md.sha1.create();return v.subject.getField=function(e){return t(v.subject,e)},v.subject.addField=function(e){i([e]),v.subject.attributes.push(e)},v.subject.attributes=f.RDNAttributesAsArray(s.certSubject,S),s.certSubjectUniqueId&&(v.subject.uniqueId=s.certSubjectUniqueId),v.subject.hash=S.digest().toHex(),s.certExtensions?v.extensions=f.certificateExtensionsFromAsn1(s.certExtensions):v.extensions=[],v.publicKey=f.publicKeyFromAsn1(s.subjectPublicKeyInfo),v},f.certificateExtensionsFromAsn1=function(e){var t=[];for(var n=0;n<e.value.length;++n){var r=e.value[n];for(var i=0;i<r.value.length;++i)t.push(f.certificateExtensionFromAsn1(r.value[i]))}return t},f.certificateExtensionFromAsn1=function(t){var n={};n.id=a.derToOid(t.value[0].value),n.critical=!1,t.value[1].type===a.Type.BOOLEAN?(n.critical=t.value[1].value.charCodeAt(0)!==0,n.value=t.value[2].value):n.value=t.value[1].value;if(n.id in l){n.name=l[n.id];if(n.name==="keyUsage"){var r=a.fromDer(n.value),i=0,s=0;r.value.length>1&&(i=r.value.charCodeAt(1),s=r.value.length>2?r.value.charCodeAt(2):0),n.digitalSignature=(i&128)===128,n.nonRepudiation=(i&64)===64,n.keyEncipherment=(i&32)===32,n.dataEncipherment=(i&16)===16,n.keyAgreement=(i&8)===8,n.keyCertSign=(i&4)===4,n.cRLSign=(i&2)===2,n.encipherOnly=(i&1)===1,n.decipherOnly=(s&128)===128}else if(n.name==="basicConstraints"){var r=a.fromDer(n.value);r.value.length>0&&r.value[0].type===a.Type.BOOLEAN?n.cA=r.value[0].value.charCodeAt(0)!==0:n.cA=!1;var o=null;r.value.length>0&&r.value[0].type===a.Type.INTEGER?o=r.value[0].value:r.value.length>1&&(o=r.value[1].value),o!==null&&(n.pathLenConstraint=a.derToInteger(o))}else if(n.name==="extKeyUsage"){var r=a.fromDer(n.value);for(var u=0;u<r.value.length;++u){var f=a.derToOid(r.value[u].value);f in l?n[l[f]]=!0:n[f]=!0}}else if(n.name==="nsCertType"){var r=a.fromDer(n.value),i=0;r.value.length>1&&(i=r.value.charCodeAt(1)),n.client=(i&128)===128,n.server=(i&64)===64,n.email=(i&32)===32,n.objsign=(i&16)===16,n.reserved=(i&8)===8,n.sslCA=(i&4)===4,n.emailCA=(i&2)===2,n.objCA=(i&1)===1}else if(n.name==="subjectAltName"||n.name==="issuerAltName"){n.altNames=[];var c,r=a.fromDer(n.value);for(var h=0;h<r.value.length;++h){c=r.value[h];var p={type:c.type,value:c.value};n.altNames.push(p);switch(c.type){case 1:case 2:case 6:break;case 7:p.ip=e.util.bytesToIP(c.value);break;case 8:p.oid=a.derToOid(c.value);break;default:}}}else if(n.name==="subjectKeyIdentifier"){var r=a.fromDer(n.value);n.subjectKeyIdentifier=e.util.bytesToHex(r.value)}}return n},f.certificationRequestFromAsn1=function(n,r){var s={},o=[];if(!a.validate(n,m,s,o)){var u=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.");throw u.errors=o,u}if(typeof s.csrSignature!="string"){var c="\0";for(var h=0;h<s.csrSignature.length;++h)c+=a.toDer(s.csrSignature[h]).getBytes();s.csrSignature=c}var p=a.derToOid(s.publicKeyOid);if(p!==f.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var d=f.createCertificationRequest();d.version=s.csrVersion?s.csrVersion.charCodeAt(0):0,d.signatureOid=e.asn1.derToOid(s.csrSignatureOid),d.signatureParameters=g(d.signatureOid,s.csrSignatureParams,!0),d.siginfo.algorithmOid=e.asn1.derToOid(s.csrSignatureOid),d.siginfo.parameters=g(d.siginfo.algorithmOid,s.csrSignatureParams,!1);var v=e.util.createBuffer(s.csrSignature);++v.read,d.signature=v.getBytes(),d.certificationRequestInfo=s.certificationRequestInfo;if(r){d.md=null;if(d.signatureOid in l){var p=l[d.signatureOid];switch(p){case"sha1WithRSAEncryption":d.md=e.md.sha1.create();break;case"md5WithRSAEncryption":d.md=e.md.md5.create();break;case"sha256WithRSAEncryption":d.md=e.md.sha256.create();break;case"RSASSA-PSS":d.md=e.md.sha256.create()}}if(d.md===null){var u=new Error("Could not compute certification request digest. Unknown signature OID.");throw u.signatureOid=d.signatureOid,u}var y=a.toDer(d.certificationRequestInfo);d.md.update(y.getBytes())}var b=e.md.sha1.create();return d.subject.getField=function(e){return t(d.subject,e)},d.subject.addField=function(e){i([e]),d.subject.attributes.push(e)},d.subject.attributes=f.RDNAttributesAsArray(s.certificationRequestInfoSubject,b),d.subject.hash=b.digest().toHex(),d.publicKey=f.publicKeyFromAsn1(s.subjectPublicKeyInfo),d.getAttribute=function(e){return t(d,e)},d.addAttribute=function(e){i([e]),d.attributes.push(e)},d.attributes=f.CRIAttributesAsArray(s.certificationRequestInfoAttributes||[]),d},f.createCertificationRequest=function(){var n={};return n.version=0,n.signatureOid=null,n.signature=null,n.siginfo={},n.siginfo.algorithmOid=null,n.subject={},n.subject.getField=function(e){return t(n.subject,e)},n.subject.addField=function(e){i([e]),n.subject.attributes.push(e)},n.subject.attributes=[],n.subject.hash=null,n.publicKey=null,n.attributes=[],n.getAttribute=function(e){return t(n,e)},n.addAttribute=function(e){i([e]),n.attributes.push(e)},n.md=null,n.setSubject=function(e){i(e),n.subject.attributes=e,n.subject.hash=null},n.setAttributes=function(e){i(e),n.attributes=e},n.sign=function(t,r){n.md=r||e.md.sha1.create();var i=l[n.md.algorithm+"WithRSAEncryption"];if(!i){var s=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw s.algorithm=n.md.algorithm,s}n.signatureOid=n.siginfo.algorithmOid=i,n.certificationRequestInfo=f.getCertificationRequestInfo(n);var o=a.toDer(n.certificationRequestInfo);n.md.update(o.getBytes()),n.signature=t.sign(n.md)},n.verify=function(){var t=!1,r=n.md;if(r===null){if(n.signatureOid in l){var i=l[n.signatureOid];switch(i){case"sha1WithRSAEncryption":r=e.md.sha1.create();break;case"md5WithRSAEncryption":r=e.md.md5.create();break;case"sha256WithRSAEncryption":r=e.md.sha256.create();break;case"RSASSA-PSS":r=e.md.sha256.create()}}if(r===null){var s=new Error("Could not compute certification request digest. Unknown signature OID.");throw s.signatureOid=n.signatureOid,s}var o=n.certificationRequestInfo||f.getCertificationRequestInfo(n),u=a.toDer(o);r.update(u.getBytes())}if(r!==null){var c;switch(n.signatureOid){case l.sha1WithRSAEncryption:break;case l["RSASSA-PSS"]:var h,p;h=l[n.signatureParameters.mgf.hash.algorithmOid];if(h===undefined||e.md[h]===undefined){var s=new Error("Unsupported MGF hash function.");throw s.oid=n.signatureParameters.mgf.hash.algorithmOid,s.name=h,s}p=l[n.signatureParameters.mgf.algorithmOid];if(p===undefined||e.mgf[p]===undefined){var s=new Error("Unsupported MGF function.");throw s.oid=n.signatureParameters.mgf.algorithmOid,s.name=p,s}p=e.mgf[p].create(e.md[h].create()),h=l[n.signatureParameters.hash.algorithmOid];if(h===undefined||e.md[h]===undefined){var s=new Error("Unsupported RSASSA-PSS hash function.");throw s.oid=n.signatureParameters.hash.algorithmOid,s.name=h,s}c=e.pss.create(e.md[h].create(),p,n.signatureParameters.saltLength)}t=n.publicKey.verify(r.digest().getBytes(),n.signature,c)}return t},n},f.getTBSCertificate=function(t){var r=a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.CONTEXT_SPECIFIC,0,!0,[a.create(a.Class.UNIVERSAL,a.Type.INTEGER,!1,a.integerToDer(t.version).getBytes())]),a.create(a.Class.UNIVERSAL,a.Type.INTEGER,!1,e.util.hexToBytes(t.serialNumber)),a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.OID,!1,a.oidToDer(t.siginfo.algorithmOid).getBytes()),o(t.siginfo.algorithmOid,t.siginfo.parameters)]),n(t.issuer),a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.UTCTIME,!1,a.dateToUtcTime(t.validity.notBefore)),a.create(a.Class.UNIVERSAL,a.Type.UTCTIME,!1,a.dateToUtcTime(t.validity.notAfter))]),n(t.subject),f.publicKeyToAsn1(t.publicKey)]);return t.issuer.uniqueId&&r.value.push(a.create(a.Class.CONTEXT_SPECIFIC,1,!0,[a.create(a.Class.UNIVERSAL,a.Type.BITSTRING,!1,String.fromCharCode(0)+t.issuer.uniqueId)])),t.subject.uniqueId&&r.value.push(a.create(a.Class.CONTEXT_SPECIFIC,2,!0,[a.create(a.Class.UNIVERSAL,a.Type.BITSTRING,!1,String.fromCharCode(0)+t.subject.uniqueId)])),t.extensions.length>0&&r.value.push(f.certificateExtensionsToAsn1(t.extensions)),r},f.getCertificationRequestInfo=function(e){var t=a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.INTEGER,!1,a.integerToDer(e.version).getBytes()),n(e.subject),f.publicKeyToAsn1(e.publicKey),u(e)]);return t},f.distinguishedNameToAsn1=function(e){return n(e)},f.certificateToAsn1=function(e){var t=e.tbsCertificate||f.getTBSCertificate(e);return a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[t,a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.OID,!1,a.oidToDer(e.signatureOid).getBytes()),o(e.signatureOid,e.signatureParameters)]),a.create(a.Class.UNIVERSAL,a.Type.BITSTRING,!1,String.fromCharCode(0)+e.signature)])},f.certificateExtensionsToAsn1=function(e){var t=a.create(a.Class.CONTEXT_SPECIFIC,3,!0,[]),n=a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[]);t.value.push(n);for(var r=0;r<e.length;++r)n.value.push(f.certificateExtensionToAsn1(e[r]));return t},f.certificateExtensionToAsn1=function(e){var t=a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[]);t.value.push(a.create(a.Class.UNIVERSAL,a.Type.OID,!1,a.oidToDer(e.id).getBytes())),e.critical&&t.value.push(a.create(a.Class.UNIVERSAL,a.Type.BOOLEAN,!1,String.fromCharCode(255)));var n=e.value;return typeof e.value!="string"&&(n=a.toDer(n).getBytes()),t.value.push(a.create(a.Class.UNIVERSAL,a.Type.OCTETSTRING,!1,n)),t},f.certificationRequestToAsn1=function(e){var t=e.certificationRequestInfo||f.getCertificationRequestInfo(e);return a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[t,a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.OID,!1,a.oidToDer(e.signatureOid).getBytes()),o(e.signatureOid,e.signatureParameters)]),a.create(a.Class.UNIVERSAL,a.Type.BITSTRING,!1,String.fromCharCode(0)+e.signature)])},f.createCaStore=function(t){function r(t){if(!t.hash){var r=e.md.sha1.create();t.attributes=f.RDNAttributesAsArray(n(t),r),t.hash=r.digest().toHex()}return i.certs[t.hash]||null}var i={certs:{}};i.getIssuer=function(e){var t=r(e.issuer);return t},i.addCertificate=function(t){typeof t=="string"&&(t=e.pki.certificateFromPem(t));if(!t.subject.hash){var r=e.md.sha1.create();t.subject.attributes=f.RDNAttributesAsArray(n(t.subject),r),t.subject.hash=r.digest().toHex()}if(t.subject.hash in i.certs){var s=i.certs[t.subject.hash];e.util.isArray(s)||(s=[s]),s.push(t)}else i.certs[t.subject.hash]=t},i.hasCertificate=function(t){var n=r(t.subject);if(!n)return!1;e.util.isArray(n)||(n=[n]);var i=a.toDer(f.certificateToAsn1(t)).getBytes();for(var s=0;s<n.length;++s){var o=a.toDer(f.certificateToAsn1(n[s])).getBytes();if(i===o)return!0}return!1};if(t)for(var s=0;s<t.length;++s){var o=t[s];i.addCertificate(o)}return i},f.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"},f.verifyCertificateChain=function(t,n,r){n=n.slice(0);var i=n.slice(0),s=new Date,o=!0,u=null,a=0;do{var l=n.shift(),c=null,h=!1;if(s<l.validity.notBefore||s>l.validity.notAfter)u={message:"Certificate is not valid yet or has expired.",error:f.certificateError.certificate_expired,notBefore:l.validity.notBefore,notAfter:l.validity.notAfter,now:s};if(u===null){c=n[0]||t.getIssuer(l),c===null&&l.isIssuer(l)&&(h=!0,c=l);if(c){var p=c;e.util.isArray(p)||(p=[p]);var d=!1;while(!d&&p.length>0){c=p.shift();try{d=c.verify(l)}catch(v){}}d||(u={message:"Certificate signature is invalid.",error:f.certificateError.bad_certificate})}u===null&&(!c||h)&&!t.hasCertificate(l)&&(u={message:"Certificate is not trusted.",error:f.certificateError.unknown_ca})}u===null&&c&&!l.isIssuer(c)&&(u={message:"Certificate issuer is invalid.",error:f.certificateError.bad_certificate});if(u===null){var m={keyUsage:!0,basicConstraints:!0};for(var g=0;u===null&&g<l.extensions.length;++g){var y=l.extensions[g];y.critical&&!(y.name in m)&&(u={message:"Certificate has an unsupported critical extension.",error:f.certificateError.unsupported_certificate})}}if(u===null&&(!o||n.length===0&&(!c||h))){var b=l.getExtension("basicConstraints"),w=l.getExtension("keyUsage");w!==null&&(!w.keyCertSign||b===null)&&(u={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:f.certificateError.bad_certificate}),u===null&&b!==null&&!b.cA&&(u={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:f.certificateError.bad_certificate});if(u===null&&w!==null&&"pathLenConstraint"in b){var E=a-1;E>b.pathLenConstraint&&(u={message:"Certificate basicConstraints pathLenConstraint violated.",error:f.certificateError.bad_certificate})}}var S=u===null?!0:u.error,x=r?r(S,a,i):S;if(x!==!0){S===!0&&(u={message:"The application rejected the certificate.",error:f.certificateError.bad_certificate});if(x||x===0)typeof x=="object"&&!e.util.isArray(x)?(x.message&&(u.message=x.message),x.error&&(u.error=x.error)):typeof x=="string"&&(u.error=x);throw u}u=null,o=!1,++a}while(n.length>0);return!0}}var r="x509";if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),e(forge);var i=!0;n=function(e,n){n(t,module)}}var s,o=function(t,n){n.exports=function(n){var i=s.map(function(e){return t(e)}).concat(e);n=n||{},n.defined=n.defined||{};if(n.defined[r])return n[r];n.defined[r]=!0;for(var o=0;o<i.length;++o)i[o](n);return n.pki}},u=n;n=function(e,t){return s=typeof e=="string"?t.slice(2):e.slice(2),i?(delete n,u.apply(null,Array.prototype.slice.call(arguments,0))):(n=u,n.apply(null,Array.prototype.slice.call(arguments,0)))},n("js/x509",["require","module","./aes","./asn1","./des","./md","./mgf","./oids","./pem","./pss","./rsa","./util"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){function t(e,t,n,r){var i=[];for(var s=0;s<e.length;s++)for(var o=0;o<e[s].safeBags.length;o++){var u=e[s].safeBags[o];if(r!==undefined&&u.type!==r)continue;if(t===null){i.push(u);continue}u.attributes[t]!==undefined&&u.attributes[t].indexOf(n)>=0&&i.push(u)}return i}function n(t){if(t.composed||t.constructed){var n=e.util.createBuffer();for(var r=0;r<t.value.length;++r)n.putBytes(t.value[r].value);t.composed=t.constructed=!1,t.value=n.getBytes()}return t}function r(e,t,r,o){t=u.fromDer(t,r);if(t.tagClass!==u.Class.UNIVERSAL||t.type!==u.Type.SEQUENCE||t.constructed!==!0)throw new Error("PKCS#12 AuthenticatedSafe expected to be a SEQUENCE OF ContentInfo");for(var f=0;f<t.value.length;f++){var c=t.value[f],h={},p=[];if(!u.validate(c,l,h,p)){var d=new Error("Cannot read ContentInfo.");throw d.errors=p,d}var v={encrypted:!1},m=null,g=h.content.value[0];switch(u.derToOid(h.contentType)){case a.oids.data:if(g.tagClass!==u.Class.UNIVERSAL||g.type!==u.Type.OCTETSTRING)throw new Error("PKCS#12 SafeContents Data is not an OCTET STRING.");m=n(g).value;break;case a.oids.encryptedData:m=i(g,o),v.encrypted=!0;break;default:var d=new Error("Unsupported PKCS#12 contentType.");throw d.contentType=u.derToOid(h.contentType),d}v.safeBags=s(m,r,o),e.safeContents.push(v)}}function i(t,r){var i={},s=[];if(!u.validate(t,e.pkcs7.asn1.encryptedDataValidator,i,s)){var o=new Error("Cannot read EncryptedContentInfo.");throw o.errors=s,o}var f=u.derToOid(i.contentType);if(f!==a.oids.data){var o=new Error("PKCS#12 EncryptedContentInfo ContentType is not Data.");throw o.oid=f,o}f=u.derToOid(i.encAlgorithm);var l=a.pbe.getCipher(f,i.encParameter,r),c=n(i.encryptedContentAsn1),h=e.util.createBuffer(c.value);l.update(h);if(!l.finish())throw new Error("Failed to decrypt PKCS#12 SafeContents.");return l.output.getBytes()}function s(e,t,n){if(!t&&e.length===0)return[];e=u.fromDer(e,t);if(e.tagClass!==u.Class.UNIVERSAL||e.type!==u.Type.SEQUENCE||e.constructed!==!0)throw new Error("PKCS#12 SafeContents expected to be a SEQUENCE OF SafeBag.");var r=[];for(var i=0;i<e.value.length;i++){var s=e.value[i],f={},l=[];if(!u.validate(s,h,f,l)){var c=new Error("Cannot read SafeBag.");throw c.errors=l,c}var p={type:u.derToOid(f.bagId),attributes:o(f.bagAttributes)};r.push(p);var v,m,g=f.bagValue.value[0];switch(p.type){case a.oids.pkcs8ShroudedKeyBag:g=a.decryptPrivateKeyInfo(g,n);if(g===null)throw new Error("Unable to decrypt PKCS#8 ShroudedKeyBag, wrong password?");case a.oids.keyBag:try{p.key=a.privateKeyFromAsn1(g)}catch(y){p.key=null,p.asn1=g}continue;case a.oids.certBag:v=d,m=function(){if(u.derToOid(f.certId)!==a.oids.x509Certificate){var e=new Error("Unsupported certificate type, only X.509 supported.");throw e.oid=u.derToOid(f.certId),e}var n=u.fromDer(f.cert,t);try{p.cert=a.certificateFromAsn1(n,!0)}catch(r){p.cert=null,p.asn1=n}};break;default:var c=new Error("Unsupported PKCS#12 SafeBag type.");throw c.oid=p.type,c}if(v!==undefined&&!u.validate(g,v,f,l)){var c=new Error("Cannot read PKCS#12 "+v.name);throw c.errors=l,c}m()}return r}function o(e){var t={};if(e!==undefined)for(var n=0;n<e.length;++n){var r={},i=[];if(!u.validate(e[n],p,r,i)){var s=new Error("Cannot read PKCS#12 BagAttribute.");throw s.errors=i,s}var o=u.derToOid(r.oid);if(a.oids[o]===undefined)continue;t[a.oids[o]]=[];for(var f=0;f<r.values.length;++f)t[a.oids[o]].push(r.values[f].value)}return t}var u=e.asn1,a=e.pki,f=e.pkcs12=e.pkcs12||{},l={name:"ContentInfo",tagClass:u.Class.UNIVERSAL,type:u.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.contentType",tagClass:u.Class.UNIVERSAL,type:u.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:u.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"content"}]},c={name:"PFX",tagClass:u.Class.UNIVERSAL,type:u.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.version",tagClass:u.Class.UNIVERSAL,type:u.Type.INTEGER,constructed:!1,capture:"version"},l,{name:"PFX.macData",tagClass:u.Class.UNIVERSAL,type:u.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"mac",value:[{name:"PFX.macData.mac",tagClass:u.Class.UNIVERSAL,type:u.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm",tagClass:u.Class.UNIVERSAL,type:u.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm.algorithm",tagClass:u.Class.UNIVERSAL,type:u.Type.OID,constructed:!1,capture:"macAlgorithm"},{name:"PFX.macData.mac.digestAlgorithm.parameters",tagClass:u.Class.UNIVERSAL,captureAsn1:"macAlgorithmParameters"}]},{name:"PFX.macData.mac.digest",tagClass:u.Class.UNIVERSAL,type:u.Type.OCTETSTRING,constructed:!1,capture:"macDigest"}]},{name:"PFX.macData.macSalt",tagClass:u.Class.UNIVERSAL,type:u.Type.OCTETSTRING,constructed:!1,capture:"macSalt"},{name:"PFX.macData.iterations",tagClass:u.Class.UNIVERSAL,type:u.Type.INTEGER,constructed:!1,optional:!0,capture:"macIterations"}]}]},h={name:"SafeBag",tagClass:u.Class.UNIVERSAL,type:u.Type.SEQUENCE,constructed:!0,value:[{name:"SafeBag.bagId",tagClass:u.Class.UNIVERSAL,type:u.Type.OID,constructed:!1,capture:"bagId"},{name:"SafeBag.bagValue",tagClass:u.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"bagValue"},{name:"SafeBag.bagAttributes",tagClass:u.Class.UNIVERSAL,type:u.Type.SET,constructed:!0,optional:!0,capture:"bagAttributes"}]},p={name:"Attribute",tagClass:u.Class.UNIVERSAL,type:u.Type.SEQUENCE,constructed:!0,value:[{name:"Attribute.attrId",tagClass:u.Class.UNIVERSAL,type:u.Type.OID,constructed:!1,capture:"oid"},{name:"Attribute.attrValues",tagClass:u.Class.UNIVERSAL,type:u.Type.SET,constructed:!0,capture:"values"}]},d={name:"CertBag",tagClass:u.Class.UNIVERSAL,type:u.Type.SEQUENCE,constructed:!0,value:[{name:"CertBag.certId",tagClass:u.Class.UNIVERSAL,type:u.Type.OID,constructed:!1,capture:"certId"},{name:"CertBag.certValue",tagClass:u.Class.CONTEXT_SPECIFIC,constructed:!0,value:[{name:"CertBag.certValue[0]",tagClass:u.Class.UNIVERSAL,type:u.Class.OCTETSTRING,constructed:!1,capture:"cert"}]}]};f.pkcs12FromAsn1=function(i,s,o){typeof s=="string"?(o=s,s=!0):s===undefined&&(s=!0);var l={},h=[];if(!u.validate(i,c,l,h)){var p=new Error("Cannot read PKCS#12 PFX. ASN.1 object is not an PKCS#12 PFX.");throw p.errors=p,p}var d={version:l.version.charCodeAt(0),safeContents:[],getBags:function(n){var r={},i;return"localKeyId"in n?i=n.localKeyId:"localKeyIdHex"in n&&(i=e.util.hexToBytes(n.localKeyIdHex)),i===undefined&&!("friendlyName"in n)&&"bagType"in n&&(r[n.bagType]=t(d.safeContents,null,null,n.bagType)),i!==undefined&&(r.localKeyId=t(d.safeContents,"localKeyId",i,n.bagType)),"friendlyName"in n&&(r.friendlyName=t(d.safeContents,"friendlyName",n.friendlyName,n.bagType)),r},getBagsByFriendlyName:function(e,n){return t(d.safeContents,"friendlyName",e,n)},getBagsByLocalKeyId:function(e,n){return t(d.safeContents,"localKeyId",e,n)}};if(l.version.charCodeAt(0)!==3){var p=new Error("PKCS#12 PFX of version other than 3 not supported.");throw p.version=l.version.charCodeAt(0),p}if(u.derToOid(l.contentType)!==a.oids.data){var p=new Error("Only PKCS#12 PFX in password integrity mode supported.");throw p.oid=u.derToOid(l.contentType),p}var v=l.content.value[0];if(v.tagClass!==u.Class.UNIVERSAL||v.type!==u.Type.OCTETSTRING)throw new Error("PKCS#12 authSafe content data is not an OCTET STRING.");v=n(v);if(l.mac){var m=null,g=0,y=u.derToOid(l.macAlgorithm);switch(y){case a.oids.sha1:m=e.md.sha1.create(),g=20;break;case a.oids.sha256:m=e.md.sha256.create(),g=32;break;case a.oids.sha384:m=e.md.sha384.create(),g=48;break;case a.oids.sha512:m=e.md.sha512.create(),g=64;break;case a.oids.md5:m=e.md.md5.create(),g=16}if(m===null)throw new Error("PKCS#12 uses unsupported MAC algorithm: "+y);var b=new e.util.ByteBuffer(l.macSalt),w="macIterations"in l?parseInt(e.util.bytesToHex(l.macIterations),16):1,E=f.generateKey(o,b,3,w,g,m),S=e.hmac.create();S.start(m,E),S.update(v.value);var x=S.getMac();if(x.getBytes()!==l.macDigest)throw new Error("PKCS#12 MAC could not be verified. Invalid password?")}return r(d,v.value,s,o),d},f.toPkcs12Asn1=function(t,n,r,i){i=i||{},i.saltSize=i.saltSize||8,i.count=i.count||2048,i.algorithm=i.algorithm||i.encAlgorithm||"aes128","useMac"in i||(i.useMac=!0),"localKeyId"in i||(i.localKeyId=null),"generateLocalKeyId"in i||(i.generateLocalKeyId=!0);var s=i.localKeyId,o;if(s!==null)s=e.util.hexToBytes(s);else if(i.generateLocalKeyId)if(n){var l=e.util.isArray(n)?n[0]:n;typeof l=="string"&&(l=a.certificateFromPem(l));var c=e.md.sha1.create();c.update(u.toDer(a.certificateToAsn1(l)).getBytes()),s=c.digest().getBytes()}else s=e.random.getBytes(20);var h=[];s!==null&&h.push(u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,!0,[u.create(u.Class.UNIVERSAL,u.Type.OID,!1,u.oidToDer(a.oids.localKeyId).getBytes()),u.create(u.Class.UNIVERSAL,u.Type.SET,!0,[u.create(u.Class.UNIVERSAL,u.Type.OCTETSTRING,!1,s)])])),"friendlyName"in i&&h.push(u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,!0,[u.create(u.Class.UNIVERSAL,u.Type.OID,!1,u.oidToDer(a.oids.friendlyName).getBytes()),u.create(u.Class.UNIVERSAL,u.Type.SET,!0,[u.create(u.Class.UNIVERSAL,u.Type.BMPSTRING,!1,i.friendlyName)])])),h.length>0&&(o=u.create(u.Class.UNIVERSAL,u.Type.SET,!0,h));var p=[],d=[];n!==null&&(e.util.isArray(n)?d=n:d=[n]);var v=[];for(var m=0;m<d.length;++m){n=d[m],typeof n=="string"&&(n=a.certificateFromPem(n));var g=m===0?o:undefined,y=a.certificateToAsn1(n),b=u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,!0,[u.create(u.Class.UNIVERSAL,u.Type.OID,!1,u.oidToDer(a.oids.certBag).getBytes()),u.create(u.Class.CONTEXT_SPECIFIC,0,!0,[u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,!0,[u.create(u.Class.UNIVERSAL,u.Type.OID,!1,u.oidToDer(a.oids.x509Certificate).getBytes()),u.create(u.Class.CONTEXT_SPECIFIC,0,!0,[u.create(u.Class.UNIVERSAL,u.Type.OCTETSTRING,!1,u.toDer(y).getBytes())])])]),g]);v.push(b)}if(v.length>0){var w=u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,!0,v),E=u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,!0,[u.create(u.Class.UNIVERSAL,u.Type.OID,!1,u.oidToDer(a.oids.data).getBytes()),u.create(u.Class.CONTEXT_SPECIFIC,0,!0,[u.create(u.Class.UNIVERSAL,u.Type.OCTETSTRING,!1,u.toDer(w).getBytes())])]);p.push(E)}var S=null;if(t!==null){var x=a.wrapRsaPrivateKey(a.privateKeyToAsn1(t));r===null?S=u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,!0,[u.create(u.Class.UNIVERSAL,u.Type.OID,!1,u.oidToDer(a.oids.keyBag).getBytes()),u.create(u.Class.CONTEXT_SPECIFIC,0,!0,[x]),o]):S=u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,!0,[u.create(u.Class.UNIVERSAL,u.Type.OID,!1,u.oidToDer(a.oids.pkcs8ShroudedKeyBag).getBytes()),u.create(u.Class.CONTEXT_SPECIFIC,0,!0,[a.encryptPrivateKeyInfo(x,r,i)]),o]);var T=u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,!0,[S]),N=u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,!0,[u.create(u.Class.UNIVERSAL,u.Type.OID,!1,u.oidToDer(a.oids.data).getBytes()),u.create(u.Class.CONTEXT_SPECIFIC,0,!0,[u.create(u.Class.UNIVERSAL,u.Type.OCTETSTRING,!1,u.toDer(T).getBytes())])]);p.push(N)}var C=u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,!0,p),k;if(i.useMac){var c=e.md.sha1.create(),L=new e.util.ByteBuffer(e.random.getBytes(i.saltSize)),A=i.count,t=f.generateKey(r,L,3,A,20),O=e.hmac.create();O.start(c,t),O.update(u.toDer(C).getBytes());var M=O.getMac();k=u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,!0,[u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,!0,[u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,!0,[u.create(u.Class.UNIVERSAL,u.Type.OID,!1,u.oidToDer(a.oids.sha1).getBytes()),u.create(u.Class.UNIVERSAL,u.Type.NULL,!1,"")]),u.create(u.Class.UNIVERSAL,u.Type.OCTETSTRING,!1,M.getBytes())]),u.create(u.Class.UNIVERSAL,u.Type.OCTETSTRING,!1,L.getBytes()),u.create(u.Class.UNIVERSAL,u.Type.INTEGER,!1,u.integerToDer(A).getBytes())])}return u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,!0,[u.create(u.Class.UNIVERSAL,u.Type.INTEGER,!1,u.integerToDer(3).getBytes()),u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,!0,[u.create(u.Class.UNIVERSAL,u.Type.OID,!1,u.oidToDer(a.oids.data).getBytes()),u.create(u.Class.CONTEXT_SPECIFIC,0,!0,[u.create(u.Class.UNIVERSAL,u.Type.OCTETSTRING,!1,u.toDer(C).getBytes())])]),k])},f.generateKey=e.pbe.generatePkcs12Key}var r="pkcs12";if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),e(forge);var i=!0;n=function(e,n){n(t,module)}}var s,o=function(t,n){n.exports=function(n){var i=s.map(function(e){return t(e)}).concat(e);n=n||{},n.defined=n.defined||{};if(n.defined[r])return n[r];n.defined[r]=!0;for(var o=0;o<i.length;++o)i[o](n);return n[r]}},u=n;n=function(e,t){return s=typeof e=="string"?t.slice(2):e.slice(2),i?(delete n,u.apply(null,Array.prototype.slice.call(arguments,0))):(n=u,n.apply(null,Array.prototype.slice.call(arguments,0)))},n("js/pkcs12",["require","module","./asn1","./hmac","./oids","./pkcs7asn1","./pbe","./random","./rsa","./sha1","./util","./x509"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){var t=e.asn1,n=e.pki=e.pki||{};n.pemToDer=function(t){var n=e.pem.decode(t)[0];if(n.procType&&n.procType.type==="ENCRYPTED")throw new Error("Could not convert PEM to DER; PEM is encrypted.");return e.util.createBuffer(n.body)},n.privateKeyFromPem=function(r){var i=e.pem.decode(r)[0];if(i.type!=="PRIVATE KEY"&&i.type!=="RSA PRIVATE KEY"){var s=new Error('Could not convert private key from PEM; PEM header type is not "PRIVATE KEY" or "RSA PRIVATE KEY".');throw s.headerType=i.type,s}if(i.procType&&i.procType.type==="ENCRYPTED")throw new Error("Could not convert private key from PEM; PEM is encrypted.");var o=t.fromDer(i.body);return n.privateKeyFromAsn1(o)},n.privateKeyToPem=function(r,i){var s={type:"RSA PRIVATE KEY",body:t.toDer(n.privateKeyToAsn1(r)).getBytes()};return e.pem.encode(s,{maxline:i})},n.privateKeyInfoToPem=function(n,r){var i={type:"PRIVATE KEY",body:t.toDer(n).getBytes()};return e.pem.encode(i,{maxline:r})}}var r="pki";if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),e(forge);var i=!0;n=function(e,n){n(t,module)}}var s,o=function(t,n){n.exports=function(n){var i=s.map(function(e){return t(e)}).concat(e);n=n||{},n.defined=n.defined||{};if(n.defined[r])return n[r];n.defined[r]=!0;for(var o=0;o<i.length;++o)i[o](n);return n[r]}},u=n;n=function(e,t){return s=typeof e=="string"?t.slice(2):e.slice(2),i?(delete n,u.apply(null,Array.prototype.slice.call(arguments,0))):(n=u,n.apply(null,Array.prototype.slice.call(arguments,0)))},n("js/pki",["require","module","./asn1","./oids","./pbe","./pem","./pbkdf2","./pkcs12","./pss","./rsa","./util","./x509"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){var t=function(t,n,r,i){var s=e.util.createBuffer(),o=t.length>>1,u=o+(t.length&1),a=t.substr(0,u),f=t.substr(o,u),l=e.util.createBuffer(),c=e.hmac.create();r=n+r;var h=Math.ceil(i/16),p=Math.ceil(i/20);c.start("MD5",a);var d=e.util.createBuffer();l.putBytes(r);for(var v=0;v<h;++v)c.start(null,null),c.update(l.getBytes()),l.putBuffer(c.digest()),c.start(null,null),c.update(l.bytes()+r),d.putBuffer(c.digest());c.start("SHA1",f);var m=e.util.createBuffer();l.clear(),l.putBytes(r);for(var v=0;v<p;++v)c.start(null,null),c.update(l.getBytes()),l.putBuffer(c.digest()),c.start(null,null),c.update(l.bytes()+r),m.putBuffer(c.digest());return s.putBytes(e.util.xorBytes(d.getBytes(),m.getBytes(),i)),s},n=function(e,t,n,r){},r=function(t,n,r){var i=e.hmac.create();i.start("SHA1",t);var s=e.util.createBuffer();return s.putInt32(n[0]),s.putInt32(n[1]),s.putByte(r.type),s.putByte(r.version.major),s.putByte(r.version.minor),s.putInt16(r.length),s.putBytes(r.fragment.bytes()),i.update(s.getBytes()),i.digest().getBytes()},i=function(t,n,r){var i=!1;try{var s=t.deflate(n.fragment.getBytes());n.fragment=e.util.createBuffer(s),n.length=s.length,i=!0}catch(o){}return i},s=function(t,n,r){var i=!1;try{var s=t.inflate(n.fragment.getBytes());n.fragment=e.util.createBuffer(s),n.length=s.length,i=!0}catch(o){}return i},o=function(t,n){var r=0;switch(n){case 1:r=t.getByte();break;case 2:r=t.getInt16();break;case 3:r=t.getInt24();break;case 4:r=t.getInt32()}return e.util.createBuffer(t.getBytes(r))},u=function(e,t,n){e.putInt(n.length(),t<<3),e.putBuffer(n)},a={};a.Versions={TLS_1_0:{major:3,minor:1},TLS_1_1:{major:3,minor:2},TLS_1_2:{major:3,minor:3}},a.SupportedVersions=[a.Versions.TLS_1_1,a.Versions.TLS_1_0],a.Version=a.SupportedVersions[0],a.MaxFragment=15360,a.ConnectionEnd={server:0,client:1},a.PRFAlgorithm={tls_prf_sha256:0},a.BulkCipherAlgorithm={none:null,rc4:0,des3:1,aes:2},a.CipherType={stream:0,block:1,aead:2},a.MACAlgorithm={none:null,hmac_md5:0,hmac_sha1:1,hmac_sha256:2,hmac_sha384:3,hmac_sha512:4},a.CompressionMethod={none:0,deflate:1},a.ContentType={change_cipher_spec:20,alert:21,handshake:22,application_data:23,heartbeat:24},a.HandshakeType={hello_request:0,client_hello:1,server_hello:2,certificate:11,server_key_exchange:12,certificate_request:13,server_hello_done:14,certificate_verify:15,client_key_exchange:16,finished:20},a.Alert={},a.Alert.Level={warning:1,fatal:2},a.Alert.Description={close_notify:0,unexpected_message:10,bad_record_mac:20,decryption_failed:21,record_overflow:22,decompression_failure:30,handshake_failure:40,bad_certificate:42,unsupported_certificate:43,certificate_revoked:44,certificate_expired:45,certificate_unknown:46,illegal_parameter:47,unknown_ca:48,access_denied:49,decode_error:50,decrypt_error:51,export_restriction:60,protocol_version:70,insufficient_security:71,internal_error:80,user_canceled:90,no_renegotiation:100},a.HeartbeatMessageType={heartbeat_request:1,heartbeat_response:2},a.CipherSuites={},a.getCipherSuite=function(e){var t=null;for(var n in a.CipherSuites){var r=a.CipherSuites[n];if(r.id[0]===e.charCodeAt(0)&&r.id[1]===e.charCodeAt(1)){t=r;break}}return t},a.handleUnexpected=function(e,t){var n=!e.open&&e.entity===a.ConnectionEnd.client;n||e.error(e,{message:"Unexpected message. Received TLS record out of order.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.unexpected_message}})},a.handleHelloRequest=function(e,t,n){!e.handshaking&&e.handshakes>0&&(a.queue(e,a.createAlert(e,{level:a.Alert.Level.warning,description:a.Alert.Description.no_renegotiation})),a.flush(e)),e.process()},a.parseHelloMessage=function(t,n,r){var i=null,s=t.entity===a.ConnectionEnd.client;if(r<38)t.error(t,{message:s?"Invalid ServerHello message. Message too short.":"Invalid ClientHello message. Message too short.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.illegal_parameter}});else{var u=n.fragment,f=u.length();i={version:{major:u.getByte(),minor:u.getByte()},random:e.util.createBuffer(u.getBytes(32)),session_id:o(u,1),extensions:[]},s?(i.cipher_suite=u.getBytes(2),i.compression_method=u.getByte()):(i.cipher_suites=o(u,2),i.compression_methods=o(u,1)),f=r-(f-u.length());if(f>0){var l=o(u,2);while(l.length()>0)i.extensions.push({type:[l.getByte(),l.getByte()],data:o(l,2)});if(!s)for(var c=0;c<i.extensions.length;++c){var h=i.extensions[c];if(h.type[0]===0&&h.type[1]===0){var p=o(h.data,2);while(p.length()>0){var d=p.getByte();if(d!==0)break;t.session.extensions.server_name.serverNameList.push(o(p,2).getBytes())}}}}if(t.session.version)if(i.version.major!==t.session.version.major||i.version.minor!==t.session.version.minor)return t.error(t,{message:"TLS version change is disallowed during renegotiation.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.protocol_version}});if(s)t.session.cipherSuite=a.getCipherSuite(i.cipher_suite);else{var v=e.util.createBuffer(i.cipher_suites.bytes());while(v.length()>0){t.session.cipherSuite=a.getCipherSuite(v.getBytes(2));if(t.session.cipherSuite!==null)break}}if(t.session.cipherSuite===null)return t.error(t,{message:"No cipher suites in common.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.handshake_failure},cipherSuite:e.util.bytesToHex(i.cipher_suite)});s?t.session.compressionMethod=i.compression_method:t.session.compressionMethod=a.CompressionMethod.none}return i},a.createSecurityParameters=function(e,t){var n=e.entity===a.ConnectionEnd.client,r=t.random.bytes(),i=n?e.session.sp.client_random:r,s=n?r:a.createRandom().getBytes();e.session.sp={entity:e.entity,prf_algorithm:a.PRFAlgorithm.tls_prf_sha256,bulk_cipher_algorithm:null,cipher_type:null,enc_key_length:null,block_length:null,fixed_iv_length:null,record_iv_length:null,mac_algorithm:null,mac_length:null,mac_key_length:null,compression_algorithm:e.session.compressionMethod,pre_master_secret:null,master_secret:null,client_random:i,server_random:s}},a.handleServerHello=function(e,t,n){var r=a.parseHelloMessage(e,t,n);if(e.fail)return;if(!(r.version.minor<=e.version.minor))return e.error(e,{message:"Incompatible TLS version.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.protocol_version}});e.version.minor=r.version.minor,e.session.version=e.version;var i=r.session_id.bytes();i.length>0&&i===e.session.id?(e.expect=d,e.session.resuming=!0,e.session.sp.server_random=r.random.bytes()):(e.expect=l,e.session.resuming=!1,a.createSecurityParameters(e,r)),e.session.id=i,e.process()},a.handleClientHello=function(t,n,r){var i=a.parseHelloMessage(t,n,r);if(t.fail)return;var s=i.session_id.bytes(),o=null;if(t.sessionCache){o=t.sessionCache.getSession(s);if(o===null)s="";else if(o.version.major!==i.version.major||o.version.minor>i.version.minor)o=null,s=""}s.length===0&&(s=e.random.getBytes(32)),t.session.id=s,t.session.clientHelloVersion=i.version,t.session.sp={};if(o)t.version=t.session.version=o.version,t.session.sp=o.sp;else{var u;for(var f=1;f<a.SupportedVersions.length;++f){u=a.SupportedVersions[f];if(u.minor<=i.version.minor)break}t.version={major:u.major,minor:u.minor},t.session.version=t.version}o!==null?(t.expect=S,t.session.resuming=!0,t.session.sp.client_random=i.random.bytes()):(t.expect=t.verifyClient!==!1?b:w,t.session.resuming=!1,a.createSecurityParameters(t,i)),t.open=!0,a.queue(t,a.createRecord(t,{type:a.ContentType.handshake,data:a.createServerHello(t)})),t.session.resuming?(a.queue(t,a.createRecord(t,{type:a.ContentType.change_cipher_spec,data:a.createChangeCipherSpec()})),t.state.pending=a.createConnectionState(t),t.state.current.write=t.state.pending.write,a.queue(t,a.createRecord(t,{type:a.ContentType.handshake,data:a.createFinished(t)}))):(a.queue(t,a.createRecord(t,{type:a.ContentType.handshake,data:a.createCertificate(t)})),t.fail||(a.queue(t,a.createRecord(t,{type:a.ContentType.handshake,data:a.createServerKeyExchange(t)})),t.verifyClient!==!1&&a.queue(t,a.createRecord(t,{type:a.ContentType.handshake,data:a.createCertificateRequest(t)})),a.queue(t,a.createRecord(t,{type:a.ContentType.handshake,data:a.createServerHelloDone(t)})))),a.flush(t),t.process()},a.handleCertificate=function(t,n,r){if(r<3)return t.error(t,{message:"Invalid Certificate message. Message too short.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.illegal_parameter}});var i=n.fragment,s={certificate_list:o(i,3)},u,f,l=[];try{while(s.certificate_list.length()>0)u=o(s.certificate_list,3),f=e.asn1.fromDer(u),u=e.pki.certificateFromAsn1(f,!0),l.push(u)}catch(h){return t.error(t,{message:"Could not parse certificate list.",cause:h,send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.bad_certificate}})}var p=t.entity===a.ConnectionEnd.client;!p&&t.verifyClient!==!0||l.length!==0?l.length===0?t.expect=p?c:w:(p?t.session.serverCertificate=l[0]:t.session.clientCertificate=l[0],a.verifyCertificateChain(t,l)&&(t.expect=p?c:w)):t.error(t,{message:p?"No server certificate provided.":"No client certificate provided.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.illegal_parameter}}),t.process()},a.handleServerKeyExchange=function(e,t,n){if(n>0)return e.error(e,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.unsupported_certificate}});e.expect=h,e.process()},a.handleClientKeyExchange=function(t,n,r){if(r<48)return t.error(t,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.unsupported_certificate}});var i=n.fragment,s={enc_pre_master_secret:o(i,2).getBytes()},u=null;if(t.getPrivateKey)try{u=t.getPrivateKey(t,t.session.serverCertificate),u=e.pki.privateKeyFromPem(u)}catch(f){t.error(t,{message:"Could not get private key.",cause:f,send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.internal_error}})}if(u===null)return t.error(t,{message:"No private key set.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.internal_error}});try{var l=t.session.sp;l.pre_master_secret=u.decrypt(s.enc_pre_master_secret);var c=t.session.clientHelloVersion;if(c.major!==l.pre_master_secret.charCodeAt(0)||c.minor!==l.pre_master_secret.charCodeAt(1))throw new Error("TLS version rollback attack detected.")}catch(f){l.pre_master_secret=e.random.getBytes(48)}t.expect=S,t.session.clientCertificate!==null&&(t.expect=E),t.process()},a.handleCertificateRequest=function(e,t,n){if(n<3)return e.error(e,{message:"Invalid CertificateRequest. Message too short.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.illegal_parameter}});var r=t.fragment,i={certificate_types:o(r,1),certificate_authorities:o(r,2)};e.session.certificateRequest=i,e.expect=p,e.process()},a.handleCertificateVerify=function(t,n,r){if(r<2)return t.error(t,{message:"Invalid CertificateVerify. Message too short.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.illegal_parameter}});var i=n.fragment;i.read-=4;var s=i.bytes();i.read+=4;var u={signature:o(i,2).getBytes()},f=e.util.createBuffer();f.putBuffer(t.session.md5.digest()),f.putBuffer(t.session.sha1.digest()),f=f.getBytes();try{var l=t.session.clientCertificate;if(!l.publicKey.verify(f,u.signature,"NONE"))throw new Error("CertificateVerify signature does not match.");t.session.md5.update(s),t.session.sha1.update(s)}catch(c){return t.error(t,{message:"Bad signature in CertificateVerify.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.handshake_failure}})}t.expect=S,t.process()},a.handleServerHelloDone=function(t,n,r){if(r>0)return t.error(t,{message:"Invalid ServerHelloDone message. Invalid length.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.record_overflow}});if(t.serverCertificate===null){var i={message:"No server certificate provided. Not enough security.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.insufficient_security}},s=0,o=t.verify(t,i.alert.description,s,[]);if(o!==!0){if(o||o===0)typeof o=="object"&&!e.util.isArray(o)?(o.message&&(i.message=o.message),o.alert&&(i.alert.description=o.alert)):typeof o=="number"&&(i.alert.description=o);return t.error(t,i)}}t.session.certificateRequest!==null&&(n=a.createRecord(t,{type:a.ContentType.handshake,data:a.createCertificate(t)}),a.queue(t,n)),n=a.createRecord(t,{type:a.ContentType.handshake,data:a.createClientKeyExchange(t)}),a.queue(t,n),t.expect=g;var u=function(e,t){e.session.certificateRequest!==null&&e.session.clientCertificate!==null&&a.queue(e,a.createRecord(e,{type:a.ContentType.handshake,data:a.createCertificateVerify(e,t)})),a.queue(e,a.createRecord(e,{type:a.ContentType.change_cipher_spec,data:a.createChangeCipherSpec()})),e.state.pending=a.createConnectionState(e),e.state.current.write=e.state.pending.write,a.queue(e,a.createRecord(e,{type:a.ContentType.handshake,data:a.createFinished(e)})),e.expect=d,a.flush(e),e.process()};if(t.session.certificateRequest===null||t.session.clientCertificate===null)return u(t,null);a.getClientSignature(t,u)},a.handleChangeCipherSpec=function(e,t){if(t.fragment.getByte()!==1)return e.error(e,{message:"Invalid ChangeCipherSpec message received.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.illegal_parameter}});var n=e.entity===a.ConnectionEnd.client;if(e.session.resuming&&n||!e.session.resuming&&!n)e.state.pending=a.createConnectionState(e);e.state.current.read=e.state.pending.read;if(!e.session.resuming&&n||e.session.resuming&&!n)e.state.pending=null;e.expect=n?v:x,e.process()},a.handleFinished=function(n,r,i){var s=r.fragment;s.read-=4;var o=s.bytes();s.read+=4;var u=r.fragment.getBytes();s=e.util.createBuffer(),s.putBuffer(n.session.md5.digest()),s.putBuffer(n.session.sha1.digest());var f=n.entity===a.ConnectionEnd.client,l=f?"server finished":"client finished",c=n.session.sp,h=12,p=t;s=p(c.master_secret,l,s.getBytes(),h);if(s.getBytes()!==u)return n.error(n,{message:"Invalid verify_data in Finished message.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.decrypt_error}});n.session.md5.update(o),n.session.sha1.update(o);if(n.session.resuming&&f||!n.session.resuming&&!f)a.queue(n,a.createRecord(n,{type:a.ContentType.change_cipher_spec,data:a.createChangeCipherSpec()})),n.state.current.write=n.state.pending.write,n.state.pending=null,a.queue(n,a.createRecord(n,{type:a.ContentType.handshake,data:a.createFinished(n)}));n.expect=f?m:T,n.handshaking=!1,++n.handshakes,n.peerCertificate=f?n.session.serverCertificate:n.session.clientCertificate,a.flush(n),n.isConnected=!0,n.connected(n),n.process()},a.handleAlert=function(e,t){var n=t.fragment,r={level:n.getByte(),description:n.getByte()},i;switch(r.description){case a.Alert.Description.close_notify:i="Connection closed.";break;case a.Alert.Description.unexpected_message:i="Unexpected message.";break;case a.Alert.Description.bad_record_mac:i="Bad record MAC.";break;case a.Alert.Description.decryption_failed:i="Decryption failed.";break;case a.Alert.Description.record_overflow:i="Record overflow.";break;case a.Alert.Description.decompression_failure:i="Decompression failed.";break;case a.Alert.Description.handshake_failure:i="Handshake failure.";break;case a.Alert.Description.bad_certificate:i="Bad certificate.";break;case a.Alert.Description.unsupported_certificate:i="Unsupported certificate.";break;case a.Alert.Description.certificate_revoked:i="Certificate revoked.";break;case a.Alert.Description.certificate_expired:i="Certificate expired.";break;case a.Alert.Description.certificate_unknown:i="Certificate unknown.";break;case a.Alert.Description.illegal_parameter:i="Illegal parameter.";break;case a.Alert.Description.unknown_ca:i="Unknown certificate authority.";break;case a.Alert.Description.access_denied:i="Access denied.";break;case a.Alert.Description.decode_error:i="Decode error.";break;case a.Alert.Description.decrypt_error:i="Decrypt error.";break;case a.Alert.Description.export_restriction:i="Export restriction.";break;case a.Alert.Description.protocol_version:i="Unsupported protocol version.";break;case a.Alert.Description.insufficient_security:i="Insufficient security.";break;case a.Alert.Description.internal_error:i="Internal error.";break;case a.Alert.Description.user_canceled:i="User canceled.";break;case a.Alert.Description.no_renegotiation:i="Renegotiation not supported.";break;default:i="Unknown error."}if(r.description===a.Alert.Description.close_notify)return e.close();e.error(e,{message:i,send:!1,origin:e.entity===a.ConnectionEnd.client?"server":"client",alert:r}),e.process()},a.handleHandshake=function(t,n){var r=n.fragment,i=r.getByte(),s=r.getInt24();if(s>r.length())return t.fragmented=n,n.fragment=e.util.createBuffer(),r.read-=4,t.process();t.fragmented=null,r.read-=4;var o=r.bytes(s+4);r.read+=4,i in q[t.entity][t.expect]?(t.entity===a.ConnectionEnd.server&&!t.open&&!t.fail&&(t.handshaking=!0,t.session={version:null,extensions:{server_name:{serverNameList:[]}},cipherSuite:null,compressionMethod:null,serverCertificate:null,clientCertificate:null,md5:e.md.md5.create(),sha1:e.md.sha1.create()}),i!==a.HandshakeType.hello_request&&i!==a.HandshakeType.certificate_verify&&i!==a.HandshakeType.finished&&(t.session.md5.update(o),t.session.sha1.update(o)),q[t.entity][t.expect][i](t,n,s)):a.handleUnexpected(t,n)},a.handleApplicationData=function(e,t){e.data.putBuffer(t.fragment),e.dataReady(e),e.process()},a.handleHeartbeat=function(t,n){var r=n.fragment,i=r.getByte(),s=r.getInt16(),o=r.getBytes(s);if(i===a.HeartbeatMessageType.heartbeat_request){if(t.handshaking||s>o.length)return t.process();a.queue(t,a.createRecord(t,{type:a.ContentType.heartbeat,data:a.createHeartbeat(a.HeartbeatMessageType.heartbeat_response,o)})),a.flush(t)}else if(i===a.HeartbeatMessageType.heartbeat_response){if(o!==t.expectedHeartbeatPayload)return t.process();t.heartbeatReceived&&t.heartbeatReceived(t,e.util.createBuffer(o))}t.process()};var f=0,l=1,c=2,h=3,p=4,d=5,v=6,m=7,g=8,y=0,b=1,w=2,E=3,S=4,x=5,T=6,N=7,C=a.handleUnexpected,k=a.handleChangeCipherSpec,L=a.handleAlert,A=a.handleHandshake,O=a.handleApplicationData,M=a.handleHeartbeat,_=[];_[a.ConnectionEnd.client]=[[C,L,A,C,M],[C,L,A,C,M],[C,L,A,C,M],[C,L,A,C,M],[C,L,A,C,M],[k,L,C,C,M],[C,L,A,C,M],[C,L,A,O,M],[C,L,A,C,M]],_[a.ConnectionEnd.server]=[[C,L,A,C,M],[C,L,A,C,M],[C,L,A,C,M],[C,L,A,C,M],[k,L,C,C,M],[C,L,A,C,M],[C,L,A,O,M],[C,L,A,C,M]];var D=a.handleHelloRequest,P=a.handleServerHello,H=a.handleCertificate,B=a.handleServerKeyExchange,j=a.handleCertificateRequest,F=a.handleServerHelloDone,I=a.handleFinished,q=[];q[a.ConnectionEnd.client]=[[C,C,P,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[D,C,C,C,C,C,C,C,C,C,C,H,B,j,F,C,C,C,C,C,C],[D,C,C,C,C,C,C,C,C,C,C,C,B,j,F,C,C,C,C,C,C],[D,C,C,C,C,C,C,C,C,C,C,C,C,j,F,C,C,C,C,C,C],[D,C,C,C,C,C,C,C,C,C,C,C,C,C,F,C,C,C,C,C,C],[D,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[D,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,I],[D,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[D,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C]];var R=a.handleClientHello,U=a.handleClientKeyExchange,z=a.handleCertificateVerify;q[a.ConnectionEnd.server]=[[C,R,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,H,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,U,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,z,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,I],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C]],a.generateKeys=function(e,n){var r=t,i=n.client_random+n.server_random;e.session.resuming||(n.master_secret=r(n.pre_master_secret,"master secret",i,48).bytes(),n.pre_master_secret=null),i=n.server_random+n.client_random;var s=2*n.mac_key_length+2*n.enc_key_length,o=e.version.major===a.Versions.TLS_1_0.major&&e.version.minor===a.Versions.TLS_1_0.minor;o&&(s+=2*n.fixed_iv_length);var u=r(n.master_secret,"key expansion",i,s),f={client_write_MAC_key:u.getBytes(n.mac_key_length),server_write_MAC_key:u.getBytes(n.mac_key_length),client_write_key:u.getBytes(n.enc_key_length),server_write_key:u.getBytes(n.enc_key_length)};return o&&(f.client_write_IV=u.getBytes(n.fixed_iv_length),f.server_write_IV=u.getBytes(n.fixed_iv_length)),f},a.createConnectionState=function(e){var t=e.entity===a.ConnectionEnd.client,n=function(){var e={sequenceNumber:[0,0],macKey:null,macLength:0,macFunction:null,cipherState:null,cipherFunction:function(e){return!0},compressionState:null,compressFunction:function(e){return!0},updateSequenceNumber:function(){e.sequenceNumber[1]===4294967295?(e.sequenceNumber[1]=0,++e.sequenceNumber[0]):++e.sequenceNumber[1]}};return e},r={read:n(),write:n()};r.read.update=function(e,t){return r.read.cipherFunction(t,r.read)?r.read.compressFunction(e,t,r.read)||e.error(e,{message:"Could not decompress record.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.decompression_failure}}):e.error(e,{message:"Could not decrypt record or bad MAC.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.bad_record_mac}}),!e.fail},r.write.update=function(e,t){return r.write.compressFunction(e,t,r.write)?r.write.cipherFunction(t,r.write)||e.error(e,{message:"Could not encrypt record.",send:!1,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.internal_error}}):e.error(e,{message:"Could not compress record.",send:!1,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.internal_error}}),!e.fail};if(e.session){var o=e.session.sp;e.session.cipherSuite.initSecurityParameters(o),o.keys=a.generateKeys(e,o),r.read.macKey=t?o.keys.server_write_MAC_key:o.keys.client_write_MAC_key,r.write.macKey=t?o.keys.client_write_MAC_key:o.keys.server_write_MAC_key,e.session.cipherSuite.initConnectionState(r,e,o);switch(o.compression_algorithm){case a.CompressionMethod.none:break;case a.CompressionMethod.deflate:r.read.compressFunction=s,r.write.compressFunction=i;break;default:throw new Error("Unsupported compression algorithm.")}}return r},a.createRandom=function(){var t=new Date,n=+t+t.getTimezoneOffset()*6e4,r=e.util.createBuffer();return r.putInt32(n),r.putBytes(e.random.getBytes(28)),r},a.createRecord=function(e,t){if(!t.data)return null;var n={type:t.type,version:{major:e.version.major,minor:e.version.minor},length:t.data.length(),fragment:t.data};return n},a.createAlert=function(t,n){var r=e.util.createBuffer();return r.putByte(n.level),r.putByte(n.description),a.createRecord(t,{type:a.ContentType.alert,data:r})},a.createClientHello=function(t){t.session.clientHelloVersion={major:t.version.major,minor:t.version.minor};var n=e.util.createBuffer();for(var r=0;r<t.cipherSuites.length;++r){var i=t.cipherSuites[r];n.putByte(i.id[0]),n.putByte(i.id[1])}var s=n.length(),o=e.util.createBuffer();o.putByte(a.CompressionMethod.none);var f=o.length(),l=e.util.createBuffer();if(t.virtualHost){var c=e.util.createBuffer();c.putByte(0),c.putByte(0);var h=e.util.createBuffer();h.putByte(0),u(h,2,e.util.createBuffer(t.virtualHost));var p=e.util.createBuffer();u(p,2,h),u(c,2,p),l.putBuffer(c)}var d=l.length();d>0&&(d+=2);var v=t.session.id,m=v.length+1+2+4+28+2+s+1+f+d,g=e.util.createBuffer();return g.putByte(a.HandshakeType.client_hello),g.putInt24(m),g.putByte(t.version.major),g.putByte(t.version.minor),g.putBytes(t.session.sp.client_random),u(g,1,e.util.createBuffer(v)),u(g,2,n),u(g,1,o),d>0&&u(g,2,l),g},a.createServerHello=function(t){var n=t.session.id,r=n.length+1+2+4+28+2+1,i=e.util.createBuffer();return i.putByte(a.HandshakeType.server_hello),i.putInt24(r),i.putByte(t.version.major),i.putByte(t.version.minor),i.putBytes(t.session.sp.server_random),u(i,1,e.util.createBuffer(n)),i.putByte(t.session.cipherSuite.id[0]),i.putByte(t.session.cipherSuite.id[1]),i.putByte(t.session.compressionMethod),i},a.createCertificate=function(t){var n=t.entity===a.ConnectionEnd.client,r=null;if(t.getCertificate){var i;n?i=t.session.certificateRequest:i=t.session.extensions.server_name.serverNameList,r=t.getCertificate(t,i)}var s=e.util.createBuffer();if(r!==null)try{e.util.isArray(r)||(r=[r]);var o=null;for(var f=0;f<r.length;++f){var l=e.pem.decode(r[f])[0];if(l.type!=="CERTIFICATE"&&l.type!=="X509 CERTIFICATE"&&l.type!=="TRUSTED CERTIFICATE"){var c=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw c.headerType=l.type,c}if(l.procType&&l.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var h=e.util.createBuffer(l.body);o===null&&(o=e.asn1.fromDer(h.bytes(),!1));var p=e.util.createBuffer();u(p,3,h),s.putBuffer(p)}r=e.pki.certificateFromAsn1(o),n?t.session.clientCertificate=r:t.session.serverCertificate=r}catch(d){return t.error(t,{message:"Could not send certificate list.",cause:d,send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.bad_certificate}})}var v=3+s.length(),m=e.util.createBuffer();return m.putByte(a.HandshakeType.certificate),m.putInt24(v),u(m,3,s),m},a.createClientKeyExchange=function(t){var n=e.util.createBuffer();n.putByte(t.session.clientHelloVersion.major),n.putByte(t.session.clientHelloVersion.minor),n.putBytes(e.random.getBytes(46));var r=t.session.sp;r.pre_master_secret=n.getBytes();var i=t.session.serverCertificate.publicKey;n=i.encrypt(r.pre_master_secret);var s=n.length+2,o=e.util.createBuffer();return o.putByte(a.HandshakeType.client_key_exchange),o.putInt24(s),o.putInt16(n.length),o.putBytes(n),o},a.createServerKeyExchange=function(t){var n=0,r=e.util.createBuffer();return n>0&&(r.putByte(a.HandshakeType.server_key_exchange),r.putInt24(n)),r},a.getClientSignature=function(t,n){var r=e.util.createBuffer();r.putBuffer(t.session.md5.digest()),r.putBuffer(t.session.sha1.digest()),r=r.getBytes(),t.getSignature=t.getSignature||function(t,n,r){var i=null;if(t.getPrivateKey)try{i=t.getPrivateKey(t,t.session.clientCertificate),i=e.pki.privateKeyFromPem(i)}catch(s){t.error(t,{message:"Could not get private key.",cause:s,send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.internal_error}})}i===null?t.error(t,{message:"No private key set.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.internal_error}}):n=i.sign(n,null),r(t,n)},t.getSignature(t,r,n)},a.createCertificateVerify=function(t,n){var r=n.length+2,i=e.util.createBuffer();return i.putByte(a.HandshakeType.certificate_verify),i.putInt24(r),i.putInt16(n.length),i.putBytes(n),i},a.createCertificateRequest=function(t){var n=e.util.createBuffer();n.putByte(1);var r=e.util.createBuffer();for(var i in t.caStore.certs){var s=t.caStore.certs[i],o=e.pki.distinguishedNameToAsn1(s.subject);r.putBuffer(e.asn1.toDer(o))}var f=1+n.length()+2+r.length(),l=e.util.createBuffer();return l.putByte(a.HandshakeType.certificate_request),l.putInt24(f),u(l,1,n),u(l,2,r),l},a.createServerHelloDone=function(t){var n=e.util.createBuffer();return n.putByte(a.HandshakeType.server_hello_done),n.putInt24(0),n},a.createChangeCipherSpec=function(){var t=e.util.createBuffer();return t.putByte(1),t},a.createFinished=function(n){var r=e.util.createBuffer();r.putBuffer(n.session.md5.digest()),r.putBuffer(n.session.sha1.digest());var i=n.entity===a.ConnectionEnd.client,s=n.session.sp,o=12,u=t,f=i?"client finished":"server finished";r=u(s.master_secret,f,r.getBytes(),o);var l=e.util.createBuffer();return l.putByte(a.HandshakeType.finished),l.putInt24(r.length()),l.putBuffer(r),l},a.createHeartbeat=function(t,n,r){typeof r=="undefined"&&(r=n.length);var i=e.util.createBuffer();i.putByte(t),i.putInt16(r),i.putBytes(n);var s=i.length(),o=Math.max(16,s-r-3);return i.putBytes(e.random.getBytes(o)),i},a.queue=function(t,n){if(!n)return;if(n.type===a.ContentType.handshake){var r=n.fragment.bytes();t.session.md5.update(r),t.session.sha1.update(r),r=null}var i;if(n.fragment.length()<=a.MaxFragment)i=[n];else{i=[];var s=n.fragment.bytes();while(s.length>a.MaxFragment)i.push(a.createRecord(t,{type:n.type,data:e.util.createBuffer(s.slice(0,a.MaxFragment))})),s=s.slice(a.MaxFragment);s.length>0&&i.push(a.createRecord(t,{type:n.type,data:e.util.createBuffer(s)}))}for(var o=0;o<i.length&&!t.fail;++o){var u=i[o],f=t.state.current.write;f.update(t,u)&&t.records.push(u)}},a.flush=function(e){for(var t=0;t<e.records.length;++t){var n=e.records[t];e.tlsData.putByte(n.type),e.tlsData.putByte(n.version.major),e.tlsData.putByte(n.version.minor),e.tlsData.putInt16(n.fragment.length()),e.tlsData.putBuffer(e.records[t].fragment)}return e.records=[],e.tlsDataReady(e)};var W=function(t){switch(t){case!0:return!0;case e.pki.certificateError.bad_certificate:return a.Alert.Description.bad_certificate;case e.pki.certificateError.unsupported_certificate:return a.Alert.Description.unsupported_certificate;case e.pki.certificateError.certificate_revoked:return a.Alert.Description.certificate_revoked;case e.pki.certificateError.certificate_expired:return a.Alert.Description.certificate_expired;case e.pki.certificateError.certificate_unknown:return a.Alert.Description.certificate_unknown;case e.pki.certificateError.unknown_ca:return a.Alert.Description.unknown_ca;default:return a.Alert.Description.bad_certificate}},X=function(t){switch(t){case!0:return!0;case a.Alert.Description.bad_certificate:return e.pki.certificateError.bad_certificate;case a.Alert.Description.unsupported_certificate:return e.pki.certificateError.unsupported_certificate;case a.Alert.Description.certificate_revoked:return e.pki.certificateError.certificate_revoked;case a.Alert.Description.certificate_expired:return e.pki.certificateError.certificate_expired;case a.Alert.Description.certificate_unknown:return e.pki.certificateError.certificate_unknown;case a.Alert.Description.unknown_ca:return e.pki.certificateError.unknown_ca;default:return e.pki.certificateError.bad_certificate}};a.verifyCertificateChain=function(t,n){try{e.pki.verifyCertificateChain(t.caStore,n,function(n,r,i){var s=W(n),o=t.verify(t,n,r,i);if(o!==!0){if(typeof o=="object"&&!e.util.isArray(o)){var u=new Error("The application rejected the certificate.");throw u.send=!0,u.alert={level:a.Alert.Level.fatal,description:a.Alert.Description.bad_certificate},o.message&&(u.message=o.message),o.alert&&(u.alert.description=o.alert),u}o!==n&&(o=X(o))}return o})}catch(r){var i=r;if(typeof i!="object"||e.util.isArray(i))i={send:!0,alert:{level:a.Alert.Level.fatal,description:W(r)}};"send"in i||(i.send=!0),"alert"in i||(i.alert={level:a.Alert.Level.fatal,description:W(i.error)}),t.error(t,i)}return!t.fail},a.createSessionCache=function(t,n){var r=null;if(t&&t.getSession&&t.setSession&&t.order)r=t;else{r={},r.cache=t||{},r.capacity=Math.max(n||100,1),r.order=[];for(var i in t)r.order.length<=n?r.order.push(i):delete t[i];r.getSession=function(t){var n=null,i=null;t?i=e.util.bytesToHex(t):r.order.length>0&&(i=r.order[0]);if(i!==null&&i in r.cache){n=r.cache[i],delete r.cache[i];for(var s in r.order)if(r.order[s]===i){r.order.splice(s,1);break}}return n},r.setSession=function(t,n){if(r.order.length===r.capacity){var i=r.order.shift();delete r.cache[i]}var i=e.util.bytesToHex(t);r.order.push(i),r.cache[i]=n}}return r},a.createConnection=function(t){var n=null;t.caStore?e.util.isArray(t.caStore)?n=e.pki.createCaStore(t.caStore):n=t.caStore:n=e.pki.createCaStore();var r=t.cipherSuites||null;if(r===null){r=[];for(var i in a.CipherSuites)r.push(a.CipherSuites[i])}var s=t.server||!1?a.ConnectionEnd.server:a.ConnectionEnd.client,o=t.sessionCache?a.createSessionCache(t.sessionCache):null,u={version:{major:a.Version.major,minor:a.Version.minor},entity:s,sessionId:t.sessionId,caStore:n,sessionCache:o,cipherSuites:r,connected:t.connected,virtualHost:t.virtualHost||null,verifyClient:t.verifyClient||!1,verify:t.verify||function(e,t,n,r){return t},getCertificate:t.getCertificate||null,getPrivateKey:t.getPrivateKey||null,getSignature:t.getSignature||null,input:e.util.createBuffer(),tlsData:e.util.createBuffer(),data:e.util.createBuffer(),tlsDataReady:t.tlsDataReady,dataReady:t.dataReady,heartbeatReceived:t.heartbeatReceived,closed:t.closed,error:function(e,n){n.origin=n.origin||(e.entity===a.ConnectionEnd.client?"client":"server"),n.send&&(a.queue(e,a.createAlert(e,n.alert)),a.flush(e));var r=n.fatal!==!1;r&&(e.fail=!0),t.error(e,n),r&&e.close(!1)},deflate:t.deflate||null,inflate:t.inflate||null};u.reset=function(e){u.version={major:a.Version.major,minor:a.Version.minor},u.record=null,u.session=null,u.peerCertificate=null,u.state={pending:null,current:null},u.expect=u.entity===a.ConnectionEnd.client?f:y,u.fragmented=null,u.records=[],u.open=!1,u.handshakes=0,u.handshaking=!1,u.isConnected=!1,u.fail=!e&&typeof e!="undefined",u.input.clear(),u.tlsData.clear(),u.data.clear(),u.state.current=a.createConnectionState(u)},u.reset();var l=function(e,t){var n=t.type-a.ContentType.change_cipher_spec,r=_[e.entity][e.expect];n in r?r[n](e,t):a.handleUnexpected(e,t)},c=function(t){var n=0,r=t.input,i=r.length();if(i<5)n=5-i;else{t.record={type:r.getByte(),version:{major:r.getByte(),minor:r.getByte()},length:r.getInt16(),fragment:e.util.createBuffer(),ready:!1};var s=t.record.version.major===t.version.major;s&&t.session&&t.session.version&&(s=t.record.version.minor===t.version.minor),s||t.error(t,{message:"Incompatible TLS version.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.protocol_version}})}return n},h=function(e){var t=0,n=e.input,r=n.length();if(r<e.record.length)t=e.record.length-r;else{e.record.fragment.putBytes(n.getBytes(e.record.length)),n.compact();var i=e.state.current.read;i.update(e,e.record)&&(e.fragmented!==null&&(e.fragmented.type===e.record.type?(e.fragmented.fragment.putBuffer(e.record.fragment),e.record=e.fragmented):e.error(e,{message:"Invalid fragmented record.",send:!0,alert:{level:a.Alert.Level.fatal,description:a.Alert.Description.unexpected_message}})),e.record.ready=!0)}return t};return u.handshake=function(t){if(u.entity!==a.ConnectionEnd.client)u.error(u,{message:"Cannot initiate handshake as a server.",fatal:!1});else if(u.handshaking)u.error(u,{message:"Handshake already in progress.",fatal:!1});else{u.fail&&!u.open&&u.handshakes===0&&(u.fail=!1),u.handshaking=!0,t=t||"";var n=null;t.length>0&&(u.sessionCache&&(n=u.sessionCache.getSession(t)),n===null&&(t="")),t.length===0&&u.sessionCache&&(n=u.sessionCache.getSession(),n!==null&&(t=n.id)),u.session={id:t,version:null,cipherSuite:null,compressionMethod:null,serverCertificate:null,certificateRequest:null,clientCertificate:null,sp:{},md5:e.md.md5.create(),sha1:e.md.sha1.create()},n&&(u.version=n.version,u.session.sp=n.sp),u.session.sp.client_random=a.createRandom().getBytes(),u.open=!0,a.queue(u,a.createRecord(u,{type:a.ContentType.handshake,data:a.createClientHello(u)})),a.flush(u)}},u.process=function(e){var t=0;return e&&u.input.putBytes(e),u.fail||(u.record!==null&&u.record.ready&&u.record.fragment.isEmpty()&&(u.record=null),u.record===null&&(t=c(u)),!u.fail&&u.record!==null&&!u.record.ready&&(t=h(u)),!u.fail&&u.record!==null&&u.record.ready&&l(u,u.record)),t},u.prepare=function(t){return a.queue(u,a.createRecord(u,{type:a.ContentType.application_data,data:e.util.createBuffer(t)})),a.flush(u)},u.prepareHeartbeatRequest=function(t,n){return t instanceof e.util.ByteBuffer&&(t=t.bytes()),typeof n=="undefined"&&(n=t.length),u.expectedHeartbeatPayload=t,a.queue(u,a.createRecord(u,{type:a.ContentType.heartbeat,data:a.createHeartbeat(a.HeartbeatMessageType.heartbeat_request,t,n)})),a.flush(u)},u.close=function(e){if(!u.fail&&u.sessionCache&&u.session){var t={id:u.session.id,version:u.session.version,sp:u.session.sp};t.sp.keys=null,u.sessionCache.setSession(t.id,t)}if(u.open){u.open=!1,u.input.clear();if(u.isConnected||u.handshaking)u.isConnected=u.handshaking=!1,a.queue(u,a.createAlert(u,{level:a.Alert.Level.warning,description:a.Alert.Description.close_notify})),a.flush(u);u.closed(u)}u.reset(e)},u},e.tls=e.tls||{};for(var V in a)typeof a[V]!="function"&&(e.tls[V]=a[V]);e.tls.prf_tls1=t,e.tls.hmac_sha1=r,e.tls.createSessionCache=a.createSessionCache,e.tls.createConnection=a.createConnection}var r="tls";if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),e(forge);var i=!0;n=function(e,n){n(t,module)}}var s,o=function(t,n){n.exports=function(n){var i=s.map(function(e){return t(e)}).concat(e);n=n||{},n.defined=n.defined||{};if(n.defined[r])return n[r];n.defined[r]=!0;for(var o=0;o<i.length;++o)i[o](n);return n[r]}},u=n;n=function(e,t){return s=typeof e=="string"?t.slice(2):e.slice(2),i?(delete n,u.apply(null,Array.prototype.slice.call(arguments,0))):(n=u,n.apply(null,Array.prototype.slice.call(arguments,0)))},n("js/tls",["require","module","./asn1","./hmac","./md","./pem","./pki","./random","./util"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){function t(t,r,i){var u=r.entity===e.tls.ConnectionEnd.client;t.read.cipherState={init:!1,cipher:e.cipher.createDecipher("AES-CBC",u?i.keys.server_write_key:i.keys.client_write_key),iv:u?i.keys.server_write_IV:i.keys.client_write_IV},t.write.cipherState={init:!1,cipher:e.cipher.createCipher("AES-CBC",u?i.keys.client_write_key:i.keys.server_write_key),iv:u?i.keys.client_write_IV:i.keys.server_write_IV},t.read.cipherFunction=s,t.write.cipherFunction=n,t.read.macLength=t.write.macLength=i.mac_length,t.read.macFunction=t.write.macFunction=o.hmac_sha1}function n(t,n){var i=!1,s=n.macFunction(n.macKey,n.sequenceNumber,t);t.fragment.putBytes(s),n.updateSequenceNumber();var u;t.version.minor===o.Versions.TLS_1_0.minor?u=n.cipherState.init?null:n.cipherState.iv:u=e.random.getBytesSync(16),n.cipherState.init=!0;var a=n.cipherState.cipher;return a.start({iv:u}),t.version.minor>=o.Versions.TLS_1_1.minor&&a.output.putBytes(u),a.update(t.fragment),a.finish(r)&&(t.fragment=a.output,t.length=t.fragment.length(),i=!0),i}function r(e,t,n){if(!n){var r=e-t.length()%e;t.fillWithByte(r-1,r)}return!0}function i(e,t,n){var r=!0;if(n){var i=t.length(),s=t.last();for(var o=i-1-s;o<i-1;++o)r=r&&t.at(o)==s;r&&t.truncate(s+1)}return r}function s(t,n){var r=!1;++u;var s;t.version.minor===o.Versions.TLS_1_0.minor?s=n.cipherState.init?null:n.cipherState.iv:s=t.fragment.getBytes(16),n.cipherState.init=!0;var a=n.cipherState.cipher;a.start({iv:s}),a.update(t.fragment),r=a.finish(i);var f=n.macLength,l="";for(var c=0;c<f;++c)l+=String.fromCharCode(0);var h=a.output.length();h>=f?(t.fragment=a.output.getBytes(h-f),l=a.output.getBytes(f)):t.fragment=a.output.getBytes(),t.fragment=e.util.createBuffer(t.fragment),t.length=t.fragment.length();var p=n.macFunction(n.macKey,n.sequenceNumber,t);return n.updateSequenceNumber(),r=p===l&&r,r}var o=e.tls;o.CipherSuites.TLS_RSA_WITH_AES_128_CBC_SHA={id:[0,47],name:"TLS_RSA_WITH_AES_128_CBC_SHA",initSecurityParameters:function(e){e.bulk_cipher_algorithm=o.BulkCipherAlgorithm.aes,e.cipher_type=o.CipherType.block,e.enc_key_length=16,e.block_length=16,e.fixed_iv_length=16,e.record_iv_length=16,e.mac_algorithm=o.MACAlgorithm.hmac_sha1,e.mac_length=20,e.mac_key_length=20},initConnectionState:t},o.CipherSuites.TLS_RSA_WITH_AES_256_CBC_SHA={id:[0,53],name:"TLS_RSA_WITH_AES_256_CBC_SHA",initSecurityParameters:function(e){e.bulk_cipher_algorithm=o.BulkCipherAlgorithm.aes,e.cipher_type=o.CipherType.block,e.enc_key_length=32,e.block_length=16,e.fixed_iv_length=16,e.record_iv_length=16,e.mac_algorithm=o.MACAlgorithm.hmac_sha1,e.mac_length=20,e.mac_key_length=20},initConnectionState:t};var u=0}var r="aesCipherSuites";if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),e(forge);var i=!0;n=function(e,n){n(t,module)}}var s,o=function(t,n){n.exports=function(n){var i=s.map(function(e){return t(e)}).concat(e);n=n||{},n.defined=n.defined||{};if(n.defined[r])return n[r];n.defined[r]=!0;for(var o=0;o<i.length;++o)i[o](n);return n[r]}},u=n;n=function(e,t){return s=typeof e=="string"?t.slice(2):e.slice(2),i?(delete n,u.apply(null,Array.prototype.slice.call(arguments,0))):(n=u,n.apply(null,Array.prototype.slice.call(arguments,0)))},n("js/aesCipherSuites",["require","module","./aes","./tls"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){e.debug=e.debug||{},e.debug.storage={},e.debug.get=function(t,n){var r;return typeof t=="undefined"?r=e.debug.storage:t in e.debug.storage&&(typeof n=="undefined"?r=e.debug.storage[t]:r=e.debug.storage[t][n]),r},e.debug.set=function(t,n,r){t in e.debug.storage||(e.debug.storage[t]={}),e.debug.storage[t][n]=r},e.debug.clear=function(t,n){typeof t=="undefined"?e.debug.storage={}:t in e.debug.storage&&(typeof n=="undefined"?delete e.debug.storage[t]:delete e.debug.storage[t][n])}}var r="debug";if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),e(forge);var i=!0;n=function(e,n){n(t,module)}}var s,o=function(t,n){n.exports=function(n){var i=s.map(function(e){return t(e)}).concat(e);n=n||{},n.defined=n.defined||{};if(n.defined[r])return n[r];n.defined[r]=!0;for(var o=0;o<i.length;++o)i[o](n);return n[r]}},u=n;n=function(e,t){return s=typeof e=="string"?t.slice(2):e.slice(2),i?(delete n,u.apply(null,Array.prototype.slice.call(arguments,0))):(n=u,n.apply(null,Array.prototype.slice.call(arguments,0)))},n("js/debug",["require","module"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){function t(t,n,r,i){t.generate=function(t,s){var o=new e.util.ByteBuffer,u=Math.ceil(s/i)+r,a=new e.util.ByteBuffer;for(var f=r;f<u;++f){a.putInt32(f),n.start(),n.update(t+a.getBytes());var l=n.digest();o.putBytes(l.getBytes(i))}return o.truncate(o.length()-s),o.getBytes()}}e.kem=e.kem||{};var n=e.jsbn.BigInteger;e.kem.rsa={},e.kem.rsa.create=function(t,r){r=r||{};var i=r.prng||e.random,s={};return s.encrypt=function(r,s){var o=Math.ceil(r.n.bitLength()/8),u;do u=(new n(e.util.bytesToHex(i.getBytesSync(o)),16)).mod(r.n);while(u.equals(n.ZERO));u=e.util.hexToBytes(u.toString(16));var a=o-u.length;a>0&&(u=e.util.fillString(String.fromCharCode(0),a)+u);var f=r.encrypt(u,"NONE"),l=t.generate(u,s);return{encapsulation:f,key:l}},s.decrypt=function(e,n,r){var i=e.decrypt(n,"NONE");return t.generate(i,r)},s},e.kem.kdf1=function(e,n){t(this,e,0,n||e.digestLength)},e.kem.kdf2=function(e,n){t(this,e,1,n||e.digestLength)}}var r="kem";if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),e(forge);var i=!0;n=function(e,n){n(t,module)}}var s,o=function(t,n){n.exports=function(n){var i=s.map(function(e){return t(e)}).concat(e);n=n||{},n.defined=n.defined||{};if(n.defined[r])return n[r];n.defined[r]=!0;for(var o=0;o<i.length;++o)i[o](n);return n[r]}},u=n;n=function(e,t){return s=typeof e=="string"?t.slice(2):e.slice(2),i?(delete n,u.apply(null,Array.prototype.slice.call(arguments,0))):(n=u,n.apply(null,Array.prototype.slice.call(arguments,0)))},n("js/kem",["require","module","./util","./random","./jsbn"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){e.log=e.log||{},e.log.levels=["none","error","warning","info","debug","verbose","max"];var t={},n=[],r=null;e.log.LEVEL_LOCKED=2,e.log.NO_LEVEL_CHECK=4,e.log.INTERPOLATE=8;for(var i=0;i<e.log.levels.length;++i){var s=e.log.levels[i];t[s]={index:i,name:s.toUpperCase()}}e.log.logMessage=function(r){var i=t[r.level].index;for(var s=0;s<n.length;++s){var o=n[s];if(o.flags&e.log.NO_LEVEL_CHECK)o.f(r);else{var u=t[o.level].index;i<=u&&o.f(o,r)}}},e.log.prepareStandard=function(e){"standard"in e||(e.standard=t[e.level].name+" ["+e.category+"] "+e.message)},e.log.prepareFull=function(t){if(!("full"in t)){var n=[t.message];n=n.concat([]||t.arguments),t.full=e.util.format.apply(this,n)}},e.log.prepareStandardFull=function(t){"standardFull"in t||(e.log.prepareStandard(t),t.standardFull=t.standard)};var o=["error","warning","info","debug","verbose"];for(var i=0;i<o.length;++i)(function(t){e.log[t]=function(n,r){var i=Array.prototype.slice.call(arguments).slice(2),s={timestamp:new Date,level:t,category:n,message:r,arguments:i};e.log.logMessage(s)}})(o[i]);e.log.makeLogger=function(t){var n={flags:0,f:t};return e.log.setLevel(n,"none"),n},e.log.setLevel=function(t,n){var r=!1;if(t&&!(t.flags&e.log.LEVEL_LOCKED))for(var i=0;i<e.log.levels.length;++i){var s=e.log.levels[i];if(n==s){t.level=n,r=!0;break}}return r},e.log.lock=function(t,n){typeof n=="undefined"||n?t.flags|=e.log.LEVEL_LOCKED:t.flags&=~e.log.LEVEL_LOCKED},e.log.addLogger=function(e){n.push(e)};if(typeof console!="undefined"&&"log"in console){var u;if(console.error&&console.warn&&console.info&&console.debug){var a={error:console.error,warning:console.warn,info:console.info,debug:console.debug,verbose:console.debug},f=function(t,n){e.log.prepareStandard(n);var r=a[n.level],i=[n.standard];i=i.concat(n.arguments.slice()),r.apply(console,i)};u=e.log.makeLogger(f)}else{var f=function(t,n){e.log.prepareStandardFull(n),console.log(n.standardFull)};u=e.log.makeLogger(f)}e.log.setLevel(u,"debug"),e.log.addLogger(u),r=u}else console={log:function(){}};if(r!==null){var l=e.util.getQueryVariables();"console.level"in l&&e.log.setLevel(r,l["console.level"].slice(-1)[0]);if("console.lock"in l){var c=l["console.lock"].slice(-1)[0];c=="true"&&e.log.lock(r)}}e.log.consoleLogger=r}var r="log";if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),e(forge);var i=!0;n=function(e,n){n(t,module)}}var s,o=function(t,n){n.exports=function(n){var i=s.map(function(e){return t(e)}).concat(e);n=n||{},n.defined=n.defined||{};if(n.defined[r])return n[r];n.defined[r]=!0;for(var o=0;o<i.length;++o)i[o](n);return n[r]}},u=n;n=function(e,t){return s=typeof e=="string"?t.slice(2):e.slice(2),i?(delete n,u.apply(null,Array.prototype.slice.call(arguments,0))):(n=u,n.apply(null,Array.prototype.slice.call(arguments,0)))},n("js/log",["require","module","./util"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){var t=e.asn1,n=e.pkcs7=e.pkcs7||{};n.messageFromPem=function(r){var i=e.pem.decode(r)[0];if(i.type!=="PKCS7"){var s=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw s.headerType=i.type,s}if(i.procType&&i.procType.type==="ENCRYPTED")throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var o=t.fromDer(i.body);return n.messageFromAsn1(o)},n.messageToPem=function(n,r){var i={type:"PKCS7",body:t.toDer(n.toAsn1()).getBytes()};return e.pem.encode(i,{maxline:r})},n.messageFromAsn1=function(r){var i={},s=[];if(!t.validate(r,n.asn1.contentInfoValidator,i,s)){var o=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw o.errors=s,o}var u=t.derToOid(i.contentType),a;switch(u){case e.pki.oids.envelopedData:a=n.createEnvelopedData();break;case e.pki.oids.encryptedData:a=n.createEncryptedData();break;case e.pki.oids.signedData:a=n.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+u+" is not (yet) supported.")}return a.fromAsn1(i.content.value[0]),a};var r=function(r){var i={},s=[];if(!t.validate(r,n.asn1.recipientInfoValidator,i,s)){var o=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 EnvelopedData.");throw o.errors=s,o}return{version:i.version.charCodeAt(0),issuer:e.pki.RDNAttributesAsArray(i.issuer),serialNumber:e.util.createBuffer(i.serial).toHex(),encryptedContent:{algorithm:t.derToOid(i.encAlgorithm),parameter:i.encParameter.value,content:i.encKey}}},i=function(n){return t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.INTEGER,!1,t.integerToDer(n.version).getBytes()),t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[e.pki.distinguishedNameToAsn1({attributes:n.issuer}),t.create(t.Class.UNIVERSAL,t.Type.INTEGER,!1,e.util.hexToBytes(n.serialNumber))]),t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(n.encryptedContent.algorithm).getBytes()),t.create(t.Class.UNIVERSAL,t.Type.NULL,!1,"")]),t.create(t.Class.UNIVERSAL,t.Type.OCTETSTRING,!1,n.encryptedContent.content)])},s=function(e){var t=[];for(var n=0;n<e.length;n++)t.push(r(e[n]));return t},o=function(e){var t=[];for(var n=0;n<e.length;n++)t.push(i(e[n]));return t},u=function(n){return[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(e.pki.oids.data).getBytes()),t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(n.algorithm).getBytes()),t.create(t.Class.UNIVERSAL,t.Type.OCTETSTRING,!1,n.parameter.getBytes())]),t.create(t.Class.CONTEXT_SPECIFIC,0,!0,[t.create(t.Class.UNIVERSAL,t.Type.OCTETSTRING,!1,n.content.getBytes())])]},a=function(n,r,i){var s={},o=[];if(!t.validate(r,i,s,o)){var u=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw u.errors=u,u}var a=t.derToOid(s.contentType);if(a!==e.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(s.encryptedContent){var f="";if(e.util.isArray(s.encryptedContent))for(var l=0;l<s.encryptedContent.length;++l){if(s.encryptedContent[l].type!==t.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");f+=s.encryptedContent[l].value}else f=s.encryptedContent;n.encryptedContent={algorithm:t.derToOid(s.encAlgorithm),parameter:e.util.createBuffer(s.encParameter.value),content:e.util.createBuffer(f)}}if(s.content){var f="";if(e.util.isArray(s.content))for(var l=0;l<s.content.length;++l){if(s.content[l].type!==t.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");f+=s.content[l].value}else f=s.content;n.content=e.util.createBuffer(f)}return n.version=s.version.charCodeAt(0),n.rawCapture=s,s},f=function(t){if(t.encryptedContent.key===undefined)throw new Error("Symmetric key not available.");if(t.content===undefined){var n;switch(t.encryptedContent.algorithm){case e.pki.oids["aes128-CBC"]:case e.pki.oids["aes192-CBC"]:case e.pki.oids["aes256-CBC"]:n=e.aes.createDecryptionCipher(t.encryptedContent.key);break;case e.pki.oids.desCBC:case e.pki.oids["des-EDE3-CBC"]:n=e.des.createDecryptionCipher(t.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+t.encryptedContent.algorithm)}n.start(t.encryptedContent.parameter),n.update(t.encryptedContent.content);if(!n.finish())throw new Error("Symmetric decryption failed.");t.content=n.output}};n.createSignedData=function(){var r=null;return r={type:e.pki.oids.signedData,version:1,certificates:[],crls:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(t){a(r,t,n.asn1.signedDataValidator),r.certificates=[],r.crls=[],r.digestAlgorithmIdentifiers=[],r.contentInfo=null,r.signerInfos=[];var i=r.rawCapture.certificates.value;for(var s=0;s<i.length;++s)r.certificates.push(e.pki.certificateFromAsn1(i[s]))},toAsn1:function(){if("content"in r)throw new Error("Signing PKCS#7 content not yet implemented.");r.contentInfo||r.sign();var n=[];for(var i=0;i<r.certificates.length;++i)n.push(e.pki.certificateToAsn1(r.certificates[0]));var s=[];return t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(r.type).getBytes()),t.create(t.Class.CONTEXT_SPECIFIC,0,!0,[t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.INTEGER,!1,t.integerToDer(r.version).getBytes()),t.create(t.Class.UNIVERSAL,t.Type.SET,!0,r.digestAlgorithmIdentifiers),r.contentInfo,t.create(t.Class.CONTEXT_SPECIFIC,0,!0,n),t.create(t.Class.CONTEXT_SPECIFIC,1,!0,s),t.create(t.Class.UNIVERSAL,t.Type.SET,!0,r.signerInfos)])])])},sign:function(n){if("content"in r)throw new Error("PKCS#7 signing not yet implemented.");typeof r.content!="object"&&(r.contentInfo=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(e.pki.oids.data).getBytes())]),"content"in r&&r.contentInfo.value.push(t.create(t.Class.CONTEXT_SPECIFIC,0,!0,[t.create(t.Class.UNIVERSAL,t.Type.OCTETSTRING,!1,r.content)])))},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(t){typeof t=="string"&&(t=e.pki.certificateFromPem(t)),r.certificates.push(t)},addCertificateRevokationList:function(e){throw new Error("PKCS#7 CRL support not yet implemented.")}},r},n.createEncryptedData=function(){var t=null;return t={type:e.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:e.pki.oids["aes256-CBC"]},fromAsn1:function(e){a(t,e,n.asn1.encryptedDataValidator)},decrypt:function(e){e!==undefined&&(t.encryptedContent.key=e),f(t)}},t},n.createEnvelopedData=function(){var r=null;return r={type:e.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:e.pki.oids["aes256-CBC"]},fromAsn1:function(e){var t=a(r,e,n.asn1.envelopedDataValidator);r.recipients=s(t.recipientInfos.value)},toAsn1:function(){return t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(r.type).getBytes()),t.create(t.Class.CONTEXT_SPECIFIC,0,!0,[t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.INTEGER,!1,t.integerToDer(r.version).getBytes()),t.create(t.Class.UNIVERSAL,t.Type.SET,!0,o(r.recipients)),t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,u(r.encryptedContent))])])])},findRecipient:function(e){var t=e.issuer.attributes;for(var n=0;n<r.recipients.length;++n){var i=r.recipients[n],s=i.issuer;if(i.serialNumber!==e.serialNumber)continue;if(s.length!==t.length)continue;var o=!0;for(var u=0;u<t.length;++u)if(s[u].type!==t[u].type||s[u].value!==t[u].value){o=!1;break}if(o)return i}return null},decrypt:function(t,n){if(r.encryptedContent.key===undefined&&t!==undefined&&n!==undefined)switch(t.encryptedContent.algorithm){case e.pki.oids.rsaEncryption:case e.pki.oids.desCBC:var i=n.decrypt(t.encryptedContent.content);r.encryptedContent.key=e.util.createBuffer(i);break;default:throw new Error("Unsupported asymmetric cipher, OID "+t.encryptedContent.algorithm)}f(r)},addRecipient:function(t){r.recipients.push({version:0,issuer:t.issuer.attributes,serialNumber:t.serialNumber,encryptedContent:{algorithm:e.pki.oids.rsaEncryption,key:t.publicKey}})},encrypt:function(t,n){if(r.encryptedContent.content===undefined){n=n||r.encryptedContent.algorithm,t=t||r.encryptedContent.key;var i,s,o;switch(n){case e.pki.oids["aes128-CBC"]:i=16,s=16,o=e.aes.createEncryptionCipher;break;case e.pki.oids["aes192-CBC"]:i=24,s=16,o=e.aes.createEncryptionCipher;break;case e.pki.oids["aes256-CBC"]:i=32,s=16,o=e.aes.createEncryptionCipher;break;case e.pki.oids["des-EDE3-CBC"]:i=24,s=8,o=e.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+n)}if(t===undefined)t=e.util.createBuffer(e.random.getBytes(i));else if(t.length()!=i)throw new Error("Symmetric key has wrong length; got "+t.length()+" bytes, expected "+i+".");r.encryptedContent.algorithm=n,r.encryptedContent.key=t,r.encryptedContent.parameter=e.util.createBuffer(e.random.getBytes(s));var u=o(t);u.start(r.encryptedContent.parameter.copy()),u.update(r.content);if(!u.finish())throw new Error("Symmetric encryption failed.");r.encryptedContent.content=u.output}for(var a=0;a<r.recipients.length;a++){var f=r.recipients[a];if(f.encryptedContent.content!==undefined)continue;switch(f.encryptedContent.algorithm){case e.pki.oids.rsaEncryption:f.encryptedContent.content=f.encryptedContent.key.encrypt(r.encryptedContent.key.data);break;default:throw new Error("Unsupported asymmetric cipher, OID "+f.encryptedContent.algorithm)}}}},r}}var r="pkcs7";if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),e(forge);var i=!0;n=function(e,n){n(t,module)}}var s,o=function(t,n){n.exports=function(n){var i=s.map(function(e){return t(e)}).concat(e);n=n||{},n.defined=n.defined||{};if(n.defined[r])return n[r];n.defined[r]=!0;for(var o=0;o<i.length;++o)i[o](n);return n[r]}},u=n;n=function(e,t){return s=typeof e=="string"?t.slice(2):e.slice(2),i?(delete n,u.apply(null,Array.prototype.slice.call(arguments,0))):(n=u,n.apply(null,Array.prototype.slice.call(arguments,0)))},n("js/pkcs7",["require","module","./aes","./asn1","./des","./oids","./pem","./pkcs7asn1","./random","./util","./x509"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){function t(t,n){var r=n.toString(16);r[0]>="8"&&(r="00"+r);var i=e.util.hexToBytes(r);t.putInt32(i.length),t.putBytes(i)}function n(e,t){e.putInt32(t.length),e.putString(t)}function r(){var t=e.md.sha1.create(),n=arguments.length;for(var r=0;r<n;++r)t.update(arguments[r]);return t.digest()}var i=e.ssh=e.ssh||{};i.privateKeyToPutty=function(i,s,o){o=o||"",s=s||"";var u="ssh-rsa",a=s===""?"none":"aes256-cbc",f="PuTTY-User-Key-File-2: "+u+"\r\n";f+="Encryption: "+a+"\r\n",f+="Comment: "+o+"\r\n";var l=e.util.createBuffer();n(l,u),t(l,i.e),t(l,i.n);var c=e.util.encode64(l.bytes(),64),h=Math.floor(c.length/66)+1;f+="Public-Lines: "+h+"\r\n",f+=c;var p=e.util.createBuffer();t(p,i.d),t(p,i.p),t(p,i.q),t(p,i.qInv);var d;if(!s)d=e.util.encode64(p.bytes(),64);else{var v=p.length()+16-1;v-=v%16;var m=r(p.bytes());m.truncate(m.length()-v+p.length()),p.putBuffer(m);var g=e.util.createBuffer();g.putBuffer(r("\0\0\0\0",s)),g.putBuffer(r("\0\0\0",s));var y=e.aes.createEncryptionCipher(g.truncate(8),"CBC");y.start(e.util.createBuffer().fillWithByte(0,16)),y.update(p.copy()),y.finish();var b=y.output;b.truncate(16),d=e.util.encode64(b.bytes(),64)}h=Math.floor(d.length/66)+1,f+="\r\nPrivate-Lines: "+h+"\r\n",f+=d;var w=r("putty-private-key-file-mac-key",s),E=e.util.createBuffer();n(E,u),n(E,a),n(E,o),E.putInt32(l.length()),E.putBuffer(l),E.putInt32(p.length()),E.putBuffer(p);var S=e.hmac.create();return S.start("sha1",w),S.update(E.bytes()),f+="\r\nPrivate-MAC: "+S.digest().toHex()+"\r\n",f},i.publicKeyToOpenSSH=function(r,i){var s="ssh-rsa";i=i||"";var o=e.util.createBuffer();return n(o,s),t(o,r.e),t(o,r.n),s+" "+e.util.encode64(o.bytes())+" "+i},i.privateKeyToOpenSSH=function(t,n){return n?e.pki.encryptRsaPrivateKey(t,n,{legacy:!0,algorithm:"aes128"}):e.pki.privateKeyToPem(t)},i.getPublicKeyFingerprint=function(r,i){i=i||{};var s=i.md||e.md.md5.create(),o="ssh-rsa",u=e.util.createBuffer();n(u,o),t(u,r.e),t(u,r.n),s.start(),s.update(u.getBytes());var a=s.digest();if(i.encoding==="hex"){var f=a.toHex();return i.delimiter?f.match(/.{2}/g).join(i.delimiter):f}if(i.encoding==="binary")return a.getBytes();if(i.encoding)throw new Error('Unknown encoding "'+i.encoding+'".');return a}}var r="ssh";if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),e(forge);var i=!0;n=function(e,n){n(t,module)}}var s,o=function(t,n){n.exports=function(n){var i=s.map(function(e){return t(e)}).concat(e);n=n||{},n.defined=n.defined||{};if(n.defined[r])return n[r];n.defined[r]=!0;for(var o=0;o<i.length;++o)i[o](n);return n[r]}},u=n;n=function(e,t){return s=typeof e=="string"?t.slice(2):e.slice(2),i?(delete n,u.apply(null,Array.prototype.slice.call(arguments,0))):(n=u,n.apply(null,Array.prototype.slice.call(arguments,0)))},n("js/ssh",["require","module","./aes","./hmac","./md5","./sha1","./util"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){var t="forge.task",n=0,r={},i=0;e.debug.set(t,"tasks",r);var s={};e.debug.set(t,"queues",s);var o="?",u=30,a=20,f="ready",l="running",c="blocked",h="sleeping",p="done",d="error",v="stop",m="start",g="block",y="unblock",b="sleep",w="wakeup",E="cancel",S="fail",x={};x[f]={},x[f][v]=f,x[f][m]=l,x[f][E]=p,x[f][S]=d,x[l]={},x[l][v]=f,x[l][m]=l,x[l][g]=c,x[l][y]=l,x[l][b]=h,x[l][w]=l,x[l][E]=p,x[l][S]=d,x[c]={},x[c][v]=c,x[c][m]=c,x[c][g]=c,x[c][y]=c,x[c][b]=c,x[c][w]=c,x[c][E]=p,x[c][S]=d,x[h]={},x[h][v]=h,x[h][m]=h,x[h][g]=h,x[h][y]=h,x[h][b]=h,x[h][w]=h,x[h][E]=p,x[h][S]=d,x[p]={},x[p][v]=p,x[p][m]=p,x[p][g]=p,x[p][y]=p,x[p][b]=p,x[p][w]=p,x[p][E]=p,x[p][S]=d,x[d]={},x[d][v]=d,x[d][m]=d,x[d][g]=d,x[d][y]=d,x[d][b]=d,x[d][w]=d,x[d][E]=d,x[d][S]=d;var T=function(s){this.id=-1,this.name=s.name||o,this.parent=s.parent||null,this.run=s.run,this.subtasks=[],this.error=!1,this.state=f,this.blocks=0,this.timeoutId=null,this.swapTime=null,this.userData=null,this.id=i++,r[this.id]=this,n>=1&&e.log.verbose(t,"[%s][%s] init",this.id,this.name,this)};T.prototype.debug=function(n){n=n||"",e.log.debug(t,n,"[%s][%s] task:",this.id,this.name,this,"subtasks:",this.subtasks.length,"queue:",s)},T.prototype.next=function(e,t){typeof e=="function"&&(t=e,e=this.name);var n=new T({run:t,name:e,parent:this});return n.state=l,n.type=this.type,n.successCallback=this.successCallback||null,n.failureCallback=this.failureCallback||null,this.subtasks.push(n),this},T.prototype.parallel=function(t,n){return e.util.isArray(t)&&(n=t,t=this.name),this.next(t,function(r){var i=r;i.block(n.length);var s=function(t,r){e.task.start({type:t,run:function(e){n[r](e)},success:function(e){i.unblock()},failure:function(e){i.unblock()}})};for(var o=0;o<n.length;o++){var u=t+"__parallel-"+r.id+"-"+o,a=o;s(u,a)}})},T.prototype.stop=function(){this.state=x[this.state][v]},T.prototype.start=function(){this.error=!1,this.state=x[this.state][m],this.state===l&&(this.start=new Date,this.run(this),C(this,0))},T.prototype.block=function(e){e=typeof e=="undefined"?1:e,this.blocks+=e,this.blocks>0&&(this.state=x[this.state][g])},T.prototype.unblock=function(e){return e=typeof e=="undefined"?1:e,this.blocks-=e,this.blocks===0&&this.state!==p&&(this.state=l,C(this,0)),this.blocks},T.prototype.sleep=function(e){e=typeof e=="undefined"?0:e,this.state=x[this.state][b];var t=this;this.timeoutId=setTimeout(function(){t.timeoutId=null,t.state=l,C(t,0)},e)},T.prototype.wait=function(e){e.wait(this)},T.prototype.wakeup=function(){this.state===h&&(cancelTimeout(this.timeoutId),this.timeoutId=null,this.state=l,C(this,0))},T.prototype.cancel=function(){this.state=x[this.state][E],this.permitsNeeded=0,this.timeoutId!==null&&(cancelTimeout(this.timeoutId),this.timeoutId=null),this.subtasks=[]},T.prototype.fail=function(e){this.error=!0,k(this,!0);if(e)e.error=this.error,e.swapTime=this.swapTime,e.userData=this.userData,C(e,0);else{if(this.parent!==null){var t=this.parent;while(t.parent!==null)t.error=this.error,t.swapTime=this.swapTime,t.userData=this.userData,t=t.parent;k(t,!0)}this.failureCallback&&this.failureCallback(this)}};var N=function(e){e.error=!1,e.state=x[e.state][m],setTimeout(function(){e.state===l&&(e.swapTime=+(new Date),e.run(e),C(e,0))},0)},C=function(e,t){var n=t>u||+(new Date)-e.swapTime>a,r=function(t){t++;if(e.state===l){n&&(e.swapTime=+(new Date));if(e.subtasks.length>0){var r=e.subtasks.shift();r.error=e.error,r.swapTime=e.swapTime,r.userData=e.userData,r.run(r),r.error||C(r,t)}else k(e),e.error||e.parent!==null&&(e.parent.error=e.error,e.parent.swapTime=e.swapTime,e.parent.userData=e.userData,C(e.parent,t))}};n?setTimeout(r,0):r(t)},k=function(i,o){i.state=p,delete r[i.id],n>=1&&e.log.verbose(t,"[%s][%s] finish",i.id,i.name,i),i.parent===null&&(i.type in s?s[i.type].length===0?e.log.error(t,"[%s][%s] task queue empty [%s]",i.id,i.name,i.type):s[i.type][0]!==i?e.log.error(t,"[%s][%s] task not first in queue [%s]",i.id,i.name,i.type):(s[i.type].shift(),s[i.type].length===0?(n>=1&&e.log.verbose(t,"[%s][%s] delete queue [%s]",i.id,i.name,i.type),delete s[i.type]):(n>=1&&e.log.verbose(t,"[%s][%s] queue start next [%s] remain:%s",i.id,i.name,i.type,s[i.type].length),s[i.type][0].start())):e.log.error(t,"[%s][%s] task queue missing [%s]",i.id,i.name,i.type),o||(i.error&&i.failureCallback?i.failureCallback(i):!i.error&&i.successCallback&&i.successCallback(i)))};e.task=e.task||{},e.task.start=function(r){var i=new T({run:r.run,name:r.name||o});i.type=r.type,i.successCallback=r.success||null,i.failureCallback=r.failure||null,i.type in s?s[r.type].push(i):(n>=1&&e.log.verbose(t,"[%s][%s] create queue [%s]",i.id,i.name,i.type),s[i.type]=[i],N(i))},e.task.cancel=function(e){e in s&&(s[e]=[s[e][0]])},e.task.createCondition=function(){var e={tasks:{}};return e.wait=function(t){t.id in e.tasks||(t.block(),e.tasks[t.id]=t)},e.notify=function(){var t=e.tasks;e.tasks={};for(var n in t)t[n].unblock()},e}}var r="task";if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),e(forge);var i=!0;n=function(e,n){n(t,module)}}var s,o=function(t,n){n.exports=function(n){var i=s.map(function(e){return t(e)}).concat(e);n=n||{},n.defined=n.defined||{};if(n.defined[r])return n[r];n.defined[r]=!0;for(var o=0;o<i.length;++o)i[o](n);return n[r]}},u=n;n=function(e,t){return s=typeof e=="string"?t.slice(2):e.slice(2),i?(delete n,u.apply(null,Array.prototype.slice.call(arguments,0))):(n=u,n.apply(null,Array.prototype.slice.call(arguments,0)))},n("js/task",["require","module","./debug","./log","./util"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){var e="forge";if(typeof n!="function"){if(typeof module!="object"||!module.exports){typeof forge=="undefined"&&(forge={disableNativeCode:!1});return}var r=!0;n=function(e,n){n(t,module)}}var i,s=function(t,n){n.exports=function(n){var r=i.map(function(e){return t(e)});n=n||{},n.defined=n.defined||{};if(n.defined[e])return n[e];n.defined[e]=!0;for(var s=0;s<r.length;++s)r[s](n);return n},n.exports.disableNativeCode=!1,n.exports(n.exports)},o=n;n=function(e,t){return i=typeof e=="string"?t.slice(2):e.slice(2),r?(delete n,o.apply(null,Array.prototype.slice.call(arguments,0))):(n=o,n.apply(null,Array.prototype.slice.call(arguments,0)))},n("js/forge",["require","module","./aes","./aesCipherSuites","./asn1","./cipher","./cipherModes","./debug","./des","./hmac","./kem","./log","./md","./mgf1","./pbkdf2","./pem","./pkcs7","./pkcs1","./pkcs12","./pki","./prime","./prng","./pss","./random","./rc2","./ssh","./task","./tls","./util"],function(){s.apply(null,Array.prototype.slice.call(arguments,0))})}(),t("js/forge")}),!function(e){function t(e){var t=e.length,r=n.type(e);return"function"===r||n.isWindow(e)?!1:1===e.nodeType&&t?!0:"array"===r||0===t||"number"==typeof t&&t>0&&t-1 in e}if(!e.jQuery){var n=function(e,t){return new n.fn.init(e,t)};n.isWindow=function(e){return null!=e&&e==e.window},n.type=function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?i[o.call(e)]||"object":typeof e},n.isArray=Array.isArray||function(e){return"array"===n.type(e)},n.isPlainObject=function(e){var t;if(!e||"object"!==n.type(e)||e.nodeType||n.isWindow(e))return!1;try{if(e.constructor&&!s.call(e,"constructor")&&!s.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(r){return!1}for(t in e);return void 0===t||s.call(e,t)},n.each=function(e,n,r){var i,s=0,o=e.length,u=t(e);if(r){if(u)for(;o>s&&(i=n.apply(e[s],r),i!==!1);s++);else for(s in e)if(i=n.apply(e[s],r),i===!1)break}else if(u)for(;o>s&&(i=n.call(e[s],s,e[s]),i!==!1);s++);else for(s in e)if(i=n.call(e[s],s,e[s]),i===!1)break;return e},n.data=function(e,t,i){if(void 0===i){var s=e[n.expando],o=s&&r[s];if(void 0===t)return o;if(o&&t in o)return o[t]}else if(void 0!==t){var s=e[n.expando]||(e[n.expando]=++n.uuid);return r[s]=r[s]||{},r[s][t]=i,i}},n.removeData=function(e,t){var i=e[n.expando],s=i&&r[i];s&&n.each(t,function(e,t){delete s[t]})},n.extend=function(){var e,t,r,i,s,o,u=arguments[0]||{},a=1,f=arguments.length,l=!1;for("boolean"==typeof u&&(l=u,u=arguments[a]||{},a++),"object"!=typeof u&&"function"!==n.type(u)&&(u={}),a===f&&(u=this,a--);f>a;a++)if(null!=(s=arguments[a]))for(i in s)e=u[i],r=s[i],u!==r&&(l&&r&&(n.isPlainObject(r)||(t=n.isArray(r)))?(t?(t=!1,o=e&&n.isArray(e)?e:[]):o=e&&n.isPlainObject(e)?e:{},u[i]=n.extend(l,o,r)):void 0!==r&&(u[i]=r));return u},n.queue=function(e,r,i){function s(e,n){var r=n||[];return null!=e&&(t(Object(e))?!function(e,t){for(var n=+t.length,r=0,i=e.length;n>r;)e[i++]=t[r++];if(n!==n)for(;void 0!==t[r];)e[i++]=t[r++];return e.length=i,e}(r,"string"==typeof e?[e]:e):[].push.call(r,e)),r}if(e){r=(r||"fx")+"queue";var o=n.data(e,r);return i?(!o||n.isArray(i)?o=n.data(e,r,s(i)):o.push(i),o):o||[]}},n.dequeue=function(e,t){n.each(e.nodeType?[e]:e,function(e,r){t=t||"fx";var i=n.queue(r,t),s=i.shift();"inprogress"===s&&(s=i.shift()),s&&("fx"===t&&i.unshift("inprogress"),s.call(r,function(){n.dequeue(r,t)}))})},n.fn=n.prototype={init:function(e){if(e.nodeType)return this[0]=e,this;throw new Error("Not a DOM node.")},offset:function(){var t=this[0].getBoundingClientRect?this[0].getBoundingClientRect():{top:0,left:0};return{top:t.top+(e.pageYOffset||document.scrollTop||0)-(document.clientTop||0),left:t.left+(e.pageXOffset||document.scrollLeft||0)-(document.clientLeft||0)}},position:function(){function e(){for(var e=this.offsetParent||document;e&&"html"===!e.nodeType.toLowerCase&&"static"===e.style.position;)e=e.offsetParent;return e||document}var t=this[0],e=e.apply(t),r=this.offset(),i=/^(?:body|html)$/i.test(e.nodeName)?{top:0,left:0}:n(e).offset();return r.top-=parseFloat(t.style.marginTop)||0,r.left-=parseFloat(t.style.marginLeft)||0,e.style&&(i.top+=parseFloat(e.style.borderTopWidth)||0,i.left+=parseFloat(e.style.borderLeftWidth)||0),{top:r.top-i.top,left:r.left-i.left}}};var r={};n.expando="velocity"+(new Date).getTime(),n.uuid=0;for(var i={},s=i.hasOwnProperty,o=i.toString,u="Boolean Number String Function Array Date RegExp Object Error".split(" "),a=0;a<u.length;a++)i["[object "+u[a]+"]"]=u[a].toLowerCase();n.fn.init.prototype=n.fn,e.Velocity={Utilities:n}}}(window),function(e){"object"==typeof module&&"object"==typeof module.exports?module.exports=e():"function"==typeof define&&define.amd?define("velocity",e):e()}(function(){return function(e,t,n,r){function i(e){for(var t=-1,n=e?e.length:0,r=[];++t<n;){var i=e[t];i&&r.push(i)}return r}function s(e){return d.isWrapped(e)?e=[].slice.call(e):d.isNode(e)&&(e=[e]),e}function o(e){var t=v.data(e,"velocity");return null===t?r:t}function u(e){return function(t){return Math.round(t*e)*(1/e)}}function a(e,n,r,i){function s(e,t){return 1-3*t+3*e}function o(e,t){return 3*t-6*e}function u(e){return 3*e}function a(e,t,n){return((s(t,n)*e+o(t,n))*e+u(t))*e}function f(e,t,n){return 3*s(t,n)*e*e+2*o(t,n)*e+u(t)}function l(t,n){for(var i=0;v>i;++i){var s=f(n,e,r);if(0===s)return n;var o=a(n,e,r)-t;n-=o/s}return n}function c(){for(var t=0;b>t;++t)x[t]=a(t*w,e,r)}function h(t,n,i){var s,o,u=0;do o=n+(i-n)/2,s=a(o,e,r)-t,s>0?i=o:n=o;while(Math.abs(s)>g&&++u<y);return o}function p(t){for(var n=0,i=1,s=b-1;i!=s&&x[i]<=t;++i)n+=w;--i;var o=(t-x[i])/(x[i+1]-x[i]),u=n+o*w,a=f(u,e,r);return a>=m?l(t,u):0==a?u:h(t,n,n+w)}function d(){T=!0,(e!=n||r!=i)&&c()}var v=4,m=.001,g=1e-7,y=10,b=11,w=1/(b-1),E="Float32Array"in t;if(4!==arguments.length)return!1;for(var S=0;4>S;++S)if("number"!=typeof arguments[S]||isNaN(arguments[S])||!isFinite(arguments[S]))return!1;e=Math.min(e,1),r=Math.min(r,1),e=Math.max(e,0),r=Math.max(r,0);var x=E?new Float32Array(b):new Array(b),T=!1,N=function(t){return T||d(),e===n&&r===i?t:0===t?0:1===t?1:a(p(t),n,i)};N.getControlPoints=function(){return[{x:e,y:n},{x:r,y:i}]};var C="generateBezier("+[e,n,r,i]+")";return N.toString=function(){return C},N}function f(e,t){var n=e;return d.isString(e)?b.Easings[e]||(n=!1):n=d.isArray(e)&&1===e.length?u.apply(null,e):d.isArray(e)&&2===e.length?w.apply(null,e.concat([t])):d.isArray(e)&&4===e.length?a.apply(null,e):!1,n===!1&&(n=b.Easings[b.defaults.easing]?b.defaults.easing:y),n}function l(e){if(e){var t=(new Date).getTime(),n=b.State.calls.length;n>1e4&&(b.State.calls=i(b.State.calls));for(var s=0;n>s;s++)if(b.State.calls[s]){var u=b.State.calls[s],a=u[0],f=u[2],h=u[3],p=!!h,m=null;h||(h=b.State.calls[s][3]=t-16);for(var g=Math.min((t-h)/f.duration,1),y=0,w=a.length;w>y;y++){var S=a[y],T=S.element;if(o(T)){var N=!1;if(f.display!==r&&null!==f.display&&"none"!==f.display){if("flex"===f.display){var C=["-webkit-box","-moz-box","-ms-flexbox","-webkit-flex"];v.each(C,function(e,t){E.setPropertyValue(T,"display",t)})}E.setPropertyValue(T,"display",f.display)}f.visibility!==r&&"hidden"!==f.visibility&&E.setPropertyValue(T,"visibility",f.visibility);for(var k in S)if("element"!==k){var L=S[k],A,O=d.isString(L.easing)?b.Easings[L.easing]:L.easing;if(1===g)A=L.endValue;else{var M=L.endValue-L.startValue;if(A=L.startValue+M*O(g,f,M),!p&&A===L.currentValue)continue}if(L.currentValue=A,"tween"===k)m=A;else{if(E.Hooks.registered[k]){var _=E.Hooks.getRoot(k),D=o(T).rootPropertyValueCache[_];D&&(L.rootPropertyValue=D)}var H=E.setPropertyValue(T,k,L.currentValue+(0===parseFloat(A)?"":L.unitType),L.rootPropertyValue,L.scrollData);E.Hooks.registered[k]&&(o(T).rootPropertyValueCache[_]=E.Normalizations.registered[_]?E.Normalizations.registered[_]("extract",null,H[1]):H[1]),"transform"===H[0]&&(N=!0)}}f.mobileHA&&o(T).transformCache.translate3d===r&&(o(T).transformCache.translate3d="(0px, 0px, 0px)",N=!0),N&&E.flushTransformCache(T)}}f.display!==r&&"none"!==f.display&&(b.State.calls[s][2].display=!1),f.visibility!==r&&"hidden"!==f.visibility&&(b.State.calls[s][2].visibility=!1),f.progress&&f.progress.call(u[1],u[1],g,Math.max(0,h+f.duration-t),h,m),1===g&&c(s)}}b.State.isTicking&&x(l)}function c(e,t){if(!b.State.calls[e])return!1;for(var n=b.State.calls[e][0],i=b.State.calls[e][1],s=b.State.calls[e][2],u=b.State.calls[e][4],a=!1,f=0,l=n.length;l>f;f++){var c=n[f].element;if(t||s.loop||("none"===s.display&&E.setPropertyValue(c,"display",s.display),"hidden"===s.visibility&&E.setPropertyValue(c,"visibility",s.visibility)),s.loop!==!0&&(v.queue(c)[1]===r||!/\.velocityQueueEntryFlag/i.test(v.queue(c)[1]))&&o(c)){o(c).isAnimating=!1,o(c).rootPropertyValueCache={};var h=!1;v.each(E.Lists.transforms3D,function(e,t){var n=/^scale/.test(t)?1:0,i=o(c).transformCache[t];o(c).transformCache[t]!==r&&(new RegExp("^\\("+n+"[^.]")).test(i)&&(h=!0,delete o(c).transformCache[t])}),s.mobileHA&&(h=!0,delete o(c).transformCache.translate3d),h&&E.flushTransformCache(c),E.Values.removeClass(c,"velocity-animating")}if(!t&&s.complete&&!s.loop&&f===l-1)try{s.complete.call(i,i)}catch(p){setTimeout(function(){throw p},1)}u&&s.loop!==!0&&u(i),o(c)&&s.loop===!0&&!t&&(v.each(o(c).tweensContainer,function(e,t){/^rotate/.test(e)&&360===parseFloat(t.endValue)&&(t.endValue=0,t.startValue=360),/^backgroundPosition/.test(e)&&100===parseFloat(t.endValue)&&"%"===t.unitType&&(t.endValue=0,t.startValue=100)}),b(c,"reverse",{loop:!0,delay:s.delay})),s.queue!==!1&&v.dequeue(c,s.queue)}b.State.calls[e]=!1;for(var d=0,m=b.State.calls.length;m>d;d++)if(b.State.calls[d]!==!1){a=!0;break}a===!1&&(b.State.isTicking=!1,delete b.State.calls,b.State.calls=[])}var h=function(){if(n.documentMode)return n.documentMode;for(var e=7;e>4;e--){var t=n.createElement("div");if(t.innerHTML="<!--[if IE "+e+"]><span></span><![endif]-->",t.getElementsByTagName("span").length)return t=null,e}return r}(),p=function(){var e=0;return t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||function(t){var n=(new Date).getTime(),r;return r=Math.max(0,16-(n-e)),e=n+r,setTimeout(function(){t(n+r)},r)}}(),d={isString:function(e){return"string"==typeof e},isArray:Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},isFunction:function(e){return"[object Function]"===Object.prototype.toString.call(e)},isNode:function(e){return e&&e.nodeType},isNodeList:function(e){return"object"==typeof e&&/^\[object (HTMLCollection|NodeList|Object)\]$/.test(Object.prototype.toString.call(e))&&e.length!==r&&(0===e.length||"object"==typeof e[0]&&e[0].nodeType>0)},isWrapped:function(e){return e&&(e.jquery||t.Zepto&&t.Zepto.zepto.isZ(e))},isSVG:function(e){return t.SVGElement&&e instanceof t.SVGElement},isEmptyObject:function(e){for(var t in e)return!1;return!0}},v,m=!1;if(e.fn&&e.fn.jquery?(v=e,m=!0):v=t.Velocity.Utilities,8>=h&&!m)throw new Error("Velocity: IE8 and below require jQuery to be loaded before Velocity.");if(7>=h)return void (jQuery.fn.velocity=jQuery.fn.animate);var g=400,y="swing",b={State:{isMobile:/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),isAndroid:/Android/i.test(navigator.userAgent),isGingerbread:/Android 2\.3\.[3-7]/i.test(navigator.userAgent),isChrome:t.chrome,isFirefox:/Firefox/i.test(navigator.userAgent),prefixElement:n.createElement("div"),prefixMatches:{},scrollAnchor:null,scrollPropertyLeft:null,scrollPropertyTop:null,isTicking:!1,calls:[]},CSS:{},Utilities:v,Redirects:{},Easings:{},Promise:t.Promise,defaults:{queue:"",duration:g,easing:y,begin:r,complete:r,progress:r,display:r,visibility:r,loop:!1,delay:!1,mobileHA:!0,_cacheValues:!0},init:function(e){v.data(e,"velocity",{isSVG:d.isSVG(e),isAnimating:!1,computedStyle:null,tweensContainer:null,rootPropertyValueCache:{},transformCache:{}})},hook:null,mock:!1,version:{major:1,minor:2,patch:2},debug:!1};t.pageYOffset!==r?(b.State.scrollAnchor=t,b.State.scrollPropertyLeft="pageXOffset",b.State.scrollPropertyTop="pageYOffset"):(b.State.scrollAnchor=n.documentElement||n.body.parentNode||n.body,b.State.scrollPropertyLeft="scrollLeft",b.State.scrollPropertyTop="scrollTop");var w=function(){function e(e){return-e.tension*e.x-e.friction*e.v}function t(t,n,r){var i={x:t.x+r.dx*n,v:t.v+r.dv*n,tension:t.tension,friction:t.friction};return{dx:i.v,dv:e(i)}}function n(n,r){var i={dx:n.v,dv:e(n)},s=t(n,.5*r,i),o=t(n,.5*r,s),u=t(n,r,o),a=1/6*(i.dx+2*(s.dx+o.dx)+u.dx),f=1/6*(i.dv+2*(s.dv+o.dv)+u.dv);return n.x=n.x+a*r,n.v=n.v+f*r,n}return function r(e,t,i){var s={x:-1,v:0,tension:null,friction:null},o=[0],u=0,a=1e-4,f=.016,l,c,h;for(e=parseFloat(e)||500,t=parseFloat(t)||20,i=i||null,s.tension=e,s.friction=t,l=null!==i,l?(u=r(e,t),c=u/i*f):c=f;;)if(h=n(h||s,c),o.push(1+h.x),u+=16,!(Math.abs(h.x)>a&&Math.abs(h.v)>a))break;return l?function(e){return o[e*(o.length-1)|0]}:u}}();b.Easings={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},spring:function(e){return 1-Math.cos(4.5*e*Math.PI)*Math.exp(6*-e)}},v.each([["ease",[.25,.1,.25,1]],["ease-in",[.42,0,1,1]],["ease-out",[0,0,.58,1]],["ease-in-out",[.42,0,.58,1]],["easeInSine",[.47,0,.745,.715]],["easeOutSine",[.39,.575,.565,1]],["easeInOutSine",[.445,.05,.55,.95]],["easeInQuad",[.55,.085,.68,.53]],["easeOutQuad",[.25,.46,.45,.94]],["easeInOutQuad",[.455,.03,.515,.955]],["easeInCubic",[.55,.055,.675,.19]],["easeOutCubic",[.215,.61,.355,1]],["easeInOutCubic",[.645,.045,.355,1]],["easeInQuart",[.895,.03,.685,.22]],["easeOutQuart",[.165,.84,.44,1]],["easeInOutQuart",[.77,0,.175,1]],["easeInQuint",[.755,.05,.855,.06]],["easeOutQuint",[.23,1,.32,1]],["easeInOutQuint",[.86,0,.07,1]],["easeInExpo",[.95,.05,.795,.035]],["easeOutExpo",[.19,1,.22,1]],["easeInOutExpo",[1,0,0,1]],["easeInCirc",[.6,.04,.98,.335]],["easeOutCirc",[.075,.82,.165,1]],["easeInOutCirc",[.785,.135,.15,.86]]],function(e,t){b.Easings[t[0]]=a.apply(null,t[1])});var E=b.CSS={RegEx:{isHex:/^#([A-f\d]{3}){1,2}$/i,valueUnwrap:/^[A-z]+\((.*)\)$/i,wrappedValueAlreadyExtracted:/[0-9.]+ [0-9.]+ [0-9.]+( [0-9.]+)?/,valueSplit:/([A-z]+\(.+\))|(([A-z0-9#-.]+?)(?=\s|$))/gi},Lists:{colors:["fill","stroke","stopColor","color","backgroundColor","borderColor","borderTopColor","borderRightColor","borderBottomColor","borderLeftColor","outlineColor"],transformsBase:["translateX","translateY","scale","scaleX","scaleY","skewX","skewY","rotateZ"],transforms3D:["transformPerspective","translateZ","scaleZ","rotateX","rotateY"]},Hooks:{templates:{textShadow:["Color X Y Blur","black 0px 0px 0px"],boxShadow:["Color X Y Blur Spread","black 0px 0px 0px 0px"],clip:["Top Right Bottom Left","0px 0px 0px 0px"],backgroundPosition:["X Y","0% 0%"],transformOrigin:["X Y Z","50% 50% 0px"],perspectiveOrigin:["X Y","50% 50%"]},registered:{},register:function(){for(var e=0;e<E.Lists.colors.length;e++){var t="color"===E.Lists.colors[e]?"0 0 0 1":"255 255 255 1";E.Hooks.templates[E.Lists.colors[e]]=["Red Green Blue Alpha",t]}var n,r,i;if(h)for(n in E.Hooks.templates){r=E.Hooks.templates[n],i=r[0].split(" ");var s=r[1].match(E.RegEx.valueSplit);"Color"===i[0]&&(i.push(i.shift()),s.push(s.shift()),E.Hooks.templates[n]=[i.join(" "),s.join(" ")])}for(n in E.Hooks.templates){r=E.Hooks.templates[n],i=r[0].split(" ");for(var e in i){var o=n+i[e],u=e;E.Hooks.registered[o]=[n,u]}}},getRoot:function(e){var t=E.Hooks.registered[e];return t?t[0]:e},cleanRootPropertyValue:function(e,t){return E.RegEx.valueUnwrap.test(t)&&(t=t.match(E.RegEx.valueUnwrap)[1]),E.Values.isCSSNullValue(t)&&(t=E.Hooks.templates[e][1]),t},extractValue:function(e,t){var n=E.Hooks.registered[e];if(n){var r=n[0],i=n[1];return t=E.Hooks.cleanRootPropertyValue(r,t),t.toString().match(E.RegEx.valueSplit)[i]}return t},injectValue:function(e,t,n){var r=E.Hooks.registered[e];if(r){var i=r[0],s=r[1],o,u;return n=E.Hooks.cleanRootPropertyValue(i,n),o=n.toString().match(E.RegEx.valueSplit),o[s]=t,u=o.join(" ")}return n}},Normalizations:{registered:{clip:function(e,t,n){switch(e){case"name":return"clip";case"extract":var r;return E.RegEx.wrappedValueAlreadyExtracted.test(n)?r=n:(r=n.toString().match(E.RegEx.valueUnwrap),r=r?r[1].replace(/,(\s+)?/g," "):n),r;case"inject":return"rect("+n+")"}},blur:function(e,t,n){switch(e){case"name":return b.State.isFirefox?"filter":"-webkit-filter";case"extract":var r=parseFloat(n);if(!r&&0!==r){var i=n.toString().match(/blur\(([0-9]+[A-z]+)\)/i);r=i?i[1]:0}return r;case"inject":return parseFloat(n)?"blur("+n+")":"none"}},opacity:function(e,t,n){if(8>=h)switch(e){case"name":return"filter";case"extract":var r=n.toString().match(/alpha\(opacity=(.*)\)/i);return n=r?r[1]/100:1;case"inject":return t.style.zoom=1,parseFloat(n)>=1?"":"alpha(opacity="+parseInt(100*parseFloat(n),10)+")"}else switch(e){case"name":return"opacity";case"extract":return n;case"inject":return n}}},register:function(){9>=h||b.State.isGingerbread||(E.Lists.transformsBase=E.Lists.transformsBase.concat(E.Lists.transforms3D));for(var e=0;e<E.Lists.transformsBase.length;e++)!function(){var t=E.Lists.transformsBase[e];E.Normalizations.registered[t]=function(e,n,i){switch(e){case"name":return"transform";case"extract":return o(n)===r||o(n).transformCache[t]===r?/^scale/i.test(t)?1:0:o(n).transformCache[t].replace(/[()]/g,"");case"inject":var s=!1;switch(t.substr(0,t.length-1)){case"translate":s=!/(%|px|em|rem|vw|vh|\d)$/i.test(i);break;case"scal":case"scale":b.State.isAndroid&&o(n).transformCache[t]===r&&1>i&&(i=1),s=!/(\d)$/i.test(i);break;case"skew":s=!/(deg|\d)$/i.test(i);break;case"rotate":s=!/(deg|\d)$/i.test(i)}return s||(o(n).transformCache[t]="("+i+")"),o(n).transformCache[t]}}}();for(var e=0;e<E.Lists.colors.length;e++)!function(){var t=E.Lists.colors[e];E.Normalizations.registered[t]=function(e,n,i){switch(e){case"name":return t;case"extract":var s;if(E.RegEx.wrappedValueAlreadyExtracted.test(i))s=i;else{var o,u={black:"rgb(0, 0, 0)",blue:"rgb(0, 0, 255)",gray:"rgb(128, 128, 128)",green:"rgb(0, 128, 0)",red:"rgb(255, 0, 0)",white:"rgb(255, 255, 255)"};/^[A-z]+$/i.test(i)?o=u[i]!==r?u[i]:u.black:E.RegEx.isHex.test(i)?o="rgb("+E.Values.hexToRgb(i).join(" ")+")":/^rgba?\(/i.test(i)||(o=u.black),s=(o||i).toString().match(E.RegEx.valueUnwrap)[1].replace(/,(\s+)?/g," ")}return 8>=h||3!==s.split(" ").length||(s+=" 1"),s;case"inject":return 8>=h?4===i.split(" ").length&&(i=i.split(/\s+/).slice(0,3).join(" ")):3===i.split(" ").length&&(i+=" 1"),(8>=h?"rgb":"rgba")+"("+i.replace(/\s+/g,",").replace(/\.(\d)+(?=,)/g,"")+")"}}}()}},Names:{camelCase:function(e){return e.replace(/-(\w)/g,function(e,t){return t.toUpperCase()})},SVGAttribute:function(e){var t="width|height|x|y|cx|cy|r|rx|ry|x1|x2|y1|y2";return(h||b.State.isAndroid&&!b.State.isChrome)&&(t+="|transform"),(new RegExp("^("+t+")$","i")).test(e)},prefixCheck:function(e){if(b.State.prefixMatches[e])return[b.State.prefixMatches[e],!0];for(var t=["","Webkit","Moz","ms","O"],n=0,r=t.length;r>n;n++){var i;if(i=0===n?e:t[n]+e.replace(/^\w/,function(e){return e.toUpperCase()}),d.isString(b.State.prefixElement.style[i]))return b.State.prefixMatches[e]=i,[i,!0]}return[e,!1]}},Values:{hexToRgb:function(e){var t=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,r;return e=e.replace(t,function(e,t,n,r){return t+t+n+n+r+r}),r=n.exec(e),r?[parseInt(r[1],16),parseInt(r[2],16),parseInt(r[3],16)]:[0,0,0]},isCSSNullValue:function(e){return 0==e||/^(none|auto|transparent|(rgba\(0, ?0, ?0, ?0\)))$/i.test(e)},getUnitType:function(e){return/^(rotate|skew)/i.test(e)?"deg":/(^(scale|scaleX|scaleY|scaleZ|alpha|flexGrow|flexHeight|zIndex|fontWeight)$)|((opacity|red|green|blue|alpha)$)/i.test(e)?"":"px"},getDisplayType:function(e){var t=e&&e.tagName.toString().toLowerCase();return/^(b|big|i|small|tt|abbr|acronym|cite|code|dfn|em|kbd|strong|samp|var|a|bdo|br|img|map|object|q|script|span|sub|sup|button|input|label|select|textarea)$/i.test(t)?"inline":/^(li)$/i.test(t)?"list-item":/^(tr)$/i.test(t)?"table-row":/^(table)$/i.test(t)?"table":/^(tbody)$/i.test(t)?"table-row-group":"block"},addClass:function(e,t){e.classList?e.classList.add(t):e.className+=(e.className.length?" ":"")+t},removeClass:function(e,t){e.classList?e.classList.remove(t):e.className=e.className.toString().replace(new RegExp("(^|\\s)"+t.split(" ").join("|")+"(\\s|$)","gi")," ")}},getPropertyValue:function(e,n,i,s){function u(e,n){function i(){f&&E.setPropertyValue(e,"display","none")}var a=0;if(8>=h)a=v.css(e,n);else{var f=!1;if(/^(width|height)$/.test(n)&&0===E.getPropertyValue(e,"display")&&(f=!0,E.setPropertyValue(e,"display",E.Values.getDisplayType(e))),!s){if("height"===n&&"border-box"!==E.getPropertyValue(e,"boxSizing").toString().toLowerCase()){var l=e.offsetHeight-(parseFloat(E.getPropertyValue(e,"borderTopWidth"))||0)-(parseFloat(E.getPropertyValue(e,"borderBottomWidth"))||0)-(parseFloat(E.getPropertyValue(e,"paddingTop"))||0)-(parseFloat(E.getPropertyValue(e,"paddingBottom"))||0);return i(),l}if("width"===n&&"border-box"!==E.getPropertyValue(e,"boxSizing").toString().toLowerCase()){var c=e.offsetWidth-(parseFloat(E.getPropertyValue(e,"borderLeftWidth"))||0)-(parseFloat(E.getPropertyValue(e,"borderRightWidth"))||0)-(parseFloat(E.getPropertyValue(e,"paddingLeft"))||0)-(parseFloat(E.getPropertyValue(e,"paddingRight"))||0);return i(),c}}var p;p=o(e)===r?t.getComputedStyle(e,null):o(e).computedStyle?o(e).computedStyle:o(e).computedStyle=t.getComputedStyle(e,null),"borderColor"===n&&(n="borderTopColor"),a=9===h&&"filter"===n?p.getPropertyValue(n):p[n],(""===a||null===a)&&(a=e.style[n]),i()}if("auto"===a&&/^(top|right|bottom|left)$/i.test(n)){var d=u(e,"position");("fixed"===d||"absolute"===d&&/top|left/i.test(n))&&(a=v(e).position()[n]+"px")}return a}var a;if(E.Hooks.registered[n]){var f=n,l=E.Hooks.getRoot(f);i===r&&(i=E.getPropertyValue(e,E.Names.prefixCheck(l)[0])),E.Normalizations.registered[l]&&(i=E.Normalizations.registered[l]("extract",e,i)),a=E.Hooks.extractValue(f,i)}else if(E.Normalizations.registered[n]){var c,p;c=E.Normalizations.registered[n]("name",e),"transform"!==c&&(p=u(e,E.Names.prefixCheck(c)[0]),E.Values.isCSSNullValue(p)&&E.Hooks.templates[n]&&(p=E.Hooks.templates[n][1])),a=E.Normalizations.registered[n]("extract",e,p)}if(!/^[\d-]/.test(a))if(o(e)&&o(e).isSVG&&E.Names.SVGAttribute(n))if(/^(height|width)$/i.test(n))try{a=e.getBBox()[n]}catch(d){a=0}else a=e.getAttribute(n);else a=u(e,E.Names.prefixCheck(n)[0]);return E.Values.isCSSNullValue(a)&&(a=0),b.debug>=2&&console.log("Get "+n+": "+a),a},setPropertyValue:function(e,n,r,i,s){var u=n;if("scroll"===n)s.container?s.container["scroll"+s.direction]=r:"Left"===s.direction?t.scrollTo(r,s.alternateValue):t.scrollTo(s.alternateValue,r);else if(E.Normalizations.registered[n]&&"transform"===E.Normalizations.registered[n]("name",e))E.Normalizations.registered[n]("inject",e,r),u="transform",r=o(e).transformCache[n];else{if(E.Hooks.registered[n]){var a=n,f=E.Hooks.getRoot(n);i=i||E.getPropertyValue(e,f),r=E.Hooks.injectValue(a,r,i),n=f}if(E.Normalizations.registered[n]&&(r=E.Normalizations.registered[n]("inject",e,r),n=E.Normalizations.registered[n]("name",e)),u=E.Names.prefixCheck(n)[0],8>=h)try{e.style[u]=r}catch(l){b.debug&&console.log("Browser does not support ["+r+"] for ["+u+"]")}else o(e)&&o(e).isSVG&&E.Names.SVGAttribute(n)?e.setAttribute(n,r):e.style[u]=r;b.debug>=2&&console.log("Set "+n+" ("+u+"): "+r)}return[u,r]},flushTransformCache:function(e){function t(t){return parseFloat(E.getPropertyValue(e,t))}var n="";if((h||b.State.isAndroid&&!b.State.isChrome)&&o(e).isSVG){var r={translate:[t("translateX"),t("translateY")],skewX:[t("skewX")],skewY:[t("skewY")],scale:1!==t("scale")?[t("scale"),t("scale")]:[t("scaleX"),t("scaleY")],rotate:[t("rotateZ"),0,0]};v.each(o(e).transformCache,function(e){/^translate/i.test(e)?e="translate":/^scale/i.test(e)?e="scale":/^rotate/i.test(e)&&(e="rotate"),r[e]&&(n+=e+"("+r[e].join(" ")+") ",delete r[e])})}else{var i,s;v.each(o(e).transformCache,function(t){return i=o(e).transformCache[t],"transformPerspective"===t?(s=i,!0):(9===h&&"rotateZ"===t&&(t="rotate"),void (n+=t+i+" "))}),s&&(n="perspective"+s+" "+n)}E.setPropertyValue(e,"transform",n)}};E.Hooks.register(),E.Normalizations.register(),b.hook=function(e,t,n){var i=r;return e=s(e),v.each(e,function(e,s){if(o(s)===r&&b.init(s),n===r)i===r&&(i=b.CSS.getPropertyValue(s,t));else{var u=b.CSS.setPropertyValue(s,t,n);"transform"===u[0]&&b.CSS.flushTransformCache(s),i=u}}),i};var S=function(){function e(){return a?k.promise||null:h}function i(){function e(e){function c(e,t){var n=r,o=r,u=r;return d.isArray(e)?(n=e[0],!d.isArray(e[1])&&/^[\d-]/.test(e[1])||d.isFunction(e[1])||E.RegEx.isHex.test(e[1])?u=e[1]:(d.isString(e[1])&&!E.RegEx.isHex.test(e[1])||d.isArray(e[1]))&&(o=t?e[1]:f(e[1],s.duration),e[2]!==r&&(u=e[2]))):n=e,t||(o=o||s.easing),d.isFunction(n)&&(n=n.call(i,T,x)),d.isFunction(u)&&(u=u.call(i,T,x)),[n||0,o,u]}function h(e,t){var n,r;return r=(t||"0").toString().toLowerCase().replace(/[%A-z]+$/,function(e){return n=e,""}),n||(n=E.Values.getUnitType(e)),[r,n]}function p(){var e={myParent:i.parentNode||n.body,position:E.getPropertyValue(i,"position"),fontSize:E.getPropertyValue(i,"fontSize")},r=e.position===P.lastPosition&&e.myParent===P.lastParent,s=e.fontSize===P.lastFontSize;P.lastParent=e.myParent,P.lastPosition=e.position,P.lastFontSize=e.fontSize;var u=100,a={};if(s&&r)a.emToPx=P.lastEmToPx,a.percentToPxWidth=P.lastPercentToPxWidth,a.percentToPxHeight=P.lastPercentToPxHeight;else{var f=o(i).isSVG?n.createElementNS("http://www.w3.org/2000/svg","rect"):n.createElement("div");b.init(f),e.myParent.appendChild(f),v.each(["overflow","overflowX","overflowY"],function(e,t){b.CSS.setPropertyValue(f,t,"hidden")}),b.CSS.setPropertyValue(f,"position",e.position),b.CSS.setPropertyValue(f,"fontSize",e.fontSize),b.CSS.setPropertyValue(f,"boxSizing","content-box"),v.each(["minWidth","maxWidth","width","minHeight","maxHeight","height"],function(e,t){b.CSS.setPropertyValue(f,t,u+"%")}),b.CSS.setPropertyValue(f,"paddingLeft",u+"em"),a.percentToPxWidth=P.lastPercentToPxWidth=(parseFloat(E.getPropertyValue(f,"width",null,!0))||1)/u,a.percentToPxHeight=P.lastPercentToPxHeight=(parseFloat(E.getPropertyValue(f,"height",null,!0))||1)/u,a.emToPx=P.lastEmToPx=(parseFloat(E.getPropertyValue(f,"paddingLeft"))||1)/u,e.myParent.removeChild(f)}return null===P.remToPx&&(P.remToPx=parseFloat(E.getPropertyValue(n.body,"fontSize"))||16),null===P.vwToPx&&(P.vwToPx=parseFloat(t.innerWidth)/100,P.vhToPx=parseFloat(t.innerHeight)/100),a.remToPx=P.remToPx,a.vwToPx=P.vwToPx,a.vhToPx=P.vhToPx,b.debug>=1&&console.log("Unit ratios: "+JSON.stringify(a),i),a}if(s.begin&&0===T)try{s.begin.call(m,m)}catch(g){setTimeout(function(){throw g},1)}if("scroll"===L){var S=/^x$/i.test(s.axis)?"Left":"Top",N=parseFloat(s.offset)||0,C,A,O;s.container?d.isWrapped(s.container)||d.isNode(s.container)?(s.container=s.container[0]||s.container,C=s.container["scroll"+S],O=C+v(i).position()[S.toLowerCase()]+N):s.container=null:(C=b.State.scrollAnchor[b.State["scrollProperty"+S]],A=b.State.scrollAnchor[b.State["scrollProperty"+("Left"===S?"Top":"Left")]],O=v(i).offset()[S.toLowerCase()]+N),u={scroll:{rootPropertyValue:!1,startValue:C,currentValue:C,endValue:O,unitType:"",easing:s.easing,scrollData:{container:s.container,direction:S,alternateValue:A}},element:i},b.debug&&console.log("tweensContainer (scroll): ",u.scroll,i)}else if("reverse"===L){if(!o(i).tweensContainer)return void v.dequeue(i,s.queue);"none"===o(i).opts.display&&(o(i).opts.display="auto"),"hidden"===o(i).opts.visibility&&(o(i).opts.visibility="visible"),o(i).opts.loop=!1,o(i).opts.begin=null,o(i).opts.complete=null,w.easing||delete s.easing,w.duration||delete s.duration,s=v.extend({},o(i).opts,s);var M=v.extend(!0,{},o(i).tweensContainer);for(var _ in M)if("element"!==_){var D=M[_].startValue;M[_].startValue=M[_].currentValue=M[_].endValue,M[_].endValue=D,d.isEmptyObject(w)||(M[_].easing=s.easing),b.debug&&console.log("reverse tweensContainer ("+_+"): "+JSON.stringify(M[_]),i)}u=M}else if("start"===L){var M;o(i).tweensContainer&&o(i).isAnimating===!0&&(M=o(i).tweensContainer),v.each(y,function(e,t){if(RegExp("^"+E.Lists.colors.join("$|^")+"$").test(e)){var n=c(t,!0),i=n[0],s=n[1],o=n[2];if(E.RegEx.isHex.test(i)){for(var u=["Red","Green","Blue"],a=E.Values.hexToRgb(i),f=o?E.Values.hexToRgb(o):r,l=0;l<u.length;l++){var h=[a[l]];s&&h.push(s),f!==r&&h.push(f[l]),y[e+u[l]]=h}delete y[e]}}});for(var B in y){var j=c(y[B]),F=j[0],I=j[1],q=j[2];B=E.Names.camelCase(B);var R=E.Hooks.getRoot(B),U=!1;if(o(i).isSVG||"tween"===R||E.Names.prefixCheck(R)[1]!==!1||E.Normalizations.registered[R]!==r){(s.display!==r&&null!==s.display&&"none"!==s.display||s.visibility!==r&&"hidden"!==s.visibility)&&/opacity|filter/.test(B)&&!q&&0!==F&&(q=0),s._cacheValues&&M&&M[B]?(q===r&&(q=M[B].endValue+M[B].unitType),U=o(i).rootPropertyValueCache[R]):E.Hooks.registered[B]?q===r?(U=E.getPropertyValue(i,R),q=E.getPropertyValue(i,B,U)):U=E.Hooks.templates[R][1]:q===r&&(q=E.getPropertyValue(i,B));var z,W,X,V=!1;if(z=h(B,q),q=z[0],X=z[1],z=h(B,F),F=z[0].replace(/^([+-\/*])=/,function(e,t){return V=t,""}),W=z[1],q=parseFloat(q)||0,F=parseFloat(F)||0,"%"===W&&(/^(fontSize|lineHeight)$/.test(B)?(F/=100,W="em"):/^scale/.test(B)?(F/=100,W=""):/(Red|Green|Blue)$/i.test(B)&&(F=F/100*255,W="")),/[\/*]/.test(V))W=X;else if(X!==W&&0!==q)if(0===F)W=X;else{a=a||p();var J=/margin|padding|left|right|width|text|word|letter/i.test(B)||/X$/.test(B)||"x"===B?"x":"y";switch(X){case"%":q*="x"===J?a.percentToPxWidth:a.percentToPxHeight;break;case"px":break;default:q*=a[X+"ToPx"]}switch(W){case"%":q*=1/("x"===J?a.percentToPxWidth:a.percentToPxHeight);break;case"px":break;default:q*=1/a[W+"ToPx"]}}switch(V){case"+":F=q+F;break;case"-":F=q-F;break;case"*":F=q*F;break;case"/":F=q/F}u[B]={rootPropertyValue:U,startValue:q,currentValue:q,endValue:F,unitType:W,easing:I},b.debug&&console.log("tweensContainer ("+B+"): "+JSON.stringify(u[B]),i)}else b.debug&&console.log("Skipping ["+R+"] due to a lack of browser support.")}u.element=i}u.element&&(E.Values.addClass(i,"velocity-animating"),H.push(u),""===s.queue&&(o(i).tweensContainer=u,o(i).opts=s),o(i).isAnimating=!0,T===x-1?(b.State.calls.push([H,m,s,null,k.resolver]),b.State.isTicking===!1&&(b.State.isTicking=!0,l())):T++)}var i=this,s=v.extend({},b.defaults,w),u={},a;switch(o(i)===r&&b.init(i),parseFloat(s.delay)&&s.queue!==!1&&v.queue(i,s.queue,function(e){b.velocityQueueEntryFlag=!0,o(i).delayTimer={setTimeout:setTimeout(e,parseFloat(s.delay)),next:e}}),s.duration.toString().toLowerCase()){case"fast":s.duration=200;break;case"normal":s.duration=g;break;case"slow":s.duration=600;break;default:s.duration=parseFloat(s.duration)||1}b.mock!==!1&&(b.mock===!0?s.duration=s.delay=1:(s.duration*=parseFloat(b.mock)||1,s.delay*=parseFloat(b.mock)||1)),s.easing=f(s.easing,s.duration),s.begin&&!d.isFunction(s.begin)&&(s.begin=null),s.progress&&!d.isFunction(s.progress)&&(s.progress=null),s.complete&&!d.isFunction(s.complete)&&(s.complete=null),s.display!==r&&null!==s.display&&(s.display=s.display.toString().toLowerCase(),"auto"===s.display&&(s.display=b.CSS.Values.getDisplayType(i))),s.visibility!==r&&null!==s.visibility&&(s.visibility=s.visibility.toString().toLowerCase()),s.mobileHA=s.mobileHA&&b.State.isMobile&&!b.State.isGingerbread,s.queue===!1?s.delay?setTimeout(e,s.delay):e():v.queue(i,s.queue,function(t,n){return n===!0?(k.promise&&k.resolver(m),!0):(b.velocityQueueEntryFlag=!0,void e(t))}),""!==s.queue&&"fx"!==s.queue||"inprogress"===v.queue(i)[0]||v.dequeue(i)}var u=arguments[0]&&(arguments[0].p||v.isPlainObject(arguments[0].properties)&&!arguments[0].properties.names||d.isString(arguments[0].properties)),a,h,p,m,y,w;if(d.isWrapped(this)?(a=!1,p=0,m=this,h=this):(a=!0,p=1,m=u?arguments[0].elements||arguments[0].e:arguments[0]),m=s(m)){u?(y=arguments[0].properties||arguments[0].p,w=arguments[0].options||arguments[0].o):(y=arguments[p],w=arguments[p+1]);var x=m.length,T=0;if(!/^(stop|finish)$/i.test(y)&&!v.isPlainObject(w)){var N=p+1;w={};for(var C=N;C<arguments.length;C++)d.isArray(arguments[C])||!/^(fast|normal|slow)$/i.test(arguments[C])&&!/^\d/.test(arguments[C])?d.isString(arguments[C])||d.isArray(arguments[C])?w.easing=arguments[C]:d.isFunction(arguments[C])&&(w.complete=arguments[C]):w.duration=arguments[C]}var k={promise:null,resolver:null,rejecter:null};a&&b.Promise&&(k.promise=new b.Promise(function(e,t){k.resolver=e,k.rejecter=t}));var L;switch(y){case"scroll":L="scroll";break;case"reverse":L="reverse";break;case"finish":case"stop":v.each(m,function(e,t){o(t)&&o(t).delayTimer&&(clearTimeout(o(t).delayTimer.setTimeout),o(t).delayTimer.next&&o(t).delayTimer.next(),delete o(t).delayTimer)});var A=[];return v.each(b.State.calls,function(e,t){t&&v.each(t[1],function(n,i){var s=w===r?"":w;return s===!0||t[2].queue===s||w===r&&t[2].queue===!1?void v.each(m,function(n,r){r===i&&((w===!0||d.isString(w))&&(v.each(v.queue(r,d.isString(w)?w:""),function(e,t){d.isFunction(t)&&t(null,!0)}),v.queue(r,d.isString(w)?w:"",[])),"stop"===y?(o(r)&&o(r).tweensContainer&&s!==!1&&v.each(o(r).tweensContainer,function(e,t){t.endValue=t.currentValue}),A.push(e)):"finish"===y&&(t[2].duration=1))}):!0})}),"stop"===y&&(v.each(A,function(e,t){c(t,!0)}),k.promise&&k.resolver(m)),e();default:if(!v.isPlainObject(y)||d.isEmptyObject(y)){if(d.isString(y)&&b.Redirects[y]){var O=v.extend({},w),M=O.duration,_=O.delay||0;return O.backwards===!0&&(m=v.extend(!0,[],m).reverse()),v.each(m,function(e,t){parseFloat(O.stagger)?O.delay=_+parseFloat(O.stagger)*e:d.isFunction(O.stagger)&&(O.delay=_+O.stagger.call(t,e,x)),O.drag&&(O.duration=parseFloat(M)||(/^(callout|transition)/.test(y)?1e3:g),O.duration=Math.max(O.duration*(O.backwards?1-e/x:(e+1)/x),.75*O.duration,200)),b.Redirects[y].call(t,t,O||{},e,x,m,k.promise?k:r)}),e()}var D="Velocity: First argument ("+y+") was not a property map, a known action, or a registered redirect. Aborting.";return k.promise?k.rejecter(new Error(D)):console.log(D),e()}L="start"}var P={lastParent:null,lastPosition:null,lastFontSize:null,lastPercentToPxWidth:null,lastPercentToPxHeight:null,lastEmToPx:null,remToPx:null,vwToPx:null,vhToPx:null},H=[];v.each(m,function(e,t){d.isNode(t)&&i.call(t)});var O=v.extend({},b.defaults,w),B;if(O.loop=parseInt(O.loop),B=2*O.loop-1,O.loop)for(var j=0;B>j;j++){var F={delay:O.delay,progress:O.progress};j===B-1&&(F.display=O.display,F.visibility=O.visibility,F.complete=O.complete),S(m,"reverse",F)}return e()}};b=v.extend(S,b),b.animate=S;var x=t.requestAnimationFrame||p;return b.State.isMobile||n.hidden===r||n.addEventListener("visibilitychange",function(){n.hidden?(x=function(e){return setTimeout(function(){e(!0)},16)},l()):x=t.requestAnimationFrame||p}),e.Velocity=b,e!==t&&(e.fn.velocity=S,e.fn.velocity.defaults=b.defaults),v.each(["Down","Up"],function(e,t){b.Redirects["slide"+t]=function(e,n,i,s,o,u){var a=v.extend({},n),f=a.begin,l=a.complete,c={height:"",marginTop:"",marginBottom:"",paddingTop:"",paddingBottom:""},h={};a.display===r&&(a.display="Down"===t?"inline"===b.CSS.Values.getDisplayType(e)?"inline-block":"block":"none"),a.begin=function(){f&&f.call(o,o);for(var n in c){h[n]=e.style[n];var r=b.CSS.getPropertyValue(e,n);c[n]="Down"===t?[r,0]:[0,r]}h.overflow=e.style.overflow,e.style.overflow="hidden"},a.complete=function(){for(var t in h)e.style[t]=h[t];l&&l.call(o,o),u&&u.resolver(o)},b(e,c,a)}}),v.each(["In","Out"],function(e,t){b.Redirects["fade"+t]=function(e,n,i,s,o,u){var a=v.extend({},n),f={opacity:"In"===t?1:0},l=a.complete;a.complete=i!==s-1?a.begin=null:function(){l&&l.call(o,o),u&&u.resolver(o)},a.display===r&&(a.display="In"===t?"auto":"none"),b(this,f,a)}}),b}(window.jQuery||window.Zepto||window,window,document)}),define("pdfView",["baseView","backbone","underscore","pdfjs-dist/build/pdf","deviceUtility","f","velocity"],function(e,t,n,r,i,o,u){var a,f,l,c,h;r.PDFJS.disableFontFace=!0,r.PDFJS.disableStream=!0,r.PDFJS.disableRange=!0,r.PDFJS.cMapUrl="../web/cmaps/",r.PDFJS.cMapPacked=!0;var p=new r.PDFJS.PDFWorker,d=function(){var e,t={},n=function(n){n.issueId!==e&&(t={}),t[n.id]=n.page,e=n.issueId},r=function(e){return t[e]},i=function(){t={}};return{set:n,get:r,clear:i}}();return e.extend({initialize:function(e){var t=window.navigator.userAgent.toLowerCase();this.tickQueue=e.tickQueue,a=e.filesBasePath,this.md=o.md.sha256.create(),f=e.extension,l=e.pdfPageClass,(new Image).src=a+this.model.get("fileBasePath")+"_large_tile1_0"+f,this.className=e.className,this.id=e.id,this.i=s.statsAPIPublicKey,this.issueId=e.issueId,this.model=e.model,this.eventLayers=e.eventLayers,this.pdfPath=e.filesBasePath+this.model.get("fileBasePath")+".pdf",this.index=e.index,this.cacheKey=this.model.get("id")+":"+this.id,this.isFirst=e.isFirst,this.isLast=e.isLast,this.showPageLoadProgress=e.showPageLoadProgress,this.pdfPath+="?env="+(window.location.host||"app")+"&br="+(t.indexOf("edge")!==-1?"edge":t.indexOf("chrome")!==-1?"chr":t.indexOf("firefox")!==-1?"fir":t.indexOf("safari")!==-1?"saf":"ukn"),this.bindEvents(),this.addHook("beforeClose",function(){c=null})},bindEvents:function(){this.unbindEvents(),this.md.update(this.i+this.model.get("fileBasePath").slice(-15)),t.on("beforePdfResize",this.beforePdfResize,this)},unbindEvents:function(){t.off("beforePdfResize",this.beforePdfResize,this)},clearPdfCache:function(){d.clear()},abortProcesses:function(){this.tickQueue.clear(),this.tickQueue.processing=!1},allowProcesses:function(){this.tickQueue&&(this.tickQueue.aborted=!1)},removeRenderedClass:function(){this.$("."+l).removeClass("page-rendered")},loadAndDraw:function(e){var t=this,n,s=this.getPage(),o=this.$(".page-inner-loader");e=e||{},e.complete=e.complete||function(){};if(this.$("."+l).hasClass("page-rendered")&&parseInt(this.$("canvas").attr("height"),10)>0){e.complete();return}i.isPortraitForced()&&(n=h.getViewport(this.getApplicationWidth()/c.width),$(".page").css({width:n.width,height:n.height}));if(s)this.isFirst&&this.setFirstPageMargin(s.getViewport(e.scale)),this.tickQueue.add({pageIndex:this.id,action:function(){t.draw({scale:e.scale,complete:e.complete})}});else{t.$(".page-loader").fadeIn();var u=function(n){d.set({id:t.cacheKey,page:n,issueId:t.issueId}),c||(c=n.getViewport(1)),t.isFirst&&t.setFirstPageMargin(n.getViewport(e.scale)),t.draw({scale:e.scale,complete:e.complete})};this.tickQueue.add({pageIndex:t.id,action:function(){var e={url:t.pdfPath,worker:p},n=r.getDocument(e);n.onPassword=function(e){e(t.pageClientId)},n.onProgress=function(e){o.css("width",e.loaded/e.total*100+"%")},n.then(function(e){t.tickQueue.aborted||e.getPage(1,t.id).then(function(e){t.tickQueue.aborted||u(e)})})}})}},beforePdfResize:function(){var e=this.getMinScale();this.removeRenderedClass();var t=h.getViewport(e);this.setFirstPageMargin(t),this.calculateAndSetNewSizeForPage({scale:e})},setFirstPageMargin:function(e){var t;this.isFirst&&!this.applicationHasClass("zooming-pdf")&&(t=this.$("."+l),i.isPortrait()?t.css("margin-left","auto"):t.css("margin-left",-(e.width/2)))},resetFirstPageMargin:function(){this.isFirst&&this.$("."+l).css("margin-left","auto")},load:function(e){var t=this,n=this.$(".page-inner-loader");this.allowProcesses();var i=function(n){d.set({id:t.cacheKey,page:n,issueId:t.issueId}),c||(c=n.getViewport(1),h=n),t.tickQueue.processing=!1,e.complete({page:n,defaultViewport:c})};t.tickQueue.add({pageIndex:this.id,action:function(){var e={url:t.pdfPath,worker:p};if(!t.tickQueue.aborted){var s=r.getDocument(e);s.onPassword=function(e){e(t.pageClientId)},s.onProgress=function(e){n.css("width",e.loaded/e.total*100+"%")},s.then(function(e){t.tickQueue.aborted||e.getPage(1,t.id).then(function(e){t.tickQueue.aborted||i(e)})})}}})},calculateAndSetNewSizeForPage:function(e){var t=h.getViewport(e.scale);this.$("."+l).css({width:t.width,height:t.height})},zoomIn:function(e){var t=this;this.resetFirstPageMargin(),this.removeRenderedClass(),this.calculateAndSetNewSizeForPage({scale:e.scale}),t.tickQueue.add({pageIndex:this.id,action:function(){t.draw({zoomIn:!0,scale:e.scale,complete:e.complete})}})},zoomOut:function(e){var t=this;this.resetFirstPageMargin(),this.removeRenderedClass(),this.calculateAndSetNewSizeForPage({scale:e.scale}),t.tickQueue.add({pageIndex:this.id,action:function(){t.draw({zoomOut:!0,scale:e.scale,complete:e.complete})}})},getPage:function(){return d.get(this.cacheKey)},draw:function(e){function f(e){var t=window.devicePixelRatio||1,n=e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1,r=t/n;return{sx:r,sy:r,scaled:r!==1}}var t=this,n=this.getPage(),s=t.$("."+l),o=e.scale,u;this.newDraw=!0,typeof o=="undefined"&&(o=this.getMinScale()),i.isPortraitForced()&&(o=this.getApplicationWidth()/c.width),u=n.getViewport(o),t.isFirst&&t.setFirstPageMargin(u);var a=this.$("canvas")[0];a.mozOpaque=!0;var h=a.getContext("2d",{alpha:!1}),p=f(h),d=null;a.width=Math.floor(u.width)*p.sx|0,a.height=Math.floor(u.height)*p.sy|0,a.style.width=Math.floor(u.width)+"px",a.style.height=Math.floor(u.height)+"px",a._viewport=u,p.scaled&&(d=[p.sx,0,0,p.sy,0,0]);var v={canvasContext:h,viewport:u,transform:d};s.css({width:u.width+"px",height:u.height+"px"});var m=n.render(v);m.promise.then(function(){r.disableFontFace=!0;if(t.tickQueue.aborted)return;t.scale=o,t.newDraw=!1,t.$(".page-loader").fadeOut(),e.complete({scale:o,width:u.width,height:u.height,defaultViewport:c}),t.newDraw||s.addClass("page-rendered"),m.cancel(),n.cleanup(),t.tickQueue.processing=!1,t.tickQueue.tick()})},getMinScale:function(){var e=this.getApplicationHeight(),t=this.getApplicationWidth(),n=i.isPortrait()?t:t/2,r=e/c.height;return c.width*r>n&&(r=n/c.width),i.isPortraitForced()&&(r=t/c.width),r},getViewport:function(){return h.getViewport(this.getMinScale())},render:function(){var e=$('<div style="background:url('+a+this.model.get("fileBasePath")+"_large_tile1_0"+f+')!important; -webkit-background-size: cover!important; -moz-background-size: cover!important; -o-background-size: cover!important; background-size: cover!important; background-repeat:no-repeat!important" id="pageContainer'+(this.index+1)+'" class="'+l+'">');return e.append($("<canvas>").data("page-index",this.id),this.eventLayers),this.pageClientId=this.md.digest().toHex().substring(0,32),this.showPageLoadProgress&&e.append($('<div class="page-loader"><div class="page-inner-loader"></div></div>')),this.$el.html(e),this}})}),"use strict",define("pagesPartView",["baseView","jquery"],function(e,t){return e.extend({className:"pages-part",events:{"tap .pages-part-object":"tap"},tap:function(){var e=this;setTimeout(function(){e.onTapped(e.model)},5)},onTapped:function(){},initialize:function(e){this.filesBasePath=e.filesBasePath,this.issueId=e.issueId,this.model=e.model},getImgSrc:function(){return this.filesBasePath+this.model.get("thumbnails").large},checkImageSize:function(e){e=e||this.$("img"),e.width>256&&this.model.get("thumbnails").xlarge&&(e.src=this.filesBasePath+this.model.get("thumbnails").xlarge)},render:function(){var e=this,n=t("<img/>",{"class":"pages-part-object",draggable:!1});return this.$el.html(n),n.on("load",function(){n.off("load"),e.checkImageSize(this)}).attr("src",this.getImgSrc()),this}})}),"use strict",define("pagesPartWrapperView",["backbone","jquery","baseView","pagesPartView"],function(e,t,n,r){return n.extend({supportZoom:!1,className:"inactive-slide pages-part-wrapper",initialize:function(e){this.partCollection=e.partCollection,this.filesBasePath=e.filesBasePath,this.issueId=e.issueId,this.innerWrapperClassName=e.innerWrapperClassName,this.openOverlayElements=e.openOverlayElements},render:function(){var e=t('<div class="'+this.innerWrapperClassName+'">');return this.partCollection.each(function(t){e.append(this.getPartThumbnailView(t).render().el)},this),this.$el.append(e),this},getPartThumbnailView:function(t){var n=this;return this.partView=new r({filesBasePath:this.filesBasePath,model:t,issueId:this.issueId}),this.partView.onTapped=function(t){if(n.openOverlayElements.length>0)return;n.trigger("setActivePartId",t.get("id")),e.trigger("pages:reInit",{issueId:n.issueId,partId:t.get("id"),pageIndex:1})},this.addView.call(this,this.partView),this.partView},checkImageSize:function(){this.partView&&this.partView.checkImageSize()},setOffset:function(e,t){t?this.$el.css("-webkit-transform","translate3d("+e+"px, 0, 0)"):this.$el.css("left",e)}})}),define("vendor/text!components/pdf/templates/pdfsTemplate.html",[],function(){return'<div>\n    <div id="iscroll-wrapper">\n        <div id="viewerContainer" class="pdf-swiper-container swiper-container">\n            <div id="viewer" class="pdf-swiper-wrapper swiper-wrapper pdfViewer"></div>\n        </div>\n    </div>\n</div>\n'}),"use strict",define("pdfsView",["backbone","hammer","underscore","jquery","swiper","baseView","eventView","deviceUtility","IScroll","pdfView","pagesPartWrapperView","vendor/text!components/pdf/templates/pdfsTemplate.html"],function(e,t,n,r,i,s,o,u,a,f,l,c){function W(e){function t(e,t){for(var n in t)if(t[n].test(e[n]))return!0;return!1}t(e.target,M)||e.preventDefault()}function X(){return u.isPortrait()?1:2}function V(e){e.preventDefault(),e.stopPropagation(),e.gesture.preventDefault(),e.gesture.stopPropagation()}var h=null,p=null,d,v,m,g="application-page",y="pdf-wrapper",b="pdf-swiper-container",w="swiper-slide",E="pdf-swiper-slide",S="swiper-slide-active",x="swiper-slide-next",T="inactive-pdf-page",N="dummy-page",C="page",k="page-rendered",L="alfred",A="#iscroll-wrapper",O="pagerendered",M={className:/^pages-part(s?)(-\w|$)/},_,D,P=1,H=!1,B,j,F,I,q,R,U,z,$=function(){var e=[],t=this;this.processing=!1,this.aborted=!1,this.tick=function(){if(e.length&&!t.processing&&!this.aborted){t.processing=!0;var n=e.shift(),r;e.length&&n.pageIndex>1&&n.pageIndex%2!==0&&n.pageIndex===e[0].pageIndex+1&&!u.isPortrait()&&(r=e.shift(),e.unshift(n)),n=r?r:n,n.action&&n.action()}},this.clear=function(){this.aborted=!0,this.processing=!1,e.forEach(function(e){e.action=null},this),e=[]},this.add=function(n){if(e.length)for(var r=e.length-1;r>=0;r--)e[r].pageIndex===n.pageIndex&&e.splice(r,1);e.unshift(n),t.tick()}};return s.extend({className:g,id:y,pdfsViewTemplate:n.template(c),events:{tap:"tap"},initialize:function(e){this.pdfViews=[],this.init(e),this.pressedKey=this.pressedKey.bind(this),this.bootstrapPdfData(e),this.addHooks(e),this.bindEvents(),P=1,h=0,p=0,this.options=e,this.tapTimeoutId=null,this.isTapped=!1,this.openOverlayElements=[],this.closedOverlayElements=[],this.hasVisibleOverlays=!1,this.zoomEnabled=!1,this.tickQueue=new $},tap:function(e){var t=this;r(".article-search-text-box").blur(),this.isTapped?(window.clearTimeout(this.tapTimeoutId),this.isTapped=!1,this.doubleTap(e)):(this.isTapped=!0,this.tapTimeoutId=window.setTimeout(function(){t.isTapped=!1,t.viewOptions.toggleOnTap&&t.toggleOverlays(e),t.viewOptions.hideOnTap&&t.hideOverlays(e)},200))},doubleTap:function(e){this.viewOptions.toggleOnDoubleTap&&this.toggleOverlays(e)},toggleOverlays:function(e){V(e),this.hasVisibleOverlays?this.hideOverlays(e):this.showOverlays(e)},hideOverlays:function(t){if(this.openOverlayElements.length===0)return;V(t),this.hasVisibleOverlays=!1,this.openOverlayElements.forEach(function(t){e.trigger(t+":closePart")}),this.openOverlayElements.length=0},showOverlays:function(t){V(t),this.hasVisibleOverlays=!0,this.closedOverlayElements.forEach(function(t){e.trigger(t+":openPart")}),this.closedOverlayElements=[]},overlayElementOpen:function(e){this.openOverlayElements.indexOf(e)===-1&&this.openOverlayElements.push(e),this.hasVisibleOverlays=!0},overlayElementClose:function(e){this.closedOverlayElements.indexOf(e)===-1&&this.closedOverlayElements.push(e)},addHooks:function(e){this.addHook.call(this,"beforeRender",function(){var t=this.model.get("parts").length<2?" has-no-parts":" has-parts";this.$el.addClass(L),this.setApplicationClass("fixed not-scrollable "+e.viewOptions.componentName+t)}),this.addHook.call(this,"beforeClose",function(){this.pdfViews[0].abortProcesses(),this.pdfViews[0].clearPdfCache(),window.clearTimeout(this.tapTimeoutId),window.clearTimeout(R),D&&(D=!1,u.resetOrientation(),this.removeApplicationClass("forced-portrait")),this.removeApplicationClass("fixed not-scrollable "+e.viewOptions.componentName+" has-no-parts has-parts"),this.destroyZoom(),this.destroySwiper()}),this.addHook.call(this,"afterClose",function(){for(var e in this)this.hasOwnProperty(e)&&delete this[e]})},bindEvents:function(){e.on("onSetTranslate",this.onSetTranslate,this),e.on("onTransitionStart",this.onTransitionStart,this),e.on("onTransitionEnd",this.onTransitionEnd,this),e.on("orientationchange",this.onResize,this),e.on(O,this.onPageRendered,this),e.on("navigate",this.slideToByDirection,this),e.on("pagesSwipeTo",this.slideToByIndex,this),e.on("fullPortraitWidth",this.toggleFullPortraitWidth,this),e.on("fullPortraitWidthOnStart",this.setFullPortraitWithOnStart,this),e.on("zoomInPDF",this.zoomIn,this),e.on("zoomOutPDF",this.zoomOut,this),e.on("disableZoomPDF",this.disableZoomHandler,this),e.on("enableZoomInPDF enableZoomOutPDF",this.enableZoomHandler,this),e.on("overlayElementOpen",this.overlayElementOpen,this),e.on("overlayElementClose",this.overlayElementClose,this),e.on("overlayElementCloseAll",this.hideOverlays,this),e.on("fullscreenChangedState",this.onFullscreenChangedState,this),e.on("print",this.print,this),e.on("done:pdfPrintFeature",this.pdfPrintFeatureDone,this),document.addEventListener("keydown",this.pressedKey,!0),r("#application-content, #main-header, #main-footer").on("mousewheel DOMMouseScroll",W)},unbindEvents:function(){e.off("onSetTranslate",this.onSetTranslate,this),e.off("onTransitionStart",this.onTransitionStart,this),e.off("onTransitionEnd",this.onTransitionEnd,this),e.off("orientationchange",this.onResize,this),e.off(O,this.onPageRendered,this),e.off("navigate",this.slideToByDirection,this),e.off("pagesSwipeTo",this.slideToByIndex,this),e.off("fullPortraitWidth",this.toggleFullPortraitWidth,this),e.off("fullPortraitWidthOnStart",this.setFullPortraitWithOnStart,this),e.off("zoomInPDF",this.zoomIn,this),e.off("zoomOutPDF",this.zoomOut,this),e.off("fullscreenChangedState",this.updateSwiper,this),e.off("overlayElementOpen",this.overlayElementOpen,this),e.off("overlayElementClose",this.overlayElementClose,this),e.off("overlayElementCloseAll",this.hideOverlays,this),e.off("print",this.print,this),e.off("done:pdfPrintFeature",this.pdfPrintFeatureDone,this),document.removeEventListener("keydown",this.pressedKey,!0),r("#application-content, #main-header, #main-footer").off("mousewheel DOMMouseScroll",W)},onFullscreenChangedState:function(){this.onResize()},setFullPortraitWithOnStart:function(e){this.fullPortraitWithOnStart=e},bootstrapPdfData:function(e){var t=e.model.get("parts"),n=e.partId||t.at(0).get("id"),r=t.get(n),i=r.get("pages"),s=i.at(0);return z=s.get("tileSizes")[0],I="."+e.model.get("extension"),q=e.model.get("files_basepath"),B=q+r.get("pdf"),this.model.set({pagesPageIndex:e.pageIndex||1,activePageIndex:e.pageIndex||1,pagesPartId:n,activePartId:n}),this.pagesCollection=i,e},shouldRenderAreas:function(){return n.isUndefined(this.viewOptions.renderAreas)?!0:this.viewOptions.renderAreas},addWrapperPage:function(e,t,n){function u(){s=new l({partCollection:t,filesBasePath:i.model.get("files_basepath"),issueId:i.model.get("id"),id:e==="first"?"firstPageIndex":e==="last"?"lastPageIndex":"",className:o,innerWrapperClassName:"pages-parts-inner-wrapper "+E,openOverlayElements:i.openOverlayElements}),s.on("setActivePartId",function(e){i.model.set("activePartId",e)},i),i.addView.call(i,s,n,"append")}var i=this,s,o=w+" "+E+" "+N+" pages-part-wrapper";e==="first"&&this.viewOptions.showPartsFirst?u():e==="last"&&this.viewOptions.showPartsLast?u():n.append(r('<div class="'+w+" "+E+" "+N+'">'))},componentDone:function(){var t=this,s,a=r("#viewer");this.addWrapperPage("first",this.model.get("parts"),a),this.pagesCollection.models.forEach(function(e,i){var s=r('<div class="event-layers">'),u,l,c;i===0?(u="page-first ",l=!0):i===this.pagesCollection.models.length-1?(u="page-last ",c=!0):i%2===0?u="page-right ":u="page-left ",u+=w+" "+E;var h=new f({model:e,index:i,id:i+1,isFirst:l,isLast:c,issueId:t.model.get("id"),eventLayers:s,filesBasePath:q,extension:I,pdfPageClass:C,className:u,showPageLoadProgress:t.viewOptions.showPageLoadProgress,tickQueue:t.tickQueue});t.pdfViews.push(h),t.addView.call(t,h,a,"append");var p,d=this.viewOptions.areaBlacklist||[];if(e&&!n.isUndefined(p=e.get("areas"))&&this.shouldRenderAreas())for(var v=p.length-1;v>=0;--v){var m=p[v];if(d.includes(m.type))continue;var g=new o({issueId:t.model.get("id"),partId:t.model.get("pagesPartId"),trigger:t.viewOptions.eventView.trigger,model:m,openOverlayElements:t.openOverlayElements});t.addView.call(t,g,s,"append")}t.bindOnTriggerEvent(e,h.$("."+C))},this),this.addWrapperPage("last",this.model.get("parts"),a);var l=r("."+C);this.pdfViews[0].load({complete:function(n){var o;F=n.defaultViewport,t.setScales(t.pdfViews[0].getMinScale()),o=n.page.getViewport(_),l.css({width:o.width,height:o.height}),t.initSwiper(),e.trigger("beforePdfResize"),!u.isPortrait()&&i.activeIndex===0?s=1:s=t.swiper.activeIndex,t.setActivePageIndex(s),t.updateCurrentPage(),t.setSize(),t.fullPortraitWithOnStart&&t.toggleFullPortraitWidth(t.fullPortraitWithOnStart),r("."+L).removeClass(L),e.trigger("removeLoader")}})},bindOnTriggerEvent:function(n,r){var i=this,s=this.model,o=this.viewOptions.bindOnTriggerEvent,u=o?o.indexOf("all")!==-1:!1,a=o?o.indexOf(n.get("pagina"))!==-1:!1;(o&&u||a)&&t(r).on(i.viewOptions.eventView.trigger,function(t){if(i.hasVisibleOverlays)return;return V(t),e.trigger("reader:open",{issueId:s.get("id"),partId:i.model.get("activePartId"),articleId:undefined}),!1},this)},toggleFullPortraitWidth:function(e){var t=this.swiper.activeIndex;this.clearCanvases(),this.removeRenderedClasses(),e?(u.forceOrientationToPortrait(),this.setApplicationClass("forced-portrait"),this.swiper.params.slidesPerView=this.swiper.params.slidesPerGroup=1,this.swiper.update(!0)):(u.resetOrientation(),this.removeApplicationClass("forced-portrait"),this.swiper.params.slidesPerView=this.swiper.params.slidesPerGroup=X(),this.swiper.update(!0),t===1&&(this.swiper.unlockSwipes(),this.swiper.slidePrev(!0,0))),this.loadAndDrawPages({swiper:this.swiper,complete:function(){this.initPageScroll(this.swiper)}.bind(this)})},getActiveIndex:function(e){return e=e||this.swiper,e?e.activeIndex:0},getPreviousIndex:function(){return this.swiper?this.swiper.previousIndex:0},render:function(){return this.$el.html(this.pdfsViewTemplate({})),this},initSwiper:function(){var t=this,n=parseInt(this.model.get("activePageIndex"));n===1&&(this.setActivePageIndex(n),this.model.setRoute(this.model.toJSON()),u.isPortrait()&&(n=1)),j=n,this.swiper=this.$("."+b).swiper({speed:200,initialSlide:n,slidesPerView:X(),slidesPerGroup:X(),onlyExternal:!0,keyboardControl:!0,watchSlidesVisibility:!0,onTransitionStart:function(t){t.lockSwipes(),e.trigger("onTransitionStart",t)},onTransitionEnd:function(n){e.trigger("onTransitionEnd",n),t.triggerStat(n)},onSetTranslate:function(t){t.update(),e.trigger("onSetTranslate",t)}}),this.togglePagesClassname(),!u.isPortrait()&&this.swiper.activeIndex===0&&n===1&&this.loadAndDrawPages({swiper:this.swiper}),n===1&&!u.isPortrait()&&this.triggerStat(this.swiper),this.swiper.params.allowSwipeToPrev=this.swiper.activeIndex>1,this.swiper.params.allowSwipeToNext=this.swiper.activeIndex<this.swiper.slides.length-(this.viewOptions.showPartsLast?1:2)},onTransitionStart:function(){this.$el.addClass(L),e.trigger("disableZoomPDF"),H&&this.resetZoom()},onTransitionEnd:function(e){e.params.allowSwipeToPrev=e.activeIndex>1,e.params.allowSwipeToNext=e.activeIndex<e.slides.length-(this.viewOptions.showPartsLast?1:2),this.$el.removeClass(L),j=e.activeIndex,this.resetPageScroll(),this.togglePagesClassname(e.activeIndex),u.isPortraitForced()&&this.initPageScroll(e),this.setActivePageIndex(e.activeIndex),this.loadAndDrawPages({swiper:e}),this.model.setRoute(this.model.toJSON()),this.updateCurrentPage(),this.pageScroll&&this.pageScroll.refresh()},loadAndDrawPages:function(t){t=t||{},t.complete=t.complete||function(){},e.trigger("disableZoomPDF"),e.trigger("disableFullscreenMode");var n=function(n){if(u.isPortrait()&&n||!u.isPortrait()&&!n||this.pdfViews.length===t.swiper.activeIndex)e.trigger("enableZoomInPDF"),e.trigger("enableFullscreenMode"),t.complete()}.bind(this);U=_;var r=this.pdfViews[t.swiper.activeIndex-1],i;u.isPortrait()||(i=this.pdfViews[t.swiper.activeIndex]),r&&r.loadAndDraw({scale:_,complete:function(){n(!0)}}),i&&i.loadAndDraw({scale:_,complete:function(){n(!1)}})},triggerStat:function(t){var n=this.getActivePage(t);n.page&&e.trigger("stat:pageView",n.page.toJSON()),n.secondActivePage&&e.trigger("stat:pageView",n.secondActivePage.toJSON())},getActivePage:function(e){var t=this.getActiveIndex(e),n=this.pagesCollection.length,r=u.isPortrait(),i=null,s=null,o="";return r?t!==0&&t!==n+2&&(i=t,o=i):t===0?(s=1,o+=s):t===n?(i=t,o+=i):(i=t,s=t+1,o=i+"-"+s),{page:i?this.pagesCollection.at(i-1):null,secondActivePage:s?this.pagesCollection.at(s-1):null,index:o}},updateCurrentPage:function(){var t=this.getActivePage(),n=this.getActiveIndex(),r={pageNumber:t.index,pagesLength:this.pagesCollection.length,section:""};this.model.set({pagesPageIndex:n,activePageIndex:n}),t.page?(r.section=t.page.get("section"),e.trigger("setActivePage",t.page)):t.secondActivePage&&(r.section=t.secondActivePage.get("section"),e.trigger("setActivePage",t.secondActivePage)),this.setActiveSection(r.section),e.trigger("setIssueDetails",r)},setActiveSection:function(e){return e=this.replaceForeignCharacters(e),e&&e!==this.activeSection&&(this.activeSection=e,this.trigger("activeSectionChange",e)),this},updateSwiper:function(){this.swiper&&this.swiper.update(!0)},destroySwiper:function(){this.swiper&&(this.swiper.destroy(),this.swiper=null)},setActivePageIndex:function(e){this.model.set({pagesPageIndex:e,activePageIndex:e})},slideToByDirection:function(t){var n,r;if(H||!this.swiper)return;n=t.direction==="left"&&this.swiper.params.allowSwipeToPrev,r=t.direction==="right"&&this.swiper.params.allowSwipeToNext;if(n||r)H&&this.resetZoom(),n?(e.trigger("willChangePageByExternal",{direction:"prev"}),this.swiper.slidePrev(!0)):r&&(e.trigger("willChangePageByExternal",{direction:"next"}),this.swiper.slideNext(!0))},slideToByIndex:function(t){var n,r,i;if(!this.swiper)return;n=t.index<j&&this.swiper.params.allowSwipeToPrev,r=t.index>j&&this.swiper.params.allowSwipeToNext;if(n||r)H&&this.resetZoom(),!u.isPortrait()&&!this.numberIsEven(t.index)&&(t.index-=1),i=n?"prev":"next",e.trigger("willChangePageByExternal",{direction:i}),this.swiper.slideTo(t.index,0,!0)},togglePagesClassname:function(e){var t=this.$("."+E);e=e>=0?e:this.swiper.activeIndex,t.each(function(t,n){n=r(n),u.isPortrait()&&t!==e||!u.isPortrait()&&t!==e&&t!==e+1?n.addClass(T):n.removeClass(T)}.bind(this))},onResize:function(){var t,n,r;if(!this.swiper)return;t=this.swiper.params.allowSwipeToPrev,n=this.swiper.params.allowSwipeToNext,r=this.pdfViews[0].getMinScale(),this.clearCanvases(),this.removeRenderedClasses(),this.swiper.unlockSwipes(),this.setScales(r),this.resetZoom(r),e.trigger("beforePdfResize"),window.clearTimeout(R);var i=!u.isPortrait()&&this.swiper.activeIndex===0?1:this.swiper.activeIndex;this.swiper.params.slidesPerView=this.swiper.params.slidesPerGroup=X(),this.setSize(),this.swiper.update(!0),u.isPortrait()&&this.swiper.activeIndex===0?this.swiper.slideNext(!1,0):!u.isPortrait()&&!this.numberIsEven(this.swiper.activeIndex)&&(this.swiper.unlockSwipeToPrev(),this.swiper.slidePrev(!1,0)),this.setActivePageIndex(i),this.togglePagesClassname(),t&&this.swiper.lockSwipeToPrev(),n&&this.swiper.lockSwipeToNext(),R=window.setTimeout(function(){this.swiper&&e.trigger("onTransitionEnd",this.swiper)}.bind(this),300)},setScales:function(e){m=this.getApplicationWidth()/(F.width/2),v=this.getApplicationWidth()/F.width,d=e,_=e},setSize:function(){var e=this.getApplicationHeight(),t=this.pdfViews[0].getViewport();this.$el.height(e),this.$("."+b+", ."+E).css("height",e),this.$("."+C).css({width:t.width,height:t.height})},initPageScroll:function(e){var t;if(!u.isPortraitForced())return;t=e.activeIndex>0?S:x,this.pageScroll=new a(this.$("."+t)[0],{scrollY:!0,scrollX:!1,mouseWheel:!0,useTransform:!0,useTransition:!0,zoom:!1,freeScroll:!1,bounce:!1,bounceTime:0,momentum:300,preventDefaultException:M})},resetPageScroll:function(){this.pageScroll&&this.pageScroll.scrollTo(this.pageScroll.x,0,0),this.destroyPageScroll()},destroyPageScroll:function(){this.pageScroll&&(this.pageScroll.scrollTo(0,0),this.pageScroll.destroy(),this.pageScroll=null)},pressedKey:function(e){var t=e.which;t===32&&(e.preventDefault(),this.space(e));if(!H&&!u.isPortraitForced())return;t===37?(e.preventDefault(),this.scrollLeft()):t===38?(e.preventDefault(),this.scrollUp()):t===39?(e.preventDefault(),this.scrollRight()):t===40&&(e.preventDefault(),this.scrollDown())},space:function(e){var t,n;if(u.isPortraitForced())H?n=this.zoomPlugin:n=this.pageScroll,n&&(e.shiftKey?t=n.y+300:t=n.y-300,t<n.maxScrollY?t=n.maxScrollY:t>0&&(t=0),n.scrollTo(n.x,t,0));else{if(!this.zoomEnabled)return;H?this.zoomOut():this.zoomIn()}},enableZoomHandler:function(){this.zoomEnabled=!0},disableZoomHandler:function(){this.zoomEnabled=!1},initZoomPlugin:function(){this.zoomPlugin=new a(this.$(A)[0],{scrollY:!0,scrollX:!0,mouseWheel:!0,useTransform:!0,useTransition:!0,zoom:!1,freeScroll:!0,bounce:!1,bounceTime:0,momentum:300})},scrollUp:function(){var e,t,n;H?n=this.zoomPlugin:n=this.pageScroll;if(!n)return;t=this.getApplicationHeight(),n&&n.y<0&&(e=n.y+t-t*.1,e>0&&(e=0),n.scrollTo(n.x,e,0))},scrollDown:function(){var e,t,n;H?n=this.zoomPlugin:n=this.pageScroll,t=this.getApplicationHeight(),n&&n.y>n.maxScrollY&&(e=n.y-(t-t*.1),e<n.maxScrollY&&(e=n.maxScrollY),n.scrollTo(n.x,e,0))},scrollLeft:function(){var t,n,r=this.zoomPlugin;if(!r)return;n=this.getApplicationWidth(),r&&r.x<0?(t=r.x+(n-n*.1),t>0&&(t=0),r.scrollTo(t,r.y,0)):r&&r.x>=0&&(this.resetZoom(),e.trigger("willChangePageByExternal",{direction:"prev"}),this.swiper.slidePrev(!0,this.swiper.params.speed))},scrollRight:function(){var t,n,r=this.zoomPlugin;if(!r)return;n=this.getApplicationWidth(),r&&r.x>r.maxScrollX?(t=r.x-(n-n*.1),t<r.maxScrollX&&(t=r.maxScrollX),r.scrollTo(t,r.y,0)):r&&r.x<=r.maxScrollX&&(this.resetZoom(),e.trigger("willChangePageByExternal",{direction:"next"}),this.swiper.slideNext(!0,this.swiper.params.speed))},destroyZoom:function(){H&&this.resetZoom(this.pdfViews[0].getMinScale()),this.zoomPlugin&&(this.zoomPlugin.destroy(),this.zoomPlugin=null)},zoomIn:function(){var t=this.pdfViews[this.swiper.activeIndex-1],n,r,i,s=function(t){this.zoomPlugin.refresh();if(u.isPortrait()&&t||!u.isPortrait()&&!t||this.pdfViews.length===this.swiper.activeIndex)_<m&&e.trigger("enableZoomInPDF"),e.trigger("enableZoomOutPDF")}.bind(this);return _===m?(e.trigger("disableZoomInPDF"),!1):(e.trigger("disableZoomPDF"),H=!0,this.swiper.disableKeyboardControl(),P===1?(this.setApplicationClass("zooming-pdf"),this.$el.addClass("pdf-zoom"),this.initZoomPlugin(),P=2,_=v):(P=3,_=m),t&&t.zoomIn({scale:_,complete:function(){s(!0)}}),u.isPortrait()||(t=this.pdfViews[this.swiper.activeIndex],t&&t.zoomIn({scale:_,complete:function(){s(!1)}})),n=m-v,r=m*this.zoomPlugin.x/n,i=m*this.zoomPlugin.y/n,this.zoomPlugin.scrollTo(r,i,0),!0)},zoomOut:function(){var t=this.pdfViews[this.swiper.activeIndex-1],n,r,i,s,o=function(t){this.zoomPlugin.refresh(),_<=d&&(this.zoomPlugin.scrollTo(0,0),this.zoomPlugin.refresh(),this.zoomPlugin.destroy());if(u.isPortrait()&&t||!u.isPortrait()&&!t||this.pdfViews.length===this.swiper.activeIndex)_>d&&e.trigger("enableZoomOutPDF"),e.trigger("enableZoomInPDF")}.bind(this);return _===d?(e.trigger("disableZoomOutPDF"),!1):(e.trigger("disableZoomPDF"),n=_,P===3?(P=2,_=v):(this.removeApplicationClass("zooming-pdf"),this.$el.removeClass("pdf-zoom"),this.zoomPlugin.refresh(),e.trigger("beforePdfResize"),H=!1,this.swiper.enableKeyboardControl(),P=1,_=d),t&&(t.zoomOut({scale:_,complete:function(){o(!0)}}),this.zoomPlugin.refresh()),u.isPortrait()||(t=this.pdfViews[this.swiper.activeIndex],t&&(t.zoomOut({scale:_,complete:function(){o(!1)}}),this.zoomPlugin.refresh())),_>d?(r=n/_,i=this.zoomPlugin.x/r,s=this.zoomPlugin.y/r):(i=0,s=0),this.zoomPlugin.scrollTo(i,s,0),_>d&&e.trigger("enableZoomOutPDF"),e.trigger("enableZoomInPDF"),!0)},removeRenderedClasses:function(){r("."+k).removeClass(k)},clearCanvases:function(){r("canvas").attr({width:1,height:1})},resetZoom:function(t){if(!H)return;_=t,P=1,H=!1,this.clearCanvases(),this.removeApplicationClass("zooming-pdf"),this.$el.removeClass("pdf-zoom"),this.zoomPlugin.refresh(),e.trigger("beforePdfResize"),this.zoomPlugin.scrollTo(0,0),this.zoomPlugin.refresh(),this.zoomPlugin.destroy(),this.swiper.enableKeyboardControl(),e.trigger("disableZoomOutPDF"),e.trigger("enableZoomInPDF")},pdfPrintFeatureDone:function(e){e.getActivePage=function(){return this.getActivePage()}.bind(this),e.pageCollection=this.pagesCollection}})}),"use strict",define("pdfComponent",["backbone","app","underscore","issueService","baseComponent","pdfsView"],function(e,t,n,r,i,s){var o=n.extend({},i);return o.features=[],o.name="pdf",o.routes={"pages/:issueId":function(e){o.open({issueId:e})},"pages/:issueId/:partId":function(e,t){o.open({issueId:e,partId:t})},"pages/:issueId/:partId/:pageIndex":function(e,t,n){o.open({issueId:e,partId:t,pageIndex:n})}},o.view=s,o.setRoute=function(e,t){var n="pages/"+e.id+"/",r;e.hasOwnProperty("activePartId")&&(n+=e.activePartId+"/"),e.hasOwnProperty("activePageIndex")&&(r=parseInt(e.activePageIndex,10),r=r>0?r:1,n+=r),o.router.setRoute({route:n,trigger:t})},o.open=function(n){var i=this;e.trigger("displayLoader",o.strings.componentView.loadingMessage),window.setTimeout(function(){n=n||{};if(n.issueId){var s=r.fetchIssueById(n.issueId);s.done(function(s){n.model=s,n.model.setRoute=o.setRoute,r.setCurrentIssueModel(s),t.renderComponentView(o,n,function(t){e.trigger("header:open",i.viewOptions.headerOptions||{}),e.trigger("footer:open",n),e.trigger("thumbnails:open"),e.trigger("info:open"),n.thisIsTheRealStitchReInit||e.trigger("stat:openIssue",{issueId:s.get("id"),issueDate:s.get("pubdate"),issueMode:"pages",issueRevision:s.get("revision"),issueDownloaded:s.get("downloaded")}),o.renderFeatures(),t.componentDone(),o.ready(n.componentReady)})}),s.fail(function(t){e.trigger("removeLoader")})}},100)},o.closeComponentView=function(){t.closeComponentView(o)},o.reInit=function(n){n.thisIsTheRealStitchReInit=!0,t.closeComponent(o),e.trigger("header:close"),e.trigger("thumbnails:close"),e.trigger("footer:close"),e.trigger("setRoute",{route:"pages/"+n.issueId+"/"+n.partId+"/"+n.pageIndex,trigger:!1}),o.open(n)},o.bindEvents=function(){e.on("pages:open",o.open,o),e.on("pages:reInit",o.reInit,o),e.on("pages:close",o.closeComponentView,o)},o.unBindEvents=function(){e.off("pages:open",o.open,o),e.off("pages:reInit",o.reInit,o),e.off("pages:close",o.closeComponentView,o)},o.bindEvents(),o}),"use strict",define("issueEntryIconModel",["backbone","baseFeatureModel","issueService"],function(e,t,n){return t.extend({initialize:function(){e.on("setRoute",function(e){this.setActive(e)},this)},setActive:function(e){e.route&&e.route==="entry"?this.set("active",!0):this.set("active",!1)},onTapped:function(){var t=n.getCurrentIssueId();return e.trigger("setRoute",{route:"entry/"+t,trigger:!0}),this}})}),"use strict",define("issueEntryIconView",["baseFeatureView","underscore","vendor/text!features/iconLinks/templates/iconLinkTemplate.html"],function(e,t,n){return e.extend({className:"issue-entry-icon icon-link",events:{tap:"tap"},initialize:function(e){this.init(e),this.coversIconHTML=t.template(n),this.bindEvents()},tap:function(){this.model.tapped.call(this.model)},bindEvents:function(){return this.unbindEvents(),this.model.on("change:active",this.render,this),this},unbindEvents:function(){return this.model.off("change:active",this.render,this),this},render:function(){var e=this.model.get("active");return this.$el.html(this.coversIconHTML({iconName:this.model.get("iconName"),iconText:this.strings.iconText})),this.$el.addClass(this.model.get("className")),e?this.$el.addClass("active"):this.$el.removeClass("active"),this}})}),"use strict",define("issueEntryIconFeature",["backbone","underscore","baseFeature","issueEntryIconModel","issueEntryIconView"],function(e,t,n,r,i){return function(){this.feature=t.extend({},n);var e=new r;this.feature.setView.call(this.feature,i).setModel.call(this.feature,e)}}),"use strict",define("zoomButtonsModel",["backbone","baseFeatureModel"],function(e,t){return t.extend({onTapped:function(){return this.set("active",!this.get("active",!0)),this}})}),define("vendor/text!components/pdf/features/zoomButtons/templates/button.html",[],function(){return'<div class="<%= modelClassname + \' \' + className %>" title="<%= tooltip %>">\n    <% if (iconName) { %>\n    <span class="icon-link-icon"><i class="<%= iconName %>"></i></span>\n    <% } %>\n    <% if (iconText) { %>\n    <span class="icon-link-text"><%= iconText %></span>\n    <% } %>\n</div>\n'}),"use strict",define("zoomButtonsView",["backbone","baseFeatureView","underscore","vendor/text!components/pdf/features/zoomButtons/templates/button.html"],function(e,t,n,r){var i=!1,s=!1;return t.extend({id:"pdf-zoom-buttons",events:{"tap .pdf-zoom-in":"zoomIn","tap .pdf-zoom-out":"zoomOut"},initialize:function(e){var t=this.model.get("icons").zoomIn,i=this.model.get("icons").zoomOut;this.init(e),this.model.get("vertical")===!0&&this.$el.addClass("vertical-zoom-buttons"),t.position=n.isNumber(t.position)?t.position:0,n.isNumber(i.position)&&i.position===0&&(t.position=1),i.position=n.isNumber(i.position)?i.position:1,t.position===i.position&&(t.position=0,i.position=1),this.zoomInTemplate=n.template(r)({modelClassname:this.model.get("className"),className:t.className,iconName:t.iconName,iconText:this.strings.iconText.zoomIn,tooltip:this.strings.tooltip?this.strings.tooltip.zoomIn:""}),this.zoomOutTemplate=n.template(r)({modelClassname:this.model.get("className"),className:i.className,iconName:i.iconName,iconText:this.strings.iconText.zoomOut,tooltip:this.strings.tooltip?this.strings.tooltip.zoomOut:""}),this.bindEvents()},bindEvents:function(){e.on("disableZoomInPDF",this.disableZoomInPDF,this),e.on("disableZoomOutPDF",this.disableZoomOutPDF,this),e.on("enableZoomInPDF",this.enableZoomInPDF,this),e.on("enableZoomOutPDF",this.enableZoomOutPDF,this),e.on("disableZoomPDF",this.disableZoomPDF,this)},unbindEvents:function(){e.off("disableZoomInPDF"),e.off("disableZoomOutPDF"),e.off("enableZoomInPDF"),e.off("enableZoomOutPDF"),e.off("disableZoomPDF")},zoomIn:function(){i&&e.trigger("zoomInPDF")},zoomOut:function(){s&&e.trigger("zoomOutPDF")},render:function(){return this.model.get("icons").zoomIn.position<=this.model.get("icons").zoomOut.position?this.$el.append(this.zoomInTemplate,this.zoomOutTemplate):this.$el.append(this.zoomOutTemplate,this.zoomInTemplate),this.disableZoomInPDF(),this.disableZoomOutPDF(),this},disableZoomPDF:function(){this.$el.addClass("disabled-pdf-zoom"),this.disableZoomInPDF(),this.disableZoomOutPDF()},disableZoomInPDF:function(){i=!1,this.$(".pdf-zoom-in").parent().addClass("disabled-pdf-zoom-button")},disableZoomOutPDF:function(){s=!1,this.$(".pdf-zoom-out").parent().addClass("disabled-pdf-zoom-button")},enableZoomInPDF:function(){i=!0,this.$el.removeClass("disabled-pdf-zoom"),this.$(".pdf-zoom-in").parent().removeClass("disabled-pdf-zoom-button")},enableZoomOutPDF:function(){s=!0,this.$el.removeClass("disabled-pdf-zoom"),this.$(".pdf-zoom-out").parent().removeClass("disabled-pdf-zoom-button")}})}),"use strict",define("zoomButtonsFeature",["underscore","baseFeature","zoomButtonsModel","zoomButtonsView"],function(e,t,n,r){return function(){this.feature=e.extend({},t),this.feature.setView.call(this.feature,r).setModel.call(this.feature,new n)}}),define("vendor/text!features/fullscreen/templates/fullscreenTemplate.html",[],function(){return'<% var currentIconName = enabled ? icons.disable : icons.enable %>\n<% var currentIconText = enabled ? strings.iconText.disable : strings.iconText.enable %>\n<span class="icon-link-icon"><i class="<%= currentIconName %>"></i></span>\n<% if (currentIconText) { %>\n<span class="icon-link-text"><%= currentIconText %></span>\n<% } %>\n'}),"use strict",define("fullscreenView",["baseFeatureView","backbone","underscore","vendor/text!features/fullscreen/templates/fullscreenTemplate.html"],function(e,t,n,r){var i=!0,s=!1;return e.extend({className:"fullscreen-icon",fullscreenContext:"#application",events:{tap:"tap"},initialize:function(e){return this.init(e),this.shouldRequestFullscreen=typeof this.model.get("requestFullscreen")=="undefined"?!0:this.model.get("requestFullscreen"),this.bindEvents(),this.model.set("enabled",s,{silent:!0}),this.generateTemplateModel(),this.fullscreenTemplate=n.template(r),this.handleFullscreenChangeEvent=this.handleFullscreenChangeEvent.bind(this),this},bindEvents:function(){return this.model.on("change:enabled",this.toggleState,this),t.on("closeOpenFullscreen",this.closeFullscreen,this),t.on("closeFullscreen",this.closeFullscreen,this),t.on("disableFullscreenMode",this.disableFullscreenMode,this),t.on("enableFullscreenMode",this.enableFullscreenMode,this),t.on("doOpenFullscreenStuff",this.doOpenFullscreenStuff,this),t.on("doCloseFullscreenStuff",this.doCloseFullscreenStuff,this),document.addEventListener("fullscreenchange",this.handleFullscreenChangeEvent),document.addEventListener("mozfullscreenchange",this.handleFullscreenChangeEvent),document.addEventListener("webkitfullscreenchange",this.handleFullscreenChangeEvent),document.addEventListener("MSFullscreenChange",this.handleFullscreenChangeEvent),this},unbindEvents:function(){return this.model.off("change:enabled",this.toggleState,this),t.off("closeOpenFullscreen"),t.off("closeFullscreen"),t.off("disableFullscreenMode"),t.off("enableFullscreenMode"),t.off("doOpenFullscreenStuff",this.doOpenFullscreenStuff,this),t.off("doCloseFullscreenStuff",this.doCloseFullscreenStuff,this),document.removeEventListener("fullscreenchange",this.handleFullscreenChangeEvent),document.removeEventListener("mozfullscreenchange",this.handleFullscreenChangeEvent),document.removeEventListener("webkitfullscreenchange",this.handleFullscreenChangeEvent),document.removeEventListener("MSFullscreenChange",this.handleFullscreenChangeEvent),this},render:function(){return this.$el.addClass(this.model.get("className")),this.$el.html(this.fullscreenTemplate(this.templateModel)),this.strings.tooltip&&this.$el.attr("title",s?this.strings.tooltip.disable:this.strings.tooltip.enable),this},disableFullscreenMode:function(){i=!1,this.$el.addClass("disabled")},enableFullscreenMode:function(){i=!0,this.$el.removeClass("disabled")},closeFullscreen:function(){if(!i)return;return this.shouldRequestFullscreen?(document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen?document.msExitFullscreen():t.trigger("doCloseFullscreenStuff"),this):(t.trigger("doCloseFullscreenStuff"),this)},openFullscreen:function(){var e;if(!i)return;return e=document.getElementById("application"),this.shouldRequestFullscreen?(e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen?e.msRequestFullscreen():t.trigger("doOpenFullscreenStuff"),this):(t.trigger("doOpenFullscreenStuff"),this)},doOpenFullscreenStuff:function(){this.setApplicationClass("fullscreen"),this.model.set("enabled",!0,{silent:!0}),t.trigger("orientationchange"),t.trigger("fullscreenChangedState"),s=!0,this.generateTemplateModel(),this.render()},doCloseFullscreenStuff:function(){t.trigger("zoomResetZoom"),this.removeApplicationClass("fullscreen"),this.model.set("enabled",!1,{silent:!0}),t.trigger("orientationchange"),t.trigger("fullscreenChangedState"),s=!1,this.generateTemplateModel(),this.render()},toggleState:function(e,t){if(!i)return;t?this.openFullscreen():this.closeFullscreen()},handleFullscreenChangeEvent:function(){var e=document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement;e?t.trigger("doOpenFullscreenStuff"):t.trigger("doCloseFullscreenStuff")},tap:function(){if(!i)return;return this.model.tapped.call(this.model),this}})}),"use strict",define("fullscreenModel",["baseFeatureModel"],function(e){return e.extend({tapped:function(){return this.toggleState(),this},toggleState:function(){return this.set("enabled",!this.get("enabled")),this}})}),"use strict",define("fullscreenFeature",["underscore","backbone","baseFeature","baseModel","fullscreenView","fullscreenModel"],function(e,t,n,r,i,s){return function(){this.feature=e.extend({},n);var t=new s;this.feature.setView.call(this.feature,i).setModel.call(this.feature,t)}}),"use strict",define("fullPortraitWidthModel",["backbone","baseFeatureModel","localService"],function(e,t,n){return t.extend({initialize:function(e){function t(e,r){this.off("change:fullWidthOnStart",t,this);var i=n.get("currentFullWidthState");i!==null&&(typeof i=="string"?r=i==="true":r=i),this.updateCurrentFullWidthState(r),this.set("currentFullWidthState",r),this.set("active",r)}this.on("change:fullWidthOnStart",t,this)},updateCurrentFullWidthState:function(e){n.put("currentFullWidthState",e),this.set("fullWidthOnStart",e,{silent:!0})},onTapped:function(){return this.set("active",!this.get("active",!0)),this.updateCurrentFullWidthState(this.get("active")),this}})}),"use strict",define("fullPortraitWidthView",["baseFeatureView","backbone","deviceUtility","vendor/text!features/iconLinks/templates/iconLinkTemplate.html"],function(e,t,n,r){return e.extend({className:"toggle-icon",events:{tap:"tap"},initialize:function(e){this.init(e),this.toggleHTML=_.template(r),this.bindEvents(),t.trigger("fullPortraitWidthOnStart",this.model.get("active"))},tap:function(){this.model.tapped.call(this.model)},bindEvents:function(){return this.unbindEvents(),t.on("orientationchange",this.orientationChange,this),this.model.on("change:active",this.onActiveChange,this),this},unbindEvents:function(){return t.off("orientationchange",this.orientationChange,this),this.model.off("change:active",this.onActiveChange,this),this},orientationChange:function(){n.isTruePortrait()?(this.$el.addClass("hidden"),this.model.get("active")&&(this.model.set("active",!1),t.trigger("fullPortraitWidth",!1))):this.$el.removeClass("hidden")},onActiveChange:function(){t.trigger("fullPortraitWidth",this.model.get("active")),this.render()},render:function(){var e=this.model.get("active"),t=this.model.get("icons"),r=this.strings&&this.strings.iconText?e?this.strings.iconText.inactivate||"":this.strings.iconText.activate||"":"";return this.$el.html(this.toggleHTML({iconName:e?t.close:t.open,iconText:r})),e?this.$el.addClass("active"):this.$el.removeClass("active"),n.isTruePortrait()&&this.$el.addClass("hidden"),this.$el.addClass(this.model.get("className")),this}})}),"use strict",define("fullPortraitWidthFeature",["underscore","baseFeature","fullPortraitWidthModel","fullPortraitWidthView"],function(e,t,n,r){return function(){this.feature=e.extend({},t),this.feature.setView.call(this.feature,r).setModel.call(this.feature,new n)}}),"use strict",define("toggleIconModel",["backbone","baseFeatureModel"],function(e,t){return t.extend({initialize:function(){this.set("active",!1),this.bindEvents()},bindEvents:function(){this.unbindEvents(),e.on("overlayElementOpen",this.tryOpen,this),e.on("overlayElementClose",this.tryClose,this)},unbindEvents:function(){e.off("overlayElementOpen",this.tryOpen,this),e.off("overlayElementClose",this.tryClose,this)},tryOpen:function(e){this.reactOnSubjectAction(e,!0)},tryClose:function(e){this.reactOnSubjectAction(e,!1)},reactOnSubjectAction:function(e,t){var n=this.get("subjects").indexOf(e);n!==-1&&this.set("active",t)},onTapped:function(){return this.get("subjects").forEach(function(t){e.trigger(t+":toggle")}),this},toggleActive:function(){this.set("active",!this.get("active"))}})}),"use strict",define("toggleIconView",["baseFeatureView","underscore","vendor/text!features/iconLinks/templates/iconLinkTemplate.html"],function(e,t,n){return e.extend({className:"toggle-icon",events:{tap:"tap"},initialize:function(e){this.init(e),this.toggleHTML=t.template(n),this.bindEvents()},tap:function(){this.model.tapped.call(this.model)},bindEvents:function(){return this.unbindEvents(),this.model.on("change:active",this.render,this),this},unbindEvents:function(){return this.model.off("change:active",this.render,this),this},render:function(){var e=this.model.get("active"),t=this.model.get("icons");return this.$el.html(this.toggleHTML({iconName:e?t.close:t.open,iconText:e?this.strings.iconText.inactivate:this.strings.iconText.activate})),e?this.$el.addClass("active"):this.$el.removeClass("active"),this.$el.addClass(this.model.get("className")),this}})}),"use strict",define("toggleIconFeature",["underscore","baseFeature","toggleIconModel","toggleIconView"],function(e,t,n,r){return function(){this.feature=e.extend({},t);var i=new n;this.feature.setView.call(this.feature,r).setModel.call(this.feature,i)}}),"use strict",define("toggleFooterIconModel",["backbone","baseFeatureModel"],function(e,t){return t.extend({initialize:function(){this.set("active",!1),this.bindEvents()},bindEvents:function(){this.unbindEvents(),e.on("overlayElementOpen",this.open,this),e.on("overlayElementClose",this.close,this)},unbindEvents:function(){e.off("overlayElementOpen",this.open,this),e.off("overlayElementClose",this.close,this)},open:function(e){this.reactOnSubjectAction(e,!0)},close:function(e){this.reactOnSubjectAction(e,!1)},reactOnSubjectAction:function(e,t){var n=this.get("subjects").indexOf(e);n!==-1&&this.set("active",t)},onTapped:function(){return this.get("subjects").forEach(function(t){e.trigger(t+":toggle")}),this}})}),"use strict",define("toggleFooterIconView",["baseFeatureView","hammer","vendor/text!features/iconLinks/templates/iconLinkTemplate.html"],function(e,t,n){return e.extend({className:"toggle-icon",events:{tap:"tap"},initialize:function(e){this.init(e),this.toggleHTML=_.template(n),this.bindEvents()},tap:function(){this.model.tapped.call(this.model)},bindEvents:function(){return this.unbindEvents(),this.model.on("change:active",this.render,this),this},unbindEvents:function(){return this.model.off("change:active",this.render,this),this},render:function(){var e=this.model.get("active"),t=this.model.get("icons"),n=this.strings&&this.strings.iconText?e?this.strings.iconText.inactivate||"":this.strings.iconText.activate||"":"";return this.$el.html(this.toggleHTML({iconName:e?t.close:t.open,iconText:n})),e?this.$el.addClass("active"):this.$el.removeClass("active"),this.$el.addClass(this.model.get("className")),this}})}),"use strict",define("toggleFooterIconFeature",["underscore","backbone","baseFeature","toggleFooterIconModel","toggleFooterIconView"],function(e,t,n,r,i){return function(){this.feature=e.extend({},n);var t=new r;this.feature.setView.call(this.feature,i).setModel.call(this.feature,t)}}),"use strict",define("readerIconModel",["baseFeatureModel"],function(e){return e.extend({})}),"use strict",define("readerIconView",["baseFeatureView","underscore","vendor/text!features/iconLinks/templates/iconLinkTemplate.html"],function(e,t,n){return e.extend({className:"reader-icon",events:{tap:"tap"},initialize:function(e){this.init(e),this.readerIconHTML=t.template(n)},tap:function(){this.model.tapped.call(this.model)},render:function(){return this.$el.html(this.readerIconHTML({iconName:this.model.get("iconName"),iconText:this.strings.iconText})),this.$el.addClass(this.model.get("className")),this}})}),"use strict",define("readerIconFeature",["underscore","backbone","issueService","baseFeature","readerIconModel","readerIconView"],function(e,t,n,r,i,s){var o=function(){var e=n.getCurrentIssueModel(),t=e.get("activePartId"),r=e.getArticleIdByActivePageIndex(),i="reader/"+e.get("id");return t&&(i+="/"+t,r&&(i+="/"+r)),i};return function(){this.feature=e.extend({},r);var n=new i;n.onTapped=function(){return t.trigger("popup:close"),t.trigger("setRoute",{route:o(),trigger:!0}),this},this.feature.setView.call(this.feature,s).setModel.call(this.feature,n)}}),"use strict",define("activeSlideUtility",["underscore","backbone"],function(e,t){var n=function(){this.initialize.apply(this,arguments)};return n.prototype.initialize=function(){this.slides=[],this.events=arguments[0].events,this.singleSlide=arguments[0].singleSlide,this.onlyOnChange=arguments[0].onlyOnChange,this.onActiveSlide=arguments[0].onActiveSlide,this.onInactiveSlide=arguments[0].onInactiveSlide,this.onRemoveSlide=arguments[0].onRemoveSlide},n.prototype.getSlides=function(){return this.slides},n.prototype.getSlide=function(e){return this.slides[e]},n.prototype.getFirstSlide=function(){return this.slides[0]},n.prototype.getLastSlide=function(){return this.slides[this.slides.length-1]},n.prototype.addSlide=function(e){this.slides.push({slide:e,active:!1})},n.prototype.setActiveSlides=function(n,r){var i;return this.setPreviousIndexes(n,r),e.each(e.range(n-this.getMinIndex(),n+this.getMaxIndex()),function(e){i=this.getSlide(e),i&&(this.onlyOnChange||!this.onlyOnChange&&!i.active)&&(this.events?(i.active=!0,t.trigger("activeSlideUtility:onActiveSlide",{slide:i.slide,current:e===n,index:e})):i&&this.hasOwnProperty("onActiveSlide")&&typeof this.onActiveSlide=="function"&&(i.active=!0,this.onActiveSlide(i.slide,e===n,e)))},this),this},n.prototype.setInactiveSlides=function(){var n;return e.each(this.previousIndexes,function(e){n=this.getSlide(e),n&&(this.onlyOnChange||!this.onlyOnChange&&n.active)&&(this.events?(n.active=!1,t.trigger("activeSlideUtility:onInactiveSlide",{slide:n.slide,index:e})):n&&this.hasOwnProperty("onInactiveSlide")&&typeof this.onInactiveSlide=="function"&&(n.active=!1,this.onInactiveSlide(n.slide,e)))},this),this},n.prototype.updateSlides=function(e,n,r,i,s){var o=this.onlyOnChange,u=this;s=s||{},this.onlyOnChange=!1,this.singleSlide=n,this.slides.forEach(function(n,r){n&&(u.events?t.trigger("activeSlideUtility:updateSlide",{slide:n.slide,index:r,values:s}):e&&e.call(u,n.slide,r,s))}),this.setActiveSlides(r,i),this.setInactiveSlides(),this.onlyOnChange=o},n.prototype.getIndexesArray=function(e){return this.singleSlide?[e-1,e,e+1]:[e-2,e-1,e,e+1,e+2,e+3]},n.prototype.getPreviousIndexesDifference=function(t){return e.difference(this.previousIndexes,this.getIndexesArray(t))},n.prototype.setPreviousIndexes=function(t,n){return this.previousIndexes=[],this.previousIndexes=e.difference(this.getIndexesArray(n),this.getIndexesArray(t)),this.previousIndexes},n.prototype.getMinIndex=function(){return this.singleSlide?1:2},n.prototype.getMaxIndex=function(){return this.singleSlide?2:4},n.prototype.getOffset=function(e,t){var n={};return t?["-webkit-","-moz-","-ms-","-o-",""].forEach(function(t){n[t+"transform"]="translate3d("+e+"px, 0, 0)"}):n.left=e+"px",n},n.prototype.kill=function(){this.slides&&(this.slides=[]);for(var e in this)this.hasOwnProperty(e)&&delete this[e]},n}),"use strict",define("pdfNativeView",["backbone","baseView","issueService","activeSlideUtility","deviceUtility","dataService","apiService"],function(e,t,n,r,i,s,o){return t.extend({className:"application-page",id:"pages-wrapper",initialize:function(e){this.init(e),this.bootstrapPagesData(e).bindEvents().addHooks(e)},bootstrapPagesData:function(t){var n=t.model.get("parts"),r=t.partId||n.at(0).get("id"),u=t.pageIndex||0,a=t.model.get("pubdate"),f="";return this.partCollection=n,this.part=n.get(r),this.pageCollection=this.part.get("pages"),this.model.set({pagesPageIndex:u,activePageIndex:u,pagesPartId:r,activePartId:r}),this.viewOptions.dateFormat&&this.viewOptions.dateFormat.issueTitle&&(f=this.viewHelpers.DateUtility.dateToStringFormat(a,this.viewOptions.dateFormat.issueTitle)),this.hello=function(){s.openNativePagesView({url:this.model.url+"?action=download&os="+i.getOs(),issueId:this.model.get("issueid"),partId:r,pageNumber:u,issuesUrl:t.issuesUrl,pubdate:a,revision:t.model.get("revision"),issueTitle:f,productId:o.getProductId()},function(){e.trigger("removeLoader")},function(){e.trigger("removeLoader"),e.trigger("setRoute",{route:"start",trigger:!0})})},t.viewOptions.waitForDisplayOnce||this.hello(),this},render:function(){return this.$el.html(),this},bindEvents:function(){var t=this;return this.unbindEvents(),e.on("userFinishedAuthentication",this.userFinishedAuthentication,this),this.viewOptions.waitForDisplayOnce&&e.on("removed:displayOnceFeature",function(){t.hello()}),this},unbindEvents:function(){return e.off("userFinishedAuthentication",this.userFinishedAuthentication,this),e.off("removed:displayOnceFeature"),this},userFinishedAuthentication:function(t){t===0&&this.model.get("downloaded")!==!0&&e.trigger("setRoute",{route:"logout",trigger:!0})},addHooks:function(t){this.addHook.call(this,"beforeRender",function(){this.setApplicationClass("fixed not-scrollable"),this.setApplicationClass(t.viewOptions.componentName)}),this.addHook.call(this,"afterRender",function(){var t;i.isAndroid()?t="android":i.isiOS()&&(t="iOS"),this.setApplicationClass(t),this.removeScrollTouchFix(),e.trigger("removeLoader")}),this.addHook.call(this,"beforeClose",function(){e.trigger("closeFullscreen"),i.resetOrientation(!0),this.removeApplicationClass("iOS android fixed not-scrollable disable-transform forced-portrait "+t.viewOptions.componentName)}),this.addHook.call(this,"afterClose",function(){for(var e in this)this.hasOwnProperty(e)&&delete this[e]})},componentDone:function(){},updatePageRoute:function(){this.model.setRoute(this.model.toJSON())}})}),"use strict",define("pdfNativeComponent",["backbone","app","underscore","issueService","baseComponent","pdfNativeView","apiService","deviceUtility"],function(e,t,n,r,i,s,o,u){function f(){e.on("updateCurrentIssueModel",function(e){var t=e.pageNumber,n=e.partId;r.getCurrentIssueModel().set({pagesPageIndex:t,activePageIndex:t,pagesPartId:n,activePartId:n})})}function l(){e.off("updateCurrentIssueModel")}var a=n.extend({},i);return a.features=[],a.name="pdfNative",a.routes={"pages/:issueId":function(e){a.open({issueId:e})},"pages/:issueId/:partId":function(e,t){a.open({issueId:e,partId:t})},"pages/:issueId/:partId/:pageIndex":function(e,t,n){a.open({issueId:e,partId:t,pageIndex:n})}},a.view=s,a.setRoute=function(e,t){var n=a.name+"/"+e.id+"/";e.hasOwnProperty("activePartId")&&(n+=e.activePartId+"/"),e.hasOwnProperty("activePageIndex")&&(n+=parseInt(e.activePageIndex,10)),a.router.setRoute({route:n,trigger:t})},a.open=function(n){e.trigger("displayLoader",a.strings.componentView.loadingMessage),n=n||{},n.componentReady=f,window.setTimeout(function(){var i=r.fetchIssueById(n.issueId),s=o.getIssuesURL()+"?env=app&results=20&pdf=true&epaperversion="+window.epaperClient.version+"&os="+u.getOs()+"&osversion="+u.getOsVersion();i.done(function(i){n.model=i,n.model.setRoute=a.setRoute,n.partId=n.partId||i.get("parts").at(0).get("id"),n.issuesUrl=s,r.setCurrentIssueModel(i),window.setTimeout(function(){t.renderComponentView(a,n,function(t){e.trigger("stat:openIssue",{issueId:i.get("id"),issueDate:i.get("pubdate"),issueMode:"pages",issueRevision:i.get("revision"),issueDownloaded:i.get("downloaded")}),a.renderFeatures(),t.componentDone(),a.ready(n.componentReady)})},0)}),i.fail(function(t){e.trigger("removeLoader")})},100)},a.beforeClose=function(){l()},a.closeComponent=function(){t.closeComponent(a)},e.on(a.name+":open",a.open,a),e.on(a.name+":beforeClose",a.beforeClose,a),e.on(a.name+":reInit",a.reInit,a),e.on(a.name+":close",a.closeComponent,a),a}),function(e,t,n,r){"use strict";function l(e,t,n){return setTimeout(y(e,n),t)}function c(e,t,n){return Array.isArray(e)?(h(e,n[t],n),!0):!1}function h(e,t,n){var i;if(!e)return;if(e.forEach)e.forEach(t,n);else if(e.length!==r){i=0;while(i<e.length)t.call(n,e[i],i,e),i++}else for(i in e)e.hasOwnProperty(i)&&t.call(n,e[i],i,e)}function p(t,n,r){var i="DEPRECATED METHOD: "+n+"\n"+r+" AT \n";return function(){var n=new Error("get-stack-trace"),r=n&&n.stack?n.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",s=e.console&&(e.console.warn||e.console.log);return s&&s.call(e.console,i,r),t.apply(this,arguments)}}function g(e,t,n){var r=t.prototype,i;i=e.prototype=Object.create(r),i.constructor=e,i._super=r,n&&d(i,n)}function y(e,t){return function(){return e.apply(t,arguments)}}function b(e,t){return typeof e==o?e.apply(t?t[0]||r:r,t):e}function w(e,t){return e===r?t:e}function E(e,t,n){h(N(t),function(t){e.addEventListener(t,n,!1)})}function S(e,t,n){h(N(t),function(t){e.removeEventListener(t,n,!1)})}function x(e,t){while(e){if(e==t)return!0;e=e.parentNode}return!1}function T(e,t){return e.indexOf(t)>-1}function N(e){return e.trim().split(/\s+/g)}function C(e,t,n){if(e.indexOf&&!n)return e.indexOf(t);var r=0;while(r<e.length){if(n&&e[r][n]==t||!n&&e[r]===t)return r;r++}return-1}function k(e){return Array.prototype.slice.call(e,0)}function L(e,t,n){var r=[],i=[],s=0;while(s<e.length){var o=t?e[s][t]:e[s];C(i,o)<0&&r.push(e[s]),i[s]=o,s++}return n&&(t?r=r.sort(function(n,r){return n[t]>r[t]}):r=r.sort()),r}function A(e,t){var n,s,o=t[0].toUpperCase()+t.slice(1),u=0;while(u<i.length){n=i[u],s=n?n+o:t;if(s in e)return s;u++}return r}function M(){return O++}function _(t){var n=t.ownerDocument||t;return n.defaultView||n.parentWindow||e}function nt(e,t){var n=this;this.manager=e,this.callback=t,this.element=e.element,this.target=e.options.inputTarget,this.domHandler=function(t){b(e.options.enable,[e])&&n.handler(t)},this.init()}function rt(e){var t,n=e.options.inputClass;return n?t=n:H?t=Tt:B?t=_t:P?t=Bt:t=bt,new t(e,it)}function it(e,t,n){var r=n.pointers.length,i=n.changedPointers.length,s=t&U&&r-i===0,o=t&(W|X)&&r-i===0;n.isFirst=!!s,n.isFinal=!!o,s&&(e.session={}),n.eventType=t,st(e,n),e.emit("hammer.input",n),e.recognize(n),e.session.prevInput=n}function st(e,t){var n=e.session,r=t.pointers,i=r.length;n.firstInput||(n.firstInput=at(t)),i>1&&!n.firstMultiple?n.firstMultiple=at(t):i===1&&(n.firstMultiple=!1);var s=n.firstInput,o=n.firstMultiple,u=o?o.center:s.center,l=t.center=ft(r);t.timeStamp=f(),t.deltaTime=t.timeStamp-s.timeStamp,t.angle=pt(u,l),t.distance=ht(u,l),ot(n,t),t.offsetDirection=ct(t.deltaX,t.deltaY);var c=lt(t.deltaTime,t.deltaX,t.deltaY);t.overallVelocityX=c.x,t.overallVelocityY=c.y,t.overallVelocity=a(c.x)>a(c.y)?c.x:c.y,t.scale=o?vt(o.pointers,r):1,t.rotation=o?dt(o.pointers,r):0,t.maxPointers=n.prevInput?t.pointers.length>n.prevInput.maxPointers?t.pointers.length:n.prevInput.maxPointers:t.pointers.length,ut(n,t);var h=e.element;x(t.srcEvent.target,h)&&(h=t.srcEvent.target),t.target=h}function ot(e,t){var n=t.center,r=e.offsetDelta||{},i=e.prevDelta||{},s=e.prevInput||{};if(t.eventType===U||s.eventType===W)i=e.prevDelta={x:s.deltaX||0,y:s.deltaY||0},r=e.offsetDelta={x:n.x,y:n.y};t.deltaX=i.x+(n.x-r.x),t.deltaY=i.y+(n.y-r.y)}function ut(e,t){var n=e.lastInterval||t,i=t.timeStamp-n.timeStamp,s,o,u,f;if(t.eventType!=X&&(i>R||n.velocity===r)){var l=t.deltaX-n.deltaX,c=t.deltaY-n.deltaY,h=lt(i,l,c);o=h.x,u=h.y,s=a(h.x)>a(h.y)?h.x:h.y,f=ct(l,c),e.lastInterval=t}else s=n.velocity,o=n.velocityX,u=n.velocityY,f=n.direction;t.velocity=s,t.velocityX=o,t.velocityY=u,t.direction=f}function at(e){var t=[],n=0;while(n<e.pointers.length)t[n]={clientX:u(e.pointers[n].clientX),clientY:u(e.pointers[n].clientY)},n++;return{timeStamp:f(),pointers:t,center:ft(t),deltaX:e.deltaX,deltaY:e.deltaY}}function ft(e){var t=e.length;if(t===1)return{x:u(e[0].clientX),y:u(e[0].clientY)};var n=0,r=0,i=0;while(i<t)n+=e[i].clientX,r+=e[i].clientY,i++;return{x:u(n/t),y:u(r/t)}}function lt(e,t,n){return{x:t/e||0,y:n/e||0}}function ct(e,t){return e===t?V:a(e)>=a(t)?e<0?$:J:t<0?K:Q}function ht(e,t,n){n||(n=et);var r=t[n[0]]-e[n[0]],i=t[n[1]]-e[n[1]];return Math.sqrt(r*r+i*i)}function pt(e,t,n){n||(n=et);var r=t[n[0]]-e[n[0]],i=t[n[1]]-e[n[1]];return Math.atan2(i,r)*180/Math.PI}function dt(e,t){return pt(t[1],t[0],tt)+pt(e[1],e[0],tt)}function vt(e,t){return ht(t[0],t[1],tt)/ht(e[0],e[1],tt)}function bt(){this.evEl=gt,this.evWin=yt,this.pressed=!1,nt.apply(this,arguments)}function Tt(){this.evEl=St,this.evWin=xt,nt.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}function Lt(){this.evTarget=Ct,this.evWin=kt,this.started=!1,nt.apply(this,arguments)}function At(e,t){var n=k(e.touches),r=k(e.changedTouches);return t&(W|X)&&(n=L(n.concat(r),"identifier",!0)),[n,r]}function _t(){this.evTarget=Mt,this.targetIds={},nt.apply(this,arguments)}function Dt(e,t){var n=k(e.touches),r=this.targetIds;if(t&(U|z)&&n.length===1)return r[n[0].identifier]=!0,[n,n];var i,s,o=k(e.changedTouches),u=[],a=this.target;s=n.filter(function(e){return x(e.target,a)});if(t===U){i=0;while(i<s.length)r[s[i].identifier]=!0,i++}i=0;while(i<o.length)r[o[i].identifier]&&u.push(o[i]),t&(W|X)&&delete r[o[i].identifier],i++;if(!u.length)return;return[L(s.concat(u),"identifier",!0),u]}function Bt(){nt.apply(this,arguments);var e=y(this.handler,this);this.touch=new _t(this.manager,e),this.mouse=new bt(this.manager,e),this.primaryTouch=null,this.lastTouches=[]}function jt(e,t){e&U?(this.primaryTouch=t.changedPointers[0].identifier,Ft.call(this,t)):e&(W|X)&&Ft.call(this,t)}function Ft(e){var t=e.changedPointers[0];if(t.identifier===this.primaryTouch){var n={x:t.clientX,y:t.clientY};this.lastTouches.push(n);var r=this.lastTouches,i=function(){var e=r.indexOf(n);e>-1&&r.splice(e,1)};setTimeout(i,Pt)}}function It(e){var t=e.srcEvent.clientX,n=e.srcEvent.clientY;for(var r=0;r<this.lastTouches.length;r++){var i=this.lastTouches[r],s=Math.abs(t-i.x),o=Math.abs(n-i.y);if(s<=Ht&&o<=Ht)return!0}return!1}function Kt(e,t){this.manager=e,this.set(t)}function Qt(e){if(T(e,Xt))return Xt;var t=T(e,Vt),n=T(e,$t);return t&&n?Xt:t||n?t?Vt:$t:T(e,Wt)?Wt:zt}function Gt(){if(!Rt)return!1;var t={},n=e.CSS&&e.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(r){t[r]=n?e.CSS.supports("touch-action",r):!0}),t}function on(e){this.options=d({},this.defaults,e||{}),this.id=M(),this.manager=null,this.options.enable=w(this.options.enable,!0),this.state=Yt,this.simultaneous={},this.requireFail=[]}function un(e){return e&rn?"cancel":e&tn?"end":e&en?"move":e&Zt?"start":""}function an(e){return e==Q?"down":e==K?"up":e==$?"left":e==J?"right":""}function fn(e,t){var n=t.manager;return n?n.get(e):e}function ln(){on.apply(this,arguments)}function cn(){ln.apply(this,arguments),this.pX=null,this.pY=null}function hn(){ln.apply(this,arguments)}function pn(){on.apply(this,arguments),this._timer=null,this._input=null}function dn(){ln.apply(this,arguments)}function vn(){ln.apply(this,arguments)}function mn(){on.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function gn(e,t){return t=t||{},t.recognizers=w(t.recognizers,gn.defaults.preset),new wn(e,t)}function wn(e,t){this.options=d({},gn.defaults,t||{}),this.options.inputTarget=this.options.inputTarget||e,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=rt(this),this.touchAction=new Kt(this,this.options.touchAction),En(this,!0),h(this.options.recognizers,function(e){var t=this.add(new e[0](e[1]));e[2]&&t.recognizeWith(e[2]),e[3]&&t.requireFailure(e[3])},this)}function En(e,t){var n=e.element;if(!n.style)return;var r;h(e.options.cssProps,function(i,s){r=A(n.style,s),t?(e.oldCssProps[r]=n.style[r],n.style[r]=i):n.style[r]=e.oldCssProps[r]||""}),t||(e.oldCssProps={})}function Sn(e,n){var r=t.createEvent("Event");r.initEvent(e,!0,!0),r.gesture=n,n.target.dispatchEvent(r)}var i=["","webkit","Moz","MS","ms","o"],s=t.createElement("div"),o="function",u=Math.round,a=Math.abs,f=Date.now,d;typeof Object.assign!="function"?d=function(t){if(t===r||t===null)throw new TypeError("Cannot convert undefined or null to object");var n=Object(t);for(var i=1;i<arguments.length;i++){var s=arguments[i];if(s!==r&&s!==null)for(var o in s)s.hasOwnProperty(o)&&(n[o]=s[o])}return n}:d=Object.assign;var v=p(function(t,n,i){var s=Object.keys(n),o=0;while(o<s.length){if(!i||i&&t[s[o]]===r)t[s[o]]=n[s[o]];o++}return t},"extend","Use `assign`."),m=p(function(t,n){return v(t,n,!0)},"merge","Use `assign`."),O=1,D=/mobile|tablet|ip(ad|hone|od)|android/i,P="ontouchstart"in e,H=A(e,"PointerEvent")!==r,B=P&&D.test(navigator.userAgent),j="touch",F="pen",I="mouse",q="kinect",R=25,U=1,z=2,W=4,X=8,V=1,$=2,J=4,K=8,Q=16,G=$|J,Y=K|Q,Z=G|Y,et=["x","y"],tt=["clientX","clientY"];nt.prototype={handler:function(){},init:function(){this.evEl&&E(this.element,this.evEl,this.domHandler),this.evTarget&&E(this.target,this.evTarget,this.domHandler),this.evWin&&E(_(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&S(this.element,this.evEl,this.domHandler),this.evTarget&&S(this.target,this.evTarget,this.domHandler),this.evWin&&S(_(this.element),this.evWin,this.domHandler)}};var mt={mousedown:U,mousemove:z,mouseup:W},gt="mousedown",yt="mousemove mouseup";g(bt,nt,{handler:function(t){var n=mt[t.type];n&U&&t.button===0&&(this.pressed=!0),n&z&&t.which!==1&&(n=W);if(!this.pressed)return;n&W&&(this.pressed=!1),this.callback(this.manager,n,{pointers:[t],changedPointers:[t],pointerType:I,srcEvent:t})}});var wt={pointerdown:U,pointermove:z,pointerup:W,pointercancel:X,pointerout:X},Et={2:j,3:F,4:I,5:q},St="pointerdown",xt="pointermove pointerup pointercancel";e.MSPointerEvent&&!e.PointerEvent&&(St="MSPointerDown",xt="MSPointerMove MSPointerUp MSPointerCancel"),g(Tt,nt,{handler:function(t){var n=this.store,r=!1,i=t.type.toLowerCase().replace("ms",""),s=wt[i],o=Et[t.pointerType]||t.pointerType,u=o==j,a=C(n,t.pointerId,"pointerId");s&U&&(t.button===0||u)?a<0&&(n.push(t),a=n.length-1):s&(W|X)&&(r=!0);if(a<0)return;n[a]=t,this.callback(this.manager,s,{pointers:n,changedPointers:[t],pointerType:o,srcEvent:t}),r&&n.splice(a,1)}});var Nt={touchstart:U,touchmove:z,touchend:W,touchcancel:X},Ct="touchstart",kt="touchstart touchmove touchend touchcancel";g(Lt,nt,{handler:function(t){var n=Nt[t.type];n===U&&(this.started=!0);if(!this.started)return;var r=At.call(this,t,n);n&(W|X)&&r[0].length-r[1].length===0&&(this.started=!1),this.callback(this.manager,n,{pointers:r[0],changedPointers:r[1],pointerType:j,srcEvent:t})}});var Ot={touchstart:U,touchmove:z,touchend:W,touchcancel:X},Mt="touchstart touchmove touchend touchcancel";g(_t,nt,{handler:function(t){var n=Ot[t.type],r=Dt.call(this,t,n);if(!r)return;this.callback(this.manager,n,{pointers:r[0],changedPointers:r[1],pointerType:j,srcEvent:t})}});var Pt=2500,Ht=25;g(Bt,nt,{handler:function(t,n,r){var i=r.pointerType==j,s=r.pointerType==I;if(s&&r.sourceCapabilities&&r.sourceCapabilities.firesTouchEvents)return;if(i)jt.call(this,n,r);else if(s&&It.call(this,r))return;this.callback(t,n,r)},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var qt=A(s.style,"touchAction"),Rt=qt!==r,Ut="compute",zt="auto",Wt="manipulation",Xt="none",Vt="pan-x",$t="pan-y",Jt=Gt();Kt.prototype={set:function(e){e==Ut&&(e=this.compute()),Rt&&this.manager.element.style&&Jt[e]&&(this.manager.element.style[qt]=e),this.actions=e.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var e=[];return h(this.manager.recognizers,function(t){b(t.options.enable,[t])&&(e=e.concat(t.getTouchAction()))}),Qt(e.join(" "))},preventDefaults:function(e){var t=e.srcEvent,n=e.offsetDirection;if(this.manager.session.prevented){t.preventDefault();return}var r=this.actions,i=T(r,Xt)&&!Jt[Xt],s=T(r,$t)&&!Jt[$t],o=T(r,Vt)&&!Jt[Vt];if(i){var u=e.pointers.length===1,a=e.distance<2,f=e.deltaTime<250;if(u&&a&&f)return}if(o&&s)return;if(i||s&&n&G||o&&n&Y)return this.preventSrc(t)},preventSrc:function(e){this.manager.session.prevented=!0,e.preventDefault()}};var Yt=1,Zt=2,en=4,tn=8,nn=tn,rn=16,sn=32;on.prototype={defaults:{},set:function(e){return d(this.options,e),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(e){if(c(e,"recognizeWith",this))return this;var t=this.simultaneous;return e=fn(e,this),t[e.id]||(t[e.id]=e,e.recognizeWith(this)),this},dropRecognizeWith:function(e){return c(e,"dropRecognizeWith",this)?this:(e=fn(e,this),delete this.simultaneous[e.id],this)},requireFailure:function(e){if(c(e,"requireFailure",this))return this;var t=this.requireFail;return e=fn(e,this),C(t,e)===-1&&(t.push(e),e.requireFailure(this)),this},dropRequireFailure:function(e){if(c(e,"dropRequireFailure",this))return this;e=fn(e,this);var t=C(this.requireFail,e);return t>-1&&this.requireFail.splice(t,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(e){return!!this.simultaneous[e.id]},emit:function(e){function r(n){t.manager.emit(n,e)}var t=this,n=this.state;n<tn&&r(t.options.event+un(n)),r(t.options.event),e.additionalEvent&&r(e.additionalEvent),n>=tn&&r(t.options.event+un(n))},tryEmit:function(e){if(this.canEmit())return this.emit(e);this.state=sn},canEmit:function(){var e=0;while(e<this.requireFail.length){if(!(this.requireFail[e].state&(sn|Yt)))return!1;e++}return!0},recognize:function(e){var t=d({},e);if(!b(this.options.enable,[this,t])){this.reset(),this.state=sn;return}this.state&(nn|rn|sn)&&(this.state=Yt),this.state=this.process(t),this.state&(Zt|en|tn|rn)&&this.tryEmit(t)},process:function(e){},getTouchAction:function(){},reset:function(){}},g(ln,on,{defaults:{pointers:1},attrTest:function(e){var t=this.options.pointers;return t===0||e.pointers.length===t},process:function(e){var t=this.state,n=e.eventType,r=t&(Zt|en),i=this.attrTest(e);if(r&&(n&X||!i))return t|rn;if(r||i)return n&W?t|tn:t&Zt?t|en:Zt;return sn}}),g(cn,ln,{defaults:{event:"pan",threshold:10,pointers:1,direction:Z},getTouchAction:function(){var e=this.options.direction,t=[];return e&G&&t.push($t),e&Y&&t.push(Vt),t},directionTest:function(e){var t=this.options,n=!0,r=e.distance,i=e.direction,s=e.deltaX,o=e.deltaY;return i&t.direction||(t.direction&G?(i=s===0?V:s<0?$:J,n=s!=this.pX,r=Math.abs(e.deltaX)):(i=o===0?V:o<0?K:Q,n=o!=this.pY,r=Math.abs(e.deltaY))),e.direction=i,n&&r>t.threshold&&i&t.direction},attrTest:function(e){return ln.prototype.attrTest.call(this,e)&&(this.state&Zt||!(this.state&Zt)&&this.directionTest(e))},emit:function(e){this.pX=e.deltaX,this.pY=e.deltaY;var t=an(e.direction);t&&(e.additionalEvent=this.options.event+t),this._super.emit.call(this,e)}}),g(hn,ln,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Xt]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||this.state&Zt)},emit:function(e){if(e.scale!==1){var t=e.scale<1?"in":"out";e.additionalEvent=this.options.event+t}this._super.emit.call(this,e)}}),g(pn,on,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[zt]},process:function(e){var t=this.options,n=e.pointers.length===t.pointers,r=e.distance<t.threshold,i=e.deltaTime>t.time;this._input=e;if(!r||!n||e.eventType&(W|X)&&!i)this.reset();else if(e.eventType&U)this.reset(),this._timer=l(function(){this.state=nn,this.tryEmit()},t.time,this);else if(e.eventType&W)return nn;return sn},reset:function(){clearTimeout(this._timer)},emit:function(e){if(this.state!==nn)return;e&&e.eventType&W?this.manager.emit(this.options.event+"up",e):(this._input.timeStamp=f(),this.manager.emit(this.options.event,this._input))}}),g(dn,ln,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Xt]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.rotation)>this.options.threshold||this.state&Zt)}}),g(vn,ln,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:G|Y,pointers:1},getTouchAction:function(){return cn.prototype.getTouchAction.call(this)},attrTest:function(e){var t=this.options.direction,n;return t&(G|Y)?n=e.overallVelocity:t&G?n=e.overallVelocityX:t&Y&&(n=e.overallVelocityY),this._super.attrTest.call(this,e)&&t&e.offsetDirection&&e.distance>this.options.threshold&&e.maxPointers==this.options.pointers&&a(n)>this.options.velocity&&e.eventType&W},emit:function(e){var t=an(e.offsetDirection);t&&this.manager.emit(this.options.event+t,e),this.manager.emit(this.options.event,e)}}),g(mn,on,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Wt]},process:function(e){var t=this.options,n=e.pointers.length===t.pointers,r=e.distance<t.threshold,i=e.deltaTime<t.time;this.reset();if(e.eventType&U&&this.count===0)return this.failTimeout();if(r&&i&&n){if(e.eventType!=W)return this.failTimeout();var s=this.pTime?e.timeStamp-this.pTime<t.interval:!0,o=!this.pCenter||ht(this.pCenter,e.center)<t.posThreshold;this.pTime=e.timeStamp,this.pCenter=e.center,!o||!s?this.count=1:this.count+=1,this._input=e;var u=this.count%t.taps;if(u===0)return this.hasRequireFailures()?(this._timer=l(function(){this.state=nn,this.tryEmit()},t.interval,this),Zt):nn}return sn},failTimeout:function(){return this._timer=l(function(){this.state=sn},this.options.interval,this),sn},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==nn&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),gn.VERSION="2.0.8",gn.defaults={domEvents:!1,touchAction:Ut,enable:!0,inputTarget:null,inputClass:null,preset:[[dn,{enable:!1}],[hn,{enable:!1},["rotate"]],[vn,{direction:G}],[cn,{direction:G},["swipe"]],[mn],[mn,{event:"doubletap",taps:2},["tap"]],[pn]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var yn=1,bn=2;wn.prototype={set:function(e){return d(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this},stop:function(e){this.session.stopped=e?bn:yn},recognize:function(e){var t=this.session;if(t.stopped)return;this.touchAction.preventDefaults(e);var n,r=this.recognizers,i=t.curRecognizer;if(!i||i&&i.state&nn)i=t.curRecognizer=null;var s=0;while(s<r.length)n=r[s],t.stopped!==bn&&(!i||n==i||n.canRecognizeWith(i))?n.recognize(e):n.reset(),!i&&n.state&(Zt|en|tn)&&(i=t.curRecognizer=n),s++},get:function(e){if(e instanceof on)return e;var t=this.recognizers;for(var n=0;n<t.length;n++)if(t[n].options.event==e)return t[n];return null},add:function(e){if(c(e,"add",this))return this;var t=this.get(e.options.event);return t&&this.remove(t),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e},remove:function(e){if(c(e,"remove",this))return this;e=this.get(e);if(e){var t=this.recognizers,n=C(t,e);n!==-1&&(t.splice(n,1),this.touchAction.update())}return this},on:function(e,t){if(e===r)return;if(t===r)return;var n=this.handlers;return h(N(e),function(e){n[e]=n[e]||[],n[e].push(t)}),this},off:function(e,t){if(e===r)return;var n=this.handlers;return h(N(e),function(e){t?n[e]&&n[e].splice(C(n[e],t),1):delete n[e]}),this},emit:function(e,t){this.options.domEvents&&Sn(e,t);var n=this.handlers[e]&&this.handlers[e].slice();if(!n||!n.length)return;t.type=e,t.preventDefault=function(){t.srcEvent.preventDefault()};var r=0;while(r<n.length)n[r](t),r++},destroy:function(){this.element&&En(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},d(gn,{INPUT_START:U,INPUT_MOVE:z,INPUT_END:W,INPUT_CANCEL:X,STATE_POSSIBLE:Yt,STATE_BEGAN:Zt,STATE_CHANGED:en,STATE_ENDED:tn,STATE_RECOGNIZED:nn,STATE_CANCELLED:rn,STATE_FAILED:sn,DIRECTION_NONE:V,DIRECTION_LEFT:$,DIRECTION_RIGHT:J,DIRECTION_UP:K,DIRECTION_DOWN:Q,DIRECTION_HORIZONTAL:G,DIRECTION_VERTICAL:Y,DIRECTION_ALL:Z,Manager:wn,Input:nt,TouchAction:Kt,TouchInput:_t,MouseInput:bt,PointerEventInput:Tt,TouchMouseInput:Bt,SingleTouchInput:Lt,Recognizer:on,AttrRecognizer:ln,Tap:mn,Pan:cn,Swipe:vn,Pinch:hn,Rotate:dn,Press:pn,on:E,off:S,each:h,merge:m,extend:v,assign:d,inherit:g,bindFn:y,prefixed:A}),typeof define=="function"&&define.amd?define("vendor/hammer/hammer.2.0.8",[],function(){return gn}):typeof module!="undefined"&&module.exports?module.exports=gn:e[n]=gn}(window,document,"Hammer"),define("articleEventView",["baseView","vendor/hammer/hammer.2.0.8"],function(e,t){var n=function(e){return(e*100<0?0:e*100)+"%"};return e.extend({className:"article-event-layer",onTapped:function(e){},initialize:function(e){this.bootstrapArticleEventData(e).bindEvents()},bootstrapArticleEventData:function(e){var t=e.properties.position;return this.triggerEvent=e.triggerEvent,this.linkType=e.properties.type,this.linkProperty=e.properties.property,this.setWidth(n(t.width)),this.setHeight(n(t.height)),this.setXposition(n(t.left)),this.setYposition(n(t.top)),this},bindEvents:function(){this.unbindEvents();var e=this,n=new t(this.el);return n.on(this.triggerEvent,function(t){return e.onTapped({type:e.linkType,property:e.linkProperty}),!1},this),this},unbindEvents:function(){return t.off(this.el,this.triggerEvent),this},render:function(){var e=this.linkProperty;return e&&e.articleId&&this.$el.attr("data-articleid",e.articleId),this.$el.attr("data-link-type",this.linkType),this},setWidth:function(e){this.el.style.width=e},setHeight:function(e){this.el.style.height=e},setXposition:function(e){this.el.style.left=e},setYposition:function(e){this.el.style.top=e}})}),define("vendor/text!components/pages/templates/pageView.html",[],function(){return'<div class="layer"></div>'}),define("vendor/text!components/pages/templates/tile.html",[],function(){return'<img src="<%= src %>" draggable="false" />'}),"use strict",define("pageView",["backbone","underscore","jquery","hammer","issueService","baseView","articleEventView","vendor/text!components/pages/templates/pageView.html","vendor/text!components/pages/templates/tile.html"],function(e,t,n,r,i,s,o,u,a){return s.extend({supportZoom:!0,initialize:function(e){this.pageTemplate=t.template(u),this.tileTemplate=t.template(a),this.currentZoomLevel=0,this.bootstrapPageData(e).bindEvents().addHooks(),this.extension=i.getIssueExtension()},bootstrapPageData:function(e){return this.filesBasePath=e.filesBasePath,this.articleTriggerEvent=e.articleTriggerEvent,this.partId=e.partId,this.viewOptions=e.viewOptions||{},this.sizeProperties={width:0,height:0},this.parent=e.parent,this.removeActiveTiles(),this},addHooks:function(){this.addHook.call(this,"afterRender",function(){this.renderArticleEventLayers(),this.bindOnTriggerEvent()}),this.addHook.call(this,"beforeClose",function(){this.activeTiles={},delete this.pageTemplate,delete this.tileTemplate})},bindEvents:function(){return this.unbindEvents(),this.parent.on("updatePageSize",this.updateSize,this),this},unbindEvents:function(){return this.parent.off("updatePageSize",this.updateSize,this),r(this.$el).off(this.articleTriggerEvent),this},render:function(){return this.$el.html(this.pageTemplate()),this.$(".layer").css("background-image","url('"+this.buildTileURL(0,0)+"')"),this},openArticle:function(){},setTileAsActive:function(e){e.active=!0,this.activeTiles.hasOwnProperty(e.id)||(this.activeTiles[e.id]=e)},getTileViewFromActiveTilesById:function(e){return this.activeTiles.hasOwnProperty(e)?this.activeTiles[e]:!1},removeActiveTiles:function(){for(var e in this.activeTiles)this.activeTiles.hasOwnProperty(e)&&this.activeTiles[e].element&&(this.activeTiles[e].element.empty(),this.activeTiles[e].element=!1,delete this.activeTiles[e]);return this.activeTiles={},this},resetActiveTiles:function(){for(var e in this.activeTiles)this.activeTiles.hasOwnProperty(e)&&(this.activeTiles[e].active=!1)},removeInactiveTiles:function(){var e;for(var t in this.activeTiles)this.activeTiles.hasOwnProperty(t)&&(e=this.activeTiles[t],e.active||(e.element&&e.element.empty(),delete this.activeTiles[t]))},buildTileURL:function(e,t){return this.filesBasePath+this.model.get("fileBasePath")+"_large_tile"+(e+1)+"_"+t+"."+this.extension},hideTileGrid:function(e,t){this.$(".tile:not(."+t+"-"+e+")").addClass("hidden-tile").removeClass("not-hidden-tile").empty(),this.$(".layer").addClass("invisible")},showTileGrid:function(e,t){this.$(".layer").removeClass("invisible"),this.$("."+t+"-"+e).removeClass("hidden-tile").addClass("not-hidden-tile")},getLayerWidth:function(){return this.$(".layer").width()},getMatchingTileElement:function(e,t,n){return this.$("#tile-"+e.index+"-level-"+n+"-template-"+t)},appendTilesGrid:function(e){this.$(".layer").html(e)},hasGrid:function(){return this.$(".layer .tile").length>0},removeTileGrid:function(){this.$(".layer").empty()},appendTileToGrid:function(e,t,n){var r=this.activeTiles[e.id];if(!r){var i=this.getMatchingTileElement(e,t,n);i&&(i.html(this.tileTemplate({src:this.buildTileURL(n,e.index)})),e.element=i)}this.setTileAsActive(e)},setOffset:function(e,t){t?this.$el.css("-webkit-transform","translate3d("+e+"px, 0, 0)"):this.$el.css("left",e)},updateSize:function(e){if(this.sizeProperties.width!==e.width||this.sizeProperties.height!==e.height)this.sizeProperties=e,this.$el.css({"background-size":e.backgroundSize}),this.setArticleEventWrapperWidth(e.layerWidth,e.layerMargin)},shouldRenderAreas:function(){return t.isUndefined(this.viewOptions.renderAreas)?!0:this.viewOptions.renderAreas},renderArticleEventLayers:function(){var t=this,r,i,s=this.model.get("areas"),u=this.viewOptions.areaBlacklist||[];if(!s)return;if(!this.shouldRenderAreas())return;i=n("<div>"),i.attr("class","article-event-wrapper"),i.height("100%");for(var a=s.length-1;a>=0;--a){if(u.includes(s[a].type))continue;r=new o({triggerEvent:this.articleTriggerEvent,properties:s[a]}),r.onTapped=function(n){switch(n.type){case"article":e.trigger("stat:articleEventLayerTapped",{articleId:n.property.articleId}),t.openArticle(n.property.articleId);break;case"externalLink":e.trigger("openExternalURL",{requestedURL:n.property.url,requestedTarget:"new"})}},this.addView.call(this,r),i.append(r.render().el)}this.$el.append(i)},setArticleEventWrapperWidth:function(e,t){this.$(".article-event-wrapper").css({width:e,"margin-left":t,"margin-right":t})},bindOnTriggerEvent:function(){var e=this,t=this.viewOptions.bindOnTriggerEvent,n=t?t.indexOf("all")!==-1:!1,i=t?t.indexOf(this.model.get("pagina"))!==-1:!1;(t&&n||i)&&r(this.$el).on(this.articleTriggerEvent,function(){e.openArticle()},this)}})}),define("vendor/text!components/pages/templates/pagesView.html",[],function(){return'<div id="outer-pages-wrapper"></div>\n'}),"use strict",define("pagesView",["backbone","swiper","underscore","baseView","jquery","issueService","localService","deviceUtility","pageCollection","pageView","pagesPartWrapperView","vendor/text!components/pages/templates/pagesView.html"],function(e,t,n,r,i,s,o,u,a,f,l,c){var h,p,d,v,m=0,g=300;return r.extend({className:"application-page",id:"pages-wrapper",events:{tap:"tap"},initialize:function(e){this.init(e),this.tapTimeoutId=null,this.isTapped=!1,this.pagesTemplate=n.template(c),this.hardwareAcceleratePage=u.isBadAndroid()?!0:!0,this.speed=300,this.openOverlayElements=[],this.closedOverlayElements=[],this.hasVisibleOverlays=!1,this.slides=[],this.bootstrapPagesData(e).bindEvents().addHooks(e),this.tileSizes=[{height:1447,width:1024},{height:636,width:450}],this.extension="."+this.model.get("extension"),this.transitionToFirstPageInPortraitSpeed=500,typeof e.viewOptions.transitionToFirstPageInPortraitSpeed!="undefined"&&(this.transitionToFirstPageInPortraitSpeed=e.viewOptions.transitionToFirstPageInPortraitSpeed)},tap:function(e){var t=this;i(".article-search-text-box").blur(),this.isTapped?(window.clearTimeout(this.tapTimeoutId),this.isTapped=!1,this.doubleTap(e)):(this.isTapped=!0,this.tapTimeoutId=window.setTimeout(function(){t.isTapped=!1,t.viewOptions.toggleOnTap&&t.toggleOverlays(e),t.viewOptions.hideOnTap&&t.hideOverlays(e)},200))},doubleTap:function(e){this.viewOptions.toggleOnDoubleTap&&this.toggleOverlays(e)},toggleOverlays:function(e){e.preventDefault(),e.stopPropagation(),e.gesture.preventDefault(),e.gesture.stopPropagation(),this.hasVisibleOverlays?this.hideOverlays(e):this.showOverlays(e)},hideOverlays:function(t){t.preventDefault(),t.stopPropagation(),t.gesture.preventDefault(),t.gesture.stopPropagation(),this.hasVisibleOverlays=!1,this.openOverlayElements.forEach(function(t){e.trigger(t+":closePart")}),this.openOverlayElements=[]},showOverlays:function(t){t.preventDefault(),t.stopPropagation(),t.gesture.preventDefault(),t.gesture.stopPropagation(),this.hasVisibleOverlays=!0,this.closedOverlayElements.forEach(function(t){e.trigger(t+":openPart")}),this.closedOverlayElements=[]},bootstrapPagesData:function(e){var t=e.model.get("parts"),n=e.partId||t.at(0).get("id"),r=e.pageIndex||0;return this.partCollection=t,this.part=t.get(n),this.pageCollection=this.part.get("pages"),this.model.set({pagesPageIndex:r,activePageIndex:r,pagesPartId:n,activePartId:n}),this},render:function(){return this.$el.html(i("<div>").attr("id","inner-pages-wrapper").html(this.buildPagesHtml(this.pageCollection,this.partCollection))),this},bindEvents:function(){return this.unbindEvents(),e.on("pagesSlideChangeEnd",this.onSlideChangeEnd,this),e.on("orientationchange",this.orientationChange,this),e.on("resizeInstant",this.orientationChange,this),e.on("done:pagesZoomFeature",this.pagesZoomFeatureDone,this),e.on("done:logoFeature",this.logoFeatureDone,this),e.on("done:dateFeature",this.dateFeatureDone,this),e.on("done:prevNextNavigationFeature",this.prevNextNavigationFeatureDone,this),e.on("pagesSwipeTo",this.swipeTo,this),e.on("navigate",this.navigate,this),e.on("overlayElementOpen",this.overlayElementOpen,this),e.on("overlayElementClose",this.overlayElementClose,this),e.on("overlayElementCloseAll",this.hideOverlays,this),e.on("userFinishedAuthentication",this.userFinishedAuthentication,this),e.on("notifyOnZoomStart",this.notifyOnZoomStart,this),e.on("notifyOnZoomEnd",this.notifyOnZoomEnd,this),e.on("fullscreen",this.onFullscreen,this),e.on("done:fullscreenFeature",this.fullscreenFeatureDone,this),e.on("done:pdfPrintFeature",this.pdfPrintFeatureDone,this),i(document).keydown(i.proxy(this.pressedKey,this)),this},unbindEvents:function(){return e.off("pagesSlideChangeEnd",this.onSlideChangeEnd,this),e.off("orientationchange",this.orientationChange,this),e.off("resizeInstant",this.orientationChange,this),e.off("done:pagesZoomFeature",this.pagesZoomFeatureDone,this),e.off("done:logoFeature",this.logoFeatureDone,this),e.off("done:dateFeature",this.dateFeatureDone,this),e.off("done:prevNextNavigationFeature",this.prevNextNavigationFeatureDone,this),e.off("pagesSwipeTo",this.swipeTo,this),e.off("navigate",this.navigate,this),e.off("overlayElementOpen",this.overlayElementOpen,this),e.off("overlayElementClose",this.overlayElementClose,this),e.off("overlayElementCloseAll",this.hideOverlays,this),e.off("userFinishedAuthentication",this.userFinishedAuthentication,this),e.off("notifyOnZoomStart"),e.off("notifyOnZoomEnd"),e.off("fullscreen"),e.off("done:fullscreenFeature",this.fullscreenFeatureDone,this),e.off("done:pdfPrintFeature",this.pdfPrintFeatureDone,this),i(document).unbind("keydown",this.pressedKey),this},notifyOnZoomStart:function(){var t=i(".layer").width(),n=this.getApplicationHeight(),r=u.isPortrait()?t:t*2;e.trigger("disablePageNavigation"),this.$el.css({width:r,height:n}),this.$(".pages-wrapper").css({width:r,height:n}),this.$(".swiper-slide-active").width(t),u.isPortrait()||this.$(".swiper-slide-next").width(t),this.$el.addClass("zoom"),this.setApplicationClass("zoom-is-active"),this.destroySwiper()},notifyOnZoomEnd:function(){this.$el.removeClass("zoom"),this.$(".pages-wrapper").css({width:"100%",height:"100%"}),this.removeApplicationClass("zoom-is-active"),this.initializeSwiper(),e.trigger("enablePageNavigation"),this.orientationChange()},pagesZoomFeatureDone:function(){e.trigger("zoomSetup",{extension:this.extension,pathSize:!1,filesBasePath:this.model.get("files_basepath"),slides:this.slides,activeIndex:this.model.get("activePageIndex")})},fullscreenFeatureDone:function(){},onFullscreen:function(){var e=this;this.orientationChange(),u.isBadAndroid()&&(d=window.setTimeout(function(){e.orientationChange()},500),this.$el.css("position","relative"),v=window.setTimeout(function(){e.$el.css("position","absolute")},1e3))},dateFeatureDone:function(){e.trigger("setDate",this.model.get("pubdate"))},prevNextNavigationFeatureDone:function(){},navigate:function(e){this.swipeToByDirection(e.direction)},overlayElementOpen:function(e){this.openOverlayElements.indexOf(e)<0&&this.openOverlayElements.push(e),this.hasVisibleOverlays=!0},overlayElementClose:function(e){this.closedOverlayElements.indexOf(e)<0&&this.closedOverlayElements.push(e)},pressedKey:function(e){switch(e.which){case 37:this.pressedLeftKey(e);break;case 38:this.pressedUpKey(e);break;case 39:this.pressedRightKey(e);break;case 40:this.pressedBottomKey(e);break;case 32:this.pressedSpaceKey(e);break;default:return}return e.preventDefault(),!0},pressedLeftKey:function(){var t=this;e.trigger("isZooming",{callback:function(n){n?e.trigger("zoomScrollLeft"):t.navigate({direction:"left"})}})},pressedRightKey:function(){var t=this;e.trigger("isZooming",{callback:function(n){n?e.trigger("zoomScrollRight"):t.navigate({direction:"right"})}})},pressedUpKey:function(){e.trigger("zoomScrollUp")},pressedBottomKey:function(){e.trigger("zoomScrollDown")},pressedSpaceKey:function(t){u.isPortraitForced()?t.originalEvent.shiftKey?e.trigger("zoomJumpUp"):e.trigger("zoomJumpDown"):e.trigger("toggleZoom")},userFinishedAuthentication:function(t){t===0&&this.model.get("downloaded")!==!0&&e.trigger("setRoute",{route:"logout",trigger:!0})},addHooks:function(t){this.addHook.call(this,"beforeRender",function(){var e=this.model.get("parts").length<2?" has-no-parts":" has-parts";this.setApplicationClass("fixed not-scrollable"),this.setApplicationClass(t.viewOptions.componentName+e)}),this.addHook.call(this,"afterRender",function(){var t;u.isAndroid()?t="android":u.isiOS()&&(t="iOS"),this.setApplicationClass(t),this.removeScrollTouchFix(),e.trigger("removeLoader")}),this.addHook.call(this,"beforeClose",function(){window.clearTimeout(this.tapTimeoutId),window.clearTimeout(h),window.clearTimeout(p),window.clearTimeout(d),window.clearTimeout(v),m=0,this.openOverlayElements=[],this.closedOverlayElements=[],this.slides=[],u.resetOrientation(!0),this.removeApplicationClass("iOS android fixed not-scrollable disable-transform forced-portrait "+t.viewOptions.componentName+" has-no-parts has-parts");if(this.swiper){this.swiper.destroy();for(var e in this.swiper)this.swiper.hasOwnProperty(e)&&delete this.swiper[e];this.swiper=null}delete this.pagesTemplate}),this.addHook.call(this,"afterClose",function(){for(var e in this)this.hasOwnProperty(e)&&delete this[e]})},componentDone:function(){var e=this;this.initializeSwiper(),this.updatePagesSizes().updateCurrentPage();if(this.pageCollection.length===0)return;u.isBadAndroid()&&(h=window.setTimeout(function(){e.badAndroidFix(),u.isEvenMoreBadAndroid()&&(p=window.setTimeout(function(){e.orientationChange()},100))},2e3))},badAndroidFix:function(){e.trigger("zoomBadAndroidFix")},logoFeatureDone:function(){},addWrapperPage:function(e,t,n){function u(){s=new l({partCollection:t,filesBasePath:i.model.get("files_basepath"),issueId:i.model.get("id"),id:e==="first"?"firstPageIndex":e==="last"?"lastPageIndex":"",className:o}),s.on("setActivePartId",function(e){i.model.set("activePartId",e)},i)}var i=this,s,o="pages-part-wrapper page-slide swiper-slide left-page empty-page";e==="first"&&this.viewOptions.showPartsFirst?u():e==="last"&&this.viewOptions.showPartsLast?u():s=new r({className:o,id:e==="first"?"firstPageIndex":e==="last"?"lastPageIndex":""}),this.slides.push(s),this.addView.call(this,s,n)},buildPagesHtml:function(t,n){var r=i("<div>").attr("class","pages-swiper-container swiper-container swiper-parent"),s=i("<div>").attr("class","pages-wrapper swiper-wrapper"),o=this,u,a;return this.addWrapperPage("first",n,s),t.each(function(t,n){u=n%2!==0?"page-slide swiper-slide left-page":"page-slide swiper-slide right-page",a=new f({parent:this,filesBasePath:this.model.get("files_basepath"),className:u,articleTriggerEvent:this.viewOptions.pageView.articleTriggerEvent,model:t,partId:this.part.get("id"),viewOptions:this.viewOptions.pageViewOptions}),this.slides.push(a),a.openArticle=function(t){i(".article-search-text-box").blur(),o.openOverlayElements.length>0&&o.viewOptions.hideOnTap?(o.openOverlayElements.forEach(function(t){e.trigger(t+":closePart")}),o.openOverlayElements=[]):e.trigger("reader:open",{issueId:o.model.get("id"),partId:o.part.get("id"),articleId:t})},this.addView.call(this,a,s)},this),this.addWrapperPage("last",n,s),t.length>0&&(this.tileSizes=t.at(0).get("tileSizes")),r.html(s),r},orientationChange:function(){e.trigger("zoomResetZoom"),this.initializeSwiper(),this.updatePagesOrientation(),this.updatePagesSizes(),this.swiper.update(!0);var t=o.get("currentFullWidthState");return t!==null&&typeof t=="string"&&(t=t==="true"),this.togglePagesClassname(this.swiper.activeIndex),!u.isPortrait()&&!t&&this.getActiveSlideIndex()%2!==0?this.swipeTo({index:this.getActiveSlideIndex()-1,speed:1,runCallbacks:!0}):this.getActiveSlideIndex()==0&&u.isPortrait()&&this.swipeTo({index:1,speed:1,runCallbacks:!0}),this},updatePagesOrientation:function(){var e;return this.swiper&&(e=this.getSlidesPerView(),this.swiper.params.slidesPerView=e,this.swiper.params.slidesPerGroup=e),this},swipeLeftFix:function(){var t=this.swiper?this.swiper.activeIndex:0,n=parseInt(this.model.get("activePageIndex"),10),r;return n>0&&(t=n),!this.numberIsEven(t)&&!u.isPortrait()&&(r=!0),!u.isPortraitForced()&&r&&this.swiper&&(this.swiper.swipePrev(),e.trigger("zoomUpdateZoomActiveIndex",t-1)),r},updatePagesSizes:function(){var e=u.isPortrait(),t=this.getApplicationWidth(),n=this.getApplicationHeight(),r,s,o,a,f,l=this.getPageDimensions(),c=e?1:2,h=t/c,p,d,v,m;l.basedOnWidth?(p="honour-width",d="honour-height"):(p="honour-height",d="honour-width"),v=Math.floor(l.height/4)*4,m=Math.floor(l.width/4)*4,r=(n-v)/2;if(r<0||this.applicationHasClass("zoom-is-active"))r=0;return this.$el.height(l.height).width(t),i(".page-slide").css({height:l.height,width:h}).find(".layer").css({"background-size":m+"px "+v+"px"}),i(".layer, .article-event-wrapper").css({width:m+"px",height:v+"px","margin-left":l.margin,"margin-right":l.margin}).addClass(p).removeClass(d),s=i(this.$(".page-slide").get(1)),o=s.find(".layer"),f=s.find(".article-event-wrapper"),a=-parseInt(o.width()/2,10)+"!important",u.isPortrait()?(o.css("margin-left",l.margin),f.css("margin-left",l.margin)):(o.css("margin-left",a),f.css("margin-left",a)),this},getActivePage:function(){var e=this.getActiveSlideIndex(),t=this.slides.length,n=u.isPortrait(),r=null,i=null,s="";return n?e!==0&&e+1!==t&&(r=e,s=r):e===0?(i=1,s+=i):e+2===t?(r=e,s+=r):(r=e,i=e+1,s=r+"-"+i),{page:r?this.slides[r]:null,secondActivePage:i?this.slides[i]:null,index:s}},updateCurrentPage:function(){var t=this.getActivePage(),n=this.getActiveSlideIndex(),r={pageNumber:t.index,pagesLength:s.getPagesFromCurrentIssuePart().length,section:""};this.model.set({pagesPageIndex:n,activePageIndex:n}),t.page&&t.page.model?(r.section=t.page.model.get("section"),e.trigger("setActivePage",t.page.model)):t.secondActivePage&&t.secondActivePage.model&&(r.section=t.secondActivePage.model.get("section"),e.trigger("setActivePage",t.secondActivePage.model)),this.setActiveSection(r.section),e.trigger("setIssueDetails",r)},getPageDimensions:function(){var e,t,n,r,i=u.isPortrait(),s=i?1:2,o=this.getApplicationWidth(),a=this.getApplicationHeight();return t=this.tileSizes[1].width*4*a/(this.tileSizes[1].height*4),u.isPortraitForced()||t>=o||!i&&t*2>=o?(r=!0,t=o/s,n=this.tileSizes[1].height*4*t/(this.tileSizes[1].width*4),e=0):(n=a,e=i?(o-t)/2:0),{basedOnWidth:r,width:t,height:n,margin:e}},makeDividableByFour:function(e){return e%4!==0&&(e=Math.floor(e/4)*4),e},setActiveSection:function(e){return e=this.replaceForeignCharacters(e),e&&e!==this.activeSection&&(this.activeSection=e,this.trigger("activeSectionChange",e)),this},initializeSwiper:function(){var n=this.transitionToFirstPageInPortraitSpeed===1?0:this.speed,r,s,o;if(this.swiper&&this.swiper!==null)return!1;s=parseInt(this.model.get("activePageIndex")),o=parseInt(this.model.get("previousPageIndex")),r=s=s?s:0,o=o?o:0,r===0&&this.model.setRoute(this.model.toJSON()),this.swiper=new t(this.$(".pages-swiper-container")[0],{initialSlide:r,slidesPerView:this.getSlidesPerView(),slidesPerGroup:this.getSlidesPerView(),enabled:!0,onlyExternal:u.hasTouchSupport?!1:!0,updateOnImagesReady:!1,preventLinksPropagation:!0,preventLinks:!1,followFinger:!0,useCSS3Transforms:this.hardwareAcceleratePage,speed:this.speed,keyboardControl:!1,onTransitionStart:function(){e.trigger("zoomDisableZoom")},onSlideReset:function(){e.trigger("zoomEnableZoom")},onTransitionEnd:function(){e.trigger("pagesSlideChangeEnd")},onTouchStart:function(e,t){m=t.timeStamp},onTouchEnd:function(e,t){u.isAndroid()&&t.timeStamp-m<g&&t.stopPropagation()}});if(s||s>=0)this.swiper.activeIndex=s;if(o||o>=0)this.swiper.previousIndex=o;return this.transitionToFirstPageInPortraitSpeed!==0&&r===0&&u.isPortrait()?window.setTimeout(i.proxy(this.swipeTo,this,{index:1,speed:n,runCallbacks:!0}),this.transitionToFirstPageInPortraitSpeed):u.isPortrait()?this.triggerStat():r%2!==0&&this.swipeTo({index:r-1,speed:1,runCallbacks:!0}),e.trigger("zoomEnableZoom"),!0},onSlideChangeEnd:function(){var t=this.getActiveSlideIndex();this.togglePagesClassname(t),u.isPortraitForced()&&e.trigger("zoomScrollToTop"),u.isTruePortrait()&&t==0?e.trigger("zoomDisableZoom"):e.trigger("zoomEnableZoom"),e.trigger("zoomUpdateZoomLevel",{level:0,index:t,renderHighQuality:!1}),u.isPortraitForced()&&(e.trigger("zoomRemoveTileLeftOvers"),e.trigger("zoomUpdateZoomLevel",{level:"auto",index:t,renderHighQuality:!0})),this.updateCurrentPage(),this.updateIndexesFromSwiper(),this.updatePageRoute(),this.model.set({pagesPageIndex:t,activePageIndex:t}).setRoute(this.model.toJSON()),this.triggerStat()},togglePagesClassname:function(e){var t=this.$(".page-slide"),n=e>=0?e:this.swiper.activeIndex,r=u.isPortrait()?n-1:n-2,s=u.isPortrait()?n+1:n+3;t.each(function(e,t){t=i(t),e<r||e>s?t.addClass("inactive-page-slide").removeClass("active-page-slide"):t.removeClass("inactive-page-slide").addClass("active-page-slide")}.bind(this))},triggerStat:function(){var t=this.getActivePage();t.page&&t.page.model&&e.trigger("stat:pageView",t.page.model.toJSON()),t.secondActivePage&&t.secondActivePage.model&&e.trigger("stat:pageView",t.secondActivePage.model.toJSON())},getActiveSlideIndex:function(){var e;!this.swiper||this.swiper===null?e=this.model.get("activePageIndex"):e=this.swiper.activeIndex;if(n.isNaN(e)||e<0)e=0;return e},getPreviousSlideIndex:function(){var e;return!this.swiper||this.swiper===null?e=this.model.get("previousPageIndex"):e=this.swiper.previousIndex,e<0&&(e=0),e},getSlidesPerView:function(){return u.isPortrait()?1:2},beforeSwipeTo:function(){e.trigger("zoomDisableZoom"),e.trigger("zoomResetZoom"),this.initializeSwiper()},swipeTo:function(e){return this.beforeSwipeTo(),!u.isPortrait()&&!this.numberIsEven(e.index)&&(e.index-=1),this.swiper&&(e.speed=e.speed||this.swiper.params.speed,this.swiper.slideTo(e.index,e.speed,e.runCallbacks)),this},swipeToByDirection:function(e){if(this.getActiveSlideIndex()==0&&e==="left"||this.getActiveSlideIndex()==1&&e=="left"&&u.isPortrait())return;return this.beforeSwipeTo(),this.swiper&&(e==="left"?this.swiper.slidePrev():this.swiper.slideNext()),this},destroySwiper:function(){return this.swiper&&(this.updateIndexesFromSwiper(),this.swiper.destroy(),this.swiper=null),this},setSwiperWrapperTransition:function(e){},updateIndexesFromSwiper:function(){var e;return this.swiper?(e=this.getActiveSlideIndex(),this.model.set({pagesPageIndex:e,activePageIndex:e,previousIndex:this.getPreviousSlideIndex()}),!0):!1},updatePageRoute:function(){this.model.setRoute(this.model.toJSON())},pdfPrintFeatureDone:function(e){e.getActivePage=function(){return this.getActivePage()}.bind(this),e.pageCollection=this.pageCollection}})}),"use strict",define("pagesComponent",["backbone","app","underscore","issueService","baseComponent","pagesView"],function(e,t,n,r,i,s){var o=n.extend({},i);return o.features=[],o.name="pages",o.routes={"pages/:issueId":function(e){o.open({issueId:e})},"pages/:issueId/:partId":function(e,t){o.open({issueId:e,partId:t})},"pages/:issueId/:partId/:pageIndex":function(e,t,n){o.open({issueId:e,partId:t,pageIndex:n})}},o.view=s,o.setRoute=function(e,t){var n=o.name+"/"+e.id+"/";e.hasOwnProperty("activePartId")&&(n+=e.activePartId+"/"),e.hasOwnProperty("activePageIndex")&&(n+=parseInt(e.activePageIndex,10)),o.router.setRoute({route:n,trigger:t})},o.open=function(n){var i=this;e.trigger("displayLoader",o.strings.componentView.loadingMessage),window.setTimeout(function(){n=n||{};if(n.issueId){var s=r.fetchIssueById(n.issueId);s.done(function(s){n.model=s,n.model.setRoute=o.setRoute,r.setCurrentIssueModel(s),t.renderComponentView(o,n,function(t){e.trigger("header:open",i.viewOptions.headerOptions||{}),e.trigger("footer:open",n),e.trigger("thumbnails:open"),e.trigger("info:open"),n.thisIsTheRealStitchReInit||e.trigger("stat:openIssue",{issueId:s.get("id"),issueDate:s.get("pubdate"),issueMode:"pages",issueRevision:s.get("revision"),issueDownloaded:s.get("downloaded")}),o.renderFeatures(),t.componentDone(),o.ready(n.componentReady),e.trigger("removeLoader")})}),s.fail(function(t){e.trigger("removeLoader")})}},100)},o.beforeClose=function(){},o.closeComponent=function(){t.closeComponent(o)},o.reInit=function(n){n.thisIsTheRealStitchReInit=!0,t.closeComponent(o),e.trigger("header:close"),e.trigger("thumbnails:close"),e.trigger("footer:close"),e.trigger("setRoute",{route:"pages/"+n.issueId+"/"+n.partId+"/"+n.pageIndex,trigger:!1}),o.open(n)},o.bindEvents=function(){e.on("pages:open",o.open,o),e.on("pages:reInit",o.reInit,o),e.on("pages:close",o.closeComponentView,o)},o.unBindEvents=function(){e.off("pages:open",o.open,o),e.off("pages:reInit",o.reInit,o),e.off("pages:close",o.closeComponentView,o)},o.bindEvents(),o}),"use strict",define("pagesZoomModel",["baseFeatureModel","localService"],function(e,t){return e.extend({defaults:{activeIndex:0,slides:[]},initialize:function(e){function n(e,r){this.off("change:fullWidthOnStart",n,this);var i=t.get("currentFullWidthState");i!==null&&(typeof i=="string"?r=i==="true":r=i),this.updateCurrentFullWidthState(r),this.set("currentFullWidthState",r)}this.on("change:fullWidthOnStart",n,this)},updateCurrentFullWidthState:function(e){t.put("currentFullWidthState",e),this.set("fullWidthOnStart",e,{silent:!0})}})}),define("vendor/text!components/pages/features/pagesZoom/templates/fullWidth.html",[],function(){return'<% var iconNameToUse = active ? iconName.active : iconName.inactive; %>\n<% var textToUse = active ? iconText.spread : iconText.page; %>\n<span class="icon-link-icon"><i class="<%= iconNameToUse %>"></i></span>\n<span class="icon-link-text"><%= textToUse %></span>\n'}),define("vendor/text!components/pages/features/pagesZoom/templates/zoomMax.html",[],function(){return'<% if (iconName) { %>\n<span class="icon-link-icon"><i class="<%= iconName %>"></i></span>\n<% } %>\n<% if (iconText) { %>\n<span class="icon-link-text"><%= iconText %></span>\n<% } %>\n'}),define("vendor/text!components/pages/features/pagesZoom/templates/zoomMin.html",[],function(){return'<% if (iconName) { %>\n<span class="icon-link-icon"><i class="<%= iconName %>"></i></span>\n<% } %>\n<% if (iconText) { %>\n<span class="icon-link-text"><%= iconText %></span>\n<% } %>\n'}),define("vendor/text!components/pages/features/pagesZoom/templates/tileGrid.html",[],function(){return'<div id="tile-0-level-0-template-0" class="tile 0-0 level-0"></div>\n<div id="tile-0-level-0-template-1" class="tile 0-1 level-0"></div>\n<div id="tile-3-level-2-template-0" class="tile 2-0 level-2"></div>\n<div id="tile-2-level-2-template-0" class="tile 2-0 level-2"></div>\n<div id="tile-1-level-2-template-0" class="tile 2-0 level-2"></div>\n<div id="tile-0-level-2-template-0" class="tile 2-0 level-2"></div>\n<div id="tile-7-level-2-template-0" class="tile 2-0 level-2"></div>\n<div id="tile-6-level-2-template-0" class="tile 2-0 level-2"></div>\n<div id="tile-5-level-2-template-0" class="tile 2-0 level-2"></div>\n<div id="tile-4-level-2-template-0" class="tile 2-0 level-2"></div>\n<div id="tile-11-level-2-template-0" class="tile 2-0 level-2"></div>\n<div id="tile-10-level-2-template-0" class="tile 2-0 level-2"></div>\n<div id="tile-9-level-2-template-0" class="tile 2-0 level-2"></div>\n<div id="tile-8-level-2-template-0" class="tile 2-0 level-2"></div>\n<div id="tile-15-level-2-template-0" class="tile 2-0 level-2"></div>\n<div id="tile-14-level-2-template-0" class="tile 2-0 level-2"></div>\n<div id="tile-13-level-2-template-0" class="tile 2-0 level-2"></div>\n<div id="tile-12-level-2-template-0" class="tile 2-0 level-2"></div>\n<div id="tile-0-level-2-template-1" class="tile 2-1 level-2"></div>\n<div id="tile-1-level-2-template-1" class="tile 2-1 level-2"></div>\n<div id="tile-2-level-2-template-1" class="tile 2-1 level-2"></div>\n<div id="tile-3-level-2-template-1" class="tile 2-1 level-2"></div>\n<div id="tile-4-level-2-template-1" class="tile 2-1 level-2"></div>\n<div id="tile-5-level-2-template-1" class="tile 2-1 level-2"></div>\n<div id="tile-6-level-2-template-1" class="tile 2-1 level-2"></div>\n<div id="tile-7-level-2-template-1" class="tile 2-1 level-2"></div>\n<div id="tile-8-level-2-template-1" class="tile 2-1 level-2"></div>\n<div id="tile-9-level-2-template-1" class="tile 2-1 level-2"></div>\n<div id="tile-10-level-2-template-1" class="tile 2-1 level-2"></div>\n<div id="tile-11-level-2-template-1" class="tile 2-1 level-2"></div>\n<div id="tile-12-level-2-template-1" class="tile 2-1 level-2"></div>\n<div id="tile-13-level-2-template-1" class="tile 2-1 level-2"></div>\n<div id="tile-14-level-2-template-1" class="tile 2-1 level-2"></div>\n<div id="tile-15-level-2-template-1" class="tile 2-1 level-2"></div>'}),"use strict",define("pagesZoomView",["backbone","baseFeatureView","jquery","underscore","baseView","deviceUtility","IScroll","hammer","vendor/text!components/pages/features/pagesZoom/templates/fullWidth.html","vendor/text!components/pages/features/pagesZoom/templates/zoomMax.html","vendor/text!components/pages/features/pagesZoom/templates/zoomMin.html","vendor/text!components/pages/features/pagesZoom/templates/tileGrid.html"],function(e,t,n,r,i,s,o,u,a,f,l,c){var h=s.isRunningAtMobile()?5:3,p=0,d,v=1.25;return t.extend({id:"zoom-buttons-wrapper",initialize:function(e){this.init(e),this.model.get("vertical")===!0&&this.$el.addClass("vertical-zoom-buttons"),this.lastPages={},this.tiles=[],this.compiledTileGridTemplate=r.template(c)(),this.addHooks().generateTiles(3).generateTiles(3)},render:function(){var e=this.model.get("icons"),t=e.fullWidth.customContext?n(e.fullWidth.customContext):this.$el,i=e.zoomMin.customContext?n(e.zoomMin.customContext):this.$el,o=e.zoomMax.customContext?n(e.zoomMax.customContext):this.$el;return this.model.get("fullWidth")&&!this.model.get("fullWidthOnly")&&(this.fullWidthElement=n("<div>").addClass("forced-portrait-icon "+this.model.get("className")+" "+e.fullWidth.className).attr("title",this.strings.tooltip?this.strings.tooltip.fullWidth:"").html(r.template(a)({iconName:e.fullWidth.iconName,iconText:this.strings.iconText.fullWidth,active:this.model.get("fullWidthOnStart")})),s.isTruePortrait()&&(this.fullWidthElement.addClass("hidden"),this.disableFullWidth({silent:!0})),t.append(this.fullWidthElement)),!s.hasTouchSupport&&this.canZoom()&&(this.zoomMinElement=n("<div>").addClass(this.model.get("className")+" "+e.zoomMin.className).attr("title",this.strings.tooltip?this.strings.tooltip.zoomMin:"").html(r.template(l)({iconName:e.zoomMin.iconName,iconText:this.strings.iconText.zoomMin})),this.zoomMaxElement=n("<div>").addClass(this.model.get("className")+" "+e.zoomMax.className).attr("title",this.strings.tooltip?this.strings.tooltip.zoomMax:"").html(r.template(f)({iconName:e.zoomMax.iconName,iconText:this.strings.iconText.zoomMax})),o.prepend(this.zoomMaxElement),i.append(this.zoomMinElement)),this},addHooks:function(){return this.addHook.call(this,"afterRender",function(){this.initializeZoom(),this.bindEvents()}),this.addHook.call(this,"beforeClose",function(){this.slides=[],this.tiles=[],this.fullWidthElement=null,this.zoomMinElement=null,this.zoomMaxElement=null,this.removeApplicationClass("zoom zooming zoom-is-active"),this.IScrollZoom&&(this.IScrollZoom.off("scrollEnd"),this.IScrollZoom.off("scrollStart"),this.IScrollZoom.off("zoomStart"),this.IScrollZoom.off("zoomEnd"),this.IScrollZoom.destroy(),delete this.IScrollZoom,this.IScrollZoom=null);for(var e in this.lastPages)this.lastPages.hasOwnProperty(e)&&delete this.lastPages[e];delete this.compiledTileGridTemplate}),this.addHook.call(this,"afterClose",function(){for(var e in this)this.hasOwnProperty(e)&&delete this[e]}),this},bindEvents:function(){this.unbindEvents(),this.model.on("change:currentFullWidthState",function(e,t){e.updateCurrentFullWidthState(t)},this.model),this.fullWidthElement&&(u(this.fullWidthElement).on("tap",n.proxy(this.onForcePortraitTapped,this)),!s.hasTouchSupport&&!s.isRunningAsHybridApplication?n(window).bind("resize",n.proxy(this.orientationChange,this)):e.on("orientationchange",this.orientationChange,this)),this.zoomMinElement&&u(this.zoomMinElement).on("tap",n.proxy(this.onZoomMinTapped,this)),this.zoomMaxElement&&u(this.zoomMaxElement).on("tap",n.proxy(this.onZoomMaxTapped,this)),this.IScrollZoom.on("scrollEnd",n.proxy(this.onScrollEnd,this),this),this.IScrollZoom.on("scrollStart",n.proxy(this.onScrollStart,this),this),this.IScrollZoom.on("zoomStart",n.proxy(this.onZoomStart,this),this),this.IScrollZoom.on("zoomEnd",n.proxy(this.onZoomEnd,this),this),e.on("zoomSetup",this.setup,this),e.on("isZooming",this.asyncIsZooming,this),e.on("zoomEnableZoom",this.enableZoom,this),e.on("zoomDisableZoom",this.disableZoom,this),e.on("zoomScrollLeft",this.scrollLeft,this),e.on("zoomScrollRight",this.scrollRight,this),e.on("zoomScrollDown",this.scrollDown,this),e.on("zoomScrollUp",this.scrollUp,this),e.on("zoomJumpDown",this.jumpDown,this),e.on("zoomJumpUp",this.jumpUp,this),e.on("zoomScrollToTop",this.scrollToTop,this),e.on("zoomScrollToBottom",this.scrollToBottom,this),e.on("zoomUpdateZoomLevel",this.updateLevel,this),e.on("zoomDestroyZoom",this.destroyZoom,this),e.on("zoomInitZoom",this.initializeZoom,this),e.on("zoomBadAndroidFix",this.androidZoomInAndOutHack,this),e.on("zoomUpdateZoomActiveIndex",this.updateZoomActiveIndex,this),e.on("zoomRemoveTileLeftOvers",this.removeTileLeftOvers,this),e.on("zoom",this.zoomTo,this),e.on("zoomResetZoom",this.resetZoom,this),e.on("toggleZoom",this.toggleZoom,this)},unbindEvents:function(){this.fullWidthElement&&(u(this.fullWidthElement).off("tap",this.onForcePortraitTapped),e.off("orientationchange",this.orientationChange,this)),this.zoomMinElement&&u(this.zoomMinElement).off("tap",this.onZoomMinTapped),this.zoomMaxElement&&u(this.zoomMaxElement).off("tap",this.onZoomMaxTapped),e.off("zoomSetup"),e.off("asyncIsZooming"),e.off("zoomEnableZoom"),e.off("zoomDisableZoom"),e.off("zoomScrollLeft"),e.off("zoomScrollRight"),e.off("zoomScrollDown"),e.off("zoomScrollUp"),e.off("zoomJumpDown"),e.off("zoomJumpUp"),e.off("zoomScrollToTop"),e.off("zoomScrollToBottom"),e.off("zoomUpdateZoomLevel"),e.off("zoomDestroyZoom"),e.off("zoomInitZoom"),e.off("zoomBadAndroidFix"),e.off("zoomUpdateZoomActiveIndex"),e.off("zoomRemoveTileLeftOvers"),e.off("zoom"),e.off("zoomResetZoom"),e.off("toggleZoom")},setup:function(e){return this.filesBasePath=e.filesBasePath,this.extension=e.extension,this.pathSize=e.pathSize,this.slides=e.slides,this.updateZoomActiveIndex(e.activeIndex),!s.isTruePortrait()&&this.model.get("fullWidthOnStart")&&this.onForcePortraitTapped(),this},canZoom:function(){return this.model.get("zoom")},asyncIsZooming:function(e){e.callback&&e.callback(this.isZooming())},toggleZoom:function(){this.canZoom()&&this.IScrollZoom&&this.IScrollZoom.enabled&&(this.floorScale(this.IScrollZoom.scale)>1?this.onZoomMinTapped():this.onZoomMaxTapped())},initializeZoom:function(){var e=!0;if(s.isAndroid()||s.isiOS())e=!1;if(!this.IScrollZoom||this.IScrollZoom===null)this.IScrollZoom=new o(this.model.get("target"),{directionLockThreshold:0,scrollY:!0,scrollX:!0,zoom:this.canZoom(),HWCompositing:e,useTransform:!0,useTransition:!0,freeScroll:!0,bounce:!1,bounceTime:0,momentum:s.isAndroid()?!1:!0,deceleration:.006,zoomMax:this.canZoom()?h:1,zoomMin:1,mouseWheel:!0,preventDefaultException:{className:/^pages-part(-\w|$)/}});return this},resetZoom:function(){if(this.IScrollZoom.scale>1){var t=n(".pages-swiper-container .inactive-page-slide").width();n(".page-slide").width(t),n("#pages-wrapper").width(s.isPortrait()?t:t*2),s.isPortraitForced()||this.removeTileLeftOvers(),this.zoomTo(1,0,0),e.trigger("notifyOnZoomEnd")}},orientationChange:function(){if(!this.fullWidthElement)return;s.isTruePortrait()?(this.fullWidthElement.addClass("hidden"),this.disableFullWidth({silent:!0}),this.updateLevel({level:"auto",index:this.model.get("activeIndex"),renderHighQuality:!1})):(this.fullWidthElement.removeClass("hidden"),this.model.get("fullWidthOnStart")&&(this.enableFullWidth({silent:!0}),this.updateLevel({level:"auto",index:this.model.get("activeIndex"),renderHighQuality:!0})))},generateTiles:function(e){var t=1,n,r,i=[],s=1,o=1;for(var u=0;u<e;u++){n={tiles:[]},r=Math.sqrt(t);for(var a=0;a<t;a++)n.tiles[s+":"+o]={id:p++,x:s,y:o,active:!1,index:a},s===r?(s=1,o+=1):s+=1;t*=4,s=1,o=1,i.push(n)}return this.tiles.push({levels:i}),this},updateZoomActiveIndex:function(e){this.model.set("activeIndex",parseInt(e,10))},updateLevel:function(e){e.level==="auto"?e.level=this.floorScale(this.IScrollZoom.scale)-1:e.level=e.level>0?e.level:0,this.refresh(),e.renderHighQuality=e.renderHighQuality||this.IScrollZoom.scale>1||s.isPortraitForced(),this.updateZoomActiveIndex(e.index),!s.isPortrait()&&e.index===1&&(e.index=0),this.updateLevelTiles(this.slides[e.index],0,e.level,e.index,e.renderHighQuality),s.isPortrait()||this.updateLevelTiles(this.slides[e.index+1],1,e.level,e.index+1,e.renderHighQuality)},updateLevelTiles:function(e,t,n,r,i){return e?(e.supportZoom&&this.tiles[t].levels.forEach(function(s,o){o===n&&(i?(e.hasGrid()||e.appendTilesGrid(this.compiledTileGridTemplate),this.updateTilesInViewport(this.tiles[t].levels[n],n,t,r,e)):e.appendTilesGrid(this.compiledTileGridTemplate))},this),!0):!1},updateTilesInViewport:function(e,t,n,r,i){var o,u,a=s.isPortrait()?1:n,f=this.getCoordinates(i,r),l=this.getTileBreakpoint(this.floorScale(this.IScrollZoom.scale));if(f.xMax===!1||f.yMax===!1||f.xMin===!1||f.yMin===!1)return!1;i.hideTileGrid(a,t),i.resetActiveTiles(),this.lastPages.hasOwnProperty(i.cid)||(this.lastPages[i.cid]=i);if(i.currentZoomLevel===0||i.currentZoomLevel!==t)i.removeActiveTiles(),i.currentZoomLevel=t;for(var c=f.yMin;c<=f.yMax;c++)for(var h=f.xMin;h<=f.xMax;h++)s.isPortrait()?o=e.tiles[h+":"+c]:r%2===1?(u=h,h>l&&(u=h-l),o=e.tiles[u+":"+c]):o=e.tiles[h+":"+c],o&&i.appendTileToGrid(o,a,t);return i.removeInactiveTiles(),i.showTileGrid(a,t),!0},getCoordinates:function(e,t){var n=e.getLayerWidth()*this.IScrollZoom.scale,r=s.isPortrait()?n:n*2,i=this.IScrollZoom.wrapperHeight,o=this.IScrollZoom.wrapperWidth,u=Math.abs(this.IScrollZoom.x),a=Math.abs(this.IScrollZoom.y),f=u+o,l=a+i,c={w:r,h:this.IScrollZoom.scrollerHeight},h=0,p={x:u-h,x2:f-h,y:a,y2:l},d=this.getTileSize(this.floorScale(this.IScrollZoom.scale)),v=d;return!s.isPortrait()&&this.floorScale(this.IScrollZoom.scale)>1&&(v/=2),s.isPortrait()||t%2===1&&(h+=n,p={x:u-h,x2:f-h,y:a,y2:l}),{yMin:n>0?Math.ceil(p.y/c.h*100/d):!1,xMin:n>0?Math.ceil(p.x/c.w*100/v):!1,yMax:n>0?Math.ceil(p.y2/c.h*100/d):!1,xMax:n>0?Math.ceil(p.x2/c.w*100/v):!1}},getTileBreakpoint:function(e){var t;return e===1?t=1:e===2?t=2:e===3&&(t=4),t},getTileSize:function(e){var t;return e===1?t=100:e===2?t=50:e>=3&&(t=25),t},floorScale:function(e){return s.isPortraitForced()?e=3:e<=d?e=1:e>d&&(e=3),e},zoomTo:function(e,t,n){return this.IScrollZoom&&(e=e||0,t=t||0,n=n||0,this.IScrollZoom.zoom(e,t,n)),this},removeTileLeftOvers:function(){for(var e in this.lastPages)this.lastPages.hasOwnProperty(e)&&(this.lastPages[e].resetActiveTiles(),this.lastPages[e].removeActiveTiles(),this.lastPages[e].removeTileGrid(),delete this.lastPages[e])},removeTileElementsLeftOvers:function(){n(".layer").empty()},androidZoomInAndOutHack:function(){e.trigger("notifyOnZoomStart"),e.trigger("notifyOnZoomEnd")},refresh:function(){this.IScrollZoom&&this.IScrollZoom.refresh()},reset:function(){},onZoomStart:function(){this.IScrollZoom&&this.IScrollZoom.enabled&&(this.setApplicationClass("zooming"),this.IScrollZoom.scale===1&&e.trigger("notifyOnZoomStart"))},onZoomEnd:function(){var t;this.IScrollZoom&&(this.calculateMaxZoom(),this.IScrollZoom.scale===1||this.IScrollZoom.scale<=v?(this.removeTileLeftOvers(),this.IScrollZoom.scale>1&&this.zoomTo(1,0,0),e.trigger("notifyOnZoomEnd"),t=s.isPortraitForced()):t=!0,this.updateLevel({level:"auto",index:this.model.get("activeIndex"),renderHighQuality:t})),this.removeApplicationClass("zooming")},onScrollStart:function(){this.IScrollZoom&&this.IScrollZoom.enabled&&this.floorScale(this.IScrollZoom.scale)>1&&this.setApplicationClass("paning")},onScrollEnd:function(){return this.removeApplicationClass("paning"),!this.IScrollZoom&&!this.IScrollZoom.enabled?!1:(this.floorScale(this.IScrollZoom.scale)>1&&this.updateLevel({level:"auto",index:this.model.get("activeIndex"),renderHighQuality:!0}),!0)},onForcePortraitTapped:function(){this.removeTileElementsLeftOvers(),this.IScrollZoom&&this.IScrollZoom.scale>1&&(this.zoomTo(1,0,0),e.trigger("notifyOnZoomEnd")),s.isPortraitForced()?this.disableFullWidth():this.enableFullWidth(),this.fullWidthElement.html(r.template(a)({iconName:this.model.get("icons").fullWidth.iconName,iconText:this.strings.iconText.fullWidth,active:s.isPortraitForced()})),this.updateLevel({level:"auto",index:this.model.get("activeIndex"),renderHighQuality:!0})},enableFullWidth:function(e){e=e||{},s.forceOrientationToPortrait(),this.setApplicationClass("forced-portrait"),e.silent||this.model.set("currentFullWidthState",!0)},disableFullWidth:function(e){e=e||{},e.silent||this.model.set("currentFullWidthState",!1),s.resetOrientation(),this.removeApplicationClass("forced-portrait")},onZoomMinTapped:function(){this.canZoom()&&this.IScrollZoom&&this.IScrollZoom.enabled&&this.IScrollZoom.scale>1&&(this.removeTileLeftOvers(),this.zoomTo(1,0,0),e.trigger("notifyOnZoomEnd"),this.floorScale(this.IScrollZoom.scale)>1&&this.updateLevel({level:"auto",index:this.model.get("activeIndex"),renderHighQuality:!0}))},calculateOffset:function(e,t){var r=n(".layer").first(),i=r.closest(".page-slide");t=t||1;switch(e.toLowerCase()){case"x":var s,o,u;return this.model.get("activeIndex")===0?s=Math.round(i.width()):s=Math.round(i.width())-Math.round(r.width()),o=Math.round(s*t),o;case"y":return Math.round(i.height()-r.height())/2;default:return 0}},onZoomMaxTapped:function(t){if(!this.canZoom())return!1;var r=this.calculateMaxZoom(),i=0,o=n(".layer").first(),u=o.closest(".page-slide"),a;!s.isTruePortrait()&&this.model.get("activeIndex")==0&&(a=u.width()*r,i=a),this.IScrollZoom&&this.IScrollZoom.enabled&&this.IScrollZoom.scale<=r&&this.IScrollZoom.scale<=r&&(e.trigger("notifyOnZoomStart"),this.zoomTo(r,i,0),this.updateLevel({level:"auto",index:this.model.get("activeIndex"),renderHighQuality:!0}))},updateScrollerWidth:function(){var e=n(".pages-swiper-container .layer").width(),t=s.isPortrait(),r=e*2;n(".pages-swiper-container .swiper-slide-visible").width(e),e=t?e:r,n(this.IScrollZoom.scroller).width(e),this.refresh()},getScrollValueByApplicationHeight:function(){return parseInt(this.getApplicationHeight())-75},scrollUp:function(){var e,t;this.canZoom()&&this.IScrollZoom&&this.IScrollZoom.enabled&&this.floorScale(this.IScrollZoom.scale)>1&&(t=this.getApplicationHeight(),this.IScrollZoom&&this.IScrollZoom.y<0&&(e=this.IScrollZoom.y+t-t*.1,e>0&&(e=0),this.IScrollZoom.scrollTo(this.IScrollZoom.x,e,1)))},scrollDown:function(){var e,t;this.canZoom()&&this.IScrollZoom&&this.IScrollZoom.enabled&&this.floorScale(this.IScrollZoom.scale)>1&&(t=this.getApplicationHeight(),this.IScrollZoom.y>this.IScrollZoom.maxScrollY&&(e=this.IScrollZoom.y-(t-t*.1),e<this.IScrollZoom.maxScrollY&&(e=this.IScrollZoom.maxScrollY),this.IScrollZoom.scrollTo(this.IScrollZoom.x,e,1)))},jumpDown:function(){var e;this.IScrollZoom&&this.IScrollZoom.y>this.IScrollZoom.maxScrollY&&(e=this.IScrollZoom.y-this.getScrollValueByApplicationHeight(),e<this.IScrollZoom.maxScrollY&&(e=this.IScrollZoom.maxScrollY),this.IScrollZoom.scrollTo(this.IScrollZoom.x,e,300))},jumpUp:function(){var e;this.IScrollZoom&&this.IScrollZoom.y<0&&(e=this.IScrollZoom.y+this.getScrollValueByApplicationHeight(),e>0&&(e=0),this.IScrollZoom.scrollTo(this.IScrollZoom.x,e,300))},scrollLeft:function(){var t,n;this.canZoom()&&this.IScrollZoom&&this.IScrollZoom.enabled&&this.floorScale(this.IScrollZoom.scale)>1&&(n=this.getApplicationWidth(),this.IScrollZoom.x<0?(t=this.IScrollZoom.x+(n-n*.1),t>0&&(t=0),this.IScrollZoom.scrollTo(t,this.IScrollZoom.y,1)):this.IScrollZoom.x>=0&&(this.resetZoom(),e.trigger("navigate",{direction:"left"})))},scrollRight:function(){var t,n;this.canZoom()&&this.IScrollZoom&&this.IScrollZoom.enabled&&this.floorScale(this.IScrollZoom.scale)>1&&(n=this.getApplicationWidth(),this.IScrollZoom.x>this.IScrollZoom.maxScrollX?(t=this.IScrollZoom.x-(n-n*.1),t<this.IScrollZoom.maxScrollX&&(t=this.IScrollZoom.maxScrollX),this.IScrollZoom.scrollTo(t,this.IScrollZoom.y,1)):this.IScrollZoom.x<=this.IScrollZoom.maxScrollX&&(this.resetZoom(),e.trigger("navigate",{direction:"right"})))},scrollToTop:function(){return this.IScrollZoom?(this.IScrollZoom.scrollTo(0,0,400*(Math.abs(this.IScrollZoom.y)/1e3)),!0):!1},disableZoom:function(){this.IScrollZoom&&this.IScrollZoom.disable()},enableZoom:function(){this.IScrollZoom&&this.IScrollZoom.enable()},calculateMaxZoom:function(){var e=n(".layer").height();return h=this.slides[2].model.get("tileSizes")[1].height*4/e,d=870/e*.95,d=d>1?d:1,h=this.canZoom()?h:1,this.setZoomMax(h)},setZoomMax:function(e){return s.isBadAndroid()&&(e=Math.floor(e)),this.IScrollZoom&&(this.IScrollZoom.options.zoomMax=e),e},destroyZoom:function(){this.IScrollZoom&&(this.IScrollZoom.destroy(),this.IScrollZoom=null)},isZooming:function(){return this.IScrollZoom&&this.IScrollZoom.scale>1}})}),"use strict",define("pagesZoomFeature",["underscore","baseFeature","pagesZoomModel","pagesZoomView"],function(e,t,n,r){return function(){this.feature=e.extend({},t),this.feature.setView.call(this.feature,r).setModel.call(this.feature,new n)}}),define("vendor/text!components/thumbnails/templates/thumbnailView.html",[],function(){return'<div class="thumbnail">\n    <img class="thumbnail-object" src="<%= url %>" style="height:<%= height %>px;" />\n    <span class="page-number"><%= pagina %></span>\n</div>\n'}),"use strict",define("thumbnailView",["backbone","underscore","issueService","baseView","deviceUtility","vendor/text!components/thumbnails/templates/thumbnailView.html"],function(e,t,n,r,i,s){return r.extend({className:"swiper-slide",events:{tap:"updateActivePage"},initialize:function(e){this.init(e),this.index=e.index,this.thumbnailHTML=t.template(s),this.thumbnailsBasePath=e.thumbnailsBasePath,this.model.on("change:active",this.toggleActive,this),this.width=e.width,this.height=e.height,this.viewOptions=this.viewOptions||{smallHeight:120,smallSpace:7,height:270,space:17},this.generateElementValues(),this.extension=n.getIssueExtension()},render:function(){var e={url:this.thumbnailsBasePath+this.model.get("fileBasePath")+"_thumb512m."+this.extension,pagina:this.model.get("pagina"),height:this.elementHeight};return this.$el.html(this.thumbnailHTML(e)),this.model.get("active")&&this.$(".page-number").addClass("active-thumbnail"),this},hide:function(){this.$el.addClass("hidden")},show:function(){this.$el.removeClass("hidden")},resize:function(){var e;this.generateElementValues(),e=this.width/this.height*this.elementHeight,this.$el.css({width:e+this.elementspace+"px",height:this.elementHeight+"px"}),this.render()},updateActivePage:function(){var t=this.index;!i.isPortrait()&&t%2!==0&&(t-=1),this.notifyActivePage(this.model),e.trigger("pagesSwipeTo",{index:t,speed:0})},notifyActivePage:function(e){},toggleActive:function(){this.model.get("active")?this.$(".page-number").addClass("active-thumbnail"):this.$(".page-number").removeClass("active-thumbnail")},generateElementValues:function(){var e=$(window).width()<519;this.elementHeight=e?this.viewOptions.smallHeight:this.viewOptions.height,this.elementspace=e?this.viewOptions.smallSpace:this.viewOptions.space}})}),define("vendor/text!components/thumbnails/templates/thumbnailsView.html",[],function(){return'<div class="thumbnails-top-context"></div>\n<div class="thumbnails-container swiper-container">\n	<div id="thumbnails" class="thumbnail-swiper swiper-wrapper"></div>\n</div>\n<div class="thumbnails-bottom-context"></div>'}),"use strict",define("thumbnailsView",["backbone","baseView","swiper","underscore","thumbnailView","deviceUtility","issueService","vendor/text!components/thumbnails/templates/thumbnailsView.html"],function(e,t,n,r,i,s,o,u){return t.extend({className:"thumbnails-outer-wrapper",initialize:function(e){this.init(e),this.viewOptions.subViewOptions||(this.viewOptions.subViewOptions={thumbnailView:{smallHeight:120,smallSpace:7,height:200,space:13}}),this.thumbnailsHTML=r.template(u),this.thumbnails={},this.pageCollection=o.getPagesFromCurrentIssuePart(),this.currentPartId=o.getCurrentPartId(),this.thumbnailsBasePath=o.getCurrentIssueFilesBasePath(),this.sizes=this.pageCollection.at(0).get("tileSizes")[0],this.addHook.call(this,"afterRender",function(){this.appendThumbnailsHTML()}),this.addHook.call(this,"beforeClose",function(){this.swiper&&(this.swiper.destroy(),this.swiper=null)}),this.bindEvents()},render:function(){return this.$el.html(this.thumbnailsHTML()),this},bindEvents:function(){return this.unbindEvents(),e.on("done:articleSearchFeature",this.articleSearchDone,this),e.on("setActivePage",this.setActivePage,this),e.on("orientationchange",this.orientationChange,this),this},unbindEvents:function(){return e.off("done:articleSearchFeature",this.articleSearchDone,this),e.off("setActivePage",this.setActivePage,this),e.off("orientationchange",this.orientationChange,this),this},articleSearchDone:function(e){var t=this;e.notifyResult=function(e){t.filterThumbnails(e)},e.notifyOnReset=function(){t.resetFilteredThumbnails()}},resize:function(){this.swiper.update()},resizeThumbnails:function(){if(this.thumbnails){for(var e in this.thumbnails)this.thumbnails.hasOwnProperty(e)&&this.thumbnails[e].resize();this.swiper&&this.swiper.update()}},orientationChange:function(){this.resizeThumbnails()},appendThumbnailsHTML:function(){var e=this,t=this.$("#thumbnails"),n;return this.pageCollection&&(this.pageCollection.each(function(r,s){n=new i({thumbnailsBasePath:this.thumbnailsBasePath,width:this.sizes.width,height:this.sizes.height,model:r,index:s+1,viewOptions:this.viewOptions.subViewOptions.thumbnailView}),t.append(n.render().el),this.thumbnails[r.get("pagina")]=n,n.notifyActivePage=function(t){e.setActivePage.call(e,t)},this.addView.call(this,n)},this),this.swiper=this.$(".thumbnails-container").swiper({mousewheelControl:!0,slidesPerView:"auto",freeMode:e.viewOptions.freeMode||!1,freeModeFluid:e.viewOptions.freeModeFluid||!1}),this.resizeThumbnails()),this},filterThumbnails:function(e){var t;for(var n in this.thumbnails)this.thumbnails.hasOwnProperty(n)&&this.thumbnails[n].hide();e.each(function(e){t=e.get("pagina"),this.thumbnails.hasOwnProperty(t)&&this.currentPartId===e.get("part")&&this.thumbnails[t].show()},this),this.swiper&&(this.swiper.update(!0),this.swiper.setWrapperTranslate(0,0,0))},resetFilteredThumbnails:function(){e.trigger("clearArticleSearchInput");for(var t in this.thumbnails)this.thumbnails.hasOwnProperty(t)&&this.thumbnails[t].$el&&this.thumbnails[t].show()},setActivePage:function(e){if(!e)return!1;this.pageCollection.each(function(e){e.unset("active")});var t=this.pageCollection.indexOf(e),n,r=1;return e.set("active",!0),s.isPortrait()||(r=2,this.numberIsEven(t)?n=this.pageCollection.at(t-1):n=this.pageCollection.at(t+1),n&&n.set("active",!0)),t===0&&(r=0),this.resetFilteredThumbnails(),this.swiper.slideTo(t-r,300),this}})}),"use strict",define("thumbnailsComponent",["backbone","app","underscore","baseComponent","thumbnailsView"],function(e,t,n,r,i){var s=n.extend({},r);return s.features=[],s.name="thumbnails",s.view=i,s.open=function(e){e=e||{},t.renderComponentView(s,e,function(){s.renderFeatures(),s.ready(e.componentReady)})},s.beforeClose=function(){},s.closeComponent=function(){t.closeComponent(s)},e.on(s.name+":open",s.open,s),e.on(s.name+":beforeClose",s.beforeClose,s),e.on(s.name+":close",s.closeComponent,s),s}),define("vendor/text!components/covers/templates/coverList.html",[],function(){return'<ol class="cover-list cover-list-default"></ol>'}),define("vendor/text!components/covers/templates/emptyList.html",[],function(){return'<ol class="cover-list cover-list-empty">\n    <% _.each([1,2,3,4,5,6,7], function(i) { %>\n    <li class="cover empty-cover<% if(i === 1) { %> first-cover <% }; %>">\n        <div class="cover-body empty-cover-body">\n            <% if(i === 1) { %>\n            <% if (downloadsOnly) { %>\n            <h3 class="empty-cover-list-message"><%= strings.noDownloadedIssues %></h3>\n            <% } else { %>\n            <h3 class="empty-cover-list-message"><%= strings.noIssuesInArchive %></h3>\n            <% } %>\n            <% } %>\n                <span class="centered-icon empty-cover-icon">\n				    <i class="dn-icon-news-paper"></i>\n                </span>\n        </div>\n    </li>\n    <% }); %>\n</ol>\n'}),define("vendor/text!components/covers/templates/coverListElement.html",[],function(){return'<li class="cover"></li>'}),"use strict",define("coversView",["backbone","underscore","jquery","deviceUtility","dataService","baseView","coverView","stringUtility","dateUtility","issueService","vendor/text!components/covers/templates/coverList.html","vendor/text!components/covers/templates/emptyList.html","vendor/text!components/covers/templates/coverListElement.html"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){return s.extend({className:"application-page",id:"covers-wrapper",noIssues:!0,initialize:function(e){this.init.call(this,e),this.coverListTemplate=t.template(l),this.emptyListTemplate=t.template(c),this.coverListElementTemplate=t.template(h),this.downloadsOnly=e.downloadsOnly,this.componentSetRoute=e.componentSetRoute,this.collection=e.issueCollection,this.coverTemplate=e.coverTemplate,this.issueId=e.issueId,this.bindEvents(),this.addHooks(e)},addHooks:function(t){this.addHook.call(this,"beforeRender",function(){e.trigger("setHistoryModel",{callback:function(){i.exitApp(function(){},function(){})}}),t.viewOptions.fixed&&this.setApplicationClass("fixed"),this.setApplicationClass(t.viewOptions.componentName)}),this.addHook.call(this,"beforeClose",function(){this.removeScrollTouchFix(n("#application-content")),this.removeApplicationClass("fixed"),this.removeApplicationClass(t.viewOptions.componentName),this.removeApplicationClass("downloads-only")}),this.addHook.call(this,"afterRender",function(){this.noIssues||this.addCoverListFooter(),this.resetScrollTouchFix(n("#application-content")),e.trigger("removeLoader")}),this.addHook.call(this,"afterClose",function(){e.trigger("setHistoryModel",null);for(var t in this)this.hasOwnProperty(t)&&delete this[t]})},render:function(){return this.downloadsOnly&&this.setApplicationClass("downloads-only"),this.$el.find(".cover-list").remove(),this.$el.prepend(this.getCoversHTML(this.collection)),this},componentDone:function(t){if(t.issueId){var n=f.getIssueModelFromCollectionById(t.issueId);n?this.tappedCover(n):e.trigger("setRoute",{route:"issues",trigger:!1})}},addCoverListFooter:function(){n("<div/>",{"class":"cover-list-footer"}).appendTo(this.$el)},setCollectionChange:function(){this.downloadsOnly?(this.collection.on("change:downloading",function(){this.render()},this),this.collection.on("change:downloaded",function(){this.render()},this)):(this.collection.off("change:downloading"),this.collection.off("change:downloaded"))},bindEvents:function(){return this.unbindEvents(),e.on("tappedCover",this.tappedCover,this),e.on("fetchNextIssues",this.fetchNextIssues,this),e.on("done:loadIssuesIconFeature",this.loadIssuesIconFeatureDone,this),e.on("done:logoFeature",this.logoFeatureDone,this),e.on("done:dateFeature",this.dateFeatureDone,this),e.on("issueEntry:close",this.issueEntryClose,this),e.on("loadIssuesIconTapped",this.loadIssues,this),e.on("scrollTo",this.scrollTo,this),this},unbindEvents:function(){return e.off("tappedCover"),e.off("fetchNextIssues"),e.off("done:loadIssuesIconFeature",this.loadIssuesIconFeatureDone,this),e.off("done:logoFeature",this.logoFeatureDone,this),e.off("done:dateFeature",this.dateFeatureDone,this),e.off("issueEntry:close",this.issueEntryClose,this),e.off("loadIssuesIconTapped",this.loadIssues,this),e.off("scrollTo",this.scrollTo,this),this},loadIssuesIconFeatureDone:function(){e.trigger("hasMoreIssuesToLoad",this.collection.getNextURL())},loadIssues:function(){var t=this,n;t.collection.fetchNextIssues().done(function(r){n=t.collection.getNextURL(),t.render(),e.trigger("hasMoreIssuesToLoad",n)})},logoFeatureDone:function(){e.trigger("changeLogoSrc")},dateFeatureDone:function(){e.trigger("setDate",a.getDateString())},fetchNextIssues:function(){var t=this;this.collection.fetchNextIssues().done(function(){t.render(),e.trigger("hasMoreIssuesToLoad",t.collection.getNextURL())})},issueEntryClose:function(){this.render(),this.triggerHook("afterRender")},filter:function(e){return this.downloadsOnly=e,this.render(),this.triggerHook("afterRender"),this},scrollTo:function(e){switch(typeof e){case"string":switch(e){case"top":n("#application-content").scrollTo("0px",{duration:400,interrupt:!0})}}},getCoverView:function(e){var t=n(this.coverListElementTemplate()),r=new o({className:"cover-body",model:e,issueId:e.get("id"),partId:e.get("parts").at(0).get("id"),viewTemplate:this.coverTemplate,strings:this.strings.coverView,viewOptions:this.viewOptions.subViewOptions.coverView});return this.addView.call(this,r,t),t},tappedCover:function(t){var n,i;if(!t)return e.trigger("setRoute",{route:"issues",trigger:!1}),this;t.setRoute=this.componentSetRoute,r.isRunningAsHybridApplication&&this.viewOptions.entryOptions.hybridRenderType?n=this.viewOptions.entryOptions.hybridRenderType:n=this.viewOptions.entryOptions.renderType,t.get("parts").length<2&&(n="pages"),i=t.get("id");switch(n){case"popup":e.trigger("popup:open",{openContent:function(n){e.trigger("setRoute",{route:"issues/"+i,trigger:!1}),e.trigger("issueEntry:open",{model:t,context:n})},closeContent:function(){e.trigger("setRoute",{route:"issues",trigger:!1}),e.trigger("issueEntry:close")}});break;case"entry":e.trigger("setRoute",{route:"entry/"+i,trigger:!0});break;case"pages":e.trigger("setRoute",{route:"pages/"+i,trigger:!0});break;case"reader":e.trigger("setRoute",{route:"reader/"+i,trigger:!0});break;default:e.trigger("setRoute",{route:"issues",trigger:!1})}return this},getCoversHTML:function(e){var r=n(this.coverListTemplate()),i=[],s;return t.each(e.models,function(e){if(this.downloadsOnly&&!e.get("downloaded")&&!e.get("downloading"))return!1;var t=e.get("parts").at(0);return t?(i.push(this.getCoverView(e)),!0):null},this),i.length>0?(r.html(i),n(r[0].childNodes[0]).addClass("first-cover"),this.noIssues=!1,r):(this.noIssues=!0,s={downloadsOnly:this.downloadsOnly,strings:this.strings.componentView},this.emptyListTemplate(s))}})}),define("vendor/text!coversCoverTemplate",[],function(){return'<% var pubdateIconText = StringUtility.replace(strings.formattedPubDate.iconText, {pubdate: DateUtility.dateToStringFormat(pubdate, viewOptions.dateFormat.issueMeta)}); %>\n<figure class="cover-object">\n    <div class="issue-overlay-container">\n        <img draggable="false" class="issue-image cover-image" src="" />\n\n        <div class="cover-icon-container bottom-right-icon">\n            <span class="progress-radial hidden">\n                <i class="overlay"></i>\n            </span>\n\n            <span class="cover-icon-btn download-icon-btn">\n                <i class="cover-icon download-icon <%= viewOptions.downloadIcon %>"></i>\n                <i class="cover-icon downloading-icon <%= viewOptions.downloadedingIcon %>"></i>\n                <i class="cover-icon unpack-icon <%= viewOptions.unpackIcon %>"></i>\n                <i class="cover-icon downloaded-icon <%= viewOptions.downloadedIcon %>"></i>\n                <i class="cover-icon removing-icon <%= viewOptions.removingIcon %>"></i>\n            </span>\n\n            <span class="cover-icon-btn tinySpinner hidden">\n                <i class="cover-icon im-icon im-icon-spinner im-icon-spin-right"></i>\n            </span>\n        </div>\n    </div>\n\n    <div class="issue-head cover-footer">\n        <p class="pub_date"><%= pubdateIconText %></p>\n    </div>\n\n    <div class="progress hidden">\n        <div class="progress-bar" role="progressbar" aria-valuenow="1" aria-valuemin="0" aria-valuemax="100" style="width: 1%;"></div>\n    </div>\n</figure>\n'}),"use strict",define("coversComponent",["app","underscore","backbone","stateService","issueService","dataService","authService","baseComponent","coversView","vendor/text!coversCoverTemplate"],function(e,t,n,r,i,s,o,u,a,f){var l=t.extend({},u),c=function(){n.on("covers:filter",function(){this.activeViews.length>0&&this.activeViews[0].filter(!0)},l),n.on("didEnterForeground",function(e){l.open({downloadsOnly:e?!1:!0})}),n.on("connectionchange",function(e){l.open({downloadsOnly:e?!1:!0})}),n.on("userFinishedAuthentication",function(e){l.open({downloadsOnly:!s.online()})})},h=function(){n.off("covers:filter"),n.off("didEnterForeground"),n.off("connectionchange")},p=function(){window.epaperClient=window.epaperClient||{},window.epaperClient.goToHome=function(){n.trigger("closeOpenFullscreen"),n.trigger("setRoute",{route:"issues",trigger:!0})},window.epaperClient.goToDownloadedIssues=function(){n.trigger("closeOpenFullscreen"),n.trigger("setRoute",{route:"issues/downloaded",trigger:!0})}};return p(),l.features=[],l.name="covers",l.routes={issues:function(){l.open({downloadsOnly:!1})},"issues/:issueId":function(e){l.open({downloadsOnly:!1,issueId:e})},"issues/downloaded":function(){l.open({downloadsOnly:!0})}},l.view=a,l.setRoute=function(e,t){l.router.setRoute({route:e,trigger:t})},l.open=function(t){var s=this;n.trigger("displayLoader",l.strings.componentView.loadingMessage),t=t||{},t.componentReady=c,i.letsDance(function(i){t.issueCollection=i,t.coverTemplate=f,t.componentSetRoute=l.setRoute,r.removeState(["issueId"]),e.renderComponentView(l,t,function(e){n.trigger("header:open",s.viewOptions.headerOptions||{}),n.trigger("footer:open"),n.trigger("info:open"),l.renderFeatures(),e.componentDone(t),l.ready(t.componentReady)})},function(){n.trigger("removeLoader")})},l.beforeClose=function(){h()},l.closeComponent=function(){e.closeComponent(l)},n.on(l.name+":open",l.open,l),n.on(l.name+":beforeClose",l.beforeClose,l),n.on(l.name+":close",l.closeComponent,l),l}),"use strict",define("deviceWaypointModel",["baseModel"],function(e){return e.extend({defaults:{noCancel:!1}})}),define("vendor/text!features/deviceWaypoint/templates/deviceWaypointTemplate.html",[],function(){return'<div class="device-waypoint-inner">\n\n    <div class="device-waypoint-inner-content">\n\n        <%\n            var storeName = ios ? strings.stores.ios : strings.stores.android,\n                link = ios ? stores.ios : stores.android,\n                title = strings.title.replace("{{store}}", storeName),\n                message = strings.message.replace("{{store}}", storeName),\n                confirmString = strings.confirm,\n                cancelString = strings.cancel,\n                windowsPhoneStrings = strings.windowsPhone ? strings.windowsPhone : {};\n\n            if (windowsPhone) {\n                title = windowsPhoneStrings.title ? windowsPhoneStrings.title : "This app is not supported to run on a Windows Phone";\n                message = windowsPhoneStrings.message ? windowsPhoneStrings.message : "";\n                link = windowsPhoneStrings.link;\n                confirmString = windowsPhoneStrings.confirm;\n                cancelString = windowsPhoneStrings.cancel;\n            }\n        %>\n\n        <h2><%= title %></h2>\n        <p><%= message %></p>\n\n        <div class="device-waypoint-actions">\n            <a class="confirm" href="<%= link %>"><%= confirmString %></a>\n            <% if (!noCancel) { %>\n            <a class="cancel"><%= cancelString %></a>\n            <% } %>\n\n            <div class="clearfix"></div>\n        </div>\n\n    </div>\n\n</div>\n'}),"use strict",define("deviceWaypointView",["backbone","baseFeatureView","deviceUtility","vendor/text!features/deviceWaypoint/templates/deviceWaypointTemplate.html"],function(e,t,n,r){return t.extend({className:"device-waypoint overlay",events:{"click .cancel":"cancel"},initialize:function(e){this.model.set({ios:n.isiOS(),android:n.isAndroid(),windowsPhone:n.isWindowsPhone()}),this.init(e),this.addHook.call(this,"afterRender",function(){this.stitch()&&this.$el.show()}),this.bindEvents()},cancel:function(){this.$el.hide()},bindEvents:function(){this.unbindEvents()},unbindEvents:function(){},render:function(){return this.$el.hide(),this.stitch()&&(this.$el.html(_.template(r)(this.templateModel)),this.$el.addClass(this.model.get("className"))),this},stitch:function(){return this.model.get("ios")&&this.model.get("stores").ios||this.model.get("android")&&this.model.get("stores").android||this.model.get("windowsPhone")}})}),"use strict",define("deviceWaypointFeature",["baseFeature","deviceWaypointModel","deviceWaypointView"],function(e,t,n){return function(){this.feature=_.extend({},e),this.feature.setView.call(this.feature,n).setModel.call(this.feature,new t)}}),"use strict",define("baseEventTriggerButtonModel",["backbone","baseFeatureModel","deviceUtility"],function(e,t,n){return t.extend({defaults:{enabled:!1},toggleEnabled:function(){this.set("enabled",!this.get("enabled"))},onTapped:function(){var t=this.get("eventPayload");return this.toggleEnabled(),e.trigger(this.get("eventToTrigger"),n.isRunningAsHybridApplication?t.native:t.web),this}})}),"use strict",define("eventTriggerButtonAModel",["backbone","baseEventTriggerButtonModel"],function(e,t){return t.extend()}),define("vendor/text!features/eventTriggerButton/baseEventTriggerButton/templates/baseEventTriggerButton.html",[],function(){return'<% if (iconName) { %>\n<span class="icon-link-icon">\n    <i class="<%= iconName %>"></i>\n    <% if (imgSrc) { %>\n    <img src="<%= imgSrc %>" />\n    <% } %>\n</span>\n<% } %>\n<% if (strings.iconText) { %>\n<span class="icon-link-text"><%= strings.iconText %></span>\n<% } %>\n\n\n'}),"use strict",define("baseEventTriggerButtonView",["baseFeatureView","vendor/text!features/eventTriggerButton/baseEventTriggerButton/templates/baseEventTriggerButton.html"],function(e,t){return e.extend({className:"trigger-event-button",template:t,events:{tap:"tap"},initialize:function(e){this.init(e),this.eventTriggerButtonTemplate=_.template(this.template),this.bindEvents()},tap:function(){this.model.tapped.call(this.model)},bindEvents:function(){this.model.set("enabled",!1),this.unbindEvents(),this.model.on("change:enabled",this.render,this)},unbindEvents:function(){this.model.off("change:enabled",this.render,this)},render:function(){return this.$el.addClass(this.model.get("className")),this.generateTemplateModel(),this.$el.html(this.eventTriggerButtonTemplate(this.templateModel)),this}})}),"use strict",define("eventTriggerButtonAView",["baseEventTriggerButtonView"],function(e){return e.extend({className:"trigger-event-button-a"})}),"use strict",define("eventTriggerButtonAFeature",["underscore","baseFeature","eventTriggerButtonAModel","eventTriggerButtonAView"],function(e,t,n,r){return function(){this.feature=e.extend({},t),this.feature.setView.call(this.feature,r).setModel.call(this.feature,new n)}}),"use strict",define("logoView",["backbone","underscore","baseFeatureView","deviceUtility"],function(e,t,n,r){return n.extend({className:"header-logo",tagName:"img",events:{tap:"tap"},initialize:function(e){this.init(e),this.bindEvents(),this.model.get("changeSrcOnSectionChange")?this.on("activeSectionChange",function(e){this.changeSrc(e)},this):this.model.changeSrc(this.model.get("defaultSrc"))},tap:function(){if(r.isEvenMoreBadAndroid()&&this.$el.css("pointer-events")==="none")return;this.model.tapped.call(this.model)},bindEvents:function(){return this.unbindEvents(),e.on("changeLogoSrc",this.model.changeSrc,this.model),this.model.on("change:src",this.setSrc,this),this},unbindEvents:function(){return this.model.off("change:src",this.setSrc,this),e.off("changeLogoSrc"),this},setSrc:function(){var e="";return this.model.get("src")&&(e=this.getImgUrl()),this.strings.text?(this.$el.addClass("has-text-logo"),this.$el.html($("<h1 id='logo-text'>").text(this.strings.text))):this.$el.attr("src",e),this},getImgUrl:function(){return this.model.get("path")+this.model.get("src")+"."+this.model.get("extension")},render:function(){return this.model.get("changeSrcOnSectionChange")&&this.model.unset("src",{silent:!0}),this.setSrc(),this}})}),"use strict",define("logoModel",["baseFeatureModel","jquery"],function(e,t){return e.extend({defaults:{changeSrcOnSectionChange:!1,path:"images/"},changeSrc:function(e){var n=this;e||(e=this.get("defaultSrc")),t.ajax({url:this.get("path")+e+"."+this.get("extension"),type:"GET",error:function(){n.set("src",n.get("fallbackSrc"))},success:function(){n.set("src",e)}})}})}),"use strict",define("logoFeature",["baseFeature","backbone","logoView","logoModel"],function(e,t,n,r){return function(){this.feature=_.extend({},e);var i=new r;i.onTapped=function(){return t.trigger("setRoute",{route:"issues",trigger:!0}),this},this.feature.setView.call(this.feature,n).setModel.call(this.feature,i)}}),function(e,t){typeof exports=="object"&&typeof module!="undefined"?module.exports=t():typeof define=="function"&&define.amd?define("moment",t):e.moment=t()}(this,function(){"use strict";function t(){return e.apply(null,arguments)}function n(t){e=t}function r(e){return e instanceof Array||Object.prototype.toString.call(e)==="[object Array]"}function i(e){return e!=null&&Object.prototype.toString.call(e)==="[object Object]"}function s(e){var t;for(t in e)return!1;return!0}function o(e){return e===void 0}function u(e){return typeof e=="number"||Object.prototype.toString.call(e)==="[object Number]"}function a(e){return e instanceof Date||Object.prototype.toString.call(e)==="[object Date]"}function f(e,t){var n=[],r;for(r=0;r<e.length;++r)n.push(t(e[r],r));return n}function l(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function c(e,t){for(var n in t)l(t,n)&&(e[n]=t[n]);return l(t,"toString")&&(e.toString=t.toString),l(t,"valueOf")&&(e.valueOf=t.valueOf),e}function h(e,t,n,r){return Rr(e,t,n,r,!0).utc()}function p(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function d(e){return e._pf==null&&(e._pf=p()),e._pf}function g(e){if(e._isValid==null){var t=d(e),n=m.call(t.parsedDateParts,function(e){return e!=null}),r=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidMonth&&!t.invalidWeekday&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&n);e._strict&&(r=r&&t.charsLeftOver===0&&t.unusedTokens.length===0&&t.bigHour===undefined);if(Object.isFrozen!=null&&!!Object.isFrozen(e))return r;e._isValid=r}return e._isValid}function y(e){var t=h(NaN);return e!=null?c(d(t),e):d(t).userInvalidated=!0,t}function w(e,t){var n,r,i;o(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),o(t._i)||(e._i=t._i),o(t._f)||(e._f=t._f),o(t._l)||(e._l=t._l),o(t._strict)||(e._strict=t._strict),o(t._tzm)||(e._tzm=t._tzm),o(t._isUTC)||(e._isUTC=t._isUTC),o(t._offset)||(e._offset=t._offset),o(t._pf)||(e._pf=d(t)),o(t._locale)||(e._locale=t._locale);if(b.length>0)for(n=0;n<b.length;n++)r=b[n],i=t[r],o(i)||(e[r]=i);return e}function S(e){w(this,e),this._d=new Date(e._d!=null?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),E===!1&&(E=!0,t.updateOffset(this),E=!1)}function x(e){return e instanceof S||e!=null&&e._isAMomentObject!=null}function T(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function N(e){var t=+e,n=0;return t!==0&&isFinite(t)&&(n=T(t)),n}function C(e,t,n){var r=Math.min(e.length,t.length),i=Math.abs(e.length-t.length),s=0,o;for(o=0;o<r;o++)(n&&e[o]!==t[o]||!n&&N(e[o])!==N(t[o]))&&s++;return s+i}function k(e){t.suppressDeprecationWarnings===!1&&typeof console!="undefined"&&console.warn&&console.warn("Deprecation warning: "+e)}function L(e,n){var r=!0;return c(function(){t.deprecationHandler!=null&&t.deprecationHandler(null,e);if(r){var i=[],s;for(var o=0;o<arguments.length;o++){s="";if(typeof arguments[o]=="object"){s+="\n["+o+"] ";for(var u in arguments[0])s+=u+": "+arguments[0][u]+", ";s=s.slice(0,-2)}else s=arguments[o];i.push(s)}k(e+"\nArguments: "+Array.prototype.slice.call(i).join("")+"\n"+(new Error).stack),r=!1}return n.apply(this,arguments)},n)}function O(e,n){t.deprecationHandler!=null&&t.deprecationHandler(e,n),A[e]||(k(n),A[e]=!0)}function M(e){return e instanceof Function||Object.prototype.toString.call(e)==="[object Function]"}function _(e){var t,n;for(n in e)t=e[n],M(t)?this[n]=t:this["_"+n]=t;this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function D(e,t){var n=c({},e),r;for(r in t)l(t,r)&&(i(e[r])&&i(t[r])?(n[r]={},c(n[r],e[r]),c(n[r],t[r])):t[r]!=null?n[r]=t[r]:delete n[r]);for(r in e)l(e,r)&&!l(t,r)&&i(e[r])&&(n[r]=c({},n[r]));return n}function P(e){e!=null&&this.set(e)}function F(e,t,n){var r=this._calendar[e]||this._calendar.sameElse;return M(r)?r.call(t,n):r}function q(e){var t=this._longDateFormat[e],n=this._longDateFormat[e.toUpperCase()];return t||!n?t:(this._longDateFormat[e]=n.replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)}),this._longDateFormat[e])}function U(){return this._invalidDate}function X(e){return this._ordinal.replace("%d",e)}function $(e,t,n,r){var i=this._relativeTime[n];return M(i)?i(e,t,n,r):i.replace(/%d/i,e)}function J(e,t){var n=this._relativeTime[e>0?"future":"past"];return M(n)?n(t):n.replace(/%s/i,t)}function Q(e,t){var n=e.toLowerCase();K[n]=K[n+"s"]=K[t]=e}function G(e){return typeof e=="string"?K[e]||K[e.toLowerCase()]:undefined}function Y(e){var t={},n,r;for(r in e)l(e,r)&&(n=G(r),n&&(t[n]=e[r]));return t}function et(e,t){Z[e]=t}function tt(e){var t=[];for(var n in e)t.push({unit:n,priority:Z[n]});return t.sort(function(e,t){return e.priority-t.priority}),t}function nt(e,n){return function(r){return r!=null?(it(this,e,r),t.updateOffset(this,n),this):rt(this,e)}}function rt(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function it(e,t,n){e.isValid()&&e._d["set"+(e._isUTC?"UTC":"")+t](n)}function st(e){return e=G(e),M(this[e])?this[e]():this}function ot(e,t){if(typeof e=="object"){e=Y(e);var n=tt(e);for(var r=0;r<n.length;r++)this[n[r].unit](e[n[r].unit])}else{e=G(e);if(M(this[e]))return this[e](t)}return this}function ut(e,t,n){var r=""+Math.abs(e),i=t-r.length,s=e>=0;return(s?n?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+r}function ht(e,t,n,r){var i=r;typeof r=="string"&&(i=function(){return this[r]()}),e&&(ct[e]=i),t&&(ct[t[0]]=function(){return ut(i.apply(this,arguments),t[1],t[2])}),n&&(ct[n]=function(){return this.localeData().ordinal(i.apply(this,arguments),e)})}function pt(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function dt(e){var t=e.match(at),n,r;for(n=0,r=t.length;n<r;n++)ct[t[n]]?t[n]=ct[t[n]]:t[n]=pt(t[n]);return function(n){var i="",s;for(s=0;s<r;s++)i+=M(t[s])?t[s].call(n,e):t[s];return i}}function vt(e,t){return e.isValid()?(t=mt(t,e.localeData()),lt[t]=lt[t]||dt(t),lt[t](e)):e.localeData().invalidDate()}function mt(e,t){function r(e){return t.longDateFormat(e)||e}var n=5;ft.lastIndex=0;while(n>=0&&ft.test(e))e=e.replace(ft,r),ft.lastIndex=0,n-=1;return e}function Ht(e,t,n){Pt[e]=M(t)?t:function(e,r){return e&&n?n:t}}function Bt(e,t){return l(Pt,e)?Pt[e](t._strict,t._locale):new RegExp(jt(e))}function jt(e){return Ft(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,n,r,i){return t||n||r||i}))}function Ft(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function qt(e,t){var n,r=t;typeof e=="string"&&(e=[e]),u(t)&&(r=function(e,n){n[t]=N(e)});for(n=0;n<e.length;n++)It[e[n]]=r}function Rt(e,t){qt(e,function(e,n,r,i){r._w=r._w||{},t(e,r._w,r,i)})}function Ut(e,t,n){t!=null&&l(It,e)&&It[e](t,n._a,n,e)}function en(e,t){return(new Date(Date.UTC(e,t+1,0))).getUTCDate()}function rn(e,t){return e?r(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||tn).test(t)?"format":"standalone"][e.month()]:r(this._months)?this._months:this._months.standalone}function on(e,t){return e?r(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[tn.test(t)?"format":"standalone"][e.month()]:r(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function un(e,t,n){var r,i,s,o=e.toLocaleLowerCase();if(!this._monthsParse){this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[];for(r=0;r<12;++r)s=h([2e3,r]),this._shortMonthsParse[r]=this.monthsShort(s,"").toLocaleLowerCase(),this._longMonthsParse[r]=this.months(s,"").toLocaleLowerCase()}return n?t==="MMM"?(i=Zt.call(this._shortMonthsParse,o),i!==-1?i:null):(i=Zt.call(this._longMonthsParse,o),i!==-1?i:null):t==="MMM"?(i=Zt.call(this._shortMonthsParse,o),i!==-1?i:(i=Zt.call(this._longMonthsParse,o),i!==-1?i:null)):(i=Zt.call(this._longMonthsParse,o),i!==-1?i:(i=Zt.call(this._shortMonthsParse,o),i!==-1?i:null))}function an(e,t,n){var r,i,s;if(this._monthsParseExact)return un.call(this,e,t,n);this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]);for(r=0;r<12;r++){i=h([2e3,r]),n&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!n&&!this._monthsParse[r]&&(s="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[r]=new RegExp(s.replace(".",""),"i"));if(n&&t==="MMMM"&&this._longMonthsParse[r].test(e))return r;if(n&&t==="MMM"&&this._shortMonthsParse[r].test(e))return r;if(!n&&this._monthsParse[r].test(e))return r}}function fn(e,t){var n;if(!e.isValid())return e;if(typeof t=="string")if(/^\d+$/.test(t))t=N(t);else{t=e.localeData().monthsParse(t);if(!u(t))return e}return n=Math.min(e.date(),en(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,n),e}function ln(e){return e!=null?(fn(this,e),t.updateOffset(this,!0),this):rt(this,"Month")}function cn(){return en(this.year(),this.month())}function pn(e){return this._monthsParseExact?(l(this,"_monthsRegex")||mn.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(l(this,"_monthsShortRegex")||(this._monthsShortRegex=hn),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)}function vn(e){return this._monthsParseExact?(l(this,"_monthsRegex")||mn.call(this),e?this._monthsStrictRegex:this._monthsRegex):(l(this,"_monthsRegex")||(this._monthsRegex=dn),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)}function mn(){function e(e,t){return t.length-e.length}var t=[],n=[],r=[],i,s;for(i=0;i<12;i++)s=h([2e3,i]),t.push(this.monthsShort(s,"")),n.push(this.months(s,"")),r.push(this.months(s,"")),r.push(this.monthsShort(s,""));t.sort(e),n.sort(e),r.sort(e);for(i=0;i<12;i++)t[i]=Ft(t[i]),n[i]=Ft(n[i]);for(i=0;i<24;i++)r[i]=Ft(r[i]);this._monthsRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+t.join("|")+")","i")}function gn(e){return yn(e)?366:365}function yn(e){return e%4===0&&e%100!==0||e%400===0}function wn(){return yn(this.year())}function En(e,t,n,r,i,s,o){var u=new Date(e,t,n,r,i,s,o);return e<100&&e>=0&&isFinite(u.getFullYear())&&u.setFullYear(e),u}function Sn(e){var t=new Date(Date.UTC.apply(null,arguments));return e<100&&e>=0&&isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e),t}function xn(e,t,n){var r=7+t-n,i=(7+Sn(e,0,r).getUTCDay()-t)%7;return-i+r-1}function Tn(e,t,n,r,i){var s=(7+n-r)%7,o=xn(e,r,i),u=1+7*(t-1)+s+o,a,f;return u<=0?(a=e-1,f=gn(a)+u):u>gn(e)?(a=e+1,f=u-gn(e)):(a=e,f=u),{year:a,dayOfYear:f}}function Nn(e,t,n){var r=xn(e.year(),t,n),i=Math.floor((e.dayOfYear()-r-1)/7)+1,s,o;return i<1?(o=e.year()-1,s=i+Cn(o,t,n)):i>Cn(e.year(),t,n)?(s=i-Cn(e.year(),t,n),o=e.year()+1):(o=e.year(),s=i),{week:s,year:o}}function Cn(e,t,n){var r=xn(e,t,n),i=xn(e+1,t,n);return(gn(e)-r+i)/7}function kn(e){return Nn(e,this._week.dow,this._week.doy).week}function An(){return this._week.dow}function On(){return this._week.doy}function Mn(e){var t=this.localeData().week(this);return e==null?t:this.add((e-t)*7,"d")}function _n(e){var t=Nn(this,1,4).week;return e==null?t:this.add((e-t)*7,"d")}function Dn(e,t){return typeof e!="string"?e:isNaN(e)?(e=t.weekdaysParse(e),typeof e=="number"?e:null):parseInt(e,10)}function Pn(e,t){return typeof e=="string"?t.weekdaysParse(e)%7||7:isNaN(e)?null:e}function Bn(e,t){return e?r(this._weekdays)?this._weekdays[e.day()]:this._weekdays[this._weekdays.isFormat.test(t)?"format":"standalone"][e.day()]:r(this._weekdays)?this._weekdays:this._weekdays.standalone}function Fn(e){return e?this._weekdaysShort[e.day()]:this._weekdaysShort}function qn(e){return e?this._weekdaysMin[e.day()]:this._weekdaysMin}function Rn(e,t,n){var r,i,s,o=e.toLocaleLowerCase();if(!this._weekdaysParse){this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[];for(r=0;r<7;++r)s=h([2e3,1]).day(r),this._minWeekdaysParse[r]=this.weekdaysMin(s,"").toLocaleLowerCase(),this._shortWeekdaysParse[r]=this.weekdaysShort(s,"").toLocaleLowerCase(),this._weekdaysParse[r]=this.weekdays(s,"").toLocaleLowerCase()}return n?t==="dddd"?(i=Zt.call(this._weekdaysParse,o),i!==-1?i:null):t==="ddd"?(i=Zt.call(this._shortWeekdaysParse,o),i!==-1?i:null):(i=Zt.call(this._minWeekdaysParse,o),i!==-1?i:null):t==="dddd"?(i=Zt.call(this._weekdaysParse,o),i!==-1?i:(i=Zt.call(this._shortWeekdaysParse,o),i!==-1?i:(i=Zt.call(this._minWeekdaysParse,o),i!==-1?i:null))):t==="ddd"?(i=Zt.call(this._shortWeekdaysParse,o),i!==-1?i:(i=Zt.call(this._weekdaysParse,o),i!==-1?i:(i=Zt.call(this._minWeekdaysParse,o),i!==-1?i:null))):(i=Zt.call(this._minWeekdaysParse,o),i!==-1?i:(i=Zt.call(this._weekdaysParse,o),i!==-1?i:(i=Zt.call(this._shortWeekdaysParse,o),i!==-1?i:null)))}function Un(e,t,n){var r,i,s;if(this._weekdaysParseExact)return Rn.call(this,e,t,n);this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]);for(r=0;r<7;r++){i=h([2e3,1]).day(r),n&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(i,"").replace(".",".?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(i,"").replace(".",".?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(i,"").replace(".",".?")+"$","i")),this._weekdaysParse[r]||(s="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[r]=new RegExp(s.replace(".",""),"i"));if(n&&t==="dddd"&&this._fullWeekdaysParse[r].test(e))return r;if(n&&t==="ddd"&&this._shortWeekdaysParse[r].test(e))return r;if(n&&t==="dd"&&this._minWeekdaysParse[r].test(e))return r;if(!n&&this._weekdaysParse[r].test(e))return r}}function zn(e){if(!this.isValid())return e!=null?this:NaN;var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return e!=null?(e=Dn(e,this.localeData()),this.add(e-t,"d")):t}function Wn(e){if(!this.isValid())return e!=null?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return e==null?t:this.add(e-t,"d")}function Xn(e){if(!this.isValid())return e!=null?this:NaN;if(e!=null){var t=Pn(e,this.localeData());return this.day(this.day()%7?t:t-7)}return this.day()||7}function $n(e){return this._weekdaysParseExact?(l(this,"_weekdaysRegex")||Yn.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(l(this,"_weekdaysRegex")||(this._weekdaysRegex=Vn),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)}function Kn(e){return this._weekdaysParseExact?(l(this,"_weekdaysRegex")||Yn.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(l(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Jn),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function Gn(e){return this._weekdaysParseExact?(l(this,"_weekdaysRegex")||Yn.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(l(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Qn),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function Yn(){function e(e,t){return t.length-e.length}var t=[],n=[],r=[],i=[],s,o,u,a,f;for(s=0;s<7;s++)o=h([2e3,1]).day(s),u=this.weekdaysMin(o,""),a=this.weekdaysShort(o,""),f=this.weekdays(o,""),t.push(u),n.push(a),r.push(f),i.push(u),i.push(a),i.push(f);t.sort(e),n.sort(e),r.sort(e),i.sort(e);for(s=0;s<7;s++)n[s]=Ft(n[s]),r[s]=Ft(r[s]),i[s]=Ft(i[s]);this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+t.join("|")+")","i")}function Zn(){return this.hours()%12||12}function er(){return this.hours()||24}function tr(e,t){ht(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}function nr(e,t){return t._meridiemParse}function rr(e){return(e+"").toLowerCase().charAt(0)==="p"}function sr(e,t,n){return e>11?n?"pm":"PM":n?"am":"AM"}function cr(e){return e?e.toLowerCase().replace("_","-"):e}function hr(e){var t=0,n,r,i,s;while(t<e.length){s=cr(e[t]).split("-"),n=s.length,r=cr(e[t+1]),r=r?r.split("-"):null;while(n>0){i=pr(s.slice(0,n).join("-"));if(i)return i;if(r&&r.length>=n&&C(s,r,!0)>=n-1)break;n--}t++}return null}function pr(e){var t=null;if(!ar[e]&&typeof module!="undefined"&&module&&module.exports)try{t=lr._abbr,require("./locale/"+e),dr(t)}catch(n){}return ar[e]}function dr(e,t){var n;return e&&(o(t)?n=gr(e):n=vr(e,t),n&&(lr=n)),lr._abbr}function vr(e,t){if(t!==null){var n=ur;t.abbr=e;if(ar[e]!=null)O("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=ar[e]._config;else if(t.parentLocale!=null){if(ar[t.parentLocale]==null)return fr[t.parentLocale]||(fr[t.parentLocale]=[]),fr[t.parentLocale].push({name:e,config:t}),null;n=ar[t.parentLocale]._config}return ar[e]=new P(D(n,t)),fr[e]&&fr[e].forEach(function(e){vr(e.name,e.config)}),dr(e),ar[e]}return delete ar[e],null}function mr(e,t){if(t!=null){var n,r=ur;ar[e]!=null&&(r=ar[e]._config),t=D(r,t),n=new P(t),n.parentLocale=ar[e],ar[e]=n,dr(e)}else ar[e]!=null&&(ar[e].parentLocale!=null?ar[e]=ar[e].parentLocale:ar[e]!=null&&delete ar[e]);return ar[e]}function gr(e){var t;e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr);if(!e)return lr;if(!r(e)){t=pr(e);if(t)return t;e=[e]}return hr(e)}function yr(){return B(ar)}function br(e){var t,n=e._a;return n&&d(e).overflow===-2&&(t=n[Wt]<0||n[Wt]>11?Wt:n[Xt]<1||n[Xt]>en(n[zt],n[Wt])?Xt:n[Vt]<0||n[Vt]>24||n[Vt]===24&&(n[$t]!==0||n[Jt]!==0||n[Kt]!==0)?Vt:n[$t]<0||n[$t]>59?$t:n[Jt]<0||n[Jt]>59?Jt:n[Kt]<0||n[Kt]>999?Kt:-1,d(e)._overflowDayOfYear&&(t<zt||t>Xt)&&(t=Xt),d(e)._overflowWeeks&&t===-1&&(t=Qt),d(e)._overflowWeekday&&t===-1&&(t=Gt),d(e).overflow=t),e}function Cr(e){var t,n,r=e._i,i=wr.exec(r)||Er.exec(r),s,o,u,a;if(i){d(e).iso=!0;for(t=0,n=xr.length;t<n;t++)if(xr[t][1].exec(i[1])){o=xr[t][0],s=xr[t][2]!==!1;break}if(o==null){e._isValid=!1;return}if(i[3]){for(t=0,n=Tr.length;t<n;t++)if(Tr[t][1].exec(i[3])){u=(i[2]||" ")+Tr[t][0];break}if(u==null){e._isValid=!1;return}}if(!s&&u!=null){e._isValid=!1;return}if(i[4]){if(!Sr.exec(i[4])){e._isValid=!1;return}a="Z"}e._f=o+(u||"")+(a||""),Pr(e)}else e._isValid=!1}function Lr(e){var t,n,r,i,s,o,u={" GMT":" +0000"," EDT":" -0400"," EST":" -0500"," CDT":" -0500"," CST":" -0600"," MDT":" -0600"," MST":" -0700"," PDT":" -0700"," PST":" -0800"},a="YXWVUTSRQPONZABCDEFGHIKLM",f,l;t=e._i.replace(/\([^\)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s|\s$/g,""),n=kr.exec(t);if(n){r=n[1]?"ddd"+(n[1].length===5?", ":" "):"",i="D MMM "+(n[2].length>10?"YYYY ":"YY "),s="HH:mm"+(n[4]?":ss":"");if(n[1]){var c=new Date(n[2]),h=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][c.getDay()];if(n[1].substr(0,3)!==h){d(e).weekdayMismatch=!0,e._isValid=!1;return}}switch(n[5].length){case 2:l===0?f=" +0000":(l=a.indexOf(n[5][1].toUpperCase())-12,f=(l<0?" -":" +")+(""+l).replace(/^-?/,"0").match(/..$/)[0]+"00");break;case 4:f=u[n[5]];break;default:f=u[" GMT"]}n[5]=f,e._i=n.splice(1).join(""),o=" ZZ",e._f=r+i+s+o,Pr(e),d(e).rfc2822=!0}else e._isValid=!1}function Ar(e){var n=Nr.exec(e._i);if(n!==null){e._d=new Date(+n[1]);return}Cr(e);if(e._isValid!==!1)return;delete e._isValid,Lr(e);if(e._isValid!==!1)return;delete e._isValid,t.createFromInputFallback(e)}function Or(e,t,n){return e!=null?e:t!=null?t:n}function Mr(e){var n=new Date(t.now());return e._useUTC?[n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate()]:[n.getFullYear(),n.getMonth(),n.getDate()]}function _r(e){var t,n,r=[],i,s;if(e._d)return;i=Mr(e),e._w&&e._a[Xt]==null&&e._a[Wt]==null&&Dr(e);if(e._dayOfYear!=null){s=Or(e._a[zt],i[zt]);if(e._dayOfYear>gn(s)||e._dayOfYear===0)d(e)._overflowDayOfYear=!0;n=Sn(s,0,e._dayOfYear),e._a[Wt]=n.getUTCMonth(),e._a[Xt]=n.getUTCDate()}for(t=0;t<3&&e._a[t]==null;++t)e._a[t]=r[t]=i[t];for(;t<7;t++)e._a[t]=r[t]=e._a[t]==null?t===2?1:0:e._a[t];e._a[Vt]===24&&e._a[$t]===0&&e._a[Jt]===0&&e._a[Kt]===0&&(e._nextDay=!0,e._a[Vt]=0),e._d=(e._useUTC?Sn:En).apply(null,r),e._tzm!=null&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[Vt]=24)}function Dr(e){var t,n,r,i,s,o,u,a;t=e._w;if(t.GG!=null||t.W!=null||t.E!=null){s=1,o=4,n=Or(t.GG,e._a[zt],Nn(Ur(),1,4).year),r=Or(t.W,1),i=Or(t.E,1);if(i<1||i>7)a=!0}else{s=e._locale._week.dow,o=e._locale._week.doy;var f=Nn(Ur(),s,o);n=Or(t.gg,e._a[zt],f.year),r=Or(t.w,f.week);if(t.d!=null){i=t.d;if(i<0||i>6)a=!0}else if(t.e!=null){i=t.e+s;if(t.e<0||t.e>6)a=!0}else i=s}r<1||r>Cn(n,s,o)?d(e)._overflowWeeks=!0:a!=null?d(e)._overflowWeekday=!0:(u=Tn(n,r,i,s,o),e._a[zt]=u.year,e._dayOfYear=u.dayOfYear)}function Pr(e){if(e._f===t.ISO_8601){Cr(e);return}if(e._f===t.RFC_2822){Lr(e);return}e._a=[],d(e).empty=!0;var n=""+e._i,r,i,s,o,u,a=n.length,f=0;s=mt(e._f,e._locale).match(at)||[];for(r=0;r<s.length;r++)o=s[r],i=(n.match(Bt(o,e))||[])[0],i&&(u=n.substr(0,n.indexOf(i)),u.length>0&&d(e).unusedInput.push(u),n=n.slice(n.indexOf(i)+i.length),f+=i.length),ct[o]?(i?d(e).empty=!1:d(e).unusedTokens.push(o),Ut(o,i,e)):e._strict&&!i&&d(e).unusedTokens.push(o);d(e).charsLeftOver=a-f,n.length>0&&d(e).unusedInput.push(n),e._a[Vt]<=12&&d(e).bigHour===!0&&e._a[Vt]>0&&(d(e).bigHour=undefined),d(e).parsedDateParts=e._a.slice(0),d(e).meridiem=e._meridiem,e._a[Vt]=Hr(e._locale,e._a[Vt],e._meridiem),_r(e),br(e)}function Hr(e,t,n){var r;return n==null?t:e.meridiemHour!=null?e.meridiemHour(t,n):e.isPM!=null?(r=e.isPM(n),r&&t<12&&(t+=12),!r&&t===12&&(t=0),t):t}function Br(e){var t,n,r,i,s;if(e._f.length===0){d(e).invalidFormat=!0,e._d=new Date(NaN);return}for(i=0;i<e._f.length;i++){s=0,t=w({},e),e._useUTC!=null&&(t._useUTC=e._useUTC),t._f=e._f[i],Pr(t);if(!g(t))continue;s+=d(t).charsLeftOver,s+=d(t).unusedTokens.length*10,d(t).score=s;if(r==null||s<r)r=s,n=t}c(e,n||t)}function jr(e){if(e._d)return;var t=Y(e._i);e._a=f([t.year,t.month,t.day||t.date,t.hour,t.minute,t.second,t.millisecond],function(e){return e&&parseInt(e,10)}),_r(e)}function Fr(e){var t=new S(br(Ir(e)));return t._nextDay&&(t.add(1,"d"),t._nextDay=undefined),t}function Ir(e){var t=e._i,n=e._f;return e._locale=e._locale||gr(e._l),t===null||n===undefined&&t===""?y({nullInput:!0}):(typeof t=="string"&&(e._i=t=e._locale.preparse(t)),x(t)?new S(br(t)):(a(t)?e._d=t:r(n)?Br(e):n?Pr(e):qr(e),g(e)||(e._d=null),e))}function qr(e){var n=e._i;o(n)?e._d=new Date(t.now()):a(n)?e._d=new Date(n.valueOf()):typeof n=="string"?Ar(e):r(n)?(e._a=f(n.slice(0),function(e){return parseInt(e,10)}),_r(e)):i(n)?jr(e):u(n)?e._d=new Date(n):t.createFromInputFallback(e)}function Rr(e,t,n,o,u){var a={};if(n===!0||n===!1)o=n,n=undefined;if(i(e)&&s(e)||r(e)&&e.length===0)e=undefined;return a._isAMomentObject=!0,a._useUTC=a._isUTC=u,a._l=n,a._i=e,a._f=t,a._strict=o,Fr(a)}function Ur(e,t,n,r){return Rr(e,t,n,r,!1)}function Xr(e,t){var n,i;t.length===1&&r(t[0])&&(t=t[0]);if(!t.length)return Ur();n=t[0];for(i=1;i<t.length;++i)if(!t[i].isValid()||t[i][e](n))n=t[i];return n}function Vr(){var e=[].slice.call(arguments,0);return Xr("isBefore",e)}function $r(){var e=[].slice.call(arguments,0);return Xr("isAfter",e)}function Qr(e){for(var t in e)if(Kr.indexOf(t)===-1||e[t]!=null&&!!isNaN(e[t]))return!1;var n=!1;for(var r=0;r<Kr.length;++r)if(e[Kr[r]]){if(n)return!1;parseFloat(e[Kr[r]])!==N(e[Kr[r]])&&(n=!0)}return!0}function Gr(){return this._isValid}function Yr(){return wi(NaN)}function Zr(e){var t=Y(e),n=t.year||0,r=t.quarter||0,i=t.month||0,s=t.week||0,o=t.day||0,u=t.hour||0,a=t.minute||0,f=t.second||0,l=t.millisecond||0;this._isValid=Qr(t),this._milliseconds=+l+f*1e3+a*6e4+u*1e3*60*60,this._days=+o+s*7,this._months=+i+r*3+n*12,this._data={},this._locale=gr(),this._bubble()}function ei(e){return e instanceof Zr}function ti(e){return e<0?Math.round(-1*e)*-1:Math.round(e)}function ni(e,t){ht(e,0,0,function(){var e=this.utcOffset(),n="+";return e<0&&(e=-e,n="-"),n+ut(~~(e/60),2)+t+ut(~~e%60,2)})}function ii(e,t){var n=(t||"").match(e);if(n===null)return null;var r=n[n.length-1]||[],i=(r+"").match(ri)||["-",0,0],s=+(i[1]*60)+N(i[2]);return s===0?0:i[0]==="+"?s:-s}function si(e,n){var r,i;return n._isUTC?(r=n.clone(),i=(x(e)||a(e)?e.valueOf():Ur(e).valueOf())-r.valueOf(),r._d.setTime(r._d.valueOf()+i),t.updateOffset(r,!1),r):Ur(e).local()}function oi(e){return-Math.round(e._d.getTimezoneOffset()/15)*15}function ui(e,n,r){var i=this._offset||0,s;if(!this.isValid())return e!=null?this:NaN;if(e!=null){if(typeof e=="string"){e=ii(Mt,e);if(e===null)return this}else Math.abs(e)<16&&!r&&(e*=60);return!this._isUTC&&n&&(s=oi(this)),this._offset=e,this._isUTC=!0,s!=null&&this.add(s,"m"),i!==e&&(!n||this._changeInProgress?Ni(this,wi(e-i,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,t.updateOffset(this,!0),this._changeInProgress=null)),this}return this._isUTC?i:oi(this)}function ai(e,t){return e!=null?(typeof e!="string"&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}function fi(e){return this.utcOffset(0,e)}function li(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(oi(this),"m")),this}function ci(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var e=ii(Ot,this._i);e!=null?this.utcOffset(e):this.utcOffset(0,!0)}return this}function hi(e){return this.isValid()?(e=e?Ur(e).utcOffset():0,(this.utcOffset()-e)%60===0):!1}function pi(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function di(){if(!o(this._isDSTShifted))return this._isDSTShifted;var e={};w(e,this),e=Ir(e);if(e._a){var t=e._isUTC?h(e._a):Ur(e._a);this._isDSTShifted=this.isValid()&&C(e._a,t.toArray())>0}else this._isDSTShifted=!1;return this._isDSTShifted}function vi(){return this.isValid()?!this._isUTC:!1}function mi(){return this.isValid()?this._isUTC:!1}function gi(){return this.isValid()?this._isUTC&&this._offset===0:!1}function wi(e,t){var n=e,r=null,i,s,o;return ei(e)?n={ms:e._milliseconds,d:e._days,M:e._months}:u(e)?(n={},t?n[t]=e:n.milliseconds=e):(r=yi.exec(e))?(i=r[1]==="-"?-1:1,n={y:0,d:N(r[Xt])*i,h:N(r[Vt])*i,m:N(r[$t])*i,s:N(r[Jt])*i,ms:N(ti(r[Kt]*1e3))*i}):(r=bi.exec(e))?(i=r[1]==="-"?-1:1,n={y:Ei(r[2],i),M:Ei(r[3],i),w:Ei(r[4],i),d:Ei(r[5],i),h:Ei(r[6],i),m:Ei(r[7],i),s:Ei(r[8],i)}):n==null?n={}:typeof n=="object"&&("from"in n||"to"in n)&&(o=xi(Ur(n.from),Ur(n.to)),n={},n.ms=o.milliseconds,n.M=o.months),s=new Zr(n),ei(e)&&l(e,"_locale")&&(s._locale=e._locale),s}function Ei(e,t){var n=e&&parseFloat(e.replace(",","."));return(isNaN(n)?0:n)*t}function Si(e,t){var n={milliseconds:0,months:0};return n.months=t.month()-e.month()+(t.year()-e.year())*12,e.clone().add(n.months,"M").isAfter(t)&&--n.months,n.milliseconds=+t- +e.clone().add(n.months,"M"),n}function xi(e,t){var n;return!e.isValid()||!t.isValid()?{milliseconds:0,months:0}:(t=si(t,e),e.isBefore(t)?n=Si(e,t):(n=Si(t,e),n.milliseconds=-n.milliseconds,n.months=-n.months),n)}function Ti(e,t){return function(n,r){var i,s;return r!==null&&!isNaN(+r)&&(O(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period). "+"See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),s=n,n=r,r=s),n=typeof n=="string"?+n:n,i=wi(n,r),Ni(this,i,e),this}}function Ni(e,n,r,i){var s=n._milliseconds,o=ti(n._days),u=ti(n._months);if(!e.isValid())return;i=i==null?!0:i,s&&e._d.setTime(e._d.valueOf()+s*r),o&&it(e,"Date",rt(e,"Date")+o*r),u&&fn(e,rt(e,"Month")+u*r),i&&t.updateOffset(e,o||u)}function Li(e,t){var n=e.diff(t,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"}function Ai(e,n){var r=e||Ur(),i=si(r,this).startOf("day"),s=t.calendarFormat(this,i)||"sameElse",o=n&&(M(n[s])?n[s].call(this,r):n[s]);return this.format(o||this.localeData().calendar(s,this,Ur(r)))}function Oi(){return new S(this)}function Mi(e,t){var n=x(e)?e:Ur(e);return!this.isValid()||!n.isValid()?!1:(t=G(o(t)?"millisecond":t),t==="millisecond"?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(t).valueOf())}function _i(e,t){var n=x(e)?e:Ur(e);return!this.isValid()||!n.isValid()?!1:(t=G(o(t)?"millisecond":t),t==="millisecond"?this.valueOf()<n.valueOf():this.clone().endOf(t).valueOf()<n.valueOf())}function Di(e,t,n,r){return r=r||"()",(r[0]==="("?this.isAfter(e,n):!this.isBefore(e,n))&&(r[1]===")"?this.isBefore(t,n):!this.isAfter(t,n))}function Pi(e,t){var n=x(e)?e:Ur(e),r;return!this.isValid()||!n.isValid()?!1:(t=G(t||"millisecond"),t==="millisecond"?this.valueOf()===n.valueOf():(r=n.valueOf(),this.clone().startOf(t).valueOf()<=r&&r<=this.clone().endOf(t).valueOf()))}function Hi(e,t){return this.isSame(e,t)||this.isAfter(e,t)}function Bi(e,t){return this.isSame(e,t)||this.isBefore(e,t)}function ji(e,t,n){var r,i,s,o;return this.isValid()?(r=si(e,this),r.isValid()?(i=(r.utcOffset()-this.utcOffset())*6e4,t=G(t),t==="year"||t==="month"||t==="quarter"?(o=Fi(this,r),t==="quarter"?o/=3:t==="year"&&(o/=12)):(s=this-r,o=t==="second"?s/1e3:t==="minute"?s/6e4:t==="hour"?s/36e5:t==="day"?(s-i)/864e5:t==="week"?(s-i)/6048e5:s),n?o:T(o)):NaN):NaN}function Fi(e,t){var n=(t.year()-e.year())*12+(t.month()-e.month()),r=e.clone().add(n,"months"),i,s;return t-r<0?(i=e.clone().add(n-1,"months"),s=(t-r)/(r-i)):(i=e.clone().add(n+1,"months"),s=(t-r)/(i-r)),-(n+s)||0}function Ii(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function qi(){if(!this.isValid())return null;var e=this.clone().utc();return e.year()<0||e.year()>9999?vt(e,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):M(Date.prototype.toISOString)?this.toDate().toISOString():vt(e,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]")}function Ri(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e="moment",t="";this.isLocal()||(e=this.utcOffset()===0?"moment.utc":"moment.parseZone",t="Z");var n="["+e+'("]',r=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",s=t+'[")]';return this.format(n+r+i+s)}function Ui(e){e||(e=this.isUtc()?t.defaultFormatUtc:t.defaultFormat);var n=vt(this,e);return this.localeData().postformat(n)}function zi(e,t){return this.isValid()&&(x(e)&&e.isValid()||Ur(e).isValid())?wi({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function Wi(e){return this.from(Ur(),e)}function Xi(e,t){return this.isValid()&&(x(e)&&e.isValid()||Ur(e).isValid())?wi({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function Vi(e){return this.to(Ur(),e)}function $i(e){var t;return e===undefined?this._locale._abbr:(t=gr(e),t!=null&&(this._locale=t),this)}function Ki(){return this._locale}function Qi(e){e=G(e);switch(e){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":case"date":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return e==="week"&&this.weekday(0),e==="isoWeek"&&this.isoWeekday(1),e==="quarter"&&this.month(Math.floor(this.month()/3)*3),this}function Gi(e){return e=G(e),e===undefined||e==="millisecond"?this:(e==="date"&&(e="day"),this.startOf(e).add(1,e==="isoWeek"?"week":e).subtract(1,"ms"))}function Yi(){return this._d.valueOf()-(this._offset||0)*6e4}function Zi(){return Math.floor(this.valueOf()/1e3)}function es(){return new Date(this.valueOf())}function ts(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function ns(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function rs(){return this.isValid()?this.toISOString():null}function is(){return g(this)}function ss(){return c({},d(this))}function os(){return d(this).overflow}function us(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}function as(e,t){ht(0,[e,e.length],0,t)}function fs(e){return ps.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function ls(e){return ps.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function cs(){return Cn(this.year(),1,4)}function hs(){var e=this.localeData()._week;return Cn(this.year(),e.dow,e.doy)}function ps(e,t,n,r,i){var s;return e==null?Nn(this,r,i).year:(s=Cn(e,r,i),t>s&&(t=s),ds.call(this,e,t,n,r,i))}function ds(e,t,n,r,i){var s=Tn(e,t,n,r,i),o=Sn(s.year,0,s.dayOfYear);return this.year(o.getUTCFullYear()),this.month(o.getUTCMonth()),this.date(o.getUTCDate()),this}function vs(e){return e==null?Math.ceil((this.month()+1)/3):this.month((e-1)*3+this.month()%3)}function gs(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return e==null?t:this.add(e-t,"d")}function Es(e,t){t[Kt]=N(("0."+e)*1e3)}function xs(){return this._isUTC?"UTC":""}function Ts(){return this._isUTC?"Coordinated Universal Time":""}function Cs(e){return Ur(e*1e3)}function ks(){return Ur.apply(null,arguments).parseZone()}function Ls(e){return e}function Os(e,t,n,r){var i=gr(),s=h().set(r,t);return i[n](s,e)}function Ms(e,t,n){u(e)&&(t=e,e=undefined),e=e||"";if(t!=null)return Os(e,t,n,"month");var r,i=[];for(r=0;r<12;r++)i[r]=Os(e,r,n,"month");return i}function _s(e,t,n,r){typeof e=="boolean"?(u(t)&&(n=t,t=undefined),t=t||""):(t=e,n=t,e=!1,u(t)&&(n=t,t=undefined),t=t||"");var i=gr(),s=e?i._week.dow:0;if(n!=null)return Os(t,(n+s)%7,r,"day");var o,a=[];for(o=0;o<7;o++)a[o]=Os(t,(o+s)%7,r,"day");return a}function Ds(e,t){return Ms(e,t,"months")}function Ps(e,t){return Ms(e,t,"monthsShort")}function Hs(e,t,n){return _s(e,t,n,"weekdays")}function Bs(e,t,n){return _s(e,t,n,"weekdaysShort")}function js(e,t,n){return _s(e,t,n,"weekdaysMin")}function Is(){var e=this._data;return this._milliseconds=Fs(this._milliseconds),this._days=Fs(this._days),this._months=Fs(this._months),e.milliseconds=Fs(e.milliseconds),e.seconds=Fs(e.seconds),e.minutes=Fs(e.minutes),e.hours=Fs(e.hours),e.months=Fs(e.months),e.years=Fs(e.years),this}function qs(e,t,n,r){var i=wi(t,n);return e._milliseconds+=r*i._milliseconds,e._days+=r*i._days,e._months+=r*i._months,e._bubble()}function Rs(e,t){return qs(this,e,t,1)}function Us(e,t){return qs(this,e,t,-1)}function zs(e){return e<0?Math.floor(e):Math.ceil(e)}function Ws(){var e=this._milliseconds,t=this._days,n=this._months,r=this._data,i,s,o,u,a;return e>=0&&t>=0&&n>=0||e<=0&&t<=0&&n<=0||(e+=zs(Vs(n)+t)*864e5,t=0,n=0),r.milliseconds=e%1e3,i=T(e/1e3),r.seconds=i%60,s=T(i/60),r.minutes=s%60,o=T(s/60),r.hours=o%24,t+=T(o/24),a=T(Xs(t)),n+=a,t-=zs(Vs(a)),u=T(n/12),n%=12,r.days=t,r.months=n,r.years=u,this}function Xs(e){return e*4800/146097}function Vs(e){return e*146097/4800}function $s(e){if(!this.isValid())return NaN;var t,n,r=this._milliseconds;e=G(e);if(e==="month"||e==="year")return t=this._days+r/864e5,n=this._months+Xs(t),e==="month"?n:n/12;t=this._days+Math.round(Vs(this._months));switch(e){case"week":return t/7+r/6048e5;case"day":return t+r/864e5;case"hour":return t*24+r/36e5;case"minute":return t*1440+r/6e4;case"second":return t*86400+r/1e3;case"millisecond":return Math.floor(t*864e5)+r;default:throw new Error("Unknown unit "+e)}}function Js(){return this.isValid()?this._milliseconds+this._days*864e5+this._months%12*2592e6+N(this._months/12)*31536e6:NaN}function Ks(e){return function(){return this.as(e)}}function io(e){return e=G(e),this.isValid()?this[e+"s"]():NaN}function so(e){return function(){return this.isValid()?this._data[e]:NaN}}function po(){return T(this.days()/7)}function go(e,t,n,r,i){return i.relativeTime(t||1,!!n,e,r)}function yo(e,t,n){var r=wi(e).abs(),i=vo(r.as("s")),s=vo(r.as("m")),o=vo(r.as("h")),u=vo(r.as("d")),a=vo(r.as("M")),f=vo(r.as("y")),l=i<=mo.ss&&["s",i]||i<mo.s&&["ss",i]||s<=1&&["m"]||s<mo.m&&["mm",s]||o<=1&&["h"]||o<mo.h&&["hh",o]||u<=1&&["d"]||u<mo.d&&["dd",u]||a<=1&&["M"]||a<mo.M&&["MM",a]||f<=1&&["y"]||["yy",f];return l[2]=t,l[3]=+e>0,l[4]=n,go.apply(null,l)}function bo(e){return e===undefined?vo:typeof e=="function"?(vo=e,!0):!1}function wo(e,t){return mo[e]===undefined?!1:t===undefined?mo[e]:(mo[e]=t,e==="s"&&(mo.ss=t-1),!0)}function Eo(e){if(!this.isValid())return this.localeData().invalidDate();var t=this.localeData(),n=yo(this,!e,t);return e&&(n=t.pastFuture(+this,n)),t.postformat(n)}function xo(){if(!this.isValid())return this.localeData().invalidDate();var e=So(this._milliseconds)/1e3,t=So(this._days),n=So(this._months),r,i,s;r=T(e/60),i=T(r/60),e%=60,r%=60,s=T(n/12),n%=12;var o=s,u=n,a=t,f=i,l=r,c=e,h=this.asSeconds();return h?(h<0?"-":"")+"P"+(o?o+"Y":"")+(u?u+"M":"")+(a?a+"D":"")+(f||l||c?"T":"")+(f?f+"H":"")+(l?l+"M":"")+(c?c+"S":""):"P0D"}var e,v;Array.prototype.some?v=Array.prototype.some:v=function(e){var t=Object(this),n=t.length>>>0;for(var r=0;r<n;r++)if(r in t&&e.call(this,t[r],r,t))return!0;return!1};var m=v,b=t.momentProperties=[],E=!1,A={};t.suppressDeprecationWarnings=!1,t.deprecationHandler=null;var H;Object.keys?H=Object.keys:H=function(e){var t,n=[];for(t in e)l(e,t)&&n.push(t);return n};var B=H,j={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},I={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},R="Invalid date",z="%d",W=/\d{1,2}/,V={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},K={},Z={},at=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,ft=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,lt={},ct={},gt=/\d/,yt=/\d\d/,bt=/\d{3}/,wt=/\d{4}/,Et=/[+-]?\d{6}/,St=/\d\d?/,xt=/\d\d\d\d?/,Tt=/\d\d\d\d\d\d?/,Nt=/\d{1,3}/,Ct=/\d{1,4}/,kt=/[+-]?\d{1,6}/,Lt=/\d+/,At=/[+-]?\d+/,Ot=/Z|[+-]\d\d:?\d\d/gi,Mt=/Z|[+-]\d\d(?::?\d\d)?/gi,_t=/[+-]?\d+(\.\d{1,3})?/,Dt=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,Pt={},It={},zt=0,Wt=1,Xt=2,Vt=3,$t=4,Jt=5,Kt=6,Qt=7,Gt=8,Yt;Array.prototype.indexOf?Yt=Array.prototype.indexOf:Yt=function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1};var Zt=Yt;ht("M",["MM",2],"Mo",function(){return this.month()+1}),ht("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)}),ht("MMMM",0,0,function(e){return this.localeData().months(this,e)}),Q("month","M"),et("month",8),Ht("M",St),Ht("MM",St,yt),Ht("MMM",function(e,t){return t.monthsShortRegex(e)}),Ht("MMMM",function(e,t){return t.monthsRegex(e)}),qt(["M","MM"],function(e,t){t[Wt]=N(e)-1}),qt(["MMM","MMMM"],function(e,t,n,r){var i=n._locale.monthsParse(e,r,n._strict);i!=null?t[Wt]=i:d(n).invalidMonth=e});var tn=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,nn="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),sn="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),hn=Dt,dn=Dt;ht("Y",0,0,function(){var e=this.year();return e<=9999?""+e:"+"+e}),ht(0,["YY",2],0,function(){return this.year()%100}),ht(0,["YYYY",4],0,"year"),ht(0,["YYYYY",5],0,"year"),ht(0,["YYYYYY",6,!0],0,"year"),Q("year","y"),et("year",1),Ht("Y",At),Ht("YY",St,yt),Ht("YYYY",Ct,wt),Ht("YYYYY",kt,Et),Ht("YYYYYY",kt,Et),qt(["YYYYY","YYYYYY"],zt),qt("YYYY",function(e,n){n[zt]=e.length===2?t.parseTwoDigitYear(e):N(e)}),qt("YY",function(e,n){n[zt]=t.parseTwoDigitYear(e)}),qt("Y",function(e,t){t[zt]=parseInt(e,10)}),t.parseTwoDigitYear=function(e){return N(e)+(N(e)>68?1900:2e3)};var bn=nt("FullYear",!0);ht("w",["ww",2],"wo","week"),ht("W",["WW",2],"Wo","isoWeek"),Q("week","w"),Q("isoWeek","W"),et("week",5),et("isoWeek",5),Ht("w",St),Ht("ww",St,yt),Ht("W",St),Ht("WW",St,yt),Rt(["w","ww","W","WW"],function(e,t,n,r){t[r.substr(0,1)]=N(e)});var Ln={dow:0,doy:6};ht("d",0,"do","day"),ht("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)}),ht("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)}),ht("dddd",0,0,function(e){return this.localeData().weekdays(this,e)}),ht("e",0,0,"weekday"),ht("E",0,0,"isoWeekday"),Q("day","d"),Q("weekday","e"),Q("isoWeekday","E"),et("day",11),et("weekday",11),et("isoWeekday",11),Ht("d",St),Ht("e",St),Ht("E",St),Ht("dd",function(e,t){return t.weekdaysMinRegex(e)}),Ht("ddd",function(e,t){return t.weekdaysShortRegex(e)}),Ht("dddd",function(e,t){return t.weekdaysRegex(e)}),Rt(["dd","ddd","dddd"],function(e,t,n,r){var i=n._locale.weekdaysParse(e,r,n._strict);i!=null?t.d=i:d(n).invalidWeekday=e}),Rt(["d","e","E"],function(e,t,n,r){t[r]=N(e)});var Hn="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),jn="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),In="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),Vn=Dt,Jn=Dt,Qn=Dt;ht("H",["HH",2],0,"hour"),ht("h",["hh",2],0,Zn),ht("k",["kk",2],0,er),ht("hmm",0,0,function(){return""+Zn.apply(this)+ut(this.minutes(),2)}),ht("hmmss",0,0,function(){return""+Zn.apply(this)+ut(this.minutes(),2)+ut(this.seconds(),2)}),ht("Hmm",0,0,function(){return""+this.hours()+ut(this.minutes(),2)}),ht("Hmmss",0,0,function(){return""+this.hours()+ut(this.minutes(),2)+ut(this.seconds(),2)}),tr("a",!0),tr("A",!1),Q("hour","h"),et("hour",13),Ht("a",nr),Ht("A",nr),Ht("H",St),Ht("h",St),Ht("k",St),Ht("HH",St,yt),Ht("hh",St,yt),Ht("kk",St,yt),Ht("hmm",xt),Ht("hmmss",Tt),Ht("Hmm",xt),Ht("Hmmss",Tt),qt(["H","HH"],Vt),qt(["k","kk"],function(e,t,n){var r=N(e);t[Vt]=r===24?0:r}),qt(["a","A"],function(e,t,n){n._isPm=n._locale.isPM(e),n._meridiem=e}),qt(["h","hh"],function(e,t,n){t[Vt]=N(e),d(n).bigHour=!0}),qt("hmm",function(e,t,n){var r=e.length-2;t[Vt]=N(e.substr(0,r)),t[$t]=N(e.substr(r)),d(n).bigHour=!0}),qt("hmmss",function(e,t,n){var r=e.length-4,i=e.length-2;t[Vt]=N(e.substr(0,r)),t[$t]=N(e.substr(r,2)),t[Jt]=N(e.substr(i)),d(n).bigHour=!0}),qt("Hmm",function(e,t,n){var r=e.length-2;t[Vt]=N(e.substr(0,r)),t[$t]=N(e.substr(r))}),qt("Hmmss",function(e,t,n){var r=e.length-4,i=e.length-2;t[Vt]=N(e.substr(0,r)),t[$t]=N(e.substr(r,2)),t[Jt]=N(e.substr(i))});var ir=/[ap]\.?m?\.?/i,or=nt("Hours",!0),ur={calendar:j,longDateFormat:I,invalidDate:R,ordinal:z,dayOfMonthOrdinalParse:W,relativeTime:V,months:nn,monthsShort:sn,week:Ln,weekdays:Hn,weekdaysMin:In,weekdaysShort:jn,meridiemParse:ir},ar={},fr={},lr,wr=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Er=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Sr=/Z|[+-]\d\d(?::?\d\d)?/,xr=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],Tr=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],Nr=/^\/?Date\((\-?\d+)/i,kr=/^((?:Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d?\d\s(?:Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(?:\d\d)?\d\d\s)(\d\d:\d\d)(\:\d\d)?(\s(?:UT|GMT|[ECMP][SD]T|[A-IK-Za-ik-z]|[+-]\d{4}))$/;t.createFromInputFallback=L("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged and will be removed in an upcoming major release. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))}),t.ISO_8601=function(){},t.RFC_2822=function(){};var zr=L("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=Ur.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:y()}),Wr=L("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=Ur.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:y()}),Jr=function(){return Date.now?Date.now():+(new Date)},Kr=["year","quarter","month","week","day","hour","minute","second","millisecond"];ni("Z",":"),ni("ZZ",""),Ht("Z",Mt),Ht("ZZ",Mt),qt(["Z","ZZ"],function(e,t,n){n._useUTC=!0,n._tzm=ii(Mt,e)});var ri=/([\+\-]|\d\d)/gi;t.updateOffset=function(){};var yi=/^(\-)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/,bi=/^(-)?P(?:(-?[0-9,.]*)Y)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)W)?(?:(-?[0-9,.]*)D)?(?:T(?:(-?[0-9,.]*)H)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)S)?)?$/;wi.fn=Zr.prototype,wi.invalid=Yr;var Ci=Ti(1,"add"),ki=Ti(-1,"subtract");t.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",t.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var Ji=L("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return e===undefined?this.localeData():this.locale(e)});ht(0,["gg",2],0,function(){return this.weekYear()%100}),ht(0,["GG",2],0,function(){return this.isoWeekYear()%100}),as("gggg","weekYear"),as("ggggg","weekYear"),as("GGGG","isoWeekYear"),as("GGGGG","isoWeekYear"),Q("weekYear","gg"),Q("isoWeekYear","GG"),et("weekYear",1),et("isoWeekYear",1),Ht("G",At),Ht("g",At),Ht("GG",St,yt),Ht("gg",St,yt),Ht("GGGG",Ct,wt),Ht("gggg",Ct,wt),Ht("GGGGG",kt,Et),Ht("ggggg",kt,Et),Rt(["gggg","ggggg","GGGG","GGGGG"],function(e,t,n,r){t[r.substr(0,2)]=N(e)}),Rt(["gg","GG"],function(e,n,r,i){n[i]=t.parseTwoDigitYear(e)}),ht("Q",0,"Qo","quarter"),Q("quarter","Q"),et("quarter",7),Ht("Q",gt),qt("Q",function(e,t){t[Wt]=(N(e)-1)*3}),ht("D",["DD",2],"Do","date"),Q("date","D"),et("date",9),Ht("D",St),Ht("DD",St,yt),Ht("Do",function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient}),qt(["D","DD"],Xt),qt("Do",function(e,t){t[Xt]=N(e.match(St)[0],10)});var ms=nt("Date",!0);ht("DDD",["DDDD",3],"DDDo","dayOfYear"),Q("dayOfYear","DDD"),et("dayOfYear",4),Ht("DDD",Nt),Ht("DDDD",bt),qt(["DDD","DDDD"],function(e,t,n){n._dayOfYear=N(e)}),ht("m",["mm",2],0,"minute"),Q("minute","m"),et("minute",14),Ht("m",St),Ht("mm",St,yt),qt(["m","mm"],$t);var ys=nt("Minutes",!1);ht("s",["ss",2],0,"second"),Q("second","s"),et("second",15),Ht("s",St),Ht("ss",St,yt),qt(["s","ss"],Jt);var bs=nt("Seconds",!1);ht("S",0,0,function(){return~~(this.millisecond()/100)}),ht(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),ht(0,["SSS",3],0,"millisecond"),ht(0,["SSSS",4],0,function(){return this.millisecond()*10}),ht(0,["SSSSS",5],0,function(){return this.millisecond()*100}),ht(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3}),ht(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4}),ht(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5}),ht(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6}),Q("millisecond","ms"),et("millisecond",16),Ht("S",Nt,gt),Ht("SS",Nt,yt),Ht("SSS",Nt,bt);var ws;for(ws="SSSS";ws.length<=9;ws+="S")Ht(ws,Lt);for(ws="S";ws.length<=9;ws+="S")qt(ws,Es);var Ss=nt("Milliseconds",!1);ht("z",0,0,"zoneAbbr"),ht("zz",0,0,"zoneName");var Ns=S.prototype;Ns.add=Ci,Ns.calendar=Ai,Ns.clone=Oi,Ns.diff=ji,Ns.endOf=Gi,Ns.format=Ui,Ns.from=zi,Ns.fromNow=Wi,Ns.to=Xi,Ns.toNow=Vi,Ns.get=st,Ns.invalidAt=os,Ns.isAfter=Mi,Ns.isBefore=_i,Ns.isBetween=Di,Ns.isSame=Pi,Ns.isSameOrAfter=Hi,Ns.isSameOrBefore=Bi,Ns.isValid=is,Ns.lang=Ji,Ns.locale=$i,Ns.localeData=Ki,Ns.max=Wr,Ns.min=zr,Ns.parsingFlags=ss,Ns.set=ot,Ns.startOf=Qi,Ns.subtract=ki,Ns.toArray=ts,Ns.toObject=ns,Ns.toDate=es,Ns.toISOString=qi,Ns.inspect=Ri,Ns.toJSON=rs,Ns.toString=Ii,Ns.unix=Zi,Ns.valueOf=Yi,Ns.creationData=us,Ns.year=bn,Ns.isLeapYear=wn,Ns.weekYear=fs,Ns.isoWeekYear=ls,Ns.quarter=Ns.quarters=vs,Ns.month=ln,Ns.daysInMonth=cn,Ns.week=Ns.weeks=Mn,Ns.isoWeek=Ns.isoWeeks=_n,Ns.weeksInYear=hs,Ns.isoWeeksInYear=cs,Ns.date=ms,Ns.day=Ns.days=zn,Ns.weekday=Wn,Ns.isoWeekday=Xn,Ns.dayOfYear=gs,Ns.hour=Ns.hours=or,Ns.minute=Ns.minutes=ys,Ns.second=Ns.seconds=bs,Ns.millisecond=Ns.milliseconds=Ss,Ns.utcOffset=ui,Ns.utc=fi,Ns.local=li,Ns.parseZone=ci,Ns.hasAlignedHourOffset=hi,Ns.isDST=pi,Ns.isLocal=vi,Ns.isUtcOffset=mi,Ns.isUtc=gi,Ns.isUTC=gi,Ns.zoneAbbr=xs,Ns.zoneName=Ts,Ns.dates=L("dates accessor is deprecated. Use date instead.",ms),Ns.months=L("months accessor is deprecated. Use month instead",ln),Ns.years=L("years accessor is deprecated. Use year instead",bn),Ns.zone=L("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",ai),Ns.isDSTShifted=L("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",di);var As=P.prototype;As.calendar=F,As.longDateFormat=q,As.invalidDate=U,As.ordinal=X,As.preparse=Ls,As.postformat=Ls,As.relativeTime=$,As.pastFuture=J,As.set=_,As.months=rn,As.monthsShort=on,As.monthsParse=an,As.monthsRegex=vn,As.monthsShortRegex=pn,As.week=kn,As.firstDayOfYear=On,As.firstDayOfWeek=An,As.weekdays=Bn,As.weekdaysMin=qn,As.weekdaysShort=Fn,As.weekdaysParse=Un,As.weekdaysRegex=$n,As.weekdaysShortRegex=Kn,As.weekdaysMinRegex=Gn,As.isPM=rr,As.meridiem=sr,dr("en",{dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10,n=N(e%100/10)===1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th";return e+n}}),t.lang=L("moment.lang is deprecated. Use moment.locale instead.",dr),t.langData=L("moment.langData is deprecated. Use moment.localeData instead.",gr);var Fs=Math.abs,Qs=Ks("ms"),Gs=Ks("s"),Ys=Ks("m"),Zs=Ks("h"),eo=Ks("d"),to=Ks("w"),no=Ks("M"),ro=Ks("y"),oo=so("milliseconds"),uo=so("seconds"),ao=so("minutes"),fo=so("hours"),lo=so("days"),co=so("months"),ho=so("years"),vo=Math.round,mo={ss:44,s:45,m:45,h:22,d:26,M:11},So=Math.abs,To=Zr.prototype;return To.isValid=Gr,To.abs=Is,To.add=Rs,To.subtract=Us,To.as=$s,To.asMilliseconds=Qs,To.asSeconds=Gs,To.asMinutes=Ys,To.asHours=Zs,To.asDays=eo,To.asWeeks=to,To.asMonths=no,To.asYears=ro,To.valueOf=Js,To._bubble=Ws,To.get=io,To.milliseconds=oo,To.seconds=uo,To.minutes=ao,To.hours=fo,To.days=lo,To.weeks=po,To.months=co,To.years=ho,To.humanize=Eo,To.toISOString=xo,To.toString=xo,To.toJSON=xo,To.locale=$i,To.localeData=Ki,To.toIsoString=L("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",xo),To.lang=Ji,ht("X",0,0,"unix"),ht("x",0,0,"valueOf"),Ht("x",At),Ht("X",_t),qt("X",function(e,t,n){n._d=new Date(parseFloat(e,10)*1e3)}),qt("x",function(e,t,n){n._d=new Date(N(e))}),t.version="2.18.1",n(Ur),t.fn=Ns,t.min=Vr,t.max=$r,t.now=Jr,t.utc=h,t.unix=Cs,t.months=Ds,t.isDate=a,t.locale=dr,t.invalid=y,t.duration=wi,t.isMoment=x,t.weekdays=Hs,t.parseZone=ks,t.localeData=gr,t.isDuration=ei,t.monthsShort=Ps,t.weekdaysMin=js,t.defineLocale=vr,t.updateLocale=mr,t.locales=yr,t.weekdaysShort=Bs,t.normalizeUnits=G,t.relativeTimeRounding=bo,t.relativeTimeThreshold=wo,t.calendarFormat=Li,t.prototype=Ns,t}),define("vendor/text!features/archiveSearchInput/templates/archiveSearchInputTemplate.html",[],function(){return'<div class="archive-search-wrapper">\n    <i class="toggleSearch <%= toggleSearchIconName %>"></i>\n    <div class="archive-search-text-box-wrapper">\n        <input type="text" class="archive-search-text-box" id="q" placeholder="<%= placeholder %>" autocomplete="off">\n        <i class="clearInput <%= clearInputIconName %> invisible"></i>\n    </div>\n</div>\n'}),define("archiveSearchService",["backbone","apiService","localService","jquery"],function(e,t,n,r){var i=t.getArchiveSearchURL(),s;return n.get("latestSearches")||n.put("latestSearches",JSON.stringify([])),e.on("archiveSearch:goToIssue",function(){if(s){var e=JSON.parse(n.get("latestSearches")),t=e.indexOf(s);t>-1&&e.splice(t,1),e.unshift(s),e.length>10&&e.pop(),n.put("latestSearches",JSON.stringify(e))}}),{getResultViewType:function(){return n.get("resultViewType")||"listView"},setResultViewType:function(e){return n.put("resultViewType",e)},getLatestSearches:function(){return JSON.parse(n.get("latestSearches"))},clearPreviousSearches:function(){n.put("latestSearches",JSON.stringify([]))},search:function(n,i,o,u,a){if(!n||n.trim().length<3)return;s=n.trim();var f=t.getArchiveSearchURL()+"?q="+encodeURIComponent(n.trim())+"&page="+(a||1)+"&page_size="+(i||10)+(o?"&from="+o:"")+(u?"&to="+u:"");r.getJSON(f,function(t){e.trigger("archiveSearch:result",t)})}}}),"use strict",define("archiveSearchInputView",["backbone","jquery","underscore","baseFeatureView","moment","deviceUtility","vendor/text!features/archiveSearchInput/templates/archiveSearchInputTemplate.html","archiveSearchService"],function(e,t,n,r,i,s,o,u){var a="YYYY-MM-DDTHH:mm:ss\\Z",f="";return r.extend({className:"archive-search-container",events:{"input .archive-search-text-box":"change",tap:"tap"},tap:function(e){var n=t(e.target);n.hasClass("clearInput")?this.clearInput():n.hasClass("toggleSearch")?this.toggleSearch():n.hasClass(this.className)?this.toggleSearch():this.focus()},blur:function(e){var t=this.model.get("toggleSearchIconName");this.$el.removeClass("focus"),this.clearInput(),this.$("input").blur(),this.$(".toggleSearch").removeClass(t.active),this.$(".toggleSearch").addClass(t.inactive)},focus:function(e){var t=this.model.get("toggleSearchIconName");this.$el.addClass("focus"),this.$(".toggleSearch").removeClass(t.inactive),this.$(".toggleSearch").addClass(t.active),this.$("input").select()},change:function(e){var t=this.$("input").val();return e.preventDefault(),this.model.set("query",t),!1},keyHandler:function(t){var n=t.which;n===27&&this.$el.hasClass("focus")&&(e.trigger("sidebar:close"),this.blur())},initialize:function(e){return this.init(e),this.model.unset("query"),this.keyHandler=this.keyHandler.bind(this),this.archiveSearchTemplate=n.template(o),this.bindEvents(),s.isAndroid()?f="android":s.isiOS()&&(f="ios"),this},bindEvents:function(){this.unbindEvents(),e.on("archiveSearch:filter",this.filterArchiveSearch,this),e.on("inputArchiveSearchQuery",this.inputQuery,this),e.on("sidebar:hide",this.blur,this),e.on("sidebar:show",this.focus,this),this.model.on("change:query",this.handleQuery,this),document.addEventListener("keyup",this.keyHandler,!0)},unbindEvents:function(){e.off("archiveSearch:filter",this.filterArchiveSearch,this),e.off("inputArchiveSearchQuery",this.inputQuery,this),e.off("sidebar:hide",this.blur,this),e.off("sidebar:show",this.focus,this),this.model.off("change:query",this.handleQuery,this),document.removeEventListener("keyup",this.keyHandler,!0)},toggleSearch:function(){this.$el.hasClass("focus")?e.trigger("sidebar:close"):e.trigger("sidebar:open")},clearInput:function(){this.inputQuery(""),this.$("input").focus(),e.trigger("archiveSearch:clearInput")},filterArchiveSearch:function(e){var t=this.model.get("query"),n=e.perPage,r=e.page,s,o;if(e.byPubdate)switch(e.byPubdate){case"today":s=i().startOf("day").format(a);break;case"latest-week":s=i().subtract(7,"days").startOf("day").format(a);break;case"latest-month":s=i().subtract(1,"month").startOf("day").format(a);break;case"latest-year":s=i().subtract(1,"year").startOf("day").format(a);break;case"custom":s=e.from,o=e.to}u.search(t,n,s,o,r)},render:function(){return this.$el.addClass(this.model.get("position")+"-position"),this.$el.addClass(f),this.$el.html(this.archiveSearchTemplate({placeholder:this.strings.placeholder,search:this.strings.search,toggleSearchIconName:this.model.get("toggleSearchIconName").inactive,clearInputIconName:this.model.get("clearInputIconName")})),this},handleQuery:function(t,n){u.search(n),n.length>0?this.$(".clearInput").removeClass("invisible"):(e.trigger("archiveSearch:clearInput"),this.$(".clearInput").addClass("invisible"))},inputQuery:function(e){this.$("input").val(e).trigger("input")}})}),"use strict",define("archiveSearchInputFeature",["underscore","baseFeature","archiveSearchInputView"],function(e,t,n){return function(){this.feature=e.extend({},t),this.feature.setView.call(this.feature,n).setModel.call(this.feature)}}),define("vendor/text!features/archiveSearchResult/templates/pagination.html",[],function(){return'<ul>\n    <li class="<%= firstPage ? \'disabled\' : \'\' %>" data-page="previous"><span class="im-icon-chevron-left pagination-btn"></span></li>\n        <% _.each(paginationRange, function(i) { %>\n             <li data-page="<%= i %>" class="<%= isSelectedPage(i) %>"><%= i %></li>\n        <% } ); %>\n    <li data-page="next"><span class="im-icon-chevron-right pagination-btn <%= lastPage ? \'disabled\' : \'\' %>"></span></li>\n</ul>'}),"use strict",define("archiveSearchPaginationView",["backbone","jquery","baseView","vendor/text!features/archiveSearchResult/templates/pagination.html"],function(e,t,n,r){function i(e,t){var n=5,r=Math.floor(n/2),i=t-r+1-n%2,s=t+r;return i<=0&&(i=1,s=n),s>e&&(i=e-n+1,s=e),_.range(Math.max(i,1),s+1)}return n.extend({tagName:"div",id:"search-pagination",events:{"tap li":"changePage"},initialize:function(e){this.init(e),this.template=_.template(r),this.bindEvents()},render:function(e){var t,n,r="";return e&&e.page&&(t=e.page,this.model.set("currentPage",t),n={paginationRange:i(e.totalPages,t),firstPage:e.firstPage,lastPage:e.lastPage,page:e.page,isSelectedPage:function(e){return e===t?"selected":""}},r=this.template(n)),this.$el.html(r),this.delegateEvents(),this},changePage:function(n){var r=t(n.target),i=r.closest("li");if(i.hasClass("disabled")||i.hasClass("selected"))return;var s=i.data("page");s==="next"?this.model.set("currentPage",this.model.get("currentPage")+1):s==="previous"?this.model.set("currentPage",this.model.get("currentPage")-1):this.model.set("currentPage",s),e.trigger("archiveSearch:changePage",{page:this.model.get("currentPage")})},bindEvents:function(){return this},unbindEvents:function(){return this}})}),function(e){typeof define=="function"&&define.amd?define("jqueryDatepicker",["jquery"],e):e(jQuery)}(function(e){function i(e){var t=e.css("visibility");while(t==="inherit")e=e.parent(),t=e.css("visibility");return t!=="hidden"}function v(e){var t,n;while(e.length&&e[0]!==document){t=e.css("position");if(t==="absolute"||t==="relative"||t==="fixed"){n=parseInt(e.css("zIndex"),10);if(!isNaN(n)&&n!==0)return n}e=e.parent()}return 0}function m(){this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},e.extend(this._defaults,this.regional[""]),this.regional.en=e.extend(!0,{},this.regional[""]),this.regional["en-US"]=e.extend(!0,{},this.regional.en),this.dpDiv=g(e("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}function g(t){var n="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return t.on("mouseout",n,function(){e(this).removeClass("ui-state-hover"),this.className.indexOf("ui-datepicker-prev")!==-1&&e(this).removeClass("ui-datepicker-prev-hover"),this.className.indexOf("ui-datepicker-next")!==-1&&e(this).removeClass("ui-datepicker-next-hover")}).on("mouseover",n,y)}function y(){e.datepicker._isDisabledDatepicker(d.inline?d.dpDiv.parent()[0]:d.input[0])||(e(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),e(this).addClass("ui-state-hover"),this.className.indexOf("ui-datepicker-prev")!==-1&&e(this).addClass("ui-datepicker-prev-hover"),this.className.indexOf("ui-datepicker-next")!==-1&&e(this).addClass("ui-datepicker-next-hover"))}function b(t,n){e.extend(t,n);for(var r in n)n[r]==null&&(t[r]=n[r]);return t}e.ui=e.ui||{};var t=e.ui.version="1.12.1",n=e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(n){return!!e.data(n,t)}}):function(t,n,r){return!!e.data(t,r[3])}}),r=e.fn.extend({disableSelection:function(){var e="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.on(e+".ui-disableSelection",function(e){e.preventDefault()})}}(),enableSelection:function(){return this.off(".ui-disableSelection")}});e.ui.focusable=function(t,n){var r,s,o,u,a,f=t.nodeName.toLowerCase();return"area"===f?(r=t.parentNode,s=r.name,!t.href||!s||r.nodeName.toLowerCase()!=="map"?!1:(o=e("img[usemap='#"+s+"']"),o.length>0&&o.is(":visible"))):(/^(input|select|textarea|button|object)$/.test(f)?(u=!t.disabled,u&&(a=e(t).closest("fieldset")[0],a&&(u=!a.disabled))):"a"===f?u=t.href||n:u=n,u&&e(t).is(":visible")&&i(e(t)))},e.extend(e.expr[":"],{focusable:function(t){return e.ui.focusable(t,e.attr(t,"tabindex")!=null)}});var s=e.ui.focusable,o=e.fn.form=function(){return typeof this[0].form=="string"?this.closest("form"):e(this[0].form)},u=e.ui.formResetMixin={_formResetHandler:function(){var t=e(this);setTimeout(function(){var n=t.data("ui-form-reset-instances");e.each(n,function(){this.refresh()})})},_bindFormResetHandler:function(){this.form=this.element.form();if(!this.form.length)return;var e=this.form.data("ui-form-reset-instances")||[];e.length||this.form.on("reset.ui-form-reset",this._formResetHandler),e.push(this),this.form.data("ui-form-reset-instances",e)},_unbindFormResetHandler:function(){if(!this.form.length)return;var t=this.form.data("ui-form-reset-instances");t.splice(e.inArray(this,t),1),t.length?this.form.data("ui-form-reset-instances",t):this.form.removeData("ui-form-reset-instances").off("reset.ui-form-reset")}};e.fn.jquery.substring(0,3)==="1.7"&&(e.each(["Width","Height"],function(t,n){function o(t,n,i,s){return e.each(r,function(){n-=parseFloat(e.css(t,"padding"+this))||0,i&&(n-=parseFloat(e.css(t,"border"+this+"Width"))||0),s&&(n-=parseFloat(e.css(t,"margin"+this))||0)}),n}var r=n==="Width"?["Left","Right"]:["Top","Bottom"],i=n.toLowerCase(),s={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+n]=function(t){return t===undefined?s["inner"+n].call(this):this.each(function(){e(this).css(i,o(this,t)+"px")})},e.fn["outer"+n]=function(t,r){return typeof t!="number"?s["outer"+n].call(this,t):this.each(function(){e(this).css(i,o(this,t,!0,r)+"px")})}}),e.fn.addBack=function(e){return this.add(e==null?this.prevObject:this.prevObject.filter(e))});var a=e.ui.keyCode={BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38},f=e.ui.escapeSelector=function(){var e=/([!"#$%&'()*+,./:;<=>?@[\]^`{|}~])/g;return function(t){return t.replace(e,"\\$1")}}(),l=e.fn.labels=function(){var t,n,r,i,s;return this[0].labels&&this[0].labels.length?this.pushStack(this[0].labels):(i=this.eq(0).parents("label"),r=this.attr("id"),r&&(t=this.eq(0).parents().last(),s=t.add(t.length?t.siblings():this.siblings()),n="label[for='"+e.ui.escapeSelector(r)+"']",i=i.add(s.find(n).addBack(n))),this.pushStack(i))},c=e.fn.scrollParent=function(t){var n=this.css("position"),r=n==="absolute",i=t?/(auto|scroll|hidden)/:/(auto|scroll)/,s=this.parents().filter(function(){var t=e(this);return r&&t.css("position")==="static"?!1:i.test(t.css("overflow")+t.css("overflow-y")+t.css("overflow-x"))}).eq(0);return n==="fixed"||!s.length?e(this[0].ownerDocument||document):s},h=e.extend(e.expr[":"],{tabbable:function(t){var n=e.attr(t,"tabindex"),r=n!=null;return(!r||n>=0)&&e.ui.focusable(t,r)}}),p=e.fn.extend({uniqueId:function(){var e=0;return function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++e)})}}(),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&e(this).removeAttr("id")})}});e.extend(e.ui,{datepicker:{version:"1.12.1"}});var d;e.extend(m.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(e){return b(this._defaults,e||{}),this},_attachDatepicker:function(t,n){var r,i,s;r=t.nodeName.toLowerCase(),i=r==="div"||r==="span",t.id||(this.uuid+=1,t.id="dp"+this.uuid),s=this._newInst(e(t),i),s.settings=e.extend({},n||{}),r==="input"?this._connectDatepicker(t,s):i&&this._inlineDatepicker(t,s)},_newInst:function(t,n){var r=t[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1");return{id:r,input:t,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:n,dpDiv:n?g(e("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):this.dpDiv}},_connectDatepicker:function(t,n){var r=e(t);n.append=e([]),n.trigger=e([]);if(r.hasClass(this.markerClassName))return;this._attachments(r,n),r.addClass(this.markerClassName).on("keydown",this._doKeyDown).on("keypress",this._doKeyPress).on("keyup",this._doKeyUp),this._autoSize(n),e.data(t,"datepicker",n),n.settings.disabled&&this._disableDatepicker(t)},_attachments:function(t,n){var r,i,s,o=this._get(n,"appendText"),u=this._get(n,"isRTL");n.append&&n.append.remove(),o&&(n.append=e("<span class='"+this._appendClass+"'>"+o+"</span>"),t[u?"before":"after"](n.append)),t.off("focus",this._showDatepicker),n.trigger&&n.trigger.remove(),r=this._get(n,"showOn"),(r==="focus"||r==="both")&&t.on("focus",this._showDatepicker);if(r==="button"||r==="both")i=this._get(n,"buttonText"),s=this._get(n,"buttonImage"),n.trigger=e(this._get(n,"buttonImageOnly")?e("<img/>").addClass(this._triggerClass).attr({src:s,alt:i,title:i}):e("<button type='button'></button>").addClass(this._triggerClass).html(s?e("<img/>").attr({src:s,alt:i,title:i}):i)),t[u?"before":"after"](n.trigger),n.trigger.on("click",function(){return e.datepicker._datepickerShowing&&e.datepicker._lastInput===t[0]?e.datepicker._hideDatepicker():e.datepicker._datepickerShowing&&e.datepicker._lastInput!==t[0]?(e.datepicker._hideDatepicker(),e.datepicker._showDatepicker(t[0])):e.datepicker._showDatepicker(t[0]),!1})},_autoSize:function(e){if(this._get(e,"autoSize")&&!e.inline){var t,n,r,i,s=new Date(2009,11,20),o=this._get(e,"dateFormat");o.match(/[DM]/)&&(t=function(e){n=0,r=0;for(i=0;i<e.length;i++)e[i].length>n&&(n=e[i].length,r=i);return r},s.setMonth(t(this._get(e,o.match(/MM/)?"monthNames":"monthNamesShort"))),s.setDate(t(this._get(e,o.match(/DD/)?"dayNames":"dayNamesShort"))+20-s.getDay())),e.input.attr("size",this._formatDate(e,s).length)}},_inlineDatepicker:function(t,n){var r=e(t);if(r.hasClass(this.markerClassName))return;r.addClass(this.markerClassName).append(n.dpDiv),e.data(t,"datepicker",n),this._setDate(n,this._getDefaultDate(n),!0),this._updateDatepicker(n),this._updateAlternate(n),n.settings.disabled&&this._disableDatepicker(t),n.dpDiv.css("display","block")},_dialogDatepicker:function(t,n,r,i,s){var o,u,a,f,l,c=this._dialogInst;return c||(this.uuid+=1,o="dp"+this.uuid,this._dialogInput=e("<input type='text' id='"+o+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.on("keydown",this._doKeyDown),e("body").append(this._dialogInput),c=this._dialogInst=this._newInst(this._dialogInput,!1),c.settings={},e.data(this._dialogInput[0],"datepicker",c)),b(c.settings,i||{}),n=n&&n.constructor===Date?this._formatDate(c,n):n,this._dialogInput.val(n),this._pos=s?s.length?s:[s.pageX,s.pageY]:null,this._pos||(u=document.documentElement.clientWidth,a=document.documentElement.clientHeight,f=document.documentElement.scrollLeft||document.body.scrollLeft,l=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[u/2-100+f,a/2-150+l]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),c.settings.onSelect=r,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),e.blockUI&&e.blockUI(this.dpDiv),e.data(this._dialogInput[0],"datepicker",c),this},_destroyDatepicker:function(t){var n,r=e(t),i=e.data(t,"datepicker");if(!r.hasClass(this.markerClassName))return;n=t.nodeName.toLowerCase(),e.removeData(t,"datepicker"),n==="input"?(i.append.remove(),i.trigger.remove(),r.removeClass(this.markerClassName).off("focus",this._showDatepicker).off("keydown",this._doKeyDown).off("keypress",this._doKeyPress).off("keyup",this._doKeyUp)):(n==="div"||n==="span")&&r.removeClass(this.markerClassName).empty(),d===i&&(d=null)},_enableDatepicker:function(t){var n,r,i=e(t),s=e.data(t,"datepicker");if(!i.hasClass(this.markerClassName))return;n=t.nodeName.toLowerCase();if(n==="input")t.disabled=!1,s.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""});else if(n==="div"||n==="span")r=i.children("."+this._inlineClass),r.children().removeClass("ui-state-disabled"),r.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1);this._disabledInputs=e.map(this._disabledInputs,function(e){return e===t?null:e})},_disableDatepicker:function(t){var n,r,i=e(t),s=e.data(t,"datepicker");if(!i.hasClass(this.markerClassName))return;n=t.nodeName.toLowerCase();if(n==="input")t.disabled=!0,s.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"});else if(n==="div"||n==="span")r=i.children("."+this._inlineClass),r.children().addClass("ui-state-disabled"),r.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0);this._disabledInputs=e.map(this._disabledInputs,function(e){return e===t?null:e}),this._disabledInputs[this._disabledInputs.length]=t},_isDisabledDatepicker:function(e){if(!e)return!1;for(var t=0;t<this._disabledInputs.length;t++)if(this._disabledInputs[t]===e)return!0;return!1},_getInst:function(t){try{return e.data(t,"datepicker")}catch(n){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(t,n,r){var i,s,o,u,a=this._getInst(t);if(arguments.length===2&&typeof n=="string")return n==="defaults"?e.extend({},e.datepicker._defaults):a?n==="all"?e.extend({},a.settings):this._get(a,n):null;i=n||{},typeof n=="string"&&(i={},i[n]=r),a&&(this._curInst===a&&this._hideDatepicker(),s=this._getDateDatepicker(t,!0),o=this._getMinMaxDate(a,"min"),u=this._getMinMaxDate(a,"max"),b(a.settings,i),o!==null&&i.dateFormat!==undefined&&i.minDate===undefined&&(a.settings.minDate=this._formatDate(a,o)),u!==null&&i.dateFormat!==undefined&&i.maxDate===undefined&&(a.settings.maxDate=this._formatDate(a,u)),"disabled"in i&&(i.disabled?this._disableDatepicker(t):this._enableDatepicker(t)),this._attachments(e(t),a),this._autoSize(a),this._setDate(a,s),this._updateAlternate(a),this._updateDatepicker(a))},_changeDatepicker:function(e,t,n){this._optionDatepicker(e,t,n)},_refreshDatepicker:function(e){var t=this._getInst(e);t&&this._updateDatepicker(t)},_setDateDatepicker:function(e,t){var n=this._getInst(e);n&&(this._setDate(n,t),this._updateDatepicker(n),this._updateAlternate(n))},_getDateDatepicker:function(e,t){var n=this._getInst(e);return n&&!n.inline&&this._setDateFromField(n,t),n?this._getDate(n):null},_doKeyDown:function(t){var n,r,i,s=e.datepicker._getInst(t.target),o=!0,u=s.dpDiv.is(".ui-datepicker-rtl");s._keyEvent=!0;if(e.datepicker._datepickerShowing)switch(t.keyCode){case 9:e.datepicker._hideDatepicker(),o=!1;break;case 13:return i=e("td."+e.datepicker._dayOverClass+":not(."+e.datepicker._currentClass+")",s.dpDiv),i[0]&&e.datepicker._selectDay(t.target,s.selectedMonth,s.selectedYear,i[0]),n=e.datepicker._get(s,"onSelect"),n?(r=e.datepicker._formatDate(s),n.apply(s.input?s.input[0]:null,[r,s])):e.datepicker._hideDatepicker(),!1;case 27:e.datepicker._hideDatepicker();break;case 33:e.datepicker._adjustDate(t.target,t.ctrlKey?-e.datepicker._get(s,"stepBigMonths"):-e.datepicker._get(s,"stepMonths"),"M");break;case 34:e.datepicker._adjustDate(t.target,t.ctrlKey?+e.datepicker._get(s,"stepBigMonths"):+e.datepicker._get(s,"stepMonths"),"M");break;case 35:(t.ctrlKey||t.metaKey)&&e.datepicker._clearDate(t.target),o=t.ctrlKey||t.metaKey;break;case 36:(t.ctrlKey||t.metaKey)&&e.datepicker._gotoToday(t.target),o=t.ctrlKey||t.metaKey;break;case 37:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,u?1:-1,"D"),o=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&e.datepicker._adjustDate(t.target,t.ctrlKey?-e.datepicker._get(s,"stepBigMonths"):-e.datepicker._get(s,"stepMonths"),"M");break;case 38:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,-7,"D"),o=t.ctrlKey||t.metaKey;break;case 39:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,u?-1:1,"D"),o=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&e.datepicker._adjustDate(t.target,t.ctrlKey?+e.datepicker._get(s,"stepBigMonths"):+e.datepicker._get(s,"stepMonths"),"M");break;case 40:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,7,"D"),o=t.ctrlKey||t.metaKey;break;default:o=!1}else t.keyCode===36&&t.ctrlKey?e.datepicker._showDatepicker(this):o=!1;o&&(t.preventDefault(),t.stopPropagation())},_doKeyPress:function(t){var n,r,i=e.datepicker._getInst(t.target);if(e.datepicker._get(i,"constrainInput"))return n=e.datepicker._possibleChars(e.datepicker._get(i,"dateFormat")),r=String.fromCharCode(t.charCode==null?t.keyCode:t.charCode),t.ctrlKey||t.metaKey||r<" "||!n||n.indexOf(r)>-1},_doKeyUp:function(t){var n,r=e.datepicker._getInst(t.target);if(r.input.val()!==r.lastVal)try{n=e.datepicker.parseDate(e.datepicker._get(r,"dateFormat"),r.input?r.input.val():null,e.datepicker._getFormatConfig(r)),n&&(e.datepicker._setDateFromField(r),e.datepicker._updateAlternate(r),e.datepicker._updateDatepicker(r))}catch(i){}return!0},_showDatepicker:function(t){t=t.target||t,t.nodeName.toLowerCase()!=="input"&&(t=e("input",t.parentNode)[0]);if(e.datepicker._isDisabledDatepicker(t)||e.datepicker._lastInput===t)return;var n,r,i,s,o,u,a;n=e.datepicker._getInst(t),e.datepicker._curInst&&e.datepicker._curInst!==n&&(e.datepicker._curInst.dpDiv.stop(!0,!0),n&&e.datepicker._datepickerShowing&&e.datepicker._hideDatepicker(e.datepicker._curInst.input[0])),r=e.datepicker._get(n,"beforeShow"),i=r?r.apply(t,[t,n]):{};if(i===!1)return;b(n.settings,i),n.lastVal=null,e.datepicker._lastInput=t,e.datepicker._setDateFromField(n),e.datepicker._inDialog&&(t.value=""),e.datepicker._pos||(e.datepicker._pos=e.datepicker._findPos(t),e.datepicker._pos[1]+=t.offsetHeight),s=!1,e(t).parents().each(function(){return s|=e(this).css("position")==="fixed",!s}),o={left:e.datepicker._pos[0],top:e.datepicker._pos[1]},e.datepicker._pos=null,n.dpDiv.empty(),n.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),e.datepicker._updateDatepicker(n),o=e.datepicker._checkOffset(n,o,s),n.dpDiv.css({position:e.datepicker._inDialog&&e.blockUI?"static":s?"fixed":"absolute",display:"none",left:o.left+"px",top:o.top+"px"}),n.inline||(u=e.datepicker._get(n,"showAnim"),a=e.datepicker._get(n,"duration"),n.dpDiv.css("z-index",v(e(t))+1),e.datepicker._datepickerShowing=!0,e.effects&&e.effects.effect[u]?n.dpDiv.show(u,e.datepicker._get(n,"showOptions"),a):n.dpDiv[u||"show"](u?a:null),e.datepicker._shouldFocusInput(n)&&n.input.trigger("focus"),e.datepicker._curInst=n)},_updateDatepicker:function(t){this.maxRows=4,d=t,t.dpDiv.empty().append(this._generateHTML(t)),this._attachHandlers(t);var n,r=this._getNumberOfMonths(t),i=r[1],s=17,o=t.dpDiv.find("."+this._dayOverClass+" a");o.length>0&&y.apply(o.get(0)),t.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),i>1&&t.dpDiv.addClass("ui-datepicker-multi-"+i).css("width",s*i+"em"),t.dpDiv[(r[0]!==1||r[1]!==1?"add":"remove")+"Class"]("ui-datepicker-multi"),t.dpDiv[(this._get(t,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),t===e.datepicker._curInst&&e.datepicker._datepickerShowing&&e.datepicker._shouldFocusInput(t)&&t.input.trigger("focus"),t.yearshtml&&(n=t.yearshtml,setTimeout(function(){n===t.yearshtml&&t.yearshtml&&t.dpDiv.find("select.ui-datepicker-year:first").replaceWith(t.yearshtml),n=t.yearshtml=null},0))},_shouldFocusInput:function(e){return e.input&&e.input.is(":visible")&&!e.input.is(":disabled")&&!e.input.is(":focus")},_checkOffset:function(t,n,r){var i=t.dpDiv.outerWidth(),s=t.dpDiv.outerHeight(),o=t.input?t.input.outerWidth():0,u=t.input?t.input.outerHeight():0,a=document.documentElement.clientWidth+(r?0:e(document).scrollLeft()),f=document.documentElement.clientHeight+(r?0:e(document).scrollTop());return n.left-=this._get(t,"isRTL")?i-o:0,n.left-=r&&n.left===t.input.offset().left?e(document).scrollLeft():0,n.top-=r&&n.top===t.input.offset().top+u?e(document).scrollTop():0,n.left-=Math.min(n.left,n.left+i>a&&a>i?Math.abs(n.left+i-a):0),n.top-=Math.min(n.top,n.top+s>f&&f>s?Math.abs(s+u):0),n},_findPos:function(t){var n,r=this._getInst(t),i=this._get(r,"isRTL");while(t&&(t.type==="hidden"||t.nodeType!==1||e.expr.filters.hidden(t)))t=t[i?"previousSibling":"nextSibling"];return n=e(t).offset(),[n.left,n.top]},_hideDatepicker:function(t){var n,r,i,s,o=this._curInst;if(!o||t&&o!==e.data(t,"datepicker"))return;this._datepickerShowing&&(n=this._get(o,"showAnim"),r=this._get(o,"duration"),i=function(){e.datepicker._tidyDialog(o)},e.effects&&(e.effects.effect[n]||e.effects[n])?o.dpDiv.hide(n,e.datepicker._get(o,"showOptions"),r,i):o.dpDiv[n==="slideDown"?"slideUp":n==="fadeIn"?"fadeOut":"hide"](n?r:null,i),n||i(),this._datepickerShowing=!1,s=this._get(o,"onClose"),s&&s.apply(o.input?o.input[0]:null,[o.input?o.input.val():"",o]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),e.blockUI&&(e.unblockUI(),e("body").append(this.dpDiv))),this._inDialog=!1)},_tidyDialog:function(e){e.dpDiv.removeClass(this._dialogClass).off(".ui-datepicker-calendar")},_checkExternalClick:function(t){if(!e.datepicker._curInst)return;var n=e(t.target),r=e.datepicker._getInst(n[0]);(n[0].id!==e.datepicker._mainDivId&&n.parents("#"+e.datepicker._mainDivId).length===0&&!n.hasClass(e.datepicker.markerClassName)&&!n.closest("."+e.datepicker._triggerClass).length&&e.datepicker._datepickerShowing&&(!e.datepicker._inDialog||!e.blockUI)||n.hasClass(e.datepicker.markerClassName)&&e.datepicker._curInst!==r)&&e.datepicker._hideDatepicker()},_adjustDate:function(t,n,r){var i=e(t),s=this._getInst(i[0]);if(this._isDisabledDatepicker(i[0]))return;this._adjustInstDate(s,n+(r==="M"?this._get(s,"showCurrentAtPos"):0),r),this._updateDatepicker(s)},_gotoToday:function(t){var n,r=e(t),i=this._getInst(r[0]);this._get(i,"gotoCurrent")&&i.currentDay?(i.selectedDay=i.currentDay,i.drawMonth=i.selectedMonth=i.currentMonth,i.drawYear=i.selectedYear=i.currentYear):(n=new Date,i.selectedDay=n.getDate(),i.drawMonth=i.selectedMonth=n.getMonth(),i.drawYear=i.selectedYear=n.getFullYear()),this._notifyChange(i),this._adjustDate(r)},_selectMonthYear:function(t,n,r){var i=e(t),s=this._getInst(i[0]);s["selected"+(r==="M"?"Month":"Year")]=s["draw"+(r==="M"?"Month":"Year")]=parseInt(n.options[n.selectedIndex].value,10),this._notifyChange(s),this._adjustDate(i)},_selectDay:function(t,n,r,i){var s,o=e(t);if(e(i).hasClass(this._unselectableClass)||this._isDisabledDatepicker(o[0]))return;s=this._getInst(o[0]),s.selectedDay=s.currentDay=e("a",i).html(),s.selectedMonth=s.currentMonth=n,s.selectedYear=s.currentYear=r,this._selectDate(t,this._formatDate(s,s.currentDay,s.currentMonth,s.currentYear))},_clearDate:function(t){var n=e(t);this._selectDate(n,"")},_selectDate:function(t,n){var r,i=e(t),s=this._getInst(i[0]);n=n!=null?n:this._formatDate(s),s.input&&s.input.val(n),this._updateAlternate(s),r=this._get(s,"onSelect"),r?r.apply(s.input?s.input[0]:null,[n,s]):s.input&&s.input.trigger("change"),s.inline?this._updateDatepicker(s):(this._hideDatepicker(),this._lastInput=s.input[0],typeof s.input[0]!="object"&&s.input.trigger("focus"),this._lastInput=null)},_updateAlternate:function(t){var n,r,i,s=this._get(t,"altField");s&&(n=this._get(t,"altFormat")||this._get(t,"dateFormat"),r=this._getDate(t),i=this.formatDate(n,r,this._getFormatConfig(t)),e(s).val(i))},noWeekends:function(e){var t=e.getDay();return[t>0&&t<6,""]},iso8601Week:function(e){var t,n=new Date(e.getTime());return n.setDate(n.getDate()+4-(n.getDay()||7)),t=n.getTime(),n.setMonth(0),n.setDate(1),Math.floor(Math.round((t-n)/864e5)/7)+1},parseDate:function(t,n,r){if(t==null||n==null)throw"Invalid arguments";n=typeof n=="object"?n.toString():n+"";if(n==="")return null;var i,s,o,u=0,a=(r?r.shortYearCutoff:null)||this._defaults.shortYearCutoff,f=typeof a!="string"?a:(new Date).getFullYear()%100+parseInt(a,10),l=(r?r.dayNamesShort:null)||this._defaults.dayNamesShort,c=(r?r.dayNames:null)||this._defaults.dayNames,h=(r?r.monthNamesShort:null)||this._defaults.monthNamesShort,p=(r?r.monthNames:null)||this._defaults.monthNames,d=-1,v=-1,m=-1,g=-1,y=!1,b,w=function(e){var n=i+1<t.length&&t.charAt(i+1)===e;return n&&i++,n},E=function(e){var t=w(e),r=e==="@"?14:e==="!"?20:e==="y"&&t?4:e==="o"?3:2,i=e==="y"?r:1,s=new RegExp("^\\d{"+i+","+r+"}"),o=n.substring(u).match(s);if(!o)throw"Missing number at position "+u;return u+=o[0].length,parseInt(o[0],10)},S=function(t,r,i){var s=-1,o=e.map(w(t)?i:r,function(e,t){return[[t,e]]}).sort(function(e,t){return-(e[1].length-t[1].length)});e.each(o,function(e,t){var r=t[1];if(n.substr(u,r.length).toLowerCase()===r.toLowerCase())return s=t[0],u+=r.length,!1});if(s!==-1)return s+1;throw"Unknown name at position "+u},x=function(){if(n.charAt(u)!==t.charAt(i))throw"Unexpected literal at position "+u;u++};for(i=0;i<t.length;i++)if(y)t.charAt(i)==="'"&&!w("'")?y=!1:x();else switch(t.charAt(i)){case"d":m=E("d");break;case"D":S("D",l,c);break;case"o":g=E("o");break;case"m":v=E("m");break;case"M":v=S("M",h,p);break;case"y":d=E("y");break;case"@":b=new Date(E("@")),d=b.getFullYear(),v=b.getMonth()+1,m=b.getDate();break;case"!":b=new Date((E("!")-this._ticksTo1970)/1e4),d=b.getFullYear(),v=b.getMonth()+1,m=b.getDate();break;case"'":w("'")?x():y=!0;break;default:x()}if(u<n.length){o=n.substr(u);if(!/^\s+/.test(o))throw"Extra/unparsed characters found in date: "+o}d===-1?d=(new Date).getFullYear():d<100&&(d+=(new Date).getFullYear()-(new Date).getFullYear()%100+(d<=f?0:-100));if(g>-1){v=1,m=g;do{s=this._getDaysInMonth(d,v-1);if(m<=s)break;v++,m-=s}while(!0)}b=this._daylightSavingAdjust(new Date(d,v-1,m));if(b.getFullYear()!==d||b.getMonth()+1!==v||b.getDate()!==m)throw"Invalid date";return b},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925))*24*60*60*1e7,formatDate:function(e,t,n){if(!t)return"";var r,i=(n?n.dayNamesShort:null)||this._defaults.dayNamesShort,s=(n?n.dayNames:null)||this._defaults.dayNames,o=(n?n.monthNamesShort:null)||this._defaults.monthNamesShort,u=(n?n.monthNames:null)||this._defaults.monthNames,a=function(t){var n=r+1<e.length&&e.charAt(r+1)===t;return n&&r++,n},f=function(e,t,n){var r=""+t;if(a(e))while(r.length<n)r="0"+r;return r},l=function(e,t,n,r){return a(e)?r[t]:n[t]},c="",h=!1;if(t)for(r=0;r<e.length;r++)if(h)e.charAt(r)==="'"&&!a("'")?h=!1:c+=e.charAt(r);else switch(e.charAt(r)){case"d":c+=f("d",t.getDate(),2);break;case"D":c+=l("D",t.getDay(),i,s);break;case"o":c+=f("o",Math.round(((new Date(t.getFullYear(),t.getMonth(),t.getDate())).getTime()-(new Date(t.getFullYear(),0,0)).getTime())/864e5),3);break;case"m":c+=f("m",t.getMonth()+1,2);break;case"M":c+=l("M",t.getMonth(),o,u);break;case"y":c+=a("y")?t.getFullYear():(t.getFullYear()%100<10?"0":"")+t.getFullYear()%100;break;case"@":c+=t.getTime();break;case"!":c+=t.getTime()*1e4+this._ticksTo1970;break;case"'":a("'")?c+="'":h=!0;break;default:c+=e.charAt(r)}return c},_possibleChars:function(e){var t,n="",r=!1,i=function(n){var r=t+1<e.length&&e.charAt(t+1)===n;return r&&t++,r};for(t=0;t<e.length;t++)if(r)e.charAt(t)==="'"&&!i("'")?r=!1:n+=e.charAt(t);else switch(e.charAt(t)){case"d":case"m":case"y":case"@":n+="0123456789";break;case"D":case"M":return null;case"'":i("'")?n+="'":r=!0;break;default:n+=e.charAt(t)}return n},_get:function(e,t){return e.settings[t]!==undefined?e.settings[t]:this._defaults[t]},_setDateFromField:function(e,t){if(e.input.val()===e.lastVal)return;var n=this._get(e,"dateFormat"),r=e.lastVal=e.input?e.input.val():null,i=this._getDefaultDate(e),s=i,o=this._getFormatConfig(e);try{s=this.parseDate(n,r,o)||i}catch(u){r=t?"":r}e.selectedDay=s.getDate(),e.drawMonth=e.selectedMonth=s.getMonth(),e.drawYear=e.selectedYear=s.getFullYear(),e.currentDay=r?s.getDate():0,e.currentMonth=r?s.getMonth():0,e.currentYear=r?s.getFullYear():0,this._adjustInstDate(e)},_getDefaultDate:function(e){return this._restrictMinMax(e,this._determineDate(e,this._get(e,"defaultDate"),new Date))},_determineDate:function(t,n,r){var i=function(e){var t=new Date;return t.setDate(t.getDate()+e),t},s=function(n){try{return e.datepicker.parseDate(e.datepicker._get(t,"dateFormat"),n,e.datepicker._getFormatConfig(t))}catch(r){}var i=(n.toLowerCase().match(/^c/)?e.datepicker._getDate(t):null)||new Date,s=i.getFullYear(),o=i.getMonth(),u=i.getDate(),a=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,f=a.exec(n);while(f){switch(f[2]||"d"){case"d":case"D":u+=parseInt(f[1],10);break;case"w":case"W":u+=parseInt(f[1],10)*7;break;case"m":case"M":o+=parseInt(f[1],10),u=Math.min(u,e.datepicker._getDaysInMonth(s,o));break;case"y":case"Y":s+=parseInt(f[1],10),u=Math.min(u,e.datepicker._getDaysInMonth(s,o))}f=a.exec(n)}return new Date(s,o,u)},o=n==null||n===""?r:typeof n=="string"?s(n):typeof n=="number"?isNaN(n)?r:i(n):new Date(n.getTime());return o=o&&o.toString()==="Invalid Date"?r:o,o&&(o.setHours(0),o.setMinutes(0),o.setSeconds(0),o.setMilliseconds(0)),this._daylightSavingAdjust(o)},_daylightSavingAdjust:function(e){return e?(e.setHours(e.getHours()>12?e.getHours()+2:0),e):null},_setDate:function(e,t,n){var r=!t,i=e.selectedMonth,s=e.selectedYear,o=this._restrictMinMax(e,this._determineDate(e,t,new Date));e.selectedDay=e.currentDay=o.getDate(),e.drawMonth=e.selectedMonth=e.currentMonth=o.getMonth(),e.drawYear=e.selectedYear=e.currentYear=o.getFullYear(),(i!==e.selectedMonth||s!==e.selectedYear)&&!n&&this._notifyChange(e),this._adjustInstDate(e),e.input&&e.input.val(r?"":this._formatDate(e))},_getDate:function(e){var t=!e.currentYear||e.input&&e.input.val()===""?null:this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return t},_attachHandlers:function(t){var n=this._get(t,"stepMonths"),r="#"+t.id.replace(/\\\\/g,"\\");t.dpDiv.find("[data-handler]").map(function(){var t={prev:function(){e.datepicker._adjustDate(r,-n,"M")},next:function(){e.datepicker._adjustDate(r,+n,"M")},hide:function(){e.datepicker._hideDatepicker()},today:function(){e.datepicker._gotoToday(r)},selectDay:function(){return e.datepicker._selectDay(r,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return e.datepicker._selectMonthYear(r,this,"M"),!1},selectYear:function(){return e.datepicker._selectMonthYear(r,this,"Y"),!1}};e(this).on(this.getAttribute("data-event"),t[this.getAttribute("data-handler")])})},_generateHTML:function(e){var t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q=new Date,R=this._daylightSavingAdjust(new Date(q.getFullYear(),q.getMonth(),q.getDate())),U=this._get(e,"isRTL"),z=this._get(e,"showButtonPanel"),W=this._get(e,"hideIfNoPrevNext"),X=this._get(e,"navigationAsDateFormat"),V=this._getNumberOfMonths(e),$=this._get(e,"showCurrentAtPos"),J=this._get(e,"stepMonths"),K=V[0]!==1||V[1]!==1,Q=this._daylightSavingAdjust(e.currentDay?new Date(e.currentYear,e.currentMonth,e.currentDay):new Date(9999,9,9)),G=this._getMinMaxDate(e,"min"),Y=this._getMinMaxDate(e,"max"),Z=e.drawMonth-$,et=e.drawYear;Z<0&&(Z+=12,et--);if(Y){t=this._daylightSavingAdjust(new Date(Y.getFullYear(),Y.getMonth()-V[0]*V[1]+1,Y.getDate())),t=G&&t<G?G:t;while(this._daylightSavingAdjust(new Date(et,Z,1))>t)Z--,Z<0&&(Z=11,et--)}e.drawMonth=Z,e.drawYear=et,n=this._get(e,"prevText"),n=X?this.formatDate(n,this._daylightSavingAdjust(new Date(et,Z-J,1)),this._getFormatConfig(e)):n,r=this._canAdjustMonth(e,-1,et,Z)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+n+"'><span class='ui-icon ui-icon-circle-triangle-"+(U?"e":"w")+"'>"+n+"</span></a>":W?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+n+"'><span class='ui-icon ui-icon-circle-triangle-"+(U?"e":"w")+"'>"+n+"</span></a>",i=this._get(e,"nextText"),i=X?this.formatDate(i,this._daylightSavingAdjust(new Date(et,Z+J,1)),this._getFormatConfig(e)):i,s=this._canAdjustMonth(e,1,et,Z)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(U?"w":"e")+"'>"+i+"</span></a>":W?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(U?"w":"e")+"'>"+i+"</span></a>",o=this._get(e,"currentText"),u=this._get(e,"gotoCurrent")&&e.currentDay?Q:R,o=X?this.formatDate(o,u,this._getFormatConfig(e)):o,a=e.inline?"":"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(e,"closeText")+"</button>",f=z?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(U?a:"")+(this._isInRange(e,u)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+o+"</button>":"")+(U?"":a)+"</div>":"",l=parseInt(this._get(e,"firstDay"),10),l=isNaN(l)?0:l,c=this._get(e,"showWeek"),h=this._get(e,"dayNames"),p=this._get(e,"dayNamesMin"),d=this._get(e,"monthNames"),v=this._get(e,"monthNamesShort"),m=this._get(e,"beforeShowDay"),g=this._get(e,"showOtherMonths"),y=this._get(e,"selectOtherMonths"),b=this._getDefaultDate(e),w="";for(S=0;S<V[0];S++){x="",this.maxRows=4;for(T=0;T<V[1];T++){N=this._daylightSavingAdjust(new Date(et,Z,e.selectedDay)),C=" ui-corner-all",k="";if(K){k+="<div class='ui-datepicker-group";if(V[1]>1)switch(T){case 0:k+=" ui-datepicker-group-first",C=" ui-corner-"+(U?"right":"left");break;case V[1]-1:k+=" ui-datepicker-group-last",C=" ui-corner-"+(U?"left":"right");break;default:k+=" ui-datepicker-group-middle",C=""}k+="'>"}k+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+C+"'>"+(/all|left/.test(C)&&S===0?U?s:r:"")+(/all|right/.test(C)&&S===0?U?r:s:"")+this._generateMonthYearHeader(e,Z,et,G,Y,S>0||T>0,d,v)+"</div><table class='ui-datepicker-calendar'><thead>"+"<tr>",L=c?"<th class='ui-datepicker-week-col'>"+this._get(e,"weekHeader")+"</th>":"";for(E=0;E<7;E++)A=(E+l)%7,L+="<th scope='col'"+((E+l+6)%7>=5?" class='ui-datepicker-week-end'":"")+">"+"<span title='"+h[A]+"'>"+p[A]+"</span></th>";k+=L+"</tr></thead><tbody>",O=this._getDaysInMonth(et,Z),et===e.selectedYear&&Z===e.selectedMonth&&(e.selectedDay=Math.min(e.selectedDay,O)),M=(this._getFirstDayOfMonth(et,Z)-l+7)%7,_=Math.ceil((M+O)/7),D=K?this.maxRows>_?this.maxRows:_:_,this.maxRows=D,P=this._daylightSavingAdjust(new Date(et,Z,1-M));for(H=0;H<D;H++){k+="<tr>",B=c?"<td class='ui-datepicker-week-col'>"+this._get(e,"calculateWeek")(P)+"</td>":"";for(E=0;E<7;E++)j=m?m.apply(e.input?e.input[0]:null,[P]):[!0,""],F=P.getMonth()!==Z,I=F&&!y||!j[0]||G&&P<G||Y&&P>Y,B+="<td class='"+((E+l+6)%7>=5?" ui-datepicker-week-end":"")+(F?" ui-datepicker-other-month":"")+(P.getTime()===N.getTime()&&Z===e.selectedMonth&&e._keyEvent||b.getTime()===P.getTime()&&b.getTime()===N.getTime()?" "+this._dayOverClass:"")+(I?" "+this._unselectableClass+" ui-state-disabled":"")+(F&&!g?"":" "+j[1]+(P.getTime()===Q.getTime()?" "+this._currentClass:"")+(P.getTime()===R.getTime()?" ui-datepicker-today":""))+"'"+((!F||g)&&j[2]?" title='"+j[2].replace(/'/g,"&#39;")+"'":"")+(I?"":" data-handler='selectDay' data-event='click' data-month='"+P.getMonth()+"' data-year='"+P.getFullYear()+"'")+">"+(F&&!g?"&#xa0;":I?"<span class='ui-state-default'>"+P.getDate()+"</span>":"<a class='ui-state-default"+(P.getTime()===R.getTime()?" ui-state-highlight":"")+(P.getTime()===Q.getTime()?" ui-state-active":"")+(F?" ui-priority-secondary":"")+"' href='#'>"+P.getDate()+"</a>")+"</td>",P.setDate(P.getDate()+1),P=this._daylightSavingAdjust(P);k+=B+"</tr>"}Z++,Z>11&&(Z=0,et++),k+="</tbody></table>"+(K?"</div>"+(V[0]>0&&T===V[1]-1?"<div class='ui-datepicker-row-break'></div>":""):""),x+=k}w+=x}return w+=f,e._keyEvent=!1,w},_generateMonthYearHeader:function(e,t,n,r,i,s,o,u){var a,f,l,c,h,p,d,v,m=this._get(e,"changeMonth"),g=this._get(e,"changeYear"),y=this._get(e,"showMonthAfterYear"),b="<div class='ui-datepicker-title'>",w="";if(s||!m)w+="<span class='ui-datepicker-month'>"+o[t]+"</span>";else{a=r&&r.getFullYear()===n,f=i&&i.getFullYear()===n,w+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>";for(l=0;l<12;l++)(!a||l>=r.getMonth())&&(!f||l<=i.getMonth())&&(w+="<option value='"+l+"'"+(l===t?" selected='selected'":"")+">"+u[l]+"</option>");w+="</select>"}y||(b+=w+(s||!m||!g?"&#xa0;":""));if(!e.yearshtml){e.yearshtml="";if(s||!g)b+="<span class='ui-datepicker-year'>"+n+"</span>";else{c=this._get(e,"yearRange").split(":"),h=(new Date).getFullYear(),p=function(e){var t=e.match(/c[+\-].*/)?n+parseInt(e.substring(1),10):e.match(/[+\-].*/)?h+parseInt(e,10):parseInt(e,10);return isNaN(t)?h:t},d=p(c[0]),v=Math.max(d,p(c[1]||"")),d=r?Math.max(d,r.getFullYear()):d,v=i?Math.min(v,i.getFullYear()):v,e.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";for(;d<=v;d++)e.yearshtml+="<option value='"+d+"'"+(d===n?" selected='selected'":"")+">"+d+"</option>";e.yearshtml+="</select>",b+=e.yearshtml,e.yearshtml=null}}return b+=this._get(e,"yearSuffix"),y&&(b+=(s||!m||!g?"&#xa0;":"")+w),b+="</div>",b},_adjustInstDate:function(e,t,n){var r=e.selectedYear+(n==="Y"?t:0),i=e.selectedMonth+(n==="M"?t:0),s=Math.min(e.selectedDay,this._getDaysInMonth(r,i))+(n==="D"?t:0),o=this._restrictMinMax(e,this._daylightSavingAdjust(new Date(r,i,s)));e.selectedDay=o.getDate(),e.drawMonth=e.selectedMonth=o.getMonth(),e.drawYear=e.selectedYear=o.getFullYear(),(n==="M"||n==="Y")&&this._notifyChange(e)},_restrictMinMax:function(e,t){var n=this._getMinMaxDate(e,"min"),r=this._getMinMaxDate(e,"max"),i=n&&t<n?n:t;return r&&i>r?r:i},_notifyChange:function(e){var t=this._get(e,"onChangeMonthYear");t&&t.apply(e.input?e.input[0]:null,[e.selectedYear,e.selectedMonth+1,e])},_getNumberOfMonths:function(e){var t=this._get(e,"numberOfMonths");return t==null?[1,1]:typeof t=="number"?[1,t]:t},_getMinMaxDate:function(e,t){return this._determineDate(e,this._get(e,t+"Date"),null)},_getDaysInMonth:function(e,t){return 32-this._daylightSavingAdjust(new Date(e,t,32)).getDate()},_getFirstDayOfMonth:function(e,t){return(new Date(e,t,1)).getDay()},_canAdjustMonth:function(e,t,n,r){var i=this._getNumberOfMonths(e),s=this._daylightSavingAdjust(new Date(n,r+(t<0?t:i[0]*i[1]),1));return t<0&&s.setDate(this._getDaysInMonth(s.getFullYear(),s.getMonth())),this._isInRange(e,s)},_isInRange:function(e,t){var n,r,i=this._getMinMaxDate(e,"min"),s=this._getMinMaxDate(e,"max"),o=null,u=null,a=this._get(e,"yearRange");return a&&(n=a.split(":"),r=(new Date).getFullYear(),o=parseInt(n[0],10),u=parseInt(n[1],10),n[0].match(/[+\-].*/)&&(o+=r),n[1].match(/[+\-].*/)&&(u+=r)),(!i||t.getTime()>=i.getTime())&&(!s||t.getTime()<=s.getTime())&&(!o||t.getFullYear()>=o)&&(!u||t.getFullYear()<=u)},_getFormatConfig:function(e){var t=this._get(e,"shortYearCutoff");return t=typeof t!="string"?t:(new Date).getFullYear()%100+parseInt(t,10),{shortYearCutoff:t,dayNamesShort:this._get(e,"dayNamesShort"),dayNames:this._get(e,"dayNames"),monthNamesShort:this._get(e,"monthNamesShort"),monthNames:this._get(e,"monthNames")}},_formatDate:function(e,t,n,r){t||(e.currentDay=e.selectedDay,e.currentMonth=e.selectedMonth,e.currentYear=e.selectedYear);var i=t?typeof t=="object"?t:this._daylightSavingAdjust(new Date(r,n,t)):this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return this.formatDate(this._get(e,"dateFormat"),i,this._getFormatConfig(e))}}),e.fn.datepicker=function(t){if(!this.length)return this;e.datepicker.initialized||(e(document).on("mousedown",e.datepicker._checkExternalClick),e.datepicker.initialized=!0),e("#"+e.datepicker._mainDivId).length===0&&e("body").append(e.datepicker.dpDiv);var n=Array.prototype.slice.call(arguments,1);return typeof t!="string"||t!=="isDisabled"&&t!=="getDate"&&t!=="widget"?t==="option"&&arguments.length===2&&typeof arguments[1]=="string"?e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this[0]].concat(n)):this.each(function(){typeof t=="string"?e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this].concat(n)):e.datepicker._attachDatepicker(this,t)}):e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this[0]].concat(n))},e.datepicker=new m,e.datepicker.initialized=!1,e.datepicker.uuid=(new Date).getTime(),e.datepicker.version="1.12.1";var w=e.datepicker}),define("vendor/text!features/archiveSearchResult/templates/filter.html",[],function(){return'<div class="list-heading">\n    <div class="filter-button">\n        <span class="closed <%= !hasDefaultSettings ? \'has-filter\' : \'\'%>"></span> <%= strings.filterButton %>\n    </div>\n    <div class="result-count">\n        <% if(hits > 0) { %>\n        <%= strings.showing %> <%= numberFormat(showingFrom) %> - <%= numberFormat(showingTo) %> (<%= numberFormat(hits) %>)\n        <% } %>\n    </div>\n    <div class="result-display-toggle">\n        <span class="im-icon-th-list <%= isSelectedViewType(\'listView\') %>"></span>\n        <span class="im-icon-th-large <%= isSelectedViewType(\'previewView\') %>"></span>\n    </div>\n</div>\n    <div class="filter-options closed">\n        <div class="filter-option by-pubdate">\n            <div class="title"><%= strings.publicationDate %></div>\n            <ul>\n                <li data-pubdate="anytime" class="<%= isSelectedPubDate(\'anytime\') %>"><%= strings.anytime %></li>\n                <li data-pubdate="today" class="<%= isSelectedPubDate(\'today\') %>"><%= strings.today %></li>\n                <li data-pubdate="latest-week" class="<%= isSelectedPubDate(\'latest-week\') %>"><%= strings.latestWeek %></li>\n                <li data-pubdate="latest-month" class="<%= isSelectedPubDate(\'latest-month\') %>"><%= strings.latestMonth %></li>\n                <li data-pubdate="latest-year" class="<%= isSelectedPubDate(\'latest-year\') %>"><%= strings.latestYear %></li>\n                <li data-pubdate="custom" class="<%= isSelectedPubDate(\'custom\') %>"><%= strings.custom %></li>\n            </ul>\n            <div class="custom-date-range closed-date-range">\n                <div class="dates">\n                    <div class="fields">\n                        <fieldset>\n                            <legend><%= strings.from %></legend>\n                            <input <% if(settingFromOrTo === \'from\') { %> checked="checked" <% } %> type="radio" class="date-range" name="date_range" value="from"><input type="text" class="from" name="from" value="<%= from.format(\'YYYY-MM-DD\') %>">\n                        </fieldset>\n                        <fieldset>\n                            <legend><%= strings.to %></legend>\n                            <input <% if(settingFromOrTo === \'to\') { %> checked="checked" <% } %> type="radio" class="date-range" name="date_range" value="to" ><input type="text" class="to" name="to" value="<%= to.format(\'YYYY-MM-DD\') %>">\n                        </fieldset>\n                    </div>\n                    <div class="date-picker">\n                        <div id="datepicker"></div>\n                    </div>\n                </div>\n                <div class="actions">\n                    <div class="action cancel"><%= strings.cancel %></div>\n                    <div class="action ok"><%= strings.ok %></div>\n                </div>\n            </div>\n        </div>\n        <div class="filter-option per-page">\n            <div class="title"><%= strings.showPerPage %></div>\n            <ul>\n                <li data-per-page="10" class="<%= isSelectedPerPage(10) %>">10</li>\n                <li data-per-page="25" class="<%= isSelectedPerPage(25) %>">25</li>\n                <li data-per-page="50" class="<%= isSelectedPerPage(50) %>">50</li>\n            </ul>\n        </div>\n    </div>'}),"use strict",define("archiveSearchFilterView",["backbone","jquery","underscore","baseView","jqueryDatepicker","moment","archiveSearchService","vendor/text!features/archiveSearchResult/templates/filter.html"],function(e,t,n,r,i,s,o,u){function f(){return s().startOf("day")}function l(){return s().subtract(1,"days").startOf("day")}function c(e,t,n){var r=s(e),i="";if(r.isBetween(t,n,"days"))i="within-range";else if(r.isSame(t,"day")||r.isSame(n,"day"))i="same-day";return[!0,i]}function h(e,t,n,r){return isNaN(e)||!e?"":String(e).replace(/(\d)(?=(?:\d{3})+$)/g,"$1"+this.strings.thousandsDelimiter)}var a={perPage:10,byPubdate:"anytime"};return r.extend({className:"search-filter",events:{"tap .filter-button":"toggleFilter","tap .by-pubdate li":"filterByPubdate","tap .per-page li":"changePageSize","tap .result-display-toggle":"toggleResultView","tap .cancel":"cancelCustomDateRange","tap .ok":"useCustomDateRange","tap .date-range":"changeDateRangeSetting","change input.from":"changeFromDate","change input.to":"changeToDate"},initialize:function(e){this.init(e),this.model.set("perPage",a.perPage),this.model.set("byPubdate",a.byPubdate),this.model.set("resultsViewType",o.getResultViewType()),this.model.set("from",l()),this.model.set("to",f()),this.model.set("settingFromOrTo","from"),this.template=n.template(u),this.bindEvents()},changeDateRangeSetting:function(e){this.model.set("settingFromOrTo",t(e.target).val())},hasDefaultSettings:function(){return this.model.get("perPage")===a.perPage&&this.model.get("byPubdate")===a.byPubdate},useCustomDateRange:function(){e.trigger("archiveSearch:filter",{byPubdate:"custom",perPage:this.model.get("perPage"),from:s(this.model.get("from")).startOf("day").format("YYYY-MM-DDTHH:mm:ss\\Z"),to:s(this.model.get("to")).startOf("day").format("YYYY-MM-DDTHH:mm:ss\\Z")}),this.model.set("byPubdate","custom"),this.$(".custom-date-range").toggleClass("closed-date-range")},changeFromDate:function(e){this.model.set("from",s(e.target.value)),this.changeDate()},changeToDate:function(e){this.model.set("to",s(e.target.value)),this.changeDate()},changeDate:function(){var e=this.model.get("from"),t=this.model.get("to");this.$("#datepicker").datepicker("option",{beforeShowDay:function(n){return c(n,e,t)}}),this.$("#datepicker").datepicker("refresh")},cancelCustomDateRange:function(){this.$(".custom-date-range").toggleClass("closed-date-range")},render:function(e){var t=this.model.get("resultsViewType"),n=this.model.get("perPage"),r=this.model.get("byPubdate"),i=this.model.get("from"),o=this.model.get("to"),u=this.model.get("settingFromOrTo"),a={strings:this.strings,hasDefaultSettings:this.hasDefaultSettings(),byPubdate:r,perPage:n,hits:e&&e.totalElements?e.totalElements:0,isSelectedPubDate:function(e){return e===r?"selected":""},isSelectedPerPage:function(e){return e===n?"selected":""},isSelectedViewType:function(e){return e===t?"selected":""},from:i,to:o,showingFrom:e?(e.page-1)*n+1:"",showingTo:e?(e.page-1)*n+e.size:"",numberFormat:h,settingFromOrTo:u};this.$el.html(this.template(a));var f=function(e){var t=s(e,"MM/DD/YYYY"),n=this.model.get("settingFromOrTo");this.model.set(n,t),this.$("."+n).val(t.format("YYYY-MM-DD")),this.changeDate()}.bind(this);return this.$("#datepicker").datepicker({beforeShowDay:function(e){return c(e,i,o)},dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],firstDay:1,prevText:"",nextText:"",onSelect:f,maxDate:0}),this.delegateEvents(),this},toggleResultView:function(t){var n=this.model.get("pubdate"),r=this.model.get("perPage"),i=this.model.get("resultsViewType");i==="listView"?i="previewView":i="listView",this.model.set("resultsViewType",i),e.trigger("archiveSearch:changeViewLayout",{viewType:i}),e.trigger("archiveSearch:filter",{byPubdate:n,perPage:r})},toggleFilter:function(){this.$(".filter-options").toggleClass("closed"),this.$(".filter-button span").toggleClass("closed"),this.$(".filter-button span").toggleClass("open")},filterByPubdate:function(n){if(t(n.target).data("pubdate")==="custom"){this.$(".custom-date-range").toggleClass("closed-date-range");return}var r=t(n.target).data("pubdate"),i=this.model.get("perPage");this.model.set("byPubdate",r),e.trigger("archiveSearch:changeByPubdate",r),e.trigger("archiveSearch:filter",{byPubdate:r,perPage:i}),this.$(".filter-options").toggleClass("closed")},changePageSize:function(n){var r=t(n.target).data("perPage"),i=this.model.get("byPubdate");this.model.set("perPage",r),e.trigger("archiveSearch:changePerPage",r),e.trigger("archiveSearch:filter",{byPubdate:i,perPage:r}),this.$(".filter-options").toggleClass("closed")},bindEvents:function(){return this},unbindEvents:function(){return this}})}),define("vendor/text!features/archiveSearchResult/templates/latestSearches.html",[],function(){return'<div class="latest-search-terms"> <!-- Show when input length === 0 -->\n    <div class="title"><%= header %></div>\n    <% if(latestSearches.length > 0) { %>\n    <ul>\n        <% _.each(latestSearches, function(item) { %>\n            <li class="search-term"><%= item %></li>\n        <% } ); %>\n        <li class="clear-previous-searches"><%= strings.clearPreviousSearches %></li>\n    </ul>\n    <% } else { %>\n        <div class="no-previous-searches"><%= strings.noSearchesYet %></div>\n    <% } %>\n</div>\n'}),define("vendor/text!features/archiveSearchResult/templates/archiveSearchResult.html",[],function(){return'<ul class="list-body">\n    <% if(searchResult.content.length === 0) { %>\n        <li class="no-results"><%= strings.noResults %></li>\n    <% } else { %>\n    <% _.each(searchResult.content, function(i) { %>\n        <li class="item">\n            <a class="issue-link"\n               title="<%= strings.goToIssueTitle %>"\n               href="#pages/<%= i.issue_id %>/<%= i.part_id %>/<%= i.pagina %>"\n               data-pagina="<%= i.pagina %>"\n               data-part-id="<%= i.part_id %>"\n               data-issue-id="<%= i.issue_id %>">\n                <div class="thumbnail">\n                    <img data-page="<%= i.pagina %>"\n                        data-part-id="<%= i.part_id %>"\n                        data-pub-date="<%= i.pubdate %>"\n                        data-issue-id="<%= i.issue_id %>"\n                        data-left-url="<%= i.left_thumbnail_url %>"\n                        data-right-url="<%= i.right_thumbnail_url %>"\n                        src="<%= correctThumbnail(i) %>">\n                </div>\n                <div class="details">\n                    <div class="pub-date"><%= formatPubdate(i.pubdate) %></div>\n                    <div class="issue"><%= formatPubday(i.pubdate) %>, <%= strings.page %> <%= i.pagina %> (<%= strings.part %> <%= i.part_id %>)</div>\n                    <div class="text" lang="<%= strings.langAttribute %>"><%= i.text %> &#x2026;</div>\n                </div>\n            </a>\n        </li>\n    <% } ); %>\n    <% } %>\n</ul>'}),define("vendor/text!features/archiveSearchResult/templates/archiveSearchResultPreview.html",[],function(){return'<ul class="list-body spread">\n    <% if(searchResult.content.length === 0) { %>\n        <li class="no-results"><%= strings.noResults %></li>\n    <% } else { %>\n    <% _.each(searchResult.content, function(i) { %>\n        <li class="item">\n            <a href="#pages/<%= i.issue_id %>/<%= i.part_id %>/<%= i.pagina %>"\n               class="issue-link"\n               data-pagina="<%= i.pagina %>"\n               data-part-id="<%= i.part_id %>"\n               data-issue-id="<%= i.issue_id %>">\n                <div class="details">\n                    <div>\n                        <div class="pub-date"><%= formatPubdate(i.pubdate) %></div>\n                        <div class="issue"><%= formatPubday(i.pubdate) %>, <%= strings.page %> <%= getPages(i) %> (<%= strings.part %> <%= i.part_id %>)</div>\n                    </div>\n                </div>\n                <div class="thumbnail <%= singlePage(i) %>">\n                    <% if(i.left_thumbnail_url) { %><img src="<%=i.left_thumbnail_url %>"><% } %><% if(i.right_thumbnail_url) { %><img src="<%=i.right_thumbnail_url %>"><% } %>\n                </div>\n                <div class="text" lang="<%= strings.langAttribute %>"><%= i.text %> &#x2026;</div>\n            </a>\n        </li>\n    <% } ); %>\n    <% } %>\n</ul>'}),"use strict",define("archiveSearchResultView",["backbone","jquery","underscore","dateUtility","deviceUtility","archiveSearchService","baseView","sidebarView","scrollTo","archiveSearchPaginationView","archiveSearchFilterView","vendor/text!features/archiveSearchResult/templates/latestSearches.html","vendor/text!features/archiveSearchResult/templates/archiveSearchResult.html","vendor/text!features/archiveSearchResult/templates/archiveSearchResultPreview.html"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){function v(e){return r.dateToStringFormat(e,"%%date%% %%month%% %%year%%")}function m(e){return r.dateToStringFormat(e,"%%weekday%%")}function g(e,t){return e&&!t||!e&&t}function y(e){return e.pagina%2===0||e.pagina===1?e.pagina+(e.right_thumbnail_url&&e.left_thumbnail_url?"-"+(e.pagina+1):""):e.pagina-1+(e.right_thumbnail_url&&e.left_thumbnail_url?"-"+e.pagina:"")}function b(e){return e.content=n.uniq(e.content,function(e){return e.left_thumbnail_url}),e}var d="";return o.extend({tagName:"nav",className:"archive-search-result-list",events:{"tap .latest-search-terms li.search-term":"searchFromLatestSearches","tap .clear-previous-searches":"clearPreviousSearches","tap .issue-link":"detailsClick",keyup:"keyHandler"},initialize:function(e){this.init(e),this.keyHandler=this.keyHandler.bind(this),this.viewTypes={listView:n.template(h),previewView:n.template(p)},i.isAndroid()?d="android":i.isiOS()&&(d="ios"),this.latestSearchesTemplate=n.template(c),this.model.set("showLatestSearches",!0),this.model.set("resultsViewType",s.getResultViewType()),this.model.set("selectedIndex",0),this.sidebar=new u({hideOnTap:this.model.get("hideOnSidebarTap"),position:this.model.get("position"),transitTime:this.model.get("transitTime"),animate:this.model.get("animate"),externalClassName:d+" "+this.model.get("className")}),this.pagination=new f({}),this.filter=new l({strings:this.strings.filter}),this.addView.call(this,this.sidebar),this.addView.call(this,this.pagination),this.addView.call(this,this.filter),this.bindEvents()},detailsClick:function(e){!e.metaKey&&!e.shiftKey&&!e.ctrlKey&&(e.preventDefault(),this.goToIssue(t(e.target).closest(".issue-link")))},clearPreviousSearches:function(){s.clearPreviousSearches(),this.inputCleared()},keyHandler:function(e){switch(e.which){case 40:this.selectedDown();break;case 38:this.selectedUp();break;case 13:this.selectedChoose()}},selectedChoose:function(){var t=this.model.get("selectedIndex");this.model.get("showLatestSearches")?e.trigger("inputArchiveSearchQuery",this.getSelected().text()):t>0&&this.goToIssue(this.getSelected().find(".issue-link"))},getSelected:function(){var e=this.model.get("selectedIndex");return this.model.get("showLatestSearches")?t(".latest-search-terms .search-term:nth-child("+e+")"):t(".list-body > .item:nth-child("+e+")")},selectedDown:function(){var e=this.getNewIndex();this.getSelected().toggleClass("selected"),this.model.set("selectedIndex",e),this.getSelected().toggleClass("selected");if(!this.model.get("showLatestSearches")){var t=this.getSelected();this.$el.parent().scrollTo(t,250)}},getNewIndex:function(){var e,n=this.model.get("selectedIndex");return this.model.get("showLatestSearches")?e=t(".latest-search-terms .search-term").length:e=t(".list-body > .item").length,n===e?n:n+1},selectedUp:function(){var e=this.model.get("selectedIndex"),t=e>1?e-1:1,n;e!==t&&(this.getSelected().toggleClass("selected"),this.model.set("selectedIndex",t),n=this.getSelected().toggleClass("selected"),this.model.get("showLatestSearches")||this.$el.parent().scrollTo(n,250))},goToIssue:function(t){var n=t.data("issue-id"),r=t.data("part-id"),i=t.data("pagina");if(!n||!r||!i)return;e.trigger("archiveSearch:goToIssue"),e.trigger("setRoute",{route:"pages/"+n+"/"+r+"/"+i,trigger:!0})},searchFromLatestSearches:function(n){e.trigger("inputArchiveSearchQuery",t(n.target).text())},render:function(){return this.sidebar.render(this.$el),this.filter.render(),this.showLatestSearches(),this.sidebar},showLatestSearches:function(){this.model.set("selectedIndex",0),this.model.set("showLatestSearches",!0),this.$el.html(this.latestSearchesTemplate({header:this.strings.latest.header,latestSearches:s.getLatestSearches(),strings:this.strings.latest}))},search:function(t){e.trigger("archiveSearch:filter",{byPubdate:this.model.get("byPubdate"),perPage:this.model.get("perPage"),page:t.page})},inputCleared:function(){this.showLatestSearches()},changePerPage:function(e){this.model.set("perPage",e)},changeByPubdate:function(e){this.model.set("byPubdate",e)},bindEvents:function(){return this.unbindEvents(),e.on("archiveSearch:clearInput",this.inputCleared,this),e.on("archiveSearch:changePage",this.search,this),e.on("archiveSearch:changePerPage",this.changePerPage,this),e.on("archiveSearch:changeByPubdate",this.changeByPubdate,this),e.on("archiveSearch:changeViewLayout",this.changeViewLayout,this),e.on("orientationchange",this.orientationChange,this),e.on("archiveSearch:result",this.handleSearchResult,this),document.addEventListener("keyup",this.keyHandler,!0),this},unbindEvents:function(){return e.off("archiveSearch:clearInput",this.inputCleared,this),e.off("archiveSearch:changePage",this.search,this),e.off("archiveSearch:changePerPage",this.changePerPage,this),e.off("archiveSearch:changeByPubdate",this.changeByPubdate,this),e.off("archiveSearch:changeViewLayout",this.changeViewLayout,this),e.off("orientationchange",this.orientationChange,this),e.off("archiveSearch:result",this.handleSearchResult,this),document.removeEventListener("keyup",this.keyHandler,!0),this},changeViewLayout:function(e){this.model.set("resultsViewType",e.viewType),s.setResultViewType(e.viewType),this.model.set("selectedIndex",0)},orientationChange:function(){this.sidebar&&this.sidebar.orientationChange()},handleSearchResult:function(e){var t,n;this.$el.empty(),this.model.set("selectedIndex",0),this.model.set("showLatestSearches",!1);if(e.error)return;t=this.model.get("resultsViewType"),n=this.viewTypes[t],this.$el.append(this.filter.render(e).$el),this.$el.append(n({searchResult:t==="previewView"?b(e):e,getPages:y,formatPubdate:v,formatPubday:m,strings:this.strings.results,singlePage:function(e){return g(e.right_thumbnail_url,e.left_thumbnail_url)?"single":""},correctThumbnail:function(e){return e.pagina%2===1&&e.right_thumbnail_url?e.right_thumbnail_url:e.left_thumbnail_url}})),e.totalPages>1&&this.$el.append(this.pagination.render(e).$el)}})}),"use strict",define("archiveSearchResultFeature",["baseFeature","archiveSearchResultView"],function(e,t){return function(){this.feature=_.extend({},e),this.feature.setView.call(this.feature,t),this.feature.setModel.call(this.feature)}}),"use strict",define("currentUserModel",["baseFeatureModel","backbone","authService","sessionService"],function(e,t,n,r){return e.extend({initialize:function(){this.authByIconAtemtKey="abi",r.get(this.authByIconAtemtKey)&&(r.destroy(this.authByIconAtemtKey),n.cleanlogin())},onTapped:function(){var e=this;return n.isLoggedIn(function(){n.logout(),t.trigger("userlogout")},function(){r.put(e.authByIconAtemtKey,!0),n.authenticate(function(){t.trigger("userlogin"),r.destroy(e.authByIconAtemtKey)},function(){t.trigger("userlogout"),t.trigger("setRoute",{route:"logout",trigger:!0})})}),this}})}),define("vendor/text!features/currentUser/templates/currentUserTemplate.html",[],function(){return'<% if (showUserName) { %>\n<% var userNameInParts = currentUser.split(" "); %>\n<% var truncatedName = this.viewHelpers.StringUtility.truncate(userNameInParts[0], 10, ""); %>\n<span class="icon-link-info <%= truncatedName.indexOf(\'\') !== -1 ? \'truncated-username\' : \'\' %>"><%= truncatedName %></span>\n<% } %>\n<% if (iconText) { %>\n<span class="icon-link-text"><%= iconText %></span>\n<% } %>\n\n<% var currentIconName = isLoggedIn ? iconName.active : iconName.inactive %>\n<span class="icon-link-icon"><i class="<%= currentIconName %>"></i></span>'}),"use strict",define("currentUserView",["backbone","baseFeatureView","hammer","authService","vendor/text!features/currentUser/templates/currentUserTemplate.html"],function(e,t,n,r,i){return t.extend({className:"auth-icon icon-link",events:{tap:"tap"},initialize:function(e){this.init(e),this.isLoggedIn=!1,this.currentUserHTML=_.template(i),this.bindEvents().addHooks()},addHooks:function(){this.addHook.call(this,"afterRender",function(){var e=this;r.isLoggedIn(function(){e.userLoggedIn()},function(){e.userLoggedOut()})})},tap:function(){this.model.tapped.call(this.model)},bindEvents:function(){return this.unbindEvents(),e.on("userlogout",this.userLoggedOut,this),e.on("userlogin",this.userLoggedIn,this),this},unbindEvents:function(){return e.off("userlogout",this.userLoggedOut,this),e.off("userlogin",this.userLoggedIn,this),this},userLoggedIn:function(){var e=this;r.getUserDisplayName(function(t){e.isLoggedIn=!0,e.userDisplayName=decodeURIComponent(t),e.render()})},userLoggedOut:function(){this.isLoggedIn=!1,this.render()},render:function(){var e=this.model.get("showUserName");return e&&(e=this.isLoggedIn?e.active:e.inactive),this.$el.html(this.currentUserHTML({iconName:this.model.get("iconName"),currentUser:this.isLoggedIn?this.userDisplayName:"",iconText:this.isLoggedIn?this.strings.iconText.logout:this.strings.iconText.login,showUserName:e,isLoggedIn:this.isLoggedIn})),this.$el.addClass(this.model.get("className")),this.isLoggedIn?this.$el.addClass("active"):this.$el.removeClass("active"),this}})}),"use strict",define("currentUserFeature",["underscore","backbone","baseFeature","currentUserModel","currentUserView"],function(e,t,n,r,i){return function(){this.feature=e.extend({},n);var t=new r;this.feature.setView.call(this.feature,i).setModel.call(this.feature,t)}}),define("vendor/text!components/info/templates/infoView.html",[],function(){return'<div id="info-content">\n    <h1 class="info-heading"><%= strings.title %></h1>\n\n    <div id="box-container">\n    <% viewOptions.instructions.forEach(function(instruction) { %>\n        <div class="info-box">\n\n            <div class="info-box-img">\n                <img src="<%= instruction.imgSrc %>" />\n            </div>\n\n            <div class="info-box-body">\n                <p class="info-text-header"><%= strings.instructions[instruction.name].title %></p>\n                <p class="info-text"><%= strings.instructions[instruction.name].message %></p>\n            </div>\n        </div>\n\n    <% }); %>\n    </div>\n</div>'}),"use strict",define("infoView",["backbone","underscore","baseView","vendor/text!components/info/templates/infoView.html"],function(e,t,n,r){return n.extend({id:"info-element",className:"info-wrapper",toggleClass:"move-up",inViewport:!1,initialize:function(e){this.init(e),this.infoHTML=t.template(r),this.toggleClass=this.viewOptions.toggleClass,this.inViewport=this.viewOptions.inViewport,this.bindEvents(),this.addHook.call(this,"beforeClose",function(){delete this.infoHTML})},render:function(){return this.$el.html(this.infoHTML(this.templateModel)),this},bindEvents:function(){this.unbindEvents(),e.on("info:toggle",this.toggle,this)},unbindEvents:function(){return e.off("info:toggle",this.toggle,this),this.inViewport&&(e.trigger("overlayElementClose","info"),this.$el.removeClass(this.toggleClass)),this},toggle:function(){return this.inViewport?(e.trigger("overlayElementClose","info"),this.$el.removeClass(this.toggleClass)):(e.trigger("overlayElementOpen","info"),this.$el.addClass(this.toggleClass)),this.inViewport=!this.inViewport,this}})}),"use strict",define("infoComponent",["backbone","app","underscore","baseComponent","infoView"],function(e,t,n,r,i){var s=n.extend({},r);return s.name="info",s.features=[],s.routes={},s.view=i,s.open=function(e){e=e||{},t.renderComponentView(s,e,function(){s.ready(e.componentReady)})},s.beforeClose=function(){},s.closeComponent=function(){t.closeComponent(s)},e.on(s.name+":open",s.open,s),e.on(s.name+":beforeClose",s.beforeClose,s),e.on(s.name+":close",s.closeComponent,s),s}),"use strict",define("queueUtility",[],function(){return function(e){var t=[],n=function(){t.length>0?e.hasOwnProperty("itemCallback")&&e.itemCallback(t.shift(),n):e.hasOwnProperty("done")&&(e.done(),e.cleanupOnDone&&(t=[]))};this.addItem=function(e){return t.push(e),this},this.startQueueProcess=function(){return n(),this}}}),"use strict",define("burtHelper",["backbone"],function(e){function t(t){window.burtApi=window.burtApi||[];var u=document.getElementsByTagName("head")[0],a=document.createElement("script");a.setAttribute("src",t.providerSrc),u.appendChild(a),e.on("stat:init",n),e.on("stat:userlogin",r),e.on("stat:userlogout",i),e.on("stat:openIssue",s),e.on("stat:downloadIssue",o)}function n(e){window.burtApi.push(function(){e.userId&&window.burtApi.connect("burt.beacon","serviceplus-id",e.userId),window.burtApi.annotate("dn-epaper","device",e.deviceType)})}function r(e){window.burtApi.push(function(){window.burtApi.connect("burt.beacon","serviceplus-id",e.userId),window.burtApi.annotate("dn-epaper","login","logged-in")})}function i(){window.burtApi.push(function(){window.burtApi.annotate("dn-epaper","login","logged-out")})}function s(e){window.burtApi.push(function(){window.burtApi.annotate("dn-epaper","issue-opened",JSON.stringify(e))})}function o(e){window.burtApi.push(function(){window.burtApi.annotate("dn-epaper","issue-downloaded",JSON.stringify(e))})}e.on("stat:setup:burt",t)}),"use strict",define("googleTagManager",["backbone"],function(e){function n(n){window.dataLayer=window.dataLayer||[],t=n.productName,e.on("stat:init",r),e.on("stat:userlogin",i),e.on("stat:userlogout",s),e.on("stat:openIssue",o),e.on("stat:downloadIssue",u),e.on("stat:pageView",a),e.on("stat:articleEventLayerTapped",f),e.on("stat:articleView",l)}function r(e){window.dataLayer.push({event:"init",device:e.deviceType,product:t})}function i(e){window.dataLayer.push({event:"logged-in",serviceplusId:e.userId})}function s(){window.dataLayer.push({event:"logged-out"})}function o(e){window.dataLayer.push({event:"issue-opened",issueDate:e.issueDate,issueMode:e.issueMode,issueDownloaded:e.issueDownloaded})}function u(e){window.dataLayer.push({event:"issue-downloaded",issueDate:e.issueDate})}function a(e){window.dataLayer.push({event:"page-show",pagina:e.pagina,section:e.section})}function f(e){window.dataLayer.push({event:"page-article-tapped","newspilot-article-id":e.articleId})}function l(e){window.dataLayer.push({event:"article-show","newspilot-article-id":e.get("id"),part:e.get("part"),pagina:e.get("pagina"),section:e.get("section"),articleType:e.get("articleType"),title:e.get("title")})}var t="";e.on("stat:setup:googleTagManager",n)}),"use strict",define("statService",["jquery","underscore","dataService","requestService","issueService"],function(e,t,n,r,i){function h(){return n.online()?"Online":"Offline"}function p(){return i.getCurrentPartId()}function d(){return i.getCurrentIssueModel().get("pubdate")}function v(){return i.getCurrentIssueModel().get("downloaded")}function m(e){var n="",i;if(!e)return;n="",t.forEach(e,function(e,t){n+=t+"="+encodeURIComponent(e)+"&"}),n=n.slice(0,-1),i=f+n,r.stat(i,function(){a=o},function(){a++,a>=u})}var s={},o=0,u=5,a=o,f="https://www.google-analytics.com/collect?",l={},c;return s.connect=function(e,t){switch(e){case"user-id":l.uid=t;break;case"device":l.cd11=t}},s.notice=function(t,n){var r=e.extend({},l);switch(t){case"issue-fetched":r.ec="Issue",r.ea="Fetched",r.el="User fetched issue "+c.publisher.name+" "+c.name+" "+n.pubdate,r.cd1=n.pubdate.slice(0,4),r.cd2=n.pubdate.slice(5,7),r.cd3=n.pubdate.slice(8,10);break;case"issue-opened":r.ec="Issue",r.ea="Open",r.el="User opens issue "+c.publisher.name+" "+c.name+" "+n.issueDate,r.cd1=n.issueDate.slice(0,4),r.cd2=n.issueDate.slice(5,7),r.cd3=n.issueDate.slice(8,10),r.cd6=h(),r.cd11=n.issueDownloaded,r.cd12=n.issueMode;break;case"issue-downloaded":r.ec="Issue",r.ea="Download",r.el="User downloads issue "+c.publisher.name+" "+c.name+" "+n.issueDate,r.cd1=n.issueDate.slice(0,4),r.cd2=n.issueDate.slice(5,7),r.cd3=n.issueDate.slice(8,10),r.cd10="Manual";break;case"articleview":r.ec="Issue",r.ea="ArticleView",r.el='User views article "'+n.title+'" in '+c.publisher.name+" "+c.name+" "+d(),r.dp="/"+window.location.hash,r.dt=n.title,r.cd1=d().slice(0,4),r.cd2=d().slice(5,7),r.cd3=d().slice(8,10),r.cd6=h(),r.cd7=p(),r.cd8=n.section,r.cd9=n.pagina,r.cd11=v();break;case"pageview":r.ec="Issue",r.ea="PageView",r.el="User views page "+n.pagina+" in "+c.publisher.name+" "+c.name+" "+d(),r.dp="/"+window.location.hash,r.dt="Page "+n.pagina,r.cd1=d().slice(0,4),r.cd2=d().slice(5,7),r.cd3=d().slice(8,10),r.cd6=h(),r.cd7=p(),r.cd8=n.section,r.cd9=n.pagina,r.cd11=v();break;case"page-print":r.ec="Issue",r.ea="PagePrint",r.el="User prints pages from "+c.publisher.name+" "+c.name+" "+d(),r.cd1=d().slice(0,4),r.cd2=d().slice(5,7),r.cd3=d().slice(8,10),r.cd6=h(),r.cd7=p(),r.cd11=v(),r.cd13=n.pageRange}m(r)},s.startTracking=function(e,t,n){c=t,l.v=1,l.tid=e,l.cid=n,l.qt=0,l.t="event",l.cd4=c.publisher.id,l.cd5=c.id},s}),"use strict",define("imStat",["backbone","statService","dataService"],function(e,t,n){function r(r,v){n.getTrackingUUID(function(n){t.startTracking(r.trackingId,v,n),e.on("stat:init",i),e.on("stat:userlogin",s),e.on("stat:userlogout",o),e.on("stat:openIssue",u),e.on("stat:downloadIssue",a),e.on("stat:articleEventLayerTapped",f),e.on("textSizeTriggered",l),e.on("stat:articleView",c),e.on("stat:pageView",h),e.on("stat:issueFetched",p),e.on("stat:pagePrint",d)})}function i(e){e.userId&&t.connect("user-id",e.userId),t.connect("device",e.deviceType)}function s(e){t.connect("user-id",e.userId),t.notice("login","logged-in")}function o(){t.notice("login","logged-out")}function u(e){t.notice("issue-opened",e)}function a(e){t.notice("issue-downloaded",e)}function f(e){t.notice("article-event-layer-tapped",e)}function l(e){t.notice("text-size-triggered",e)}function c(e){t.notice("articleview",e.toJSON())}function h(e){t.notice("pageview",e)}function p(e){t.notice("issue-fetched",e.toJSON())}function d(e){t.notice("page-print",e)}e.on("stat:setup:infomaker",r)}),"use strict",define("imBilling",["backbone","jquery","dataService","requestService","cookieService"],function(e,t,n,r,i){function v(t,r){n.getTrackingUUID(function(n){u=r,h.v=1,h.tid=t.trackingId,h.cid=n,h.qt=0,h.t="event",h.ec="Consumed Issue",h.cd1=u.publisher.id,h.cd2=u.id,h.cd3=u.publisher.name,h.cd4=u.name,e.on("stat:init",y),e.on("stat:userlogin",b),e.on("stat:issueFetched",w),e.on("stat:downloadStarted",E),e.on("stat:downloadCompleted",S),e.on("stat:pagePrint",x)})}function m(){p=[],i.hasItem(d)&&(p=i.getItem(d).split(","))}function g(){var e=new Date,t=new Date(e.getFullYear(),e.getMonth()+1,0,23,59,59);i.setItem(d,p.join(","),t)}function y(e){e.userId&&(s=e.userId),o=e.deviceType}function b(e){s=e.userId}function w(e){var n,r=e.get("issueid");if(o!=="web")return;m();if(p.indexOf(r)>=0)return;p.push(r),n=t.extend({},h),e=e.toJSON(),n.ea="Fetched",n.el=""+u.publisher.name+" "+u.name+" "+e.pubdate,n.cd5=e.pubdate,n.cd6=e.issueid,n.cd7=e.revision,T(n)}function E(e){var n=t.extend({},h);n.ea="Download Started",n.el=""+e.publisherName+" "+e.productName+" "+e.publicationDate,n.cd1=e.publisherId,n.cd2=e.productId,n.cd3=e.publisherName,n.cd4=e.productName,n.cd5=e.publicationDate,n.cd6=e.issueId,n.cd7=e.revision,n.cd8=e.eventType,T(n)}function S(e){var n=t.extend({},h);n.ea="Download Finished",n.el=""+e.publisherName+" "+e.productName+" "+e.publicationDate,n.cd1=e.publisherId,n.cd2=e.productId,n.cd3=e.publisherName,n.cd4=e.productName,n.cd5=e.publicationDate,n.cd6=e.issueId,n.cd7=e.revision,n.cd8=e.eventType,T(n)}function x(e){var n=t.extend({},h);n.ea="Page Print",n.el=""+u.publisher.name+" "+u.name+" "+e.pubDate,n.cd1=u.publisher.id,n.cd2=u.id,n.cd3=u.publisher.name,n.cd4=u.name,n.cd5=e.pubDate,n.cd6=e.issueId,n.cd7=e.revision,n.cd9=e.pageRange,n.cm1=e.pages.length,T(n)}function T(e){var t="",n;if(!e)return;t="",_.forEach(e,function(e,n){t+=n+"="+encodeURIComponent(e)+"&"}),t=t.slice(0,-1),n=c+t,r.stat(n,function(){l=a,o==="web"&&g()},function(){l++,l>=f})}var s,o,u,a=0,f=5,l=a,c="https://www.google-analytics.com/collect?",h={},p=[],d="consumedIssues";e.on("stat:setup:infomakerBilling",v)}),"use strict",define("cxenseWrapper",["backbone"],function(e){function n(n){t=n.siteId||!1,e.on("stat:openIssue",o)}function r(e){}function i(e){}function s(){}function o(e){t&&window.cX&&(window.cX.initializePage(),window.cX.setSiteId(t),window.cX.sendPageViewEvent())}function u(e){}var t;e.on("stat:setup:cxense",n)}),"use strict",define("bonnierIPA",["backbone","jquery","localService"],function(e,t,n){function u(e){function o(e){var n=e.scripts||{},r=[];Object.keys(n).forEach(function(e){var i=document.getElementsByTagName(e)[0];n[e].forEach(function(e){var n=t.Deferred(),s=document.createElement("script");s.src="https:"+e,i.appendChild(s),s.onload=n.resolve,s.onerror=n.resolve,r.push(n)})}),t.when.apply(t,r).done(a)}function u(e){var t=n.get(e);if(t!==null)try{t=JSON.parse(t)}catch(r){console.log("Unable to parse "+e),t=null}else console.log("No "+e+" from remote or local found!");return t}(function(){function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:undefined};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n}if(typeof window.CustomEvent=="function")return!1;e.prototype=window.Event.prototype,window.CustomEvent=e})();var f=window.epaperClient.bonnierIPASettings||u(r),l=window.epaperClient.bonnierIPAProduct||u(i);if(!f||!l)return;n.put(r,JSON.stringify(f)),n.put(i,JSON.stringify(l)),s=l.name,o(f)}function a(){if(!Array.isArray(o))return;o.forEach(function(e){document.dispatchEvent(e)}),o=null}function f(e){Array.isArray(o)?o.push(e):document.dispatchEvent(e)}function l(e,t){var n=new CustomEvent("analys:"+e,{detail:t});f(n)}function c(e){var t={device:e.deviceType,product:s};e.userId&&(t["serviceplus-id"]=e.userId),l("init",t)}function h(e){l("logged-in",{serviceplusId:e.userId})}function p(){l("logged-out",{})}function d(e){l("issue-opened",{issueDate:e.issueDate,issueMode:e.issueMode,issueDownloaded:e.issueDownloaded})}function v(e){l("issue-downloaded",{issueDate:e.issueDate})}function m(e){l("page-show",{pagina:e.pagina,section:e.section})}function g(e){l("page-article-tapped",{"newspilot-article-id":e.articleId})}function y(e){l("article-show",{"newspilot-article-id":e.get("id"),part:e.get("part"),pagina:e.get("pagina"),section:e.get("section"),articleType:e.get("articleType"),title:e.get("title")})}var r="bonnierIPASettings",i="bonnierIPAProduct",s,o=[];e.on("stat:setup:bonnierIPA",u),e.on("stat:init",c),e.on("stat:userlogin",h),e.on("stat:userlogout",p),e.on("stat:openIssue",d),e.on("stat:downloadIssue",v),e.on("stat:pageView",m),e.on("stat:articleEventLayerTapped",g),e.on("stat:articleView",y)}),"use strict",define("googleTagManagerExtended",["backbone"],function(e){function n(n,c){window.dataLayer=window.dataLayer||[],t=c.name,e.on("stat:init",r),e.on("stat:userlogin",i),e.on("stat:userlogout",s),e.on("stat:openIssue",o),e.on("stat:downloadIssue",u),e.on("stat:pageView",a),e.on("stat:articleEventLayerTapped",f),e.on("stat:articleView",l)}function r(e){window.dataLayer.push({event:"init",device:e.deviceType,product:t})}function i(e){window.dataLayer.push({event:"logged-in",serviceplusId:e.userId})}function s(){window.dataLayer.push({event:"logged-out"})}function o(e){window.dataLayer.push({event:"issue-opened",issueDate:e.issueDate,issueMode:e.issueMode,issueDownloaded:e.issueDownloaded,product:t})}function u(e){window.dataLayer.push({event:"issue-downloaded",issueDate:e.issueDate})}function a(e){window.dataLayer.push({event:"page-show",pagina:e.pagina,section:e.section,product:t})}function f(e){window.dataLayer.push({event:"page-article-tapped","newspilot-article-id":e.articleId})}function l(e){window.dataLayer.push({event:"article-show","newspilot-article-id":e.get("id"),part:e.get("part"),pagina:e.get("pagina"),section:e.get("section"),articleType:e.get("articleType"),title:e.get("title"),product:t})}var t="";e.on("stat:setup:googleTagManagerExtended",n)}),"use strict",define("statUtility",["backbone","deviceUtility","apiService","burtHelper","googleTagManager","imStat","imBilling","cxenseWrapper","bonnierIPA","googleTagManagerExtended"],function(e,t,n,r,i,s,o,u,a,f){return window.s={statsAPIPublicKey:"3epivpkCnhFYcDoJj2uJQvgXe"},{setup:function(t,r){var i=document.createElement("script"),s=document.getElementsByTagName("head")[0],o=n.getStatscriptUrl();s.appendChild(i),i.onload=function(){t.forEach(function(t){e.trigger("stat:setup:"+t.name,t,r)})},i.setAttribute("src",o)}}}),"use strict",define("autoloader",["requestService","issueService","queueUtility","jquery","apiService","dateUtility","deviceUtility","downloadService","sessionService","localService","statUtility","advertUtility","authService","dataService"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){var d={},v,m,g=o.isRunningAsHybridApplication,y=o.hasTouchSupport,b=o.isiOS(),w=o.isAndroid(),E=o.isPdfCompatible(),S=function(){var e=v.product.id,n=v.product.authId?v.product.authId:v.product.id,r=v.product.authenticationServiceIdentifier||"";p.setSelections(v.selections),f.setOverrideId(v.uuid),f.setProductId(e),a.setProductId(e),v.hasOwnProperty("issuesResultsRange")&&t.setResultsRange(v.issuesResultsRange),i.setProductId(e),i.setProductUuid(v.product.uuid),i.setAuthId(n),i.setAuthenticationServiceIdentifier(r),i.setProductName(v.product.name),i.setEnvironment(v.environment),i.setTokenPrefix(v.tokenPrefix)},x=function(){s.setDateStrings(m.dateUtility)},T=function(){u.setDialogStrings(m.downloadService)},N=function(){c.setAdPointer(m.advertUtility.adPointer)},C=function(){h.setAuthStrings(m.authService)},k=function(){x(),T(),N(),C()},L=function(){l.setup(v.statProviders,v.product)},A=function(){return typeof v=="object"&&v.hasOwnProperty("startRoute")?v.startRoute:""},O=function(e){var t=r.Deferred(),i=new n({cleanupOnDone:!0,itemCallback:function(t,r){var i=function(){var i=m.components[t.name];require([t.name],function(s){s.setId.call(s,t.id).setComponentName.call(s,t.name).setContext.call(s,t.context).setHistory.call(s,t.history).setPrimary.call(s,t.primary).setRouter.call(s,e).addViewOptions.call(s,t.viewOptions).addRoutes.call(s).setStrings.call(s,i.view).setSelection.call(s,t.selection);var o,u=new n({cleanupOnDone:!0,itemCallback:function(e,t){require([e.name],function(n){o=new n,o.feature.setName.call(o.feature,e.name).setCloseEvents.call(o.feature,e.closeEvents).setPrepend.call(o.feature,e.prepend).setContexts.call(o.feature,e.contexts).setModelDefaults.call(o.feature,e.model).setStrings.call(o.feature,i.features[e.name]),s.addFeature.call(s,o.feature),t()})},done:function(){r()}});d.hasOwnProperty(t.name)||(d[t.name]=s);if(t.hasOwnProperty("features")){for(var a in t.features){var f=t.features[a];if(g&&f.model.noApp||!g&&f.model.noDesktop||y&&f.model.noTouch||!E&&f.model.pdfOnly||b&&f.model.noIOS||w&&f.model.noAndroid)continue;u.addItem(f)}u.startQueueProcess()}else r()},function(e){console.log("oh, darn: ",e)})};t.facade?require([t.name],function(e){t=t.components[e],i()}):i()},done:function(){t.resolve()}});return v.components.forEach(function(e){i.addItem(e)},function(e){console.log("oh, darn: "+e)}),i.startQueueProcess(),t},M={autoload:function(e,t,n){var i=r.Deferred();return M.setup(e,t,n),k(),L(),O(n).done(function(){i.resolve()}),i},setup:function(e,t,n){v=e,m=t,S(),n.configuredStartRoute=A()}};return M}),"use strict",define("bootstrap",["router","jquery","backbone","issueService","deviceUtility","requestService","dataService","authService","autoloader","hammer"],function(e,t,n,r,i,s,o,u,a,f){var l="3.1.7.4",c="2017-11-08-1512",h=new e,p,d,v=document.getElementsByTagName("body")[0],m="generatedConfig.json",g="strings.json";f.defaults.stop_browser_behavior.touchAction="auto",window.epaperClient=window.epaperClient||{},window.epaperClient.version=l,window.epaperClient.buildVersion=c,window.epaperClient.toString=function(){return"Epaper version "+l+".  Copyright Infomaker Scandinavia AB 2016."},window.location.origin||(window.location.origin=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")),o.init(),i.isRunningAsHybridApplication?(v.classList.add("device"),d="app"):(v.classList.add("desktop"),d="web"),i.isExtraWideDevice()&&v.classList.add("extra-wide-device"),i.isSmallDevice()?(v.classList.add("small-screen-device"),i.setSmallDevice(!0)):(v.classList.add("large-screen-device"),i.setSmallDevice(!1)),i.hasTouchSupport||v.classList.add("no-touch"),s.getJSON(m+"?"+c).done(function(e){s.getJSON(g+"?"+c).done(function(r){a.setup(e,r,h),o.getOverrides(function(s){t.extend(!0,e,s.config),t.extend(!0,r,s.strings),p=a.autoload(e,r,h),p.done(function(){var t,s,a;r.index&&r.index.title&&(document.title=r.index.title),n.history.start({silent:!0}),t=u.getReturnRoute(),s=u.getRequestedRoute(),!t&&!s?e.selections&&!o.selection()?a="products":a=h.configuredStartRoute:a=t||s,o.setApplicationRootPath(function(e){o.setConnectionStatus(function(e){o.getOsVersion(function(e){i.setOsVersion(e),i.isBadAndroid()&&v.classList.add("old-android-version"),u.getUserId(function(e){n.trigger("setRoute",{route:a,trigger:!0}),n.trigger("stat:init",{userId:e,deviceType:d})})})})})})})})})}),"use strict",require.config({baseUrl:"",deps:[],paths:{app:"core/app",autoloader:"core/autoloader",bootstrap:"core/bootstrap",router:"core/router",advertModel:"core/models/advertModel",articleModel:"core/models/articleModel",baseModel:"core/models/baseModel",issueModel:"core/models/issueModel",sectionModel:"core/models/sectionModel",pageModel:"core/models/pageModel",partModel:"core/models/partModel",baseCollection:"core/collections/baseCollection",issueCollection:"core/collections/issueCollection",sectionCollection:"core/collections/sectionCollection",articleCollection:"core/collections/articleCollection",pageCollection:"core/collections/pageCollection",partCollection:"core/collections/partCollection",baseView:"core/views/baseView",baseFeatureView:"core/views/baseFeatureView",coverView:"core/views/coverView",sidebarView:"core/views/sidebarView",imageGalleryView:"core/views/imageGallery/imageGalleryView",imageGalleryFullscreenView:"core/views/imageGallery/imageGalleryFullscreenView",advertUtility:"utilities/advertUtility",dateUtility:"utilities/dateUtility",deviceUtility:"utilities/deviceUtility",stringUtility:"utilities/stringUtility",viewUtility:"utilities/viewUtility",queueUtility:"utilities/queueUtility",historyUtility:"utilities/historyUtility",activeSlideUtility:"utilities/activeSlideUtility",statUtility:"utilities/statUtility",appUtility:"utilities/appUtility",clientExtensions:"utilities/clientExtensions",bonnierIPA:"core/statProviders/bonnierIPA",burtHelper:"core/statProviders/burt",cxenseWrapper:"core/statProviders/cxense",googleTagManager:"core/statProviders/googleTagManager",googleTagManagerExtended:"core/statProviders/googleTagManagerExtended",imStat:"core/statProviders/infomaker",imBilling:"core/statProviders/infomakerBilling",localService:"DAL/localService",stateService:"DAL/stateService",sessionService:"DAL/sessionService",authService:"DAL/authService",webAuthService:"DAL/webAuthService",nativeAuthService:"DAL/nativeAuthService",dataService:"DAL/dataService",statService:"DAL/statService",nativeService:"DAL/nativeService",webService:"DAL/webService",requestService:"DAL/requestService",issueService:"DAL/issueService",apiService:"DAL/apiService",downloadService:"DAL/downloadService",cookieService:"DAL/cookieService",errorService:"DAL/errorService",archiveSearchService:"DAL/archiveSearchService",baseComponent:"components/baseComponent",authMessageComponent:"components/authMessage/authMessageComponent",headerComponent:"components/header/headerComponent",footerComponent:"components/footer/footerComponent",coversComponent:"components/covers/coversComponent",pagesComponent:"components/pages/pagesComponent",pdfComponent:"components/pdf/pdfComponent",pdfNativeComponent:"components/pdfNative/pdfNativeComponent",pagesFacadeComponent:"components/pagesFacade/pagesFacadeComponent",readerComponent:"components/reader/readerComponent",popupComponent:"components/popup/popupComponent",issueEntryComponent:"components/issueEntry/issueEntryComponent",thumbnailsComponent:"components/thumbnails/thumbnailsComponent",infoComponent:"components/info/infoComponent",messageComponent:"components/message/messageComponent",productsComponent:"components/products/productsComponent",baseFeature:"features/baseFeature",baseFeatureModel:"features/baseFeatureModel",authMessageView:"components/authMessage/views/authMessageView",messageView:"components/message/views/messageView",headerView:"components/header/views/headerView",footerView:"components/footer/views/footerView",coversView:"components/covers/views/coversView",productsView:"components/products/views/productsView",selectionIconFeature:"components/covers/features/selectionIcon/selectionIconFeature",selectionIconView:"components/covers/features/selectionIcon/views/selectionIconView",selectionIconModel:"components/covers/features/selectionIcon/models/selectionIconModel",coversIconFeature:"features/coversIcon/coversIconFeature",coversIconView:"features/coversIcon/views/coversIconView",coversIconModel:"features/coversIcon/models/coversIconModel",displayOnceFeature:"features/displayOnce/displayOnceFeature",displayOnceView:"features/displayOnce/views/displayOnceView",displayOnceModel:"features/displayOnce/models/displayOnceModel",deviceWaypointFeature:"features/deviceWaypoint/deviceWaypointFeature",deviceWaypointView:"features/deviceWaypoint/views/deviceWaypointView",deviceWaypointModel:"features/deviceWaypoint/models/deviceWaypointModel",socialShareFeature:"features/socialShare/socialShareFeature",socialShareView:"features/socialShare/views/socialShareView",socialShareModel:"features/socialShare/models/socialShareModel",logoutIconFeature:"features/logoutIcon/logoutIconFeature",logoutIconView:"features/logoutIcon/views/logoutIconView",logoutIconModel:"features/logoutIcon/models/logoutIconModel",issueDetailsDisplayFeature:"features/issueDetailsDisplay/issueDetailsDisplayFeature",issueDetailsDisplayView:"features/issueDetailsDisplay/views/issueDetailsDisplayView",issueDetailsDisplayModel:"features/issueDetailsDisplay/models/issueDetailsDisplayModel",downloadedCoversIconFeature:"features/downloadedCoversIcon/downloadedCoversIconFeature",downloadedCoversIconView:"features/downloadedCoversIcon/views/downloadedCoversIconView",downloadedCoversIconModel:"features/downloadedCoversIcon/models/downloadedCoversIconModel",readerView:"components/reader/views/readerView",articleView:"components/reader/views/articleView",advertView:"components/reader/views/advertView",readerSwiperView:"components/reader/views/readerSwiperView",articleListFeature:"features/articleList/articleListFeature",listItemView:"features/articleList/views/listItemView",baseArticleListView:"features/articleList/views/baseArticleListView",articleListView:"features/articleList/views/articleListView",sectionView:"features/articleList/views/sectionView",listGroupView:"features/articleList/views/listGroupView",readerIconFeature:"features/readerIcon/readerIconFeature",readerIconView:"features/readerIcon/views/readerIconView",readerIconModel:"features/readerIcon/models/readerIconModel",textsizeFeature:"components/reader/features/textsize/textsizeFeature",textsizeView:"components/reader/features/textsize/views/textsizeView",textsizeModel:"components/reader/features/textsize/models/textsizeModel",pagesView:"components/pages/views/pagesView",pdfsView:"components/pdf/views/pdfsView",pdfView:"components/pdf/views/pdfView",pdfNativeView:"components/pdfNative/views/pdfNativeView",eventView:"components/pdf/views/eventView",pageView:"components/pages/views/pageView",pagesPartWrapperView:"components/pages/views/pagesPartWrapperView",pagesPartView:"components/pages/views/pagesPartView",articleEventView:"components/pages/views/articleEventView",fullPortraitWidthFeature:"components/pdf/features/fullPortraitWidth/fullPortraitWidthFeature",fullPortraitWidthView:"components/pdf/features/fullPortraitWidth/views/fullPortraitWidthView",fullPortraitWidthModel:"components/pdf/features/fullPortraitWidth/models/fullPortraitWidthModel",zoomButtonsFeature:"components/pdf/features/zoomButtons/zoomButtonsFeature",zoomButtonsView:"components/pdf/features/zoomButtons/views/zoomButtonsView",zoomButtonsModel:"components/pdf/features/zoomButtons/models/zoomButtonsModel",progressbarFeature:"components/pdf/features/progressbar/progressbarFeature",progressbarView:"components/pdf/features/progressbar/views/progressbarView",progressbarModel:"components/pdf/features/progressbar/models/progressbarModel",pdfPrintFeature:"components/pdf/features/pdfPrint/pdfPrintFeature",pdfPrintView:"components/pdf/features/pdfPrint/views/pdfPrintView",pdfPrintModel:"components/pdf/features/pdfPrint/models/pdfPrintModel",pagesZoomFeature:"components/pages/features/pagesZoom/pagesZoomFeature",pagesZoomView:"components/pages/features/pagesZoom/views/pagesZoomView",tileView:"components/pages/features/pagesZoom/views/tileView",pagesZoomModel:"components/pages/features/pagesZoom/models/pagesZoomModel",pagesIconFeature:"features/pagesIcon/pagesIconFeature",pagesIconView:"features/pagesIcon/views/pagesIconView",pagesIconModel:"features/pagesIcon/models/pagesIconModel",downloadIssueIconFeature:"features/downloadIssueIcon/downloadIssueIconFeature",downloadIssueIconView:"features/downloadIssueIcon/views/downloadIssueIconView",downloadIssueIconModel:"features/downloadIssueIcon/models/downloadIssueIconModel",startpageIconFeature:"features/startpageIcon/startpageIconFeature",startpageIconView:"features/startpageIcon/views/startpageIconView",startpageIconModel:"features/startpageIcon/models/startpageIconModel",toggleIconFeature:"features/toggleIcon/toggleIconFeature",toggleIconView:"features/toggleIcon/views/toggleIconView",toggleIconModel:"features/toggleIcon/models/toggleIconModel",toggleArticleListIconFeature:"features/toggleArticleListIcon/toggleArticleListIconFeature",toggleArticleListIconView:"features/toggleArticleListIcon/views/toggleArticleListIconView",toggleArticleListIconModel:"features/toggleArticleListIcon/models/toggleArticleListIconModel",toggleFooterIconFeature:"features/toggleFooterIcon/toggleFooterIconFeature",toggleFooterIconView:"features/toggleFooterIcon/views/toggleFooterIconView",toggleFooterIconModel:"features/toggleFooterIcon/models/toggleFooterIconModel",thumbnailsView:"components/thumbnails/views/thumbnailsView",thumbnailView:"components/thumbnails/views/thumbnailView",articleSearchFeature:"features/articleSearch/articleSearchFeature",articleSearchView:"features/articleSearch/views/articleSearchView",articleSearchModel:"features/articleSearch/models/articleSearchModel",archiveSearchInputFeature:"features/archiveSearchInput/archiveSearchInputFeature",archiveSearchInputView:"features/archiveSearchInput/views/archiveSearchInputView",archiveSearchResultFeature:"features/archiveSearchResult/archiveSearchResultFeature",archiveSearchResultView:"features/archiveSearchResult/views/archiveSearchResultView",archiveSearchPaginationView:"features/archiveSearchResult/views/archiveSearchPaginationView",archiveSearchFilterView:"features/archiveSearchResult/views/archiveSearchFilterView",logoFeature:"features/logo/logoFeature",logoModel:"features/logo/models/logoModel",logoView:"features/logo/views/logoView",currentUserFeature:"features/currentUser/currentUserFeature",currentUserModel:"features/currentUser/models/currentUserModel",currentUserView:"features/currentUser/views/currentUserView",loadIssuesIconFeature:"features/loadIssuesIcon/loadIssuesIconFeature",loadIssuesIconModel:"features/loadIssuesIcon/models/loadIssuesIconModel",loadIssuesIconView:"features/loadIssuesIcon/views/loadIssuesIconView",dateFeature:"features/date/dateFeature",dateModel:"features/date/models/dateModel",dateView:"features/date/views/dateView",linkFeature:"features/link/linkFeature",linkView:"features/link/views/linkView",linkModel:"features/link/models/linkModel",fullscreenFeature:"features/fullscreen/fullscreenFeature",fullscreenView:"features/fullscreen/views/fullscreenView",fullscreenModel:"features/fullscreen/models/fullscreenModel",prevNextNavigationFeature:"features/prevNextNavigation/prevNextNavigationFeature",prevNextNavigationView:"features/prevNextNavigation/views/prevNextNavigationView",prevNextNavigationModel:"features/prevNextNavigation/models/prevNextNavigationModel",issueEntryIconFeature:"features/issueEntryIcon/issueEntryIconFeature",issueEntryIconView:"features/issueEntryIcon/views/issueEntryIconView",issueEntryIconModel:"features/issueEntryIcon/models/issueEntryIconModel",textOutletFeature:"features/textOutlet/textOutletFeature",textOutletView:"features/textOutlet/views/textOutletView",textOutletModel:"features/textOutlet/models/textOutletModel",baseEventTriggerButtonView:"features/eventTriggerButton/baseEventTriggerButton/views/baseEventTriggerButtonView",baseEventTriggerButtonModel:"features/eventTriggerButton/baseEventTriggerButton/models/baseEventTriggerButtonModel",eventTriggerButtonAFeature:"features/eventTriggerButton/eventTriggerButtonA/eventTriggerButtonAFeature",eventTriggerButtonAView:"features/eventTriggerButton/eventTriggerButtonA/views/eventTriggerButtonAView",eventTriggerButtonAModel:"features/eventTriggerButton/eventTriggerButtonA/models/eventTriggerButtonAModel",eventTriggerButtonBFeature:"features/eventTriggerButton/eventTriggerButtonB/eventTriggerButtonBFeature",eventTriggerButtonBView:"features/eventTriggerButton/eventTriggerButtonB/views/eventTriggerButtonBView",eventTriggerButtonBModel:"features/eventTriggerButton/eventTriggerButtonB/models/eventTriggerButtonBModel",eventTriggerButtonCFeature:"features/eventTriggerButton/eventTriggerButtonC/eventTriggerButtonCFeature",eventTriggerButtonCView:"features/eventTriggerButton/eventTriggerButtonC/views/eventTriggerButtonCView",eventTriggerButtonCModel:"features/eventTriggerButton/eventTriggerButtonC/models/eventTriggerButtonCModel",eventTriggerButtonDFeature:"features/eventTriggerButton/eventTriggerButtonD/eventTriggerButtonDFeature",eventTriggerButtonDView:"features/eventTriggerButton/eventTriggerButtonD/views/eventTriggerButtonDView",eventTriggerButtonDModel:"features/eventTriggerButton/eventTriggerButtonD/models/eventTriggerButtonDModel",eventTriggerButtonEFeature:"features/eventTriggerButton/eventTriggerButtonE/eventTriggerButtonEFeature",eventTriggerButtonEView:"features/eventTriggerButton/eventTriggerButtonE/views/eventTriggerButtonEView",eventTriggerButtonEModel:"features/eventTriggerButton/eventTriggerButtonE/models/eventTriggerButtonEModel",eventTriggerButtonFFeature:"features/eventTriggerButton/eventTriggerButtonF/eventTriggerButtonFFeature",eventTriggerButtonFView:"features/eventTriggerButton/eventTriggerButtonF/views/eventTriggerButtonFView",eventTriggerButtonFModel:"features/eventTriggerButton/eventTriggerButtonF/models/eventTriggerButtonFModel",eventTriggerButtonGFeature:"features/eventTriggerButton/eventTriggerButtonG/eventTriggerButtonGFeature",eventTriggerButtonGView:"features/eventTriggerButton/eventTriggerButtonG/views/eventTriggerButtonGView",eventTriggerButtonGModel:"features/eventTriggerButton/eventTriggerButtonG/models/eventTriggerButtonGModel",eventTriggerButtonHFeature:"features/eventTriggerButton/eventTriggerButtonH/eventTriggerButtonHFeature",eventTriggerButtonHView:"features/eventTriggerButton/eventTriggerButtonH/views/eventTriggerButtonHView",eventTriggerButtonHModel:"features/eventTriggerButton/eventTriggerButtonH/models/eventTriggerButtonHModel",popupView:"components/popup/views/popupView",issueEntryView:"components/issueEntry/views/issueEntryView",issueEntryPartView:"components/issueEntry/views/issueEntryPartView",infoView:"components/info/views/infoView",jquery:"vendor/jquery/jquery",jqueryBrowser:"vendor/jqueryBrowser/jquery.browser",blockAdblockCSS:"vendor/blockAdblockCSS/blockAdblockCSS",velocity:"vendor/velocity/velocity","pdfjs-dist/build/pdf":"vendor/pdfjs/build/pdf","pdfjs-dist/build/pdf.worker":"vendor/pdfjs/build/pdf.worker.js?2017-11-08-1512",f:"vendor/stats/f",backbone:"vendor/backbone/backbone",underscore:"vendor/underscore/underscore",transit:"vendor/transit/transit",IScroll:"vendor/IScroll/IScroll",hammer:"vendor/hammer/hammer",swiper:"vendor/swiper/swiper.3.0.7",scrollTo:"vendor/scrollto/scrollTo",md5:"vendor/md5/md5",moment:"vendor/moment/moment",jqueryDatepicker:"vendor/jqueryDatepicker/jquery-ui",coverTemplate:"core/templates/coverView.html",coversCoverTemplate:"components/covers/templates/coverView.html"},shim:{blockAdblockCSS:{exports:"blockAdBlockCSS",deps:["jquery"]},underscore:{exports:"_"},smartbanner:{exports:"SmartBanner"},velocity:{deps:["jquery"],exports:"velocity"},f:{exports:"f"},scrollTo:{deps:["jquery"],exports:"scrollTo"},hammer:{deps:["jquery"],exports:"Hammer"},"pdfjs-dist/build/pdf":{exports:"pdfjs"}}}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(e){if(this==null)throw new TypeError('"this" is null or not defined');var t=Object(this),n=t.length>>>0;if(typeof e!="function")throw new TypeError("predicate must be a function");var r=arguments[1],i=0;while(i<n){var s=t[i];if(e.call(r,s,i,t))return s;i++}return undefined}}),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(e,t){function o(e,t){return e===t||typeof e=="number"&&typeof t=="number"&&isNaN(e)&&isNaN(t)}if(this==null)throw new TypeError('"this" is null or not defined');var n=Object(this),r=n.length>>>0;if(r===0)return!1;var i=t|0,s=Math.max(i>=0?i:r-Math.abs(i),0);while(s<r){if(o(n[s],e))return!0;s++}return!1}}),require(["bootstrap"]),define("core/config",function(){});